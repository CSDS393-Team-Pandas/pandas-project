/*!
*  filename: ej2-kanban.min.js
*  version : 19.4.48
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.kanban=function(e,t,n,a,r,i,o,l){"use strict";var s="content-ready",d="data-ready",c=function(){function e(e){this.dataState={isPending:!1,resolver:null,isDataChanged:!1},this.parent=e,this.keyField=this.parent.cardSettings.headerField,this.dataState={isDataChanged:!1},this.isObservable=!1,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof a.DataManager?e:new a.DataManager(e),this.query=t instanceof a.Query?t:new a.Query,this.kanbanData=new a.DataManager(this.parent.kanbanData)},e.prototype.getQuery=function(){return this.query.clone()},e.prototype.getData=function(e){if(this.parent.dataSource&&"result"in this.parent.dataSource){var t=this.eventPromise({requestType:""},e);return this.isObservable=!0,t.promise}return this.dataManager.executeQuery(e)},e.prototype.setState=function(e){return this.dataState=e},e.prototype.getStateEventArgument=function(e){var n=new a.UrlAdaptor,r=new a.DataManager({url:"",adaptor:new a.UrlAdaptor}),i=n.processQuery(r,e),o=JSON.parse(i.data);return t.extend(o,i.pvtData)},e.prototype.eventPromise=function(e,n,r){var i=this,o=e,l=this.getStateEventArgument(n),s=new a.Deferred,d=new a.Deferred;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(l.action=e,"cardChanged"===e.requestType||"cardRemoved"===e.requestType||"cardCreated"===e.requestType){var c=e;c.promise=d.promise,c.state=l,c.index=r,this.setState({isPending:!0,resolver:d.resolve}),o.endEdit=d.resolve,o.cancelEdit=d.reject,this.parent.trigger("dataSourceChanged",c),d.promise.then(function(){i.setState({isPending:!0,resolver:s.resolve}),i.parent.trigger("dataStateChange",l),c.addedRecords.forEach(function(e){i.parent.kanbanData.push(e)}),c.changedRecords.forEach(function(e){var n=i.parent.kanbanData.filter(function(t){return t[i.parent.cardSettings.headerField]===e[i.parent.cardSettings.headerField]})[0];t.extend(n,e)}),c.deletedRecords.forEach(function(e){var t=i.parent.kanbanData.findIndex(function(t){return t[i.parent.cardSettings.headerField]===e[i.parent.cardSettings.headerField]});i.parent.kanbanData.splice(t,1)})}).catch(function(){i.parent.hideSpinner()})}else this.setState({isPending:!0,resolver:s.resolve}),this.parent.trigger("dataStateChange",l);else this.setState({}),s.resolve(this.parent.dataSource);return s},e.prototype.getTable=function(){return this.parent.query?this.getQuery().fromTable:null},e.prototype.refreshDataManager=function(){var e=this;this.getData(this.getQuery()).then(function(t){return e.dataManagerSuccess(t)}).catch(function(t){return e.dataManagerFailure(t)})},e.prototype.dataManagerSuccess=function(e,n,a,r){var i=this;if(!this.parent.isDestroyed)if(n){var o=t.extend([],e.result,null,!0);this.parent.kanbanData=o,"cardCreated"===a.requestType?Array.isArray(e)?this.modifyArrayData(a.addedRecords,e):a.addedRecords[0]=t.extend(a.addedRecords[0],e):"cardChanged"===a.requestType?Array.isArray(e)?this.modifyArrayData(a.changedRecords,e):a.changedRecords[0]=t.extend(a.changedRecords[0],e):"cardRemoved"===a.requestType&&(Array.isArray(e)?this.modifyArrayData(a.deletedRecords,e):a.deletedRecords[0]=t.extend(a.deletedRecords[0],e)),this.refreshUI(a,r)}else this.parent.trigger("dataBinding",e,function(e){var n=t.extend([],e.result,null,!0);i.parent.kanbanData=n,i.parent.notify(d,{processedData:n}),i.parent.trigger("dataBound",null,function(){return i.parent.hideSpinner()})})},e.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("actionFailure",{error:e},function(){return t.parent.hideSpinner()})},e.prototype.updateDataManager=function(e,t,n,a,r){var i=this;this.parent.showSpinner();var o,l={requestType:n,cancel:!1,addedRecords:t.addedRecords,changedRecords:t.changedRecords,deletedRecords:t.deletedRecords};this.eventPromise(l,this.query,r),this.parent.trigger("actionComplete",l,function(n){if(!n.cancel){switch(e){case"insert":o=i.dataManager.insert(a,i.getTable(),i.getQuery());break;case"update":o=i.dataManager.update(i.keyField,a,i.getTable(),i.getQuery());break;case"delete":o=i.dataManager.remove(i.keyField,a,i.getTable(),i.getQuery());break;case"batch":o=i.dataManager.saveChanges(t,i.keyField,i.getTable(),i.getQuery())}i.dataManager.dataSource.offline?i.isObservable||(i.kanbanData=i.dataManager,i.parent.kanbanData=i.dataManager.dataSource.json,i.refreshUI(n,r)):o.then(function(){i.parent.isDestroyed||i.getData(i.getQuery()).then(function(e){return i.dataManagerSuccess(e,"DataSourceChange",n,r)}).catch(function(e){return i.dataManagerFailure(e)})}).catch(function(e){i.dataManagerFailure(e)})}})},e.prototype.modifyArrayData=function(e,n){if(e.length===n.length)for(var a=0;a<n.length;a++)e[a]=t.extend(e[a],n[a]);return e},e.prototype.refreshUI=function(e,t){var n=this;this.parent.layoutModule.columnData=this.parent.layoutModule.getColumnCards(),this.parent.swimlaneSettings.keyField&&(this.parent.layoutModule.kanbanRows=this.parent.layoutModule.getRows(),this.parent.layoutModule.swimlaneData=this.parent.layoutModule.getSwimlaneCards()),e.addedRecords.forEach(function(e,a){n.parent.swimlaneSettings.keyField&&!e[n.parent.swimlaneSettings.keyField]&&(e[n.parent.swimlaneSettings.keyField]=""),n.parent.layoutModule.renderCardBasedOnIndex(e,t+a)}),e.changedRecords.forEach(function(e){n.parent.swimlaneSettings.keyField&&!e[n.parent.swimlaneSettings.keyField]&&(e[n.parent.swimlaneSettings.keyField]=""),n.parent.layoutModule.removeCard(e),n.parent.layoutModule.renderCardBasedOnIndex(e,t),n.parent.layoutModule.isSelectedCard&&n.parent.actionModule.SingleCardSelection(e),n.parent.sortSettings.field&&"Index"===n.parent.sortSettings.sortBy&&"Descending"===n.parent.sortSettings.direction&&t>0&&--t}),e.deletedRecords.forEach(function(e){n.parent.layoutModule.removeCard(e)}),this.parent.layoutModule.refresh(),this.parent.renderTemplates(),this.parent.notify(s,{}),this.parent.trigger("dataBound",e,function(){return n.parent.hideSpinner()})},e}(),p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},u=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),h([t.Property()],n.prototype,"keyField",void 0),h([t.Property()],n.prototype,"textField",void 0),h([t.Property(!1)],n.prototype,"showEmptyRow",void 0),h([t.Property(!0)],n.prototype,"showItemCount",void 0),h([t.Property(!1)],n.prototype,"allowDragAndDrop",void 0),h([t.Property()],n.prototype,"template",void 0),h([t.Property("Ascending")],n.prototype,"sortDirection",void 0),h([t.Property()],n.prototype,"sortComparer",void 0),h([t.Property(!0)],n.prototype,"showUnassignedRow",void 0),h([t.Property(!1)],n.prototype,"enableFrozenRows",void 0),n}(t.ChildProperty),g=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),m=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},f=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return g(n,e),m([t.Property(!0)],n.prototype,"showHeader",void 0),m([t.Property()],n.prototype,"headerField",void 0),m([t.Property()],n.prototype,"contentField",void 0),m([t.Property()],n.prototype,"tagsField",void 0),m([t.Property()],n.prototype,"grabberField",void 0),m([t.Property()],n.prototype,"footerCssField",void 0),m([t.Property()],n.prototype,"template",void 0),m([t.Property("Single")],n.prototype,"selectionType",void 0),n}(t.ChildProperty),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},b=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return y(n,e),v([t.Property()],n.prototype,"template",void 0),v([t.Property([])],n.prototype,"fields",void 0),v([t.Property(null)],n.prototype,"model",void 0),n}(t.ChildProperty),w=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),C=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},S=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return w(n,e),C([t.Property()],n.prototype,"keyField",void 0),C([t.Property()],n.prototype,"headerText",void 0),C([t.Property()],n.prototype,"template",void 0),C([t.Property(!1)],n.prototype,"allowToggle",void 0),C([t.Property(!0)],n.prototype,"isExpanded",void 0),C([t.Property()],n.prototype,"minCount",void 0),C([t.Property()],n.prototype,"maxCount",void 0),C([t.Property(!0)],n.prototype,"showItemCount",void 0),C([t.Property(!1)],n.prototype,"showAddButton",void 0),C([t.Property(!0)],n.prototype,"allowDrag",void 0),C([t.Property(!0)],n.prototype,"allowDrop",void 0),C([t.Property([])],n.prototype,"transitionColumns",void 0),n}(t.ChildProperty),k=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),E=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},O=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return k(n,e),E([t.Property()],n.prototype,"text",void 0),E([t.Property()],n.prototype,"keyFields",void 0),n}(t.ChildProperty),D=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),A=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},x=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return D(n,e),A([t.Property("Index")],n.prototype,"sortBy",void 0),A([t.Property()],n.prototype,"field",void 0),A([t.Property("Ascending")],n.prototype,"direction",void 0),n}(t.ChildProperty),j="e-kanban-header",M="e-kanban-content",F="e-show-add-button",T=function(){function e(e){this.parent=e,this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}return e.prototype.clickHandler=function(e){var n=t.closest(e.target,".e-card,.e-header-icon,.e-content-row.e-swimlane-row,.e-show-add-button,.e-frozen-swimlane-row,.e-content-row:not(.e-swimlane-row) .e-content-cells");if(n)if(n.classList.contains("e-card"))this.parent.allowKeyboard&&this.parent.keyboardModule.cardTabIndexRemove(),this.cardClick(e);else if(n.classList.contains("e-header-icon"))this.columnExpandCollapse(e);else if(n.classList.contains("e-content-row")&&n.classList.contains("e-swimlane-row"))this.rowExpandCollapse(e);else if(n.classList.contains(F))this.addButtonClick(n);else if(n.classList.contains("e-frozen-swimlane-row")){var a=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")),r=this.parent.layoutModule.frozenSwimlaneRow.querySelector(".e-icons");this.rowExpandCollapse(e,a[this.parent.layoutModule.frozenOrder]),!!r.classList.contains("e-swimlane-row-collapse")?t.classList(r,["e-swimlane-row-expand"],["e-swimlane-row-collapse"]):t.classList(r,["e-swimlane-row-collapse"],["e-swimlane-row-expand"])}},e.prototype.addButtonClick=function(e){var n=this,a={};if(0===this.parent.kanbanData.length)a[this.parent.cardSettings.headerField]=1;else if("number"==typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]){var r=this.parent.kanbanData.map(function(e){return parseInt(e[n.parent.cardSettings.headerField],10)});a[this.parent.cardSettings.headerField]=Math.max.apply(Math,r)+1}if(a[this.parent.keyField]=t.closest(e,".e-content-cells").getAttribute("data-key"),"Index"===this.parent.sortSettings.sortBy&&(a[this.parent.sortSettings.field]=1,t.closest(e,".e-content-cells").querySelector(".e-card"))){var i="Ascending"===this.parent.sortSettings.direction?e.nextElementSibling.lastElementChild:e.nextElementSibling.firstElementChild,o=this.parent.getCardDetails(i);a[this.parent.sortSettings.field]=o[this.parent.sortSettings.field]+1}0!==this.parent.kanbanData.length&&this.parent.swimlaneSettings.keyField&&t.closest(e,".e-content-row").previousElementSibling&&(a[this.parent.swimlaneSettings.keyField]=t.closest(e,".e-content-row").previousElementSibling.getAttribute("data-key")),this.parent.openDialog("Add",a)},e.prototype.doubleClickHandler=function(e){t.closest(e.target,".e-card")&&this.cardDoubleClick(e)},e.prototype.cardClick=function(e,n){var a=this,r=t.closest(n||e.target,".e-card"),i=this.parent.getCardDetails(r);if(i){this.parent.activeCardData={data:i,element:r};var o={data:i,element:r,cancel:!1,event:e};this.parent.trigger("cardClick",o,function(n){if(!n.cancel){if(r.classList.contains("e-selection")&&"click"===e.type)t.removeClass([r],"e-selection"),a.parent.layoutModule.disableAttributeSelection(r);else{var i=e.ctrlKey;a.parent.isAdaptive&&a.parent.touchModule&&(i=a.parent.touchModule.mobilePopup&&a.parent.touchModule.tabHold||i),a.cardSelection(r,i,e.shiftKey)}a.parent.isAdaptive&&a.parent.touchModule&&a.parent.touchModule.updatePopupContent();var o=t.closest(r,".e-content-cells");a.parent.allowKeyboard&&([].slice.call(o.querySelectorAll(".e-card")).forEach(function(e){e.setAttribute("tabindex","0")}),a.parent.keyboardModule.addRemoveTabIndex("Remove"))}})}},e.prototype.cardDoubleClick=function(e){var n=this,a=t.closest(e.target,".e-card"),r=this.parent.getCardDetails(a);this.parent.activeCardData={data:r,element:a},this.cardSelection(a,!1,!1);var i={data:r,element:a,cancel:!1,event:e};this.parent.trigger("cardDoubleClick",i,function(e){e.cancel||n.parent.dialogModule.openDialog("Edit",i.data)})},e.prototype.rowExpandCollapse=function(e,n){var a=this,r=e instanceof HTMLElement?e:e.target,i=t.isNullOrUndefined(n)?r:n,o={cancel:!1,target:r,requestType:"rowExpandCollapse"};this.parent.trigger("actionBegin",o,function(e){if(!e.cancel){var n,o=t.closest(i,".e-swimlane-row"),l=o.getAttribute("data-key"),d=a.parent.element.querySelector(".e-content-row:nth-child("+(o.rowIndex+2)+")"),c=o.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse"),p=!!o.classList.contains("e-collapsed");p?(t.removeClass([d,o],"e-collapsed"),t.classList(c,["e-swimlane-row-expand"],["e-swimlane-row-collapse"]),a.parent.swimlaneToggleArray.splice(a.parent.swimlaneToggleArray.indexOf(l),1),n="0"):(t.addClass([d,o],"e-collapsed"),t.classList(c,["e-swimlane-row-collapse"],["e-swimlane-row-expand"]),a.parent.swimlaneToggleArray.push(l),n="-1"),c.setAttribute("aria-label",p?l+" Expand":l+" Collapse"),o.setAttribute("aria-expanded",p.toString()),d.setAttribute("aria-expanded",p.toString()),[].slice.call(d.querySelectorAll(".e-content-cells")).forEach(function(e){e.setAttribute("tabindex",n)}),a.parent.notify(s,{}),a.parent.trigger("actionComplete",{target:r,requestType:"rowExpandCollapse"})}})},e.prototype.columnExpandCollapse=function(e){var n=this,a=e instanceof HTMLElement?e:e.target,r={cancel:!1,target:a,requestType:"columnExpandCollapse"};this.parent.trigger("actionBegin",r,function(e){if(!e.cancel){var r=t.closest(a,".e-header-cells"),i=r.cellIndex;n.columnToggle(r);var o=n.parent.element.querySelectorAll(".e-header-cells.e-collapsed").length;if(o===n.parent.columns.length-n.hideColumnKeys.length){var l=".e-header-cells:not(.e-stacked-header-cell):nth-child("+(i+1===o?1:i+2)+")",d=n.parent.element.querySelector(l);t.addClass([d],"e-collapsed"),n.columnToggle(d)}n.parent.notify(s,{}),n.parent.trigger("actionComplete",{target:a,requestType:"columnExpandCollapse"})}})},e.prototype.columnToggle=function(e){var n=this,a=e.cellIndex,r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),i=".e-kanban-table col:nth-child("+(a+1)+")",o=e.querySelector(".e-column-expand,.e-column-collapse"),l=[].slice.call(this.parent.element.querySelectorAll(i));if(e.classList.contains("e-collapsed")){t.removeClass(l,"e-collapsed"),this.parent.isAdaptive&&l.forEach(function(e){return e.style.width=t.formatUnit(n.parent.layoutModule.getWidth())}),t.classList(o,["e-column-expand"],["e-column-collapse"]);for(var s=0,d=r;s<d.length;s++)!function(n){var r=n.querySelector(".e-content-cells:nth-child("+(a+1)+")");t.removeClass([r,e],"e-collapsed"),t.remove(r.querySelector(".e-collapse-header-text")),e.setAttribute("aria-expanded","true"),r.setAttribute("aria-expanded","true"),[].slice.call(r.parentElement.querySelectorAll(".e-collapsed")).forEach(function(e){var t=e.querySelector(".e-collapse-header-text");t.style.height="auto",t&&r.getBoundingClientRect().height<t.getBoundingClientRect().height+10&&(t.style.height=r.getBoundingClientRect().height-4+"px")})}(g=d[s]);this.columnToggleArray.splice(this.columnToggleArray.indexOf(e.getAttribute("data-key")),1),this.parent.columns[a].setProperties({isExpanded:!0},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",e.getAttribute("data-key")+" Expand")}else{t.addClass(l,"e-collapsed"),this.parent.isAdaptive&&l.forEach(function(e){return e.style.width=t.formatUnit(50)}),t.classList(o,["e-column-collapse"],["e-column-expand"]);for(var c=e.getAttribute("data-key"),p=this,h=0,u=r;h<u.length;h++){var g=u[h];!function(n){var a=n.querySelector('.e-content-cells[data-key="'+c+'"]'),r=a.cellIndex,i=(p.parent.columns[r].showItemCount?"["+a.querySelectorAll(".e-card").length+"] ":"")+p.parent.columns[r].headerText;a.appendChild(t.createElement("div",{className:"e-collapse-header-text",innerHTML:i})),t.addClass([a,e],"e-collapsed"),e.setAttribute("aria-expanded","false"),a.setAttribute("aria-expanded","false"),[].slice.call(a.parentElement.querySelectorAll(".e-collapsed")).forEach(function(e){var t=e.querySelector(".e-collapse-header-text");t&&a.getBoundingClientRect().height<t.getBoundingClientRect().height+10&&(t.style.height=a.getBoundingClientRect().height-4+"px")})}(g)}this.columnToggleArray.push(e.getAttribute("data-key")),this.parent.columns[a].setProperties({isExpanded:!1},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",c+" Collapse")}},e.prototype.cardSelection=function(e,n,a){var r=this;if(e){var i=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var o=t.closest(e,".e-content-row");if((t.isNullOrUndefined(this.lastSelectionRow)?o.rowIndex:this.lastSelectionRow.rowIndex)!==o.rowIndex&&(n||a)&&"Multiple"===this.parent.cardSettings.selectionType)return;if(0===i.length||n&&"Single"!==this.parent.cardSettings.selectionType||(t.removeClass(i,"e-selection"),this.parent.layoutModule.disableAttributeSelection(i),i.forEach(function(e){r.selectionArray.splice(r.selectionArray.indexOf(e.getAttribute("data-id")),1),r.selectedCardsElement.splice(r.selectedCardsElement.indexOf(e),1),r.selectedCardsData.splice(r.selectedCardsData.indexOf(r.parent.getCardDetails(e),1))})),i.length>0&&a&&"Multiple"===this.parent.cardSettings.selectionType){var l=[],s=void 0,d=void 0,c=void 0,p=[].slice.call(o.querySelectorAll(".e-card"));p.forEach(function(e){return l.push(e.getAttribute("data-id"))});var h=e.getAttribute("data-id"),u=this.lastCard.getAttribute("data-id"),g=d=l.indexOf(h),m=s=l.indexOf(u),f=g>m?"next":"prev";for("prev"===f&&(s=g,d=m),c=s;c<=d;c++){var y=p[c];t.addClass([y],"e-selection"),y.setAttribute("aria-selected","true"),y.setAttribute("tabindex","0"),this.selectionArray.push(y.getAttribute("data-id")),this.selectedCardsElement.push(y),this.selectedCardsData.push(this.parent.getCardDetails(y)),this.lastCardSelection=y,"prev"===f&&(this.lastCardSelection=p[s])}}else if(t.addClass([e],"e-selection"),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=t.closest(e,".e-content-row"),this.lastSelectionRow.previousElementSibling){var v=this.lastSelectionRow.previousElementSibling.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse");v&&v.classList.contains("e-swimlane-row-collapse")&&this.rowExpandCollapse(v)}}}},e.prototype.addColumn=function(e,n){var a=t.createInstance(S,[this.parent,"columns",e,!0]);this.parent.columns.splice(n,0,a),this.parent.notify(d,{processedData:this.parent.kanbanData})},e.prototype.deleteColumn=function(e){var n=this.parent.element.querySelectorAll(".e-header-cells").item(e);n&&n.classList.contains("e-toggle-header")&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(n.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?(t.detach(this.parent.element.querySelector("."+j)),t.detach(this.parent.element.querySelector("."+M))):this.parent.notify(d,{processedData:this.parent.kanbanData})},e.prototype.showColumn=function(e){var t=this.hideColumnKeys.indexOf(e.toString());-1!==t&&(this.hideColumnKeys.splice(t,1),this.parent.notify(d,{processedData:this.parent.kanbanData}))},e.prototype.hideColumn=function(e){this.hideColumnKeys.push(e.toString()),this.parent.notify(d,{processedData:this.parent.kanbanData})},e.prototype.SingleCardSelection=function(e){if("None"!==this.parent.cardSettings.selectionType&&e[this.parent.cardSettings.headerField]){var n=this.parent.element.querySelector('.e-card[data-id="'+e[this.parent.cardSettings.headerField].toString()+'"]');n&&(t.addClass([n],"e-selection"),n.setAttribute("aria-selected","true"),n.setAttribute("tabindex","0"))}},e}(),R=function(){function e(e){this.parent=e}return e.prototype.addCard=function(e,t){var n=this,a={cancel:!1,requestType:"cardCreate",addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]};this.parent.trigger("actionBegin",a,function(a){if(!a.cancel){var r=[];n.parent.sortSettings.field&&"Index"===n.parent.sortSettings.sortBy&&(e instanceof Array?r=e:r.push(e),r.forEach(function(e,t){if(!e[n.parent.sortSettings.field]){var a=n.parent.getColumnData(e[n.parent.keyField]);"Ascending"===n.parent.sortSettings.direction&&a.length>0?e[n.parent.sortSettings.field]=a[a.length-1][n.parent.sortSettings.field]+t+1:"Descending"===n.parent.sortSettings.direction&&a.length>0&&(e[n.parent.sortSettings.field]=a[0][n.parent.sortSettings.field]+t+1),0===a.length&&(e[n.parent.sortSettings.field]=1)}}),e instanceof Array||t||"Descending"!==n.parent.sortSettings.direction||n.parent.getColumnData(r[0][n.parent.keyField]).filter(function(e,a){e[n.parent.sortSettings.field]===r[0][n.parent.sortSettings.field]&&(t=a+1)}),0===t||t||"Descending"!==n.parent.sortSettings.direction||(t=0),r=n.priorityOrder(r,t));var i={addedRecords:e instanceof Array?e:[e],changedRecords:n.parent.sortSettings.field&&"Index"===n.parent.sortSettings.sortBy?r:[],deletedRecords:[]},o=e instanceof Array||r.length>0?"batch":"insert";n.parent.dataModule.updateDataManager(o,i,"cardCreated",e,t)}})},e.prototype.getIndexFromData=function(e){var n=this.parent.element.querySelector('.e-card[data-id="'+e[this.parent.cardSettings.headerField]+'"]'),a=t.closest(n,".e-content-cells");return[].slice.call(a.querySelectorAll(".e-card")).indexOf(n)},e.prototype.updateCard=function(e,n){var a=this,r={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};n=t.isNullOrUndefined(n)?this.getIndexFromData(r.changedRecords[0]):n,this.parent.trigger("actionBegin",r,function(t){if(!t.cancel){if(a.parent.sortSettings.field&&"Index"===a.parent.sortSettings.sortBy){var r=[];e instanceof Array?r=e:r.push(e),e=a.priorityOrder(r,n)}var i={addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]},o=e instanceof Array?"batch":"update";a.parent.dataModule.updateDataManager(o,i,"cardChanged",e,n)}})},e.prototype.deleteCard=function(e){var t=this,n={addedRecords:[],changedRecords:[],deletedRecords:[]};n.deletedRecords="string"==typeof e||"number"==typeof e?this.parent.kanbanData.filter(function(n){return n[t.parent.cardSettings.headerField]===e}):e instanceof Array?e:[e];var a={requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:n.deletedRecords};this.parent.trigger("actionBegin",a,function(e){if(!e.cancel){var a=n.deletedRecords.length>1?"batch":"delete",r=n.deletedRecords;t.parent.dataModule.updateDataManager(a,n,"cardRemoved",r[0])}})},e.prototype.priorityOrder=function(e,n){for(var a,r=this,i=e.map(function(e){return e[r.parent.cardSettings.headerField]}),o=e[e.length-1][this.parent.sortSettings.field],l=e.map(function(e){return e[r.parent.keyField]}),s=[],d=[],c=this,p=0,h=l.filter(function(e,t){return l.indexOf(e)===t}).sort();p<h.length;p++)!function(l){var p=e.filter(function(e){return e[r.parent.keyField]===l});a=c.parent.layoutModule.getColumnData(l);for(var h=0,u=p;h<u.length;h++){var g=u[h];if(c.parent.swimlaneSettings.keyField){var m=c.parent.getSwimlaneData(g[c.parent.swimlaneSettings.keyField]);a=c.parent.getColumnData(l,m)}}if(p.forEach(function(e){return s.push(e)}),!t.isNullOrUndefined(n)){for(var f=0;f<i.length;f++)!function(e){a.filter(function(t,a){t[r.parent.cardSettings.headerField]===i[e]&&a<=n&&d.push(a)})}(f);if(d.length>0&&(n+=d.length),"Ascending"===c.parent.sortSettings.direction)for(y=n;y<a.length;y++)-1===i.indexOf(a[y][c.parent.cardSettings.headerField])&&(a[y][c.parent.sortSettings.field]=++o,s.push(a[y]));else for(var y=n-1;y>=0;y--)-1===i.indexOf(a[y][c.parent.cardSettings.headerField])&&(a[y][c.parent.sortSettings.field]=++o,s.push(a[y]))}}(h[p]);return s},e}(),q=function(){function e(e){this.parent=e,this.dragObj={element:null,cloneElement:null,instance:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[],modifiedData:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1},this.isDragging=!1,this.isExternalDrop=!1}return e.prototype.wireDragEvents=function(e){var n;null!=!this.parent.element&&0===this.parent.externalDropId.length&&(n=this.parent.element.querySelector("."+M)),this.dragObj.instance=new t.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:n,dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)})},e.prototype.dragHelper=function(e){if(this.parent.isAdaptive&&this.parent.touchModule.mobilePopup&&this.parent.touchModule.mobilePopup.element.classList.contains("e-popup-open")&&this.parent.touchModule.mobilePopup.hide(),this.dragObj.element=t.closest(e.sender.target,".e-card"),t.isNullOrUndefined(this.dragObj.element))return null;this.dragObj.element.style.width=t.formatUnit(this.dragObj.element.offsetWidth);var n=t.createElement("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=n.children.item(0),t.addClass([this.dragObj.cloneElement],"e-cloned-card"),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=t.createElement("div",{className:"e-target-multi-clone"}),this.dragObj.targetClone=t.createElement("div",{className:"e-target-dropped-clone",styles:"width:100%;height:"+t.formatUnit(this.dragObj.element.offsetHeight)}),this.dragObj.modifiedData=[],this.dragObj.cloneElement},e.prototype.dragStart=function(e){var n=this;if(this.dragObj.selectedCards=this.dragObj.element,this.dragObj.element.classList.contains("e-selection")){var a=t.closest(this.dragObj.element,".e-content-row");this.dragObj.selectedCards=[].slice.call(a.querySelectorAll(".e-card.e-selection:not(.e-cloned-card)")),this.dragObj.selectedCards.forEach(function(e){n.dragObj.cardDetails.push(n.parent.getCardDetails(e))})}else this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)];var r={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStart",r,function(a){if(a.cancel)return n.removeElement(n.dragObj.cloneElement),n.dragObj.instance.intDestroy(e),n.dragObj.element=null,n.dragObj.targetClone=null,n.dragObj.draggedClone=null,n.dragObj.cloneElement=null,void(n.dragObj.targetCloneMulti=null);if(n.dragObj.element.classList.contains("e-selection")){if(n.dragObj.selectedCards.forEach(function(e){n.draggedClone(e)}),n.dragObj.selectedCards.length>1){n.dragObj.cloneElement.innerHTML="";var r=t.createElement("div",{className:"e-multi-card-text",innerHTML:n.dragObj.selectedCards.length+" Cards"});n.dragObj.cloneElement.appendChild(r),t.classList(n.dragObj.cloneElement,["e-multi-card-clone"],["e-selection"]),n.parent.layoutModule.disableAttributeSelection(n.dragObj.cloneElement),n.dragObj.cloneElement.style.width="90px"}}else n.draggedClone(n.dragObj.element);t.EventHandler.add(document.body,"keydown",n.keydownHandler,n),n.parent.notify(s,{})})},e.prototype.draggedClone=function(e){this.dragObj.draggedClone=t.createElement("div",{className:"e-target-dragged-clone",styles:"width:"+t.formatUnit(e.offsetWidth-1)+";height:"+t.formatUnit(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),t.addClass([e],"e-kanban-dragged-card")},e.prototype.drag=function(e){var n=this;if(e.target){var a=t.closest(e.target,".e-kanban .e-card"),r=a||e.target,i=t.closest(r,".e-content-row:not(.e-swimlane-row) .e-content-cells.e-droppable");if(this.externalDrop(r),this.kanbanObj=this.parent.isExternalKanbanDrop?this.parent.externalDropObj:this.parent,this.calculateArgs(e),i&&"not-allowed"!==document.body.style.cursor){var o=this.getColumnKey(i),l=o.split(",");this.multiCloneRemove();var d=o===this.getColumnKey(t.closest(this.dragObj.draggedClone,".e-content-cells"));if(1===l.length||d)if(r.classList.contains("e-target-dragged-clone")&&this.removeElement(this.dragObj.targetClone,this.kanbanObj),r.classList.contains("e-card")){var c=r.classList.contains("e-target-dragged-clone")&&r.previousElementSibling.classList.contains("e-kanban-dragged-card")?null:r.previousElementSibling,p="afterend";if(t.isNullOrUndefined(c)){var h=r.classList.contains("e-target-dragged-clone")?this.dragObj.pageY/2:this.dragObj.pageY,u=r.classList.contains("e-target-dragged-clone")?r.offsetHeight:r.offsetHeight/2;h-(this.kanbanObj.element.getBoundingClientRect().top+r.offsetTop)<u&&(p="beforebegin")}r.insertAdjacentElement(p,this.dragObj.targetClone)}else if(r.classList.contains("e-content-cells")&&!t.closest(r,".e-swimlane-row")){if(0!==r.querySelectorAll(".e-kanban-dragged-card").length&&0===r.querySelectorAll(".e-card:not(.e-kanban-dragged-card):not(.e-cloned-card)").length)return;r.querySelector(".e-card-wrapper").appendChild(this.dragObj.targetClone)}else r.classList.contains("e-card-wrapper")&&!t.closest(r,".e-swimlane-row")&&0===i.querySelectorAll(".e-card").length&&r.appendChild(this.dragObj.targetClone);else l.length>1&&i.classList.contains("e-dropping")&&this.multiCloneCreate(l,i);this.kanbanObj.notify(s,{})}0===this.kanbanObj.element.querySelectorAll(".e-dropping").length&&this.cellDropping();var g=!1;i&&(g=i.classList.contains("e-collapsed")&&i.classList.contains("e-dropping")),g&&(this.toggleVisible(r),t.addClass([i],"e-toggle-visible"));var m=[].slice.call(this.kanbanObj.element.querySelectorAll(".e-toggle-visible"));m.length>0&&!r.classList.contains("e-toggle-visible")&&!t.closest(r,".e-toggle-visible")&&(this.toggleVisible(r,m.slice(-1)[0]),t.removeClass(m,"e-toggle-visible")),this.kanbanObj.notify(s,{});var f=t.closest(r,".e-column-key");if(f){var y=[].slice.call(this.kanbanObj.element.querySelectorAll(".e-column-key:not(.e-disabled)")).filter(function(e){return n.getColumnKey(e)===n.getColumnKey(f)});y.length>0&&(t.addClass(y,"e-multi-active"),y[0].previousElementSibling&&t.addClass([y[0].previousElementSibling],"e-multi-bottom-border"))}document.body.style.cursor=i&&i.classList.contains("e-dropping")?"":"not-allowed",a&&!t.closest(a,".e-content-cells").classList.contains("e-dropping")&&(a.style.cursor="not-allowed",document.body.style.cursor="not-allowed"),this.isExternalDrop&&"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.multiCloneRemove()),this.updateScrollPosition();var v={data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.kanbanObj.trigger("drag",v),this.parent.isExternalKanbanDrop=!1,this.isExternalDrop=!1}},e.prototype.removeElement=function(e,n){(n=n||this.parent).element.getElementsByClassName(e.className).length>0&&t.remove(e)},e.prototype.externalDrop=function(e){var n=this;this.parent.externalDropId.forEach(function(a){var r=t.closest(e,a);if(r)if(r.classList.contains("e-kanban")){n.parent.externalDropObj=document.querySelector(a).ej2_instances[0],n.parent.isExternalKanbanDrop=!0;var i=[].slice.call(n.parent.externalDropObj.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed) .e-content-cells"));t.addClass(i,"e-dropping")}else n.isExternalDrop=!0})},e.prototype.multiCloneCreate=function(e,n){var a=n.offsetHeight,r=n.querySelector(".e-limits");r&&(a-=r.offsetHeight),this.dragObj.targetCloneMulti.style.height=t.formatUnit(a),n.querySelector("."+F)&&t.addClass([n.querySelector("."+F)],"e-multi-card-wrapper"),t.addClass([n.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"),n.querySelector(".e-card-wrapper").style.height="auto",n.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var i=0,o=e;i<o.length;i++){var l=o[i],s=t.closest(this.dragObj.draggedClone,".e-content-cells"),d=this.kanbanObj.columns[s.cellIndex].transitionColumns,c=this.allowedTransition(this.dragObj.element.getAttribute("data-key"),l,d),p=c?"":" e-disabled",h=t.createElement("div",{className:"e-column-key"+p,attrs:{"data-key":l.trim()}}),u=t.createElement("div",{className:"e-text",innerHTML:l.trim()});n.appendChild(this.dragObj.targetCloneMulti).appendChild(h).appendChild(u),h.style.cursor=c?"":"not-allowed",h.style.lineHeight=h.style.height=t.formatUnit(a/e.length),u.style.top=t.formatUnit(a/2-u.offsetHeight/2)}},e.prototype.allowedTransition=function(e,t,n){for(var a=!0,r=t.split(","),i=0;i<r.length;i++){if(e===r[i].trim())return!0;if(n){if(1===n.length&&0===n[0].length)return!0;for(var o=0;o<n.length;o++){if(r[i].trim()===n[o].trim())return!0;a=!1}}}return a},e.prototype.cellDropping=function(){var e=this,n=t.closest(this.dragObj.draggedClone,".e-content-cells"),a=t.closest(this.dragObj.draggedClone,".e-content-row");if(this.addDropping(a,n),n&&n.classList.contains("e-drop")&&t.addClass([n],"e-dropping"),this.kanbanObj.swimlaneSettings.keyField&&this.kanbanObj.swimlaneSettings.allowDragAndDrop){var r=[].slice.call(this.kanbanObj.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed)"));[].slice.call(r).forEach(function(t){a!==t&&e.addDropping(t,n)})}},e.prototype.addDropping=function(e,n){var a=this;n&&e&&[].slice.call(e.children).forEach(function(e){var r=a.kanbanObj.columns[n.cellIndex].transitionColumns;e!==n&&e.classList.contains("e-drop")&&a.allowedTransition(n.getAttribute("data-key"),e.getAttribute("data-key"),r)&&t.addClass([e],"e-dropping")})},e.prototype.keydownHandler=function(e){"Escape"===e.code&&this.dragObj.cloneElement&&(t.EventHandler.remove(this.dragObj.cloneElement,"keydown",this.keydownHandler),this.dragObj.element.removeAttribute("aria-grabbed"),this.dragStopClear(),this.dragStopPostClear())},e.prototype.dragStop=function(e){var n,a,r=this,i=t.closest(this.dragObj.targetClone,".e-content-cells");if(t.EventHandler.remove(document.body,"keydown",this.keydownHandler),this.dragObj.targetClone.parentElement){a=[].slice.call(this.dragObj.targetClone.parentElement.querySelectorAll(".e-card:not(.e-kanban-dragged-card),.e-target-dropped-clone")).indexOf(this.dragObj.targetClone)}if(!t.isNullOrUndefined(this.kanbanObj)&&this.kanbanObj.element.querySelector(".e-target-multi-clone")&&(n=t.closest(e.target,".e-column-key:not(.e-disabled)")),i||n){var o;i?o=this.getColumnKey(i):(o=this.getColumnKey(n),i=t.closest(n,".e-content-cells")),this.dragObj.selectedCards instanceof HTMLElement?this.updateDroppedData(this.dragObj.selectedCards,o,i):this.dragObj.selectedCards.forEach(function(e){r.updateDroppedData(e,o,i)}),this.parent.sortSettings.field&&"Index"===this.parent.sortSettings.sortBy&&this.changeOrder(this.dragObj.modifiedData)}0===this.dragObj.modifiedData.length&&(this.dragObj.modifiedData=this.dragObj.cardDetails);var l={cancel:!1,data:this.dragObj.modifiedData,event:e,element:this.dragObj.selectedCards,dropIndex:a};this.parent.trigger("dragStop",l,function(e){if(r.dragStopClear(),!e.cancel&&(i||n)){var t=e.data instanceof Array&&e.data.length>1?e.data:e.data[0];r.parent.crudModule.updateCard(t,e.dropIndex)}r.dragStopPostClear()})},e.prototype.dragStopClear=function(){this.removeElement(this.dragObj.draggedClone),this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.removeElement(this.dragObj.cloneElement),[].slice.call(this.parent.element.querySelectorAll(".e-target-dragged-clone")).forEach(function(e){t.remove(e)}),this.dragObj.element.style.removeProperty("width"),this.multiCloneRemove(),this.dragObj.selectedCards instanceof HTMLElement?t.removeClass([this.dragObj.selectedCards],"e-kanban-dragged-card"):t.removeClass(this.dragObj.selectedCards,"e-kanban-dragged-card"),clearInterval(this.dragObj.navigationInterval),this.dragObj.navigationInterval=null,"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),[].slice.call(this.parent.element.querySelectorAll(".e-card[style]")).forEach(function(e){e.style.cursor=""});var e=".e-content-row:not(.e-swimlane-row)";[].slice.call(this.parent.element.querySelectorAll(e+" .e-content-cells")).forEach(function(e){return t.removeClass([e],"e-dropping")}),this.parent.externalDropObj&&[].slice.call(this.parent.externalDropObj.element.querySelectorAll(e+" .e-content-cells")).forEach(function(e){return t.removeClass([e],"e-dropping")})},e.prototype.dragStopPostClear=function(){this.parent.isAdaptive&&(this.parent.touchModule.tabHold=!1),this.dragObj.cardDetails=this.dragObj.modifiedData=[],this.isDragging=!1,this.parent.isExternalKanbanDrop=!1,this.parent.externalDropObj=null},e.prototype.updateDroppedData=function(e,n,a){var r=this.parent.getCardDetails(e),i=t.extend({},r,null,!0);if(1===n.split(",").length&&(i[this.parent.keyField]=n),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){var o=t.closest(a,".e-content-row").previousElementSibling;if(this.parent.isAdaptive){var l=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField;i[this.parent.swimlaneSettings.keyField]=l}else i[this.parent.swimlaneSettings.keyField]=this.getColumnKey(o)}this.dragObj.modifiedData.push(i)},e.prototype.changeOrder=function(e){var t=this,n=!1,a="Ascending"===this.kanbanObj.sortSettings.direction?this.dragObj.targetClone.previousElementSibling:this.dragObj.targetClone.nextElementSibling;if(!a||a.classList.contains("e-kanban-dragged-card")||a.classList.contains("e-cloned-card")||a.classList.contains("e-target-dragged-clone"))if(this.dragObj.targetClone.nextElementSibling&&"Ascending"===this.kanbanObj.sortSettings.direction)a=this.dragObj.targetClone.nextElementSibling;else{if(!this.dragObj.targetClone.previousElementSibling||"Descending"!==this.kanbanObj.sortSettings.direction)return;a=this.dragObj.targetClone.previousElementSibling}else n=!0;if(a.classList.contains("e-card")){var r=this.kanbanObj.getCardDetails(a)[this.kanbanObj.sortSettings.field];e.length>1&&"Descending"===this.kanbanObj.sortSettings.direction&&(e=e.reverse()),e.forEach(function(e,a){n?e[t.kanbanObj.sortSettings.field]=++r:1!==r&&a<=e[t.kanbanObj.sortSettings.field]?e[t.kanbanObj.sortSettings.field]=--r:1===r&&(e[t.kanbanObj.sortSettings.field]=a+1)})}},e.prototype.toggleVisible=function(e,n){var a=this;[].slice.call(this.kanbanObj.element.querySelectorAll(".e-header-cells:not(.e-stacked-header-cell)")).forEach(function(t){a.getColumnKey(t)===a.getColumnKey(n||e)&&a.kanbanObj.actionModule.columnToggle(t)});var r=t.closest(this.dragObj.draggedClone,".e-content-cells");if(r){var i=t.formatUnit(r.offsetWidth-16);this.dragObj.draggedClone.style.width=i,this.dragObj.cloneElement.style.width=i}},e.prototype.multiCloneRemove=function(){var e=[].slice.call(this.kanbanObj.element.querySelectorAll(".e-target-multi-clone"));e.length>0&&([].slice.call(this.kanbanObj.element.querySelectorAll(".e-column-key")).forEach(function(e){return t.remove(e)}),e.forEach(function(e){var n=t.closest(e,".e-content-cells");n&&(n.style.borderStyle="",n.querySelector("."+F)&&t.removeClass([n.querySelector("."+F)],"e-multi-card-wrapper"),t.removeClass([n.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"))}),this.removeElement(this.dragObj.targetCloneMulti,this.kanbanObj))},e.prototype.calculateArgs=function(e){var t=this.getPageCoordinates(e);this.dragObj.pageY=t.pageY,this.dragObj.pageX=t.pageX,this.isDragging=!0,this.kanbanObj.isAdaptive&&this.kanbanObj.tooltipModule&&this.kanbanObj.tooltipModule.tooltipObj.close()},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getColumnKey=function(e){return e&&e.getAttribute("data-key")?e.getAttribute("data-key").trim():""},e.prototype.updateScrollPosition=function(){var e=this;t.isNullOrUndefined(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval(function(){e.autoScroll()},100))},e.prototype.autoScrollValidation=function(){var e=this.dragObj.pageY,t=this.dragObj.pageX,n={left:!1,right:!1,top:!1,bottom:!1},a=this.kanbanObj.element.querySelector("."+M).getBoundingClientRect();e<a.top+30+window.pageYOffset&&e>a.top+window.pageYOffset&&(n.top=!0),e>a.bottom-30+window.pageYOffset&&e<a.bottom+window.pageYOffset&&(n.bottom=!0),t<a.left+30+window.pageXOffset&&t>a.left+window.pageXOffset&&(n.left=!0),t>a.right-30+window.pageXOffset&&t<a.right+window.pageXOffset&&(n.right=!0),this.dragEdges=n},e.prototype.autoScroll=function(){this.autoScrollValidation();if(this.kanbanObj.isAdaptive){var e;if(this.dragEdges.top||this.dragEdges.bottom?e=this.dragObj.targetClone?t.closest(this.dragObj.targetClone,".e-card-wrapper"):t.closest(this.dragObj.draggedClone,".e-card-wrapper"):(this.dragEdges.right||this.dragEdges.left)&&(e=this.kanbanObj.element.querySelector("."+M)),e){var n=e.offsetHeight<=e.scrollHeight,a=e.offsetWidth<=e.scrollWidth,r=e.scrollTop>=0&&e.scrollTop+e.offsetHeight<=e.scrollHeight,i=e.scrollLeft>=0&&e.scrollLeft+e.offsetWidth<=e.scrollWidth;n&&r&&(this.dragEdges.top||this.dragEdges.bottom)&&(e.scrollTop+=this.dragEdges.top?-66:30),a&&i&&(this.dragEdges.left||this.dragEdges.right)&&(this.kanbanObj.layoutModule.getWidth()*(this.kanbanObj.columns.length-1)>e.scrollLeft||this.dragEdges.left)&&(e.scrollLeft+=this.dragEdges.left?-30:30)}}else{var o=this.kanbanObj.element.querySelector("."+M),l=this.dragObj.targetClone.parentElement,s=o.offsetHeight<=o.scrollHeight,d=o.offsetWidth<=o.scrollWidth,c=s&&o.scrollTop>=0&&o.scrollTop+o.offsetHeight<=o.scrollHeight,p=d&&o.scrollLeft>=0&&o.scrollLeft+o.offsetWidth<=o.scrollWidth;c&&(this.dragEdges.top||this.dragEdges.bottom)&&(o.scrollTop+=this.dragEdges.top?-30:30,l&&(l.scrollTop+=this.dragEdges.top?-30:30)),p&&(this.dragEdges.left||this.dragEdges.right)&&(o.scrollLeft+=this.dragEdges.left?-30:30,l&&(l.scrollLeft+=this.dragEdges.left?-30:30)),this.dragObj.pageY-window.scrollY<30?window.scrollTo(window.scrollX,window.scrollY-30):window.innerHeight-(this.dragObj.pageY-window.scrollY)<30&&window.scrollTo(window.scrollX,window.scrollY+30)}},e.prototype.unWireDragEvents=function(e){var t=e.ej2_instances[0];t&&!t.isDestroyed&&t.destroy()},e}(),P=function(){function e(e){this.preventUpdate=!1,this.parent=e}return e.prototype.openDialog=function(e,t){this.action=e,this.parent.activeCardData.data=t,this.renderDialog(t,e),this.dialogObj.show()},e.prototype.closeDialog=function(){this.dialogObj.hide()},e.prototype.renderDialog=function(e,a){this.element=t.createElement("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);var r={buttons:this.getDialogButtons(a),content:this.getDialogContent(e,a),cssClass:"e-kanban-dialog",enableRtl:this.parent.enableRtl,header:this.parent.localeObj.getConstant("Add"===a?"addTitle":"Edit"===a?"editTitle":"deleteTitle"),height:"auto",isModal:!0,showCloseIcon:!0,width:"Delete"===a?400:350,visible:!1,beforeOpen:this.onBeforeDialogOpen.bind(this),beforeClose:this.onBeforeDialogClose.bind(this)};this.dialogObj=new n.Dialog(t.extend(r,"Delete"!==a?this.parent.dialogSettings.model||{}:{}),this.element),"Delete"!==a&&this.applyFormValidation(),this.dialogObj.element.querySelector(".e-dlg-closeicon-btn").title=this.parent.localeObj.getConstant("close")},e.prototype.getDialogContent=function(e,n){if("Delete"===n)return this.parent.localeObj.getConstant("deleteContent");var a=t.createElement("div",{className:"e-kanban-form-wrapper"}),r=t.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-kanban-form",attrs:{onsubmit:"return false;"}});if(this.parent.dialogSettings.template){e&&(this.destroyComponents(),[].slice.call(r.childNodes).forEach(function(e){return t.remove(e)}));var i=this.parent.element.id+"_dialogTemplate",o=this.parent.templateParser(this.parent.dialogSettings.template)(e,this.parent,"dialogTemplate",i,!1);t.append(o,r),this.parent.renderTemplates()}else{var l=t.createElement("div",{className:"e-kanban-dialog-content"});r.appendChild(l);var s=t.createElement("table");l.appendChild(s);for(var d=0,c=this.getDialogFields();d<c.length;d++){var p=c[d],h=t.createElement("tr");s.appendChild(h),h.appendChild(t.createElement("td",{className:"e-label",innerHTML:p.text?p.text:p.key}));var u=t.createElement("td");h.appendChild(u),u.appendChild(this.renderComponents(p))}}return a.appendChild(r),a},e.prototype.getDialogFields=function(){var e=this.parent.dialogSettings.fields;return 0===e.length&&(e=[{text:"ID",key:this.parent.cardSettings.headerField,type:"TextBox"},{key:this.parent.keyField,type:"DropDown"},{key:this.parent.cardSettings.contentField,type:"TextArea"}],this.parent.sortSettings.field&&e.splice(e.length-1,0,{key:this.parent.sortSettings.field,type:"TextBox"}),this.parent.swimlaneSettings.keyField&&e.splice(e.length-1,0,{key:this.parent.swimlaneSettings.keyField,type:"DropDown"})),e},e.prototype.getDialogButtons=function(e){var t="Delete"===e?"e-dialog-yes":"Add"===e?"e-dialog-add":"e-dialog-edit",n="Delete"===e?"e-dialog-no":"e-dialog-cancel",a=[{buttonModel:{cssClass:"e-flat "+t,isPrimary:!0,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"save":"yes")},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-flat "+n,isPrimary:!1,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"cancel":"no")},click:this.dialogButtonClick.bind(this)}];if("Edit"===e){var r={buttonModel:{cssClass:"e-flat e-dialog-delete",isPrimary:!1,content:this.parent.localeObj.getConstant("delete")},click:this.dialogButtonClick.bind(this)};a.splice(0,0,r)}return a},e.prototype.renderComponents=function(e){var n=t.createElement("div",{className:e.key+"_wrapper"}),a=t.createElement("input",{className:"e-field",attrs:{name:e.key}});n.appendChild(a);var o,l,s,d=this.parent.activeCardData.data?this.parent.activeCardData.data[e.key]:null;switch(e.type){case"DropDown":if(e.key===this.parent.keyField){var c=this.parent.layoutModule.columnKeys;if(this.parent.actionModule.hideColumnKeys.length>0){c=[];for(var p=0;p<this.parent.columns.length;p++)this.parent.layoutModule.isColumnVisible(this.parent.columns[p])&&(c="number"==typeof this.parent.columns[p].keyField?c.concat(this.parent.columns[p].keyField.toString()):c.concat(this.parent.columns[p].keyField.split(",").map(function(e){return e.trim()})))}l={dataSource:c,value:d?d.toString():d}}else e.key===this.parent.swimlaneSettings.keyField&&(l={dataSource:[].slice.call(this.parent.layoutModule.kanbanRows),fields:{text:"textField",value:"keyField"},value:d});s=new r.DropDownList(l);break;case"Numeric":s=new i.NumericTextBox({value:d});break;case"TextBox":s=new i.TextBox({value:d}),d&&this.parent.cardSettings.headerField===e.key&&(s.enabled=!1);break;case"TextArea":t.remove(a),o=t.createElement("div"),a=t.createElement("textarea",{className:"e-field",attrs:{name:e.key,rows:"3"},innerHTML:d}),n.appendChild(o).appendChild(a)}return s&&s.appendTo(a),n},e.prototype.onBeforeDialogOpen=function(e){var t=this,n={data:this.parent.activeCardData.data,cancel:!1,element:this.element,target:this.parent.activeCardData.element,requestType:this.action};this.storeElement=document.activeElement,parseInt(e.maxHeight,10)<=250&&(e.maxHeight="250px"),this.parent.trigger("dialogOpen",n,function(n){e.cancel=n.cancel,n.cancel&&t.destroy()})},e.prototype.onBeforeDialogClose=function(e){var n=this,a=this.getFormElements(),r={};if(e.isInteracted&&(this.preventUpdate=!0),!this.preventUpdate)for(var i=0,o=a;i<o.length;i++){var l=o[i],s=l.name||this.getColumnName(l);if(!t.isNullOrUndefined(s)&&""!==s){var d=this.getValueFromElement(l);s===this.parent.cardSettings.headerField&&(d="string"===this.getIDType()?d:parseInt(d,10)),r[s]=d}}this.preventUpdate=!1;var c={data:r=t.extend(this.parent.activeCardData.data,r),cancel:!1,element:this.element,requestType:this.action};this.parent.trigger("dialogClose",c,function(t){e.cancel=t.cancel,t.cancel||(n.cardData=c.data,n.destroy(),n.parent.actionModule.SingleCardSelection(n.cardData))})},e.prototype.getIDType=function(){return 0!==this.parent.kanbanData.length?typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]:"string"},e.prototype.applyFormValidation=function(){for(var e=this,t=this.element.querySelector(".e-kanban-form"),n={},a=0,r=this.parent.dialogSettings.fields;a<r.length;a++){var o=r[a];n[o.key]=o.validationRules&&Object.keys(o.validationRules).length>0?o.validationRules:null}this.formObj=new i.FormValidator(t,{rules:n,customPlacement:function(t,n){var a=n.getAttribute("for");e.element.querySelector("#"+a+"_Error")||e.createTooltip(t,n,a,"")},validationComplete:function(t){var n=e.element.querySelector("#"+t.inputName+"_Error");n&&(n.style.display="failure"===t.status?"":"none")}})},e.prototype.createTooltip=function(e,n,a,r){var i,o,l=e.parentElement.getBoundingClientRect();this.element.classList.contains("e-kanban-dialog")?(i=this.element,o=this.element.getBoundingClientRect()):o=(i=this.element.querySelector(".e-kanban-dialog .e-dlg-content")).getBoundingClientRect();var s=t.createElement("div",{className:"e-tooltip-wrap e-popup e-kanban-error",id:a+"_Error",styles:"display:"+r+";top:"+(l.bottom-o.top+i.scrollTop+9)+"px;left:"+(l.left-o.left+i.scrollLeft+l.width/2)+"px;"}),d=t.createElement("div",{className:"e-tip-content"});d.appendChild(n);var c=t.createElement("div",{className:"e-arrow-tip e-tip-top"});c.appendChild(t.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),c.appendChild(t.createElement("div",{className:"e-arrow-tip-inner e-tip-top"})),s.appendChild(d),s.appendChild(c),i.appendChild(s),s.style.left=parseInt(s.style.left,10)-s.offsetWidth/2+"px"},e.prototype.destroyToolTip=function(){this.element&&this.element.querySelectorAll(".e-kanban-error").forEach(function(e){return t.remove(e)}),this.formObj&&this.formObj.element&&this.formObj.reset()},e.prototype.dialogButtonClick=function(e){var t=e.target.cloneNode(!0),n=this.formObj.element.id;if(document.getElementById(n)&&this.formObj.validate()&&(t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add"))){if(this.dialogObj.hide(),t.classList.contains("e-dialog-edit")){var a=this.parent.activeCardData,r=void 0;a.data[this.parent.keyField]===this.cardData[this.parent.keyField]&&a.element&&(r=[].slice.call(a.element.parentElement.children).indexOf(a.element)),this.parent.crudModule.updateCard(this.cardData,r)}t.classList.contains("e-dialog-add")&&this.parent.crudModule.addCard(this.cardData),this.parent.actionModule.SingleCardSelection(this.cardData),this.cardData=null}t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add")||(t.classList.contains("e-dialog-cancel")&&(this.preventUpdate=!0),this.dialogObj.hide(),t.classList.contains("e-dialog-yes")?this.parent.crudModule.deleteCard(this.parent.activeCardData.data):t.classList.contains("e-dialog-no")?this.openDialog("Edit",this.parent.activeCardData.data):t.classList.contains("e-dialog-delete")&&this.openDialog("Delete",this.parent.activeCardData.data))},e.prototype.getFormElements=function(){for(var e=[],t=0,n=[].slice.call(this.element.querySelectorAll(".e-field"));t<n.length;t++){var a=n[t];a.classList.contains("e-control")?e.push(a):a.querySelector(".e-control")?e.push(a.querySelector(".e-control")):e.push(a)}return e},e.prototype.getColumnName=function(e){var n=e.getAttribute("data-name")||"";if(""===n){var a=!1,r="";e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?(r=e.classList.contains("e-dropdownlist")?"e-ddl":"e-multiselect",a=!0):e.classList.contains("e-numerictextbox")&&(r="e-numeric");var i=a?"."+r+":not(.e-control)":"."+r,o=t.closest(e,i)||e.querySelector("."+r);if(o){var l=o.querySelector("[name]");l&&(n=l.name)}}return n},e.prototype.getValueFromElement=function(e){return e.classList.contains("e-dropdownlist")?e.ej2_instances[0].value:e.classList.contains("e-multiselect")?e.ej2_instances[0].value:e.classList.contains("e-checkbox")?e.ej2_instances[0].checked:"checkbox"===e.type?e.checked:e.value},e.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements();e<t.length;e++){var n=t[e].ej2_instances;n&&n.length>0&&n.forEach(function(e){return e.destroy()})}},e.prototype.destroy=function(){this.destroyToolTip(),this.destroyComponents(),this.dialogObj&&(this.dialogObj.destroy(),this.storeElement.focus(),this.dialogObj=null,t.remove(this.element),this.element=null)},e}(),L=function(){function e(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",multiSelectionEnter:"ctrl+13",multiSelectionSpace:"ctrl+32",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",shiftTab:"shift+tab",enter:"13",tab:"tab",delete:"46",escape:"27",space:"32"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.multiSelection=!1}return e.prototype.keyActionHandler=function(e){var n=this,a=this.parent.element.querySelectorAll(".e-card.e-selection").item(0);if(a||t.closest(document.activeElement,".e-kanban")){var r,i=[];switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":e.preventDefault(),this.processUpDownArrow(e.action,a);break;case"rightArrow":case"leftArrow":this.processLeftRightArrow(e);break;case"firstCardSelection":case"lastCardSelection":this.processCardSelection(e.action,a);break;case"multiSelectionEnter":case"multiSelectionSpace":document.activeElement&&this.parent.actionModule.cardSelection(document.activeElement,!0,!1);break;case"space":case"enter":this.processEnter(e,a);break;case"escape":if(document.activeElement.classList.contains("e-card")||document.activeElement.classList.contains(F))if(document.activeElement.classList.contains("e-selection"))t.removeClass([document.activeElement],"e-selection"),document.activeElement.focus();else{var o=t.closest(document.activeElement,".e-content-cells"),l=[].slice.call(o.querySelectorAll(".e-card"));t.removeClass(l,"e-selection"),o.focus(),this.cardTabIndexRemove(),this.addRemoveTabIndex("Add")}break;case"tab":case"shiftTab":r=t.closest(document.activeElement,".e-content-cells"),document.activeElement.classList.contains("e-card")&&(document.activeElement.nextElementSibling||"tab"!==e.action||e.preventDefault(),!document.activeElement.previousElementSibling&&r.querySelector("."+F)&&"tab"===e.action&&t.addClass([r.querySelector("."+F)],"e-show-add-focus")),document.activeElement.classList.contains(F)&&(!r.querySelector(".e-card")&&"tab"===e.action||"shiftTab"===e.action)&&e.preventDefault(),document.activeElement.classList.contains("e-kanban")&&(this.cardTabIndexRemove(),this.parent.keyboardModule.addRemoveTabIndex("Add"));break;case"delete":[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection")).forEach(function(e){i.push(n.parent.getCardDetails(e))}),this.parent.crudModule.deleteCard(i)}}},e.prototype.processCardSelection=function(e,n){if(n){t.removeClass([n],"e-selection"),this.parent.layoutModule.disableAttributeSelection(n);var a=this.parent.actionModule.selectionArray;a.splice(a.indexOf(n.getAttribute("data-id")),1)}this.cardTabIndexRemove();var r=[].slice.call(this.parent.element.querySelectorAll(".e-card")),i="firstCardSelection"===e?r[0]:r[r.length-1];this.parent.actionModule.cardSelection(i,!1,!1),this.addRemoveTabIndex("Remove"),i.focus(),[].slice.call(t.closest(i,".e-content-cells").querySelectorAll(".e-card")).forEach(function(e){e.setAttribute("tabindex","0")})},e.prototype.processLeftRightArrow=function(e){document.activeElement.classList.contains("e-content-cells")&&("rightArrow"===e.action&&document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():"leftArrow"===e.action&&document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus())},e.prototype.processUpDownArrow=function(e,n){if("upArrow"===e&&document.activeElement){if(document.activeElement.classList.contains("e-card")&&document.activeElement.previousElementSibling)document.activeElement.previousElementSibling.focus();else if(document.activeElement.classList.contains(F)){document.activeElement.setAttribute("tabindex","-1"),t.removeClass([document.activeElement],"e-show-add-focus");var a=t.closest(document.activeElement,".e-content-cells");a.querySelectorAll(".e-card").length>0&&[].slice.call(a.querySelectorAll(".e-card")).slice(-1)[0].focus()}this.removeSelection()}else if("downArrow"===e&&document.activeElement&&document.activeElement.classList.contains("e-card")){if(document.activeElement.nextElementSibling)document.activeElement.nextElementSibling.focus();else if(t.closest(document.activeElement,".e-card-wrapper").nextElementSibling){var r=t.closest(document.activeElement,".e-card-wrapper").nextElementSibling;r.setAttribute("tabindex","0"),t.addClass([r],"e-show-add-focus"),r.focus()}this.removeSelection()}if(("multiSelectionByUpArrow"===e||"multiSelectionByDownArrow"===e)&&n&&"Multiple"===this.parent.cardSettings.selectionType){var i=void 0;(i="multiSelectionByUpArrow"===e?document.activeElement.previousElementSibling:document.activeElement.nextElementSibling)&&(this.parent.actionModule.cardSelection(i,!1,!0),i.focus(),this.multiSelection=!0)}},e.prototype.removeSelection=function(){if(this.multiSelection){var e=this.parent.getSelectedCards();e.length>0&&(t.removeClass(e,"e-selection"),this.parent.layoutModule.disableAttributeSelection(e)),this.multiSelection=!1}},e.prototype.cardTabIndexRemove=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card")).forEach(function(e){e.setAttribute("tabindex","-1")}),[].slice.call(this.parent.element.querySelectorAll("."+F)).forEach(function(e){e.setAttribute("tabindex","-1"),t.removeClass([e],"e-show-add-focus")})},e.prototype.processEnter=function(e,t){"space"===e.action&&e.preventDefault();var n=e.target;if(n.classList.contains("e-header-icon")&&this.parent.actionModule.columnExpandCollapse(e),(n.classList.contains("e-swimlane-row-expand")||n.classList.contains("e-swimlane-row-collapse"))&&this.parent.actionModule.rowExpandCollapse(e),document.activeElement.classList.contains("e-card")&&this.parent.actionModule.cardSelection(document.activeElement,!1,!1),document.activeElement.classList.contains(F)&&(this.parent.dialogModule.dialogObj||this.parent.actionModule.addButtonClick(document.activeElement),document.activeElement.focus()),n.classList.contains("e-content-cells")){var a=[].slice.call(n.querySelectorAll(".e-card"));this.addRemoveTabIndex("Remove"),a.length>0&&(n.querySelector(".e-card").focus(),a.forEach(function(e){e.setAttribute("tabindex","0")})),n.querySelector("."+F)&&(n.querySelector("."+F).setAttribute("tabindex","0"),n.querySelector("."+F).focus())}t===document.activeElement&&1===this.parent.element.querySelectorAll(".e-selection").length&&(this.parent.activeCardData={data:this.parent.getCardDetails(t),element:t},this.parent.dialogModule.dialogObj||this.parent.dialogModule.openDialog("Edit",this.parent.getCardDetails(t)),t.focus())},e.prototype.addRemoveTabIndex=function(e){var t="Add"===e?"0":"-1",n=[].slice.call(this.parent.element.querySelectorAll(".e-header-icon"));n.length>0&&n.forEach(function(e){e.setAttribute("tabindex",t)});var a=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row-expand"));a.length>0&&a.forEach(function(e){e.setAttribute("tabindex",t)});[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach(function(e){e.setAttribute("tabindex",t)})},e.prototype.destroy=function(){this.keyboardModule.destroy()},e}(),H=function(){function e(e){this.parent=e,this.renderTooltip()}return e.prototype.renderTooltip=function(){this.tooltipObj=new n.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:".e-tooltip-text",beforeRender:this.onBeforeRender.bind(this),beforeClose:this.onBeforeClose.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},e.prototype.onBeforeRender=function(e){if(this.parent.dragAndDropModule.isDragging)return void(e.cancel=!0);var n;if(this.parent.tooltipTemplate){n=t.createElement("div");var a=t.closest(e.target,".e-card"),r=this.parent.getCardDetails(a),i=this.parent.element.id+"_tooltipTemplate",o=this.parent.templateParser(this.parent.tooltipTemplate)(r,this.parent,"tooltipTemplate",i,!1);t.append(o,n),this.parent.renderTemplates()}else n='<div class="e-card-header-caption">'+e.target.innerText+"</div>";this.tooltipObj.setProperties({content:n},!0)},e.prototype.onBeforeClose=function(){this.parent.resetTemplates(["tooltipTemplate"])},e.prototype.destroy=function(){this.tooltipObj.destroy(),t.addClass([this.parent.element],"e-control"),this.tooltipObj=null},e}(),N=function(){function e(e){this.parent=e,this.tabHold=!1}return e.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+M),this.touchObj=new t.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},e.prototype.tapHoldHandler=function(e){this.tabHold=!0;var n=t.closest(e.originalEvent.target,".e-card");n&&"Multiple"===this.parent.cardSettings.selectionType&&(this.parent.actionModule.cardSelection(n,!0,!1),this.mobilePopup||(this.renderMobilePopup(),this.mobilePopup.show()),this.updatePopupContent())},e.prototype.renderMobilePopup=function(){if("Multiple"===this.parent.cardSettings.selectionType){var e=t.createElement("div",{className:"e-mobile-popup-wrapper e-popup-close",innerHTML:'<div class="e-popup-header"><button class="e-close"></button></div><div class="e-popup-content"></div>'});document.body.appendChild(e),t.addClass([e],"e-device"),this.mobilePopup=new n.Popup(e,{targetType:"container",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut"},showAnimation:{name:"ZoomIn"},collision:{X:"fit",Y:"fit"},position:{X:"left",Y:"top"},viewPortElement:document.body,zIndex:1004,close:this.popupClose.bind(this)});var a=this.mobilePopup.element.querySelector(".e-close"),r=new o.Button({cssClass:"e-flat e-round e-small",enableRtl:this.parent.enableRtl,iconCss:"e-icons e-close-icon"});r.appendTo(a),r.isStringTemplate=!0,t.EventHandler.add(a,"click",this.closeClick,this)}},e.prototype.getPopupContent=function(){var e,t=this.parent.getSelectedCards();return t.length>1?e="("+t.length+") "+this.parent.localeObj.getConstant("cardsSelected"):1===t.length&&(e=" "+this.parent.getCardDetails(t[0])[this.parent.cardSettings.headerField]),e},e.prototype.updatePopupContent=function(){if(this.mobilePopup){var e=this.getPopupContent();e?this.mobilePopup.element.querySelector(".e-popup-content").textContent=e:this.mobilePopup.hide()}},e.prototype.closeClick=function(){this.parent.touchModule.mobilePopup.hide()},e.prototype.popupClose=function(){this.popupDestroy()},e.prototype.popupDestroy=function(){if(this.mobilePopup&&this.mobilePopup.element){var e=this.mobilePopup.element.querySelector(".e-control.e-btn").ej2_instances[0];e&&e.destroy(),this.mobilePopup.destroy(),t.remove(this.mobilePopup.element),this.mobilePopup=null}},e.prototype.unWireTouchEvents=function(){this.touchObj&&this.touchObj.destroy(),this.touchObj=null,this.element=null},e.prototype.destroy=function(){this.popupDestroy(),this.unWireTouchEvents(),this.tabHold=!1},e}(),I=function(){function e(e){this.parent=e}return e.prototype.renderSwimlaneHeader=function(){var e=t.createElement("div",{className:"e-swimlane-header",innerHTML:'<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons e-icon-menu"></div></div><div class="e-toolbar-level-title"><div class="e-toolbar-swimlane-name"></div></div></div>'});this.parent.element.appendChild(e),t.EventHandler.add(e.querySelector(".e-icon-menu"),"click",this.menuClick,this)},e.prototype.renderSwimlaneTree=function(){var e=this.parent.element.querySelector(".e-swimlane-header").offsetHeight,a=window.innerHeight-e;this.popupOverlay=t.createElement("div",{className:"e-swimlane-overlay",styles:"height: "+a+"px;"});var r=t.createElement("div",{className:"e-swimlane-content",styles:"top:"+e+"px;"}),i=t.createElement("div",{className:"e-swimlane-resource e-popup-close",styles:"height: "+a+"px;"});r.appendChild(i),r.appendChild(this.popupOverlay),this.parent.element.appendChild(r);var o=t.createElement("div",{className:"e-swimlane-tree"});i.appendChild(o),this.treeViewObj=new l.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:this.parent.layoutModule.kanbanRows,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this),drawNode:this.drawNode.bind(this)}),this.treeViewObj.appendTo(o);var s={targetType:"relative",actionOnScroll:"none",enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+M)};s.content=this.treeViewObj.element,this.treePopup=new n.Popup(i,s)},e.prototype.menuClick=function(){if(this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open"))this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable");else{var e=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));t.removeClass(e,"e-active"),t.addClass([e[this.parent.layoutModule.swimlaneIndex]],"e-active"),this.treePopup.show(),t.addClass([this.popupOverlay],"e-enable")}},e.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(d,{processedData:this.parent.kanbanData}),e.event.preventDefault()},e.prototype.hidePopup=function(){this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable")},e.prototype.getWidth=function(){return 80*window.innerWidth/100},e.prototype.drawNode=function(e){if(this.parent.swimlaneSettings.template&&this.parent.isReact){var n=this.parent.element.id+"_treeviewTemplate",a=this.parent.templateParser(this.parent.swimlaneSettings.template)(e.nodeData,this.parent,"nodeTemplate",n,!1);t.append(a,e.node.querySelector(".e-list-text"))}},e}(),B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),_=function(e){function n(t){var n=e.call(this,t)||this;return n.kanbanRows=[],n.parent=t,n.columnKeys=[],n.swimlaneIndex=0,n.swimlaneData={},n.scrollLeft=0,n.frozenOrder=0,n.parent.on(d,n.initRender,n),n.parent.on(s,n.scrollUiUpdate,n),n}return B(n,e),n.prototype.initRender=function(){if(0!==this.parent.columns.length){if(this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.swimlaneData=this.getSwimlaneCards(),this.parent.isAdaptive){var e=this.parent.element.querySelector("."+M);e&&(this.scrollLeft=e.scrollLeft)}this.destroy(),this.parent.on(d,this.initRender,this),this.parent.on(s,this.scrollUiUpdate,this),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&0!==this.parent.kanbanData.length&&this.renderSwimlaneHeader();var n=t.createElement("div",{className:j});this.parent.element.appendChild(n),this.renderHeader(n),this.renderContent(),this.renderCards(),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(s,{}),this.wireEvents(),this.parent.isInitialRender&&(this.parent.isInitialRender=!1)}},n.prototype.renderHeader=function(e){var n=t.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(n);var a=t.createElement("table",{className:"e-kanban-table e-header-table",attrs:{role:"presentation"}});n.appendChild(a),this.renderColGroup(a);var r=t.createElement("thead");a.appendChild(r),this.parent.stackedHeaders.length>0&&r.appendChild(this.createStackedRow(this.parent.stackedHeaders));var i=t.createElement("tr",{className:"e-header-row"});r.appendChild(i);for(var o=this,l=0,s=this.parent.columns;l<s.length;l++)!function(e){if(o.isColumnVisible(e)){var n=o.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),a=t.createElement("th",{className:-1===n?"e-header-cells":"e-header-cells e-collapsed",attrs:{"data-role":"kanban-column","data-key":e.keyField.toString()}}),r=[];e.allowToggle&&(r.push("e-toggle-header"),e.isExpanded||r.push("e-collapsed")),t.addClass([a],r);var l=t.createElement("div",{className:"e-header-wrap"});a.appendChild(l);var s=o.columnData[e.keyField].length,d=t.createElement("div",{className:"e-header-title"});if(l.appendChild(d),e.template){var c={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:s};t.addClass([a],"e-template");var p=o.parent.element.id+"_columnTemplate",h=o.parent.templateParser(e.template)(c,o.parent,"columnTemplate",p,!1);t.append(h,d)}else{var u=t.createElement("div",{className:"e-header-text",innerHTML:e.headerText});if(d.appendChild(u),e.showItemCount){var g=t.createElement("div",{className:"e-item-count",innerHTML:"- "+s.toString()+" "+o.parent.localeObj.getConstant("items")});d.appendChild(g)}}if(e.allowToggle){var m=!(!e.isExpanded||-1!==n),f=m?"e-column-expand":"e-column-collapse",y=t.createElement("div",{className:"e-header-icon e-icons "+f,attrs:{tabindex:"0"}});y.setAttribute("aria-label",m?e.keyField+" Expand":e.keyField+" Collapse"),a.setAttribute("aria-expanded",m.toString()),l.appendChild(y)}var v={data:[{keyField:e.keyField,textField:e.headerText,count:s}],element:i,cancel:!1,requestType:"headerRow"};o.parent.trigger("queryCellInfo",v,function(e){e.cancel||i.appendChild(a)})}}(s[l])},n.prototype.renderContent=function(){var e=t.createElement("div",{className:M});this.parent.element.appendChild(e);var n=t.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(n);var a=t.createElement("table",{className:"e-kanban-table e-content-table",attrs:{role:"presentation"}});n.appendChild(a),this.renderColGroup(a);var r=t.createElement("tbody");a.appendChild(r);var i=!1;this.swimlaneRow=this.kanbanRows,this.initializeSwimlaneTree();for(var o=0,l=this.swimlaneRow;o<l.length;o++){var s=l[o];this.parent.swimlaneSettings.keyField&&0!==this.parent.swimlaneToggleArray.length&&(i=-1!==this.parent.swimlaneToggleArray.indexOf(s.keyField)),this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive&&this.renderSwimlaneRow(r,s,i),this.renderSingleContent(r,s,i)}},n.prototype.renderSingleContent=function(e,n,a){for(var r=a?"e-content-row e-collapsed":"e-content-row",i=t.createElement("tr",{className:r,attrs:{"aria-expanded":"true"}}),o=0,l=this.parent.columns;o<l.length;o++){var s=l[o];if(this.isColumnVisible(s)){var d=this.parent.actionModule.columnToggleArray.indexOf(s.keyField.toString()),c=-1===d?"e-content-cells":"e-content-cells e-collapsed",p=(s.allowDrag?" e-drag":"")+(s.allowDrop?" e-drop e-droppable":""),h=t.createElement("td",{className:c+p,attrs:{"data-role":"kanban-column","data-key":s.keyField.toString(),"aria-expanded":"true",tabindex:"0",role:"navigation"}});if(s.allowToggle&&!s.isExpanded||-1!==d){t.addClass([h],"e-collapsed");var u=(s.showItemCount?"["+this.getColumnData(s.keyField,this.swimlaneData[n.keyField]).length+"] ":"")+s.headerText;h.appendChild(t.createElement("div",{className:"e-collapse-header-text",innerHTML:u})),h.setAttribute("aria-expanded","false")}if(s.showAddButton){var g=t.createElement("div",{className:F,attrs:{tabindex:"-1"}});g.appendChild(t.createElement("div",{className:"e-show-add-icon e-icons"})),h.appendChild(g)}i.appendChild(h)}}var m={data:[{keyField:n.keyField,textField:n.textField,count:n.count}],element:i,cancel:!1,requestType:"contentRow"};this.parent.trigger("queryCellInfo",m,function(t){t.cancel||(e.classList.contains("e-swimlane-row")?e.insertAdjacentElement("beforebegin",i):e.appendChild(i))})},n.prototype.initializeSwimlaneTree=function(){this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&0!==this.parent.kanbanData.length&&(this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.element.querySelector(".e-toolbar-swimlane-name").innerHTML=this.swimlaneRow[0].textField)},n.prototype.renderSwimlaneRow=function(e,n,a){var r=a?" e-collapsed":"",i=t.createElement("tr",{className:"e-content-row e-swimlane-row"+r,attrs:{"data-key":n.keyField,"aria-expanded":(!a).toString()}}),o=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,l=t.createElement("td",{className:"e-content-cells",attrs:{"data-role":"kanban-column",colspan:o.toString()}}),s=t.createElement("div",{className:"e-swimlane-header"});l.appendChild(s);var d=a?"e-swimlane-row-collapse":"e-swimlane-row-expand",c=t.createElement("div",{className:"e-icons "+d,attrs:{tabindex:"0","aria-label":a?n.keyField+" Collapse":n.keyField+" Expand"}});s.appendChild(c);var p=t.createElement("div",{className:"e-header-wrap"});s.appendChild(p);var h=this.swimlaneData[n.keyField].length;if(this.parent.swimlaneSettings.template){var u=t.extend({},n,{count:h},!0);t.addClass([l],"e-template");var g=this.parent.element.id+"_swimlaneTemplate",m=this.parent.templateParser(this.parent.swimlaneSettings.template)(u,this.parent,"swimlaneTemplate",g,!1);t.append(m,p)}else p.appendChild(t.createElement("div",{className:"e-swimlane-text",innerHTML:n.textField,attrs:{"data-role":n.textField}}));this.parent.swimlaneSettings.showItemCount&&s.appendChild(t.createElement("div",{className:"e-item-count",innerHTML:"- "+h.toString()+" "+this.parent.localeObj.getConstant("items")})),i.appendChild(l);var f={data:[{keyField:n.keyField,textField:n.textField,count:n.count}],element:i,cancel:!1,requestType:"swimlaneRow"};this.parent.trigger("queryCellInfo",f,function(t){t.cancel||(e.classList.contains("e-swimlane-row")?e.insertAdjacentElement("beforebegin",i):e.appendChild(i))})},n.prototype.renderCards=function(){var e=this,n=this.swimlaneRow,a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),i=[];a.forEach(function(a,o){for(var l=0,s=0,d=e.parent.columns;s<d.length;s++)!function(r){if(e.isColumnVisible(r)){var i=e.parent.swimlaneSettings.keyField?e.getColumnData(r.keyField,e.swimlaneData[n[o].keyField]):e.columnData[r.keyField];l+=i.length;var s=a.querySelector('[data-key="'+r.keyField+'"]'),d=t.createElement("div",{className:"e-card-wrapper",attrs:{role:"listbox"}});if(s.appendChild(d),i.length>0)for(var c=0,p=i;c<p.length;c++)!function(n){var a=n[e.parent.cardSettings.headerField],r=e.parent.actionModule.selectionArray.indexOf(a),i=e.renderCard(n);-1!==r&&(i.setAttribute("aria-selected","true"),t.addClass([i],"e-selection"));var o={data:n,element:i,cancel:!1};e.parent.trigger("cardRendered",o,function(e){e.cancel||d.appendChild(i)})}(p[c]);else d.appendChild(e.renderEmptyCard())}}(d[s]);0===l&&(i.push(a),r.length>0&&i.push(r[o]))}),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||i.forEach(function(e){return t.remove(e)})},n.prototype.renderCard=function(e){var n=t.createElement("div",{className:"e-card",attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1",role:"option"}});if(this.parent.cardSettings.template){t.addClass([n],"e-template");var a=this.parent.element.id+"_cardTemplate",r=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"cardTemplate",a,!1);t.append(r,n)}else{var i=this.parent.enableTooltip?" e-tooltip-text":"";if(this.parent.cardSettings.showHeader){var o=t.createElement("div",{className:"e-card-header"}),l=t.createElement("div",{className:"e-card-header-caption"}),s=t.createElement("div",{className:"e-card-header-title"+i,innerHTML:e[this.parent.cardSettings.headerField]||""});o.appendChild(l),l.appendChild(s),n.appendChild(o)}var d=t.createElement("div",{className:"e-card-content"+i,innerHTML:e[this.parent.cardSettings.contentField]||""});if(n.appendChild(d),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var c=t.createElement("div",{className:"e-card-tags"}),p=0,h=e[this.parent.cardSettings.tagsField].toString().split(",");p<h.length;p++){var u=h[p];c.appendChild(t.createElement("div",{className:"e-card-tag e-card-label",innerHTML:u}))}n.appendChild(c)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&(t.addClass([n],"e-card-color"),n.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var g=t.createElement("div",{className:"e-card-footer"}),m=0,f=e[this.parent.cardSettings.footerCssField].split(",");m<f.length;m++){var y=f[m];g.appendChild(t.createElement("div",{className:y.trim()+" e-card-footer-css"}))}n.appendChild(g)}}return n},n.prototype.renderEmptyCard=function(){return t.createElement("span",{className:"e-empty-card",innerHTML:this.parent.localeObj.getConstant("noCard")})},n.prototype.renderColGroup=function(e){var n=this,a=t.createElement("colgroup");this.parent.columns.forEach(function(e){if(n.isColumnVisible(e)){var r=n.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),i=e.allowToggle&&!e.isExpanded,o=-1===r?i?"e-collapsed":"":"e-collapsed",l=t.createElement("col",{className:o,attrs:{"data-key":e.keyField.toString()},styles:n.parent.isAdaptive?"width: "+(i?t.formatUnit(50):t.formatUnit(n.getWidth())):""});a.appendChild(l)}}),e.appendChild(a)},n.prototype.getRows=function(){var e=this,n=[];return this.parent.swimlaneSettings.keyField?(this.parent.kanbanData.map(function(a){if(e.parent.swimlaneSettings.showEmptyRow||!(t.isNullOrUndefined(a[e.parent.keyField])||""===a[e.parent.keyField]||a[e.parent.keyField]&&-1===e.columnKeys.indexOf(a[e.parent.keyField].toString()))){var r=a[e.parent.swimlaneSettings.textField]||a[e.parent.swimlaneSettings.keyField],i=a[e.parent.swimlaneSettings.keyField];if(!a[e.parent.swimlaneSettings.keyField]){if(!e.parent.swimlaneSettings.showUnassignedRow)return;r=e.parent.localeObj.getConstant("unassigned"),i=""}n.push({keyField:i,textField:r})}}),n=n.filter(function(e,t,n){return t===n.map(function(e){return e.keyField}).indexOf(e.keyField)}),(n=this.swimlaneSorting(n)).forEach(function(t){t.count=e.parent.kanbanData.filter(function(n){return e.columnKeys.indexOf(n[e.parent.keyField])>-1&&n[e.parent.swimlaneSettings.keyField]===t.keyField}).length}),0===n.length&&n.push({keyField:"",textField:""})):n.push({keyField:"",textField:""}),n},n.prototype.swimlaneSorting=function(e){return this.parent.swimlaneSettings.sortComparer?e=this.parent.swimlaneSettings.sortComparer.call(this.parent,e):(e.sort(function(e,t){return e.textField.localeCompare(t.textField,void 0,{numeric:!0})}),"Descending"===this.parent.swimlaneSettings.sortDirection&&e.reverse()),e},n.prototype.createStackedRow=function(e){var n=t.createElement("tr",{className:"e-header-row e-stacked-header-row"}),a=[];this.parent.columns.forEach(function(t){for(var n="",r=0,i=e;r<i.length;r++){var o=i[r];-1!==o.keyFields.indexOf(t.keyField.toString())&&(n=o.text)}a.push(n)});for(var r=0;r<a.length;r++){for(var i=1,o=r+1;o<a.length&&(""!==a[r]&&""!==a[o]&&a[r]===a[o]);o++)i++;var l=t.createElement("div",{className:"e-header-text",innerHTML:a[r]}),s=t.createElement("th",{className:"e-header-cells e-stacked-header-cell",attrs:{colspan:i.toString()}});n.appendChild(s).appendChild(l),r+=i-1}return n},n.prototype.scrollUiUpdate=function(){var e=this,n=this.parent.element.querySelector("."+j),a=this.parent.element.querySelector("."+M),r=this.parent.element.offsetHeight-n.offsetHeight;if(this.parent.isAdaptive){r=window.innerHeight-(n.offsetHeight+25);var i=this.parent.element.querySelector(".e-swimlane-header");i&&(r-=i.offsetHeight),[].slice.call(this.parent.element.querySelectorAll(".e-content-cells")).forEach(function(n){var a=n.querySelector(".e-card-wrapper");a.classList.contains("e-multi-card-wrapper")||(a.style.height=t.formatUnit(r),t.EventHandler.add(n,"touchmove",e.onAdaptiveScroll,e))})}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=t.formatUnit(r)),[].slice.call(n.children).forEach(function(n){var r=0;a.offsetWidth-a.clientWidth>0&&(r=17,a.offsetHeight-a.clientHeight>0&&(n.style.width=t.formatUnit(a.clientWidth))),e.parent.enableRtl?n.style.paddingLeft=t.formatUnit(r):n.style.paddingRight=t.formatUnit(r)}),this.updateScrollPosition()},n.prototype.onContentScroll=function(e){var n=e.target,a=this.parent.element.querySelector("."+j);[].slice.call(a.children).forEach(function(e){e.scrollLeft=n.scrollLeft}),this.parent.scrollPosition.content={left:n.scrollLeft,top:n.scrollTop},!t.isNullOrUndefined(this.parent.swimlaneSettings.keyField)&&this.parent.swimlaneSettings.enableFrozenRows&&this.frozenRows(e)},n.prototype.addFrozenSwimlaneDataKey=function(e){var n=e.getAttribute("data-key");t.isNullOrUndefined(n)||this.frozenSwimlaneRow.setAttribute("data-key",n)},n.prototype.frozenRows=function(e){var n=this.parent.element.querySelector(".e-swimlane-row"),a=this.parent.element.querySelector("."+j),r=this.parent.element.querySelector("."+M);if(t.isNullOrUndefined(this.frozenSwimlaneRow)){this.frozenSwimlaneRow=t.createElement("div",{className:"e-frozen-swimlane-row"});var i=t.createElement("div",{className:"e-frozen-row"});this.frozenSwimlaneRow.appendChild(i),this.parent.element.insertBefore(this.frozenSwimlaneRow,this.parent.element.firstElementChild),i.appendChild(n.querySelector(".e-swimlane-header").cloneNode(!0)),this.addFrozenSwimlaneDataKey(n),t.setStyleAttribute(this.frozenSwimlaneRow,{height:t.formatUnit(n.getBoundingClientRect().height),width:t.formatUnit(r.querySelector(".e-swimlane").getBoundingClientRect().width),top:t.formatUnit(a.getBoundingClientRect().height.toString())}),t.setStyleAttribute(a,{position:"relative",top:t.formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)}),t.setStyleAttribute(r,{position:"relative",top:t.formatUnit(-this.frozenSwimlaneRow.getBoundingClientRect().height)})}else{var o=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")),l=o[this.frozenOrder],s=o[this.frozenOrder-1],d=o[this.frozenOrder+1],c=void 0,p=void 0,h=void 0;l&&(c=l.getBoundingClientRect().top+l.getBoundingClientRect().height),s&&(p=s.getBoundingClientRect().top+s.getBoundingClientRect().height),d&&(h=d.getBoundingClientRect().top+d.getBoundingClientRect().height);var u=r.getBoundingClientRect().top+this.frozenSwimlaneRow.getBoundingClientRect().height,g=this.frozenSwimlaneRow.querySelector(".e-frozen-row");h&&u>=h&&this.frozenOrder<o.length-1?(g&&(t.remove(g.querySelector(".e-swimlane-header")),g.appendChild(d.querySelector(".e-swimlane-header").cloneNode(!0)),this.addFrozenSwimlaneDataKey(d)),++this.frozenOrder):p&&u<c&&u>p&&this.frozenOrder>0&&(g&&(t.remove(g.querySelector(".e-swimlane-header")),g.appendChild(s.querySelector(".e-swimlane-header").cloneNode(!0)),this.addFrozenSwimlaneDataKey(s)),--this.frozenOrder)}e&&0==e.target.scrollTop&&this.removeFrozenRows()},n.prototype.removeFrozenRows=function(){t.remove(this.frozenSwimlaneRow),this.frozenSwimlaneRow=null;var e=this.parent.element.querySelector("."+j),n=this.parent.element.querySelector("."+M);t.setStyleAttribute(e,{position:"",top:""}),t.setStyleAttribute(n,{position:"",top:""}),this.parent.scrollPosition.content={left:this.parent.scrollPosition.content.left,top:0},n.scrollTop=0,this.frozenOrder=0},n.prototype.onColumnScroll=function(e){var t=e.target;if(t.offsetParent){var n=t.offsetParent.getAttribute("data-key");this.parent.scrollPosition.column[n]={left:t.scrollLeft,top:t.scrollTop}}},n.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},n.prototype.isColumnVisible=function(e){var t=this,n=!1;return"number"==typeof e.keyField?n=-1===this.parent.actionModule.hideColumnKeys.indexOf(e.keyField.toString()):e.keyField.split(",").forEach(function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)}),n},n.prototype.renderLimits=function(e,n){var a=t.createElement("div",{className:"e-limits"});e.minCount&&a.appendChild(t.createElement("div",{className:"e-min-count",innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&a.appendChild(t.createElement("div",{className:"e-max-count",innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),a.childElementCount>0&&(n.querySelector(".e-card-wrapper")?n.insertBefore(a,n.firstElementChild):n.appendChild(a))},n.prototype.renderValidation=function(){var e=this;this.parent.columns.forEach(function(n){if(n.minCount||n.maxCount){var a=e.columnData[n.keyField],r='[data-key="'+n.keyField+'"]',i=e.parent.element.querySelector(".e-header-cells"+r),o=[].slice.call(e.parent.element.querySelectorAll(".e-content-cells"+r));if("Swimlane"===e.parent.constraintType&&e.parent.swimlaneSettings.keyField)e.swimlaneRow.forEach(function(r,i){e.renderLimits(n,o[i]);var l=a.filter(function(t){return t[e.parent.swimlaneSettings.keyField]===r.keyField}),s=e.getValidationClass(n,l.length);s&&t.addClass([o[i]],s)});else{e.renderLimits(n,i);var l=e.getValidationClass(n,a.length);l&&t.addClass(o.concat(i),l)}}})},n.prototype.getValidationClass=function(e,t){var n;return e.maxCount&&t>e.maxCount?n="e-max-color":e.minCount&&t<e.minCount&&(n="e-min-color"),n},n.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll(".e-limits")).forEach(function(e){t.remove(e)});var e=[].slice.call(this.parent.element.querySelectorAll(".e-min-color"));t.removeClass(e,"e-min-color");var n=[].slice.call(this.parent.element.querySelectorAll(".e-max-color"));t.removeClass(n,"e-max-color"),this.renderValidation()},n.prototype.getColumnData=function(e,t){var n=this;void 0===t&&(t=this.parent.kanbanData);var a=[];if("number"==typeof e){var r=t.filter(function(t){return t[n.parent.keyField]===e});a=a.concat(r)}else for(var i=0,o=e.split(",");i<o.length;i++)!function(e){var r=t.filter(function(t){return t[n.parent.keyField]===e.trim()});a=a.concat(r)}(o[i]);return this.sortCategory(a),a},n.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,n=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,n,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,n,e)}return e},n.prototype.sortOrder=function(e,t,n){var a=!0;if(this.parent.kanbanData.length>0&&(a="number"==typeof this.parent.kanbanData[0][e]),!a&&"Index"===this.parent.sortSettings.sortBy)return n;var r,i;return n=n.sort(function(t,n){return a?(r=t[e],i=n[e]):(r=t[e].toLowerCase(),i=n[e].toLowerCase()),r>i?1:i>r?-1:0}),"Descending"===t&&n.reverse(),n},n.prototype.documentClick=function(e){if(e.target.classList.contains("e-swimlane-overlay")&&this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open")&&(this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable")),!t.closest(e.target,".e-kanban")){var n=[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection"));t.removeClass(n,"e-selection"),this.disableAttributeSelection(n)}},n.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach(function(e){e.setAttribute("aria-selected","false")})},n.prototype.getColumnCards=function(e){var t=this,n={};return this.columnKeys=[],this.parent.columns.forEach(function(a){var r="number"==typeof a.keyField;t.columnKeys=r?t.columnKeys.concat(a.keyField.toString()):t.columnKeys.concat(a.keyField.split(",").map(function(e){return e.trim()}));var i=t.getColumnData(a.keyField,e);n[a.keyField]=i}),n},n.prototype.getSwimlaneCards=function(){var e=this,n={};return this.parent.swimlaneSettings.keyField&&this.kanbanRows.forEach(function(a){return n[a.keyField]=e.parent.kanbanData.filter(function(n){return!t.isNullOrUndefined(n[e.parent.keyField])&&e.columnKeys.indexOf(n[e.parent.keyField].toString())>-1&&(!n[e.parent.swimlaneSettings.keyField]&&e.parent.swimlaneSettings.showUnassignedRow?"":n[e.parent.swimlaneSettings.keyField])===a.keyField})}),n},n.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector("."+j);[].slice.call(e.children).forEach(function(e){return t.remove(e)}),this.renderHeader(e)},n.prototype.refreshCards=function(){this.parent.resetTemplates(["cardTemplate"]),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach(function(e){return t.remove(e)}),this.renderCards(),this.wireDragEvent(),this.parent.renderTemplates()},n.prototype.refresh=function(){var e=this,t=!1;this.parent.columns.forEach(function(n){if(n.showItemCount){n&&n.template&&!t&&(e.refreshHeaders(),t=!0);var a='.e-header-cells[data-key="'+n.keyField+'"] .e-item-count',r=e.parent.element.querySelector(a);if(r){var i=0;if("number"==typeof n.keyField)i=[].slice.call(e.parent.element.querySelectorAll('.e-card[data-key="'+n.keyField+'"]')).length;else for(var o=0,l=n.keyField.split(",");o<l.length;o++){var s=l[o];i=[].slice.call(e.parent.element.querySelectorAll('.e-card[data-key="'+s.trim()+'"]')).length+i}r.innerHTML="- "+i+" "+e.parent.localeObj.getConstant("items")}}}),this.parent.swimlaneSettings.keyField&&[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")).forEach(function(t){var n=t.getAttribute("data-key"),a=t.querySelector(".e-item-count");if(a&&n){var r=[].slice.call(t.nextElementSibling.querySelectorAll(".e-card"));a.innerHTML="- "+r.length+" "+e.parent.localeObj.getConstant("items")}}),this.refreshValidation()},n.prototype.updateScrollPosition=function(){var e=this,t=this.parent.element.querySelector("."+M);t&&t.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach(function(t){if(t.offsetParent){var n=e.parent.scrollPosition.column[t.offsetParent.getAttribute("data-key")];n&&t.scrollTo(n.left,n.top)}})},n.prototype.renderCardBasedOnIndex=function(e,n){var a=this,r=e[this.parent.keyField],i=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");if(this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive){var o='.e-content-row.e-swimlane-row[data-key="'+e[this.parent.swimlaneSettings.keyField]+'"]';if(this.parent.element.querySelector(o))i=this.parent.element.querySelector(o).nextElementSibling;else{if(-1!==this.columnKeys.indexOf(r)&&-1===this.parent.actionModule.hideColumnKeys.indexOf(r)){var l=this.kanbanRows.findIndex(function(t){return t.keyField===e[a.parent.swimlaneSettings.keyField]}),s=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")),d=this.parent.element.querySelector(".e-content-table tbody");s[l]&&(d=s[l]),this.renderSwimlaneRow(d,this.kanbanRows[l],!1),this.renderSingleContent(d,this.kanbanRows[l],!1)}i=this.parent.element.querySelector(o).nextElementSibling,[].slice.call(i.children).forEach(function(e){var n=t.createElement("div",{className:"e-card-wrapper"});e.appendChild(n),n.appendChild(a.renderEmptyCard())})}}if("Index"!==this.parent.sortSettings.sortBy){var c=this.parent.cardSettings.headerField;if("Custom"===this.parent.sortSettings.sortBy&&(c=this.parent.sortSettings.field),t.isNullOrUndefined(this.parent.swimlaneSettings.keyField))n=this.getColumnData(r,this.parent.kanbanData).findIndex(function(t){return t[c]===e[c]});else{var p=this.parent.getSwimlaneData(e[this.parent.swimlaneSettings.keyField]);n=this.getColumnData(r,p).findIndex(function(t){return t[c]===e[c]})}}else"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(n=e[this.parent.sortSettings.field]-1);if(i){var h=[].slice.call(i.children).filter(function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(r.toString().replace(/\s/g,""))})[0],u=h.querySelector(".e-card-wrapper"),g=u.querySelector(".e-empty-card");g&&t.remove(g);var m=this.renderCard(e);this.parent.allowDragAndDrop&&h.classList.contains("e-drag")&&(this.parent.dragAndDropModule.wireDragEvents(m),t.addClass([m],"e-droppable"));var f={data:e,element:m,cancel:!1};this.parent.trigger("cardRendered",f,function(e){e.cancel||(t.isNullOrUndefined(n)||0===u.children.length?u.appendChild(m):u.insertBefore(m,u.childNodes[n]))})}},n.prototype.removeCard=function(e){var n=e[this.parent.cardSettings.headerField],a=this.parent.element.querySelector('.e-card[data-id="'+n+'"]');this.isSelectedCard=!!a.classList.contains("e-selection");var r=a.parentElement;a&&t.remove(a),0===r.querySelectorAll(".e-card:not(.e-cloned-card)").length&&r.appendChild(this.renderEmptyCard())},n.prototype.wireEvents=function(){var e=this;t.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),t.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),t.EventHandler.add(document,t.Browser.touchStartEvent,this.documentClick,this);var n=this.parent.element.querySelector("."+M);t.EventHandler.add(n,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach(function(n){e.parent.isInitialRender&&n.offsetParent&&(e.parent.scrollPosition.column[n.offsetParent.getAttribute("data-key")]={left:0,top:0}),t.EventHandler.add(n,"scroll",e.onColumnScroll,e)}),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),n.scrollLeft=this.scrollLeft),this.wireDragEvent()},n.prototype.unWireEvents=function(){var e=this;t.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),t.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),t.EventHandler.remove(document,t.Browser.touchStartEvent,this.documentClick);var n=this.parent.element.querySelector("."+M);n&&(t.EventHandler.remove(n,"scroll",this.onContentScroll),this.parent.allowDragAndDrop&&this.unWireDragEvent()),[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach(function(n){t.EventHandler.remove(n,"scroll",e.onColumnScroll)}),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},n.prototype.wireDragEvent=function(){var e=this;if(this.parent.allowDragAndDrop){var n=[].slice.call(this.parent.element.querySelectorAll(".e-content-cells.e-drag .e-card"));t.addClass(n,"e-droppable"),n.forEach(function(t){return e.parent.dragAndDropModule.wireDragEvents(t)})}},n.prototype.unWireDragEvent=function(){var e=this,n=[].slice.call(this.parent.element.querySelectorAll(".e-content-cells.e-drag .e-card"));t.removeClass(n,"e-droppable"),n.forEach(function(t){return e.parent.dragAndDropModule.unWireDragEvents(t)})},n.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(d,this.initRender),this.parent.off(s,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector("."+j);e&&t.remove(e);var n=this.parent.element.querySelector("."+M);n&&t.remove(n),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var a=this.parent.element.querySelector(".e-swimlane-header");a&&t.remove(a);var r=this.parent.element.querySelector(".e-swimlane-content");r&&t.remove(r)},n}(I),U=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),z=function(e,t,n,a){var r,i=arguments.length,o=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(i<3?r(o):i>3?r(t,n,o):r(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},K=function(e){function a(t,n){return e.call(this,t,n)||this}return U(a,e),a.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.kanbanData=[],this.enablePersistence&&this.swimlaneToggleArray||(this.swimlaneToggleArray=[]),this.activeCardData={data:null,element:null};var e={items:"items",min:"Min",max:"Max",cardsSelected:"Cards Selected",addTitle:"Add New Card",editTitle:"Edit Card Details",deleteTitle:"Delete Card",deleteContent:"Are you sure you want to delete this card?",save:"Save",delete:"Delete",cancel:"Cancel",yes:"Yes",no:"No",close:"Close",noCard:"No cards to display",unassigned:"Unassigned"};this.localeObj=new t.L10n(this.getModuleName(),e,this.locale),this.scrollPosition={content:{left:0,top:0},column:{}},this.isInitialRender=!0},a.prototype.requiredModules=function(){return[]},a.prototype.getPersistData=function(){return this.dataSource.length>0?this.addOnPersist(["columns","dataSource","swimlaneToggleArray"]):this.addOnPersist(["columns","kanbanData","swimlaneToggleArray"])},a.prototype.getModuleName=function(){return"kanban"},a.prototype.render=function(){var e=["e-kanban"],a=[];this.enableRtl?e.push("e-rtl"):a.push("e-rtl"),this.isAdaptive?e.push("e-device"):a.push("e-device"),this.cssClass&&e.push(this.cssClass),this.element.setAttribute("role","main"),t.classList(this.element,e,a),this.element.style.width=t.formatUnit(this.width),this.element.style.height=t.formatUnit(this.height),n.createSpinner({target:this.element}),this.showSpinner(),this.initializeModules()},a.prototype.onPropertyChanged=function(e,n){for(var a=0,r=Object.keys(e);a<r.length;a++)switch(r[a]){case"cssClass":n.cssClass&&t.removeClass([this.element],n.cssClass),e.cssClass&&t.addClass([this.element],e.cssClass);break;case"enableRtl":case"locale":this.refresh();break;case"width":this.element.style.width=t.formatUnit(e.width),this.element.querySelector("."+j).firstElementChild.style.width="auto",this.notify(s,{});break;case"height":this.element.style.height=t.formatUnit(e.height),this.element.querySelector("."+M).style.height="auto",this.notify(s,{});break;case"dataSource":case"query":this.dataModule&&this.dataModule.setState({isDataChanged:!1}),this.dataModule=new c(this);break;case"columns":case"constraintType":this.notify(d,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,n.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,n.cardSettings);break;case"allowDragAndDrop":e.allowDragAndDrop?this.layoutModule.wireDragEvent():this.layoutModule.unWireDragEvent();break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new H(this),this.layoutModule.refreshCards());break;case"dialogSettings":e.dialogSettings&&(this.dialogModule=new P(this));break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new L(this));break;case"stackedHeaders":this.layoutModule.refreshHeaders();break;case"sortSettings":this.notify(d,{processedData:this.kanbanData})}},a.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++)switch(a[n]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortDirection":this.notify(d,{processedData:this.kanbanData});break;case"enableFrozenRows":this.layoutModule.frozenSwimlaneRow&&!this.swimlaneSettings.enableFrozenRows&&this.layoutModule.removeFrozenRows()}},a.prototype.onCardSettingsPropertyChanged=function(e,n){for(var a=[],r=0,i=Object.keys(e);r<i.length;r++)switch(i[r]){case"showHeader":case"headerField":case"contentField":case"template":case"tagsField":case"grabberField":case"footerCssField":this.layoutModule.refreshCards();break;case"selectionType":(a=this.getSelectedCards()).length>0&&(t.removeClass(a,"e-selection"),this.layoutModule.disableAttributeSelection(a))}},a.prototype.initializeModules=function(){this.dataModule=new c(this),this.layoutModule=new _(this),this.allowKeyboard&&(this.keyboardModule=new L(this)),this.actionModule=new T(this),this.crudModule=new R(this),this.dragAndDropModule=new q(this),this.dialogModule=new P(this),this.enableTooltip&&(this.tooltipModule=new H(this)),(t.Browser.isDevice||t.Browser.isTouch)&&(this.touchModule=new N(this))},a.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},a.prototype.resetTemplates=function(e){this.isReact&&this.clearTemplate(e)},a.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.dialogModule=null,this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},a.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return t.compile(document.querySelector(e).innerHTML.trim())}catch(n){return t.compile(e)}},a.prototype.getCardDetails=function(e){var t=this,n="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter(function(e){return e[t.cardSettings.headerField]===n})[0]},a.prototype.getColumnData=function(e,t){return this.layoutModule.getColumnCards(t)[e]||[]},a.prototype.getSwimlaneData=function(e){return this.layoutModule.getSwimlaneCards()[e]||[]},a.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll(".e-card.e-selection"))},a.prototype.showSpinner=function(){n.showSpinner(this.element)},a.prototype.hideSpinner=function(){n.hideSpinner(this.element)},a.prototype.openDialog=function(e,t){this.dialogModule.openDialog(e,t)},a.prototype.closeDialog=function(){this.dialogModule.closeDialog()},a.prototype.addCard=function(e,t){this.crudModule.addCard(e,t)},a.prototype.updateCard=function(e,t){this.crudModule.updateCard(e,t)},a.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},a.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},a.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},a.prototype.showColumn=function(e){this.actionModule.showColumn(e)},a.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},a.prototype.refreshUI=function(e,t){t=t||0,this.dataModule.refreshUI(e,t)},a.prototype.refreshHeader=function(){this.resetTemplates(["columnTemplate"]),this.layoutModule&&this.layoutModule.refreshHeaders(),this.renderTemplates()},a.prototype.destroy=function(){this.destroyModules(),[].slice.call(this.element.childNodes).forEach(function(e){t.detach(e)});var n=["e-kanban"];this.cssClass&&(n=n.concat(this.cssClass.split(" "))),t.removeClass([this.element],n),e.prototype.destroy.call(this)},z([t.Property()],a.prototype,"cssClass",void 0),z([t.Property("auto")],a.prototype,"width",void 0),z([t.Property("auto")],a.prototype,"height",void 0),z([t.Property([])],a.prototype,"dataSource",void 0),z([t.Property()],a.prototype,"query",void 0),z([t.Property()],a.prototype,"keyField",void 0),z([t.Property("Column")],a.prototype,"constraintType",void 0),z([t.Property([])],a.prototype,"externalDropId",void 0),z([t.Collection([],S)],a.prototype,"columns",void 0),z([t.Property(!0)],a.prototype,"allowKeyboard",void 0),z([t.Collection([],O)],a.prototype,"stackedHeaders",void 0),z([t.Complex({},u)],a.prototype,"swimlaneSettings",void 0),z([t.Complex({},f)],a.prototype,"cardSettings",void 0),z([t.Complex({},x)],a.prototype,"sortSettings",void 0),z([t.Complex({},b)],a.prototype,"dialogSettings",void 0),z([t.Property(!0)],a.prototype,"allowDragAndDrop",void 0),z([t.Property(!1)],a.prototype,"enableTooltip",void 0),z([t.Property(!1)],a.prototype,"showEmptyColumn",void 0),z([t.Property(!1)],a.prototype,"enablePersistence",void 0),z([t.Property()],a.prototype,"tooltipTemplate",void 0),z([t.Event()],a.prototype,"actionBegin",void 0),z([t.Event()],a.prototype,"actionComplete",void 0),z([t.Event()],a.prototype,"actionFailure",void 0),z([t.Event()],a.prototype,"created",void 0),z([t.Event()],a.prototype,"dataBinding",void 0),z([t.Event()],a.prototype,"dataBound",void 0),z([t.Event()],a.prototype,"cardClick",void 0),z([t.Event()],a.prototype,"cardDoubleClick",void 0),z([t.Event()],a.prototype,"queryCellInfo",void 0),z([t.Event()],a.prototype,"cardRendered",void 0),z([t.Event()],a.prototype,"dragStart",void 0),z([t.Event()],a.prototype,"drag",void 0),z([t.Event()],a.prototype,"dragStop",void 0),z([t.Event()],a.prototype,"dialogOpen",void 0),z([t.Event()],a.prototype,"dialogClose",void 0),z([t.Event()],a.prototype,"dataStateChange",void 0),z([t.Event()],a.prototype,"dataSourceChanged",void 0),a=z([t.NotifyPropertyChanges],a)}(t.Component);return e.Kanban=K,e.actionBegin="actionBegin",e.actionComplete="actionComplete",e.actionFailure="actionFailure",e.cardClick="cardClick",e.cardDoubleClick="cardDoubleClick",e.cardRendered="cardRendered",e.queryCellInfo="queryCellInfo",e.dataBinding="dataBinding",e.dataBound="dataBound",e.dragStart="dragStart",e.drag="drag",e.dragStop="dragStop",e.documentClick="document-click",e.dialogOpen="dialogOpen",e.dialogClose="dialogClose",e.contentReady=s,e.dataReady=d,e.bottomSpace=25,e.cardSpace=16,e.toggleWidth=50,e.dataSourceChanged="dataSourceChanged",e.dataStateChange="dataStateChange",e}({},ej.base,ej.popups,ej.data,ej.dropdowns,ej.inputs,ej.buttons,ej.navigations),this.ejs=ej;
//# sourceMappingURL=ej2-kanban.min.js.map
