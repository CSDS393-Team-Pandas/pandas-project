/*!
*  filename: ej2-schedule.min.js
*  version : 19.4.50
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.schedule=function(e,t,i,n,r,a,s,o,l,c,p){"use strict";function h(e,i){var n=0,r=t.createElement("div",{className:i}).cloneNode();return r.style.visibility="hidden",r.style.position="absolute",e.appendChild(r),n=r.getBoundingClientRect().height,t.remove(r),n}function d(e){var t=getComputedStyle(e);return window.WebKitCSSMatrix?new WebKitCSSMatrix(t.webkitTransform).m42:0}function u(e,t){var i=new Date(e.getTime());return t=(t-i.getDay()-7)%7,new Date(i.setDate(i.getDate()+t))}function v(e,t){var i=u(e,t),n=new Date(i.getFullYear(),i.getMonth(),i.getDate()+6);return new Date(n.getTime())}function m(e){return new Date(e.getFullYear(),e.getMonth(),1)}function g(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}function f(e){var t=new Date(e.getFullYear(),0,1).valueOf(),i=(new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf()-t+We)/We;return Math.ceil(i/7)}function y(e,t){return new Date(t.valueOf()-(t.valueOf()-e.valueOf())/2)}function T(e,t){var i=e.getTimezoneOffset(),n=new Date(e.getTime()+t),r=n.getTimezoneOffset()-i;return e.setTime(n.getTime()+r*ze),e}function w(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function D(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0).getTimezoneOffset(),i=e.getTimezoneOffset()-t;return e.getTime()-new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0).getTime()-60*i*1e3}function b(e,t){return Math.ceil((t.getTime()-e.getTime())/We)}function C(e,t){return e=new Date(""+e),new Date(e.setDate(e.getDate()+t))}function O(e,t){var i=(e=new Date(""+e)).getDate();return e.setDate(1),e.setMonth(e.getMonth()+t),e.setDate(Math.min(i,x(e))),e}function E(e,t){var i=(e=new Date(""+e)).getDate();return e.setDate(1),e.setFullYear(e.getFullYear()+t),e.setDate(Math.min(i,x(e))),e}function S(e,t,i){var n=new Date(e.getTime());n.setHours(t.getHours()),n.setMinutes(t.getMinutes()),n.setSeconds(t.getSeconds());var r=new Date(e.getTime());return 0===i.getHours()?r=C(r,1):(r.setHours(i.getHours()),r.setMinutes(i.getMinutes()),r.setSeconds(i.getSeconds())),{startHour:n,endHour:r}}function x(e){return g(e).getDate()}function A(e,t){var i=w(new Date(e)),n=w(new Date(t));return Math.round((n.getTime()-i.getTime())/We)}function V(e){return-1!==e.indexOf("Date")?new Date(parseInt(e.match(/\d+/g).toString(),10)):-1!==e.indexOf("T")?new Date(e):new Date(e.replace(/-/g,"/"))}function k(){if(null!==Ye)return Ye;var e=t.createElement("div"),i=0;e.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(e);var n=devicePixelRatio?"1.10"===devicePixelRatio.toFixed(2)||devicePixelRatio<=1?Math.ceil(devicePixelRatio%1):Math.floor(devicePixelRatio%1):0;return i=e.offsetWidth-e.clientWidth-n|0,document.body.removeChild(e),Ye=i}function M(e,t,i,n,r){for(var a=0,s=e.length;a<s;a++)if(e[a][t]===i){if(!n)return a;var o=r.slice(-2)[0].field;if((n[o]instanceof Array?n[o]:[n[o]]).join(",").includes(e[a][r.slice(-1)[0].groupIDField]))return a}return-1}function R(e){var t=getComputedStyle(e);return e.offsetHeight+(parseInt(t.marginTop,10)||0)+(parseInt(t.marginBottom,10)||0)}function P(e){for(var t=0,i=[].slice.call(e.children);t<i.length;t++){var n=i[t];n.classList.contains("blazor-template")||e.removeChild(n)}}function I(e){var t=new Date(e.getFullYear(),0,1),i=new Date(e.getFullYear(),6,1);return e.getTimezoneOffset()<Math.max(t.getTimezoneOffset(),i.getTimezoneOffset())}function H(e){var t=e.getFullYear(),i=e.getMonth(),n=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds(),o=e.getMilliseconds();return Date.UTC(t,i,n,r,a,s,o)}function j(){return window.navigator.userAgent.toLowerCase().indexOf("mobi")>-1}function q(){return window.navigator.userAgent.toLowerCase().indexOf("ipad")>-1}function L(e,i){if("multiple"===i)e=e.split(" ").map(function(e){return e.charAt(0).toLocaleUpperCase()+e.substring(1)}).join(" ");else if("single"===i){if(e[0]>="0"&&e[0]<="9"){var n=e.match(/[a-zA-Z]/);e=t.isNullOrUndefined(n)?e:e.slice(0,n.index)+e[n.index].toLocaleUpperCase()+e.slice(n.index+1)}e=e[0].toLocaleUpperCase()+e.slice(1)}return e}function N(e,i,n,r){void 0===r&&(r="Gregorian");var a,s,o=we(e),l=i.getConstant(ft)+" ",c=r.toLowerCase();if("en"===n||"en-US"===n){var p="months.stand-alone.abbreviated",h="days.stand-alone.abbreviated";s=t.getValue(p,t.getDefaultDateObject(c)),a=t.getValue(h,t.getDefaultDateObject(c))}else{var p="main."+n+".dates.calendars."+c+".months.stand-alone.abbreviated",h="main."+n+".dates.calendars."+c+".days.stand-alone.abbreviated";s=t.getValue(p,t.cldrData),a=t.getValue(h,t.cldrData)}switch(o.interval>1&&(l+=o.interval+" "),o.freq){case"DAILY":l+=i.getConstant(Tt);break;case"WEEKLY":l+=i.getConstant(wt)+" "+i.getConstant(gt)+" ",o.day.forEach(function(e,i){l+=L(t.getValue(Ct[e],a),"single"),l+=o.day.length-1===i?"":", "});break;case"MONTHLY":l+=i.getConstant(Dt)+" "+i.getConstant(gt)+" ",l+=F(o,a,i);break;case"YEARLY":l+=i.getConstant(bt)+" "+i.getConstant(gt)+" ",l+=L(t.getValue(o.month[0].toString(),s),"single")+" ",l+=F(o,a,i)}if(o.count)l+=", "+o.count+" "+i.getConstant(mt);else if(o.until){var d=o.until;l+=", "+i.getConstant(yt)+" "+d.getDate()+" "+L(t.getValue((d.getMonth()+1).toString(),s),"single")+" "+d.getFullYear()}return l}function F(e,i,n){var r="";if(e.monthDay.length)r+=e.monthDay[0];else if(e.day){var a=e.setPosition-1;r+=n.getConstant(vt[a>-1?a:vt.length-1])+" "+L(t.getValue(Ct[e.day[0]],i),"single")}return r}function U(e,i,n,r,a,s,o,l,c){void 0===a&&(a=ut),void 0===s&&(s=null),void 0===o&&(o="Gregorian"),void 0===l&&(l=null),void 0===c&&(c=null);var p,h=we(i);je=ke(o);var d=[],u=new Date(e.getTime());Pe=[];var v=t.isNullOrUndefined(n)?[]:n.split(","),m=new lt;if(v.forEach(function(e){var t=B(e);l&&c&&(t=m.convert(new Date(t.getTime()),l,c)),Pe.push(new Date(t.getTime()).setHours(0,0,0,0))}),h.recExceptionCount=t.isNullOrUndefined(h.count)?0:Pe.length,He=s&&s>e&&!h.count?new Date(new Date(s.getTime()).setHours(0,0,0)):null,!h.until&&He&&((p=new Date(He.getTime())).setDate(He.getDate()+a*h.interval),h.until=p),h.until&&e>h.until)return d;switch(Ie=a,Ae(dt[r]),h.freq){case"DAILY":Y(u,h.until,d,h);break;case"WEEKLY":_(u,h.until,d,h);break;case"MONTHLY":G(u,h.until,d,h);break;case"YEARLY":X(u,h.until,d,h)}return d}function B(e){return new Date(e.substr(0,4)+"-"+e.substr(4,2)+"-"+e.substr(6,5)+":"+e.substr(11,2)+":"+e.substr(13))}function W(e,t){var i=new Date(t).setHours(0,0,0,0);-1===Pe.indexOf(i)&&(!He||i>=He.getTime())&&e.push(t)}function z(e,t){var i=Ie;return t.count?i=t.count:t.until&&("DAILY"===t.freq||"WEEKLY"===t.freq?i=Math.floor((t.until.getTime()-e.getTime())/We)+1:"MONTHLY"!==t.freq&&"YEARLY"!==t.freq||(i=Math.floor((t.until.getMonth()+12*t.until.getFullYear()-(e.getMonth()+12*e.getFullYear()))/t.interval)+(t.day.length>1?Math.floor((t.until.getTime()-e.getTime())/We)+1:1),"YEARLY"===t.freq&&(i=t.month.length>1?i*t.month.length:i))),i}function Y(e,t,i,n){for(var r=new Date(e.getTime()),a=n.interval,s=z(e,n),o=n.day;ge(r,t)&&(!0,!(Ve(r,n)&&(o.indexOf(dt[r.getDay()])>-1||0===o.length)&&(W(i,r.getTime()),s&&i.length+n.recExceptionCount>=s)));)r.setDate(r.getDate()+a)}function _(e,i,n,r){var a=new Date(e.getTime());r.day.length||r.day.push(dt[e.getDay()]);var s,o=r.interval,l=r.day,c=z(e,r),p=!0,h=[];if(l.length>1)for((t.isNullOrUndefined(r.wkst)||""===r.wkst)&&(r.wkst=ht[0]),s=dt.indexOf(r.wkst);ge(a,i);){var d=dt.indexOf(dt[a.getDay()])-s,u=C(C(a,-(d=-1===d?6:d)),6),v=new Date(a.getTime());for(u=w(u),v=w(v);u>=v&&(l.indexOf(dt[a.getDay()])>-1&&h.push([a.getTime()]),!(c&&n.length+r.recExceptionCount>=c));)a.setDate(a.getDate()+1),v=w(v=new Date(a.getTime()));if(a.setDate(a.getDate()-1),c&&n.length+r.recExceptionCount>=c)break;a.setDate(a.getDate()+1+7*(o-1)),le(h,p,e,i,n,r),h=[]}else{for(a=Te(e,r.day);ge(a,i)&&((p=Ve(a,r))&&l.indexOf(dt[a.getDay()])>-1&&W(n,a.getTime()),!(c&&n.length+r.recExceptionCount>=c));)a.setDate(a.getDate()+7*o);le(h,p,e,i,n,r),h=[]}}function G(e,t,i,n){switch(n.month.length||n.day.length||n.monthDay.length?n.month.length>0&&!n.day.length&&!n.monthDay.length&&n.monthDay.push(e.getDate()):(n.monthDay.push(e.getDate()),"YEARLY"===n.freq&&n.month.push(e.getMonth()+1)),Se(n)){case"day":switch(n.freq){case"MONTHLY":re(e,t,i,n);break;case"YEARLY":ae(e,t,i,n)}break;case"both":case"date":switch(n.freq){case"MONTHLY":ee(e,t,i,n);break;case"YEARLY":$(e,t,i,n)}}}function X(e,t,i,n){switch(Z(n)){case"MONTH":G(e,t,i,n);break;case"WEEKNO":Q(e,t,i,n);break;case"YEARDAY":K(e,t,i,n)}}function Q(e,i,n,r){for(var a,s,o,l,c,p=je.getYearLastDate(e,0),h=z(e,r),d=r.weekNo,u=[],v=r.day;ge(p,i);){s=6-ht.indexOf(dt[p.getDay()])+1;for(var m=0;m<d.length;m++)for(l=1===(o=(o=d[m])>0?o:53+o+1)?s:s+7*(o-1),c=1===o?s-7:s+7*(o-2);c<l;)a=new Date(p.getTime()+We*c),(0===v.length||v.indexOf(dt[a.getDay()])>-1)&&(t.isNullOrUndefined(r.setPosition)?de(void 0,e,i,n,r,a.getTime()):u.push([a.getTime()])),c++;if(t.isNullOrUndefined(r.setPosition)||me(u,void 0,e,i,n,r),h&&n.length+r.recExceptionCount>=h)return;p=je.getYearLastDate(a,r.interval),u=[]}}function K(e,i,n,r){for(var a,s,o=je.getYearLastDate(e,0),l=z(e,r),c=[],p=r.day;ge(o,i);){for(var h=0;h<r.yearDay.length;h++)s=r.yearDay[h],a=new Date(o.getTime()),s!==je.getLeapYearDaysCount()&&s!==-je.getLeapYearDaysCount()||je.isLeapYear(je.getFullYear(a),1)?(a.setDate(a.getDate()+(s<0?je.getYearDaysCount(a,1)+1+s:s)),(0===p.length||p.indexOf(dt[a.getDay()])>-1)&&(null==r.setPosition?de(void 0,e,i,n,r,a.getTime()):c.push([a.getTime()]))):a.setDate(a.getDate()+1);if(t.isNullOrUndefined(r.setPosition)||me(c,void 0,e,i,n,r),l&&n.length+r.recExceptionCount>=l)return;o=je.getYearLastDate(a,r.interval),c=[]}}function Z(e){return e.yearDay.length?"YEARDAY":e.weekNo.length?"WEEKNO":"MONTH"}function J(e,t){var i={monthCollection:[],index:0,tempDate:new Date(e.getTime()),mainDate:new Date(e.getTime()),expectedCount:z(e,t),monthInit:0,dateCollection:[]};return t.month.length&&je.setMonth(i.tempDate,t.month[0],i.tempDate.getDate()),i}function $(e,t,i,n){if(n.month.length)return void ee(e,t,i,n);var r,a=J(e,n);for(a.tempDate=a.mainDate=je.getMonthStartDate(a.tempDate);ge(a.tempDate,t);){for(r=new Date(a.tempDate.getTime());je.isSameYear(r,a.tempDate)&&a.expectedCount&&i.length+n.recExceptionCount<=a.expectedCount;){if(!(0===n.month.length||n.month.length>0&&!je.checkMonth(a.tempDate,n.month))){je.setValidDate(a.tempDate,1,1),a.tempDate=Te(a.tempDate,n.day);break}te(n,a,t,!1),a.beginDate=new Date(a.tempDate.getTime()),a.monthInit=ie(a.tempDate,n,a.monthInit,a.beginDate)}if(a.tempDate.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),le(a.dateCollection,a.state,e,t,i,n),je.isLastMonth(a.tempDate)&&(je.setValidDate(a.tempDate,1,1),a.tempDate=Te(a.tempDate,n.day)),a.expectedCount&&i.length+n.recExceptionCount>=a.expectedCount)return;a.tempDate.setFullYear(a.tempDate.getFullYear()+n.interval-1),a.tempDate=Te(a.tempDate,n.day),a.monthInit=ie(a.tempDate,n,a.monthInit,a.beginDate),a.dateCollection=[]}}function ee(e,i,n,r){var a=J(e,r);if(a.tempDate=a.mainDate=je.getMonthStartDate(a.tempDate),!(("MONTHLY"===r.freq&&12===r.interval||"YEARLY"===r.freq)&&je.getMonthDaysCount(e)<r.monthDay[0]))for(;ge(a.tempDate,i);){if(a.beginDate=new Date(a.tempDate.getTime()),te(r,a,i,!0,e,n),t.isNullOrUndefined(r.setPosition)||me(a.dateCollection,a.state,e,i,n,r),a.expectedCount&&n.length+r.recExceptionCount>=a.expectedCount)return;a.monthInit=ie(a.tempDate,r,a.monthInit,a.beginDate),a.dateCollection=[]}}function te(e,i,n,r,a,s){for(var o=0;o<e.monthDay.length;o++){i.date=e.monthDay[o],i.tempDate=je.getMonthStartDate(i.tempDate);var l=je.getMonthDaysCount(i.tempDate);if(i.date=i.date>0?i.date:l+i.date+1,De(i.tempDate,i.date,i.mainDate)&&i.date>0){if(je.setDate(i.tempDate,i.date),n&&i.tempDate>n)return;(0===e.day.length||e.day.indexOf(dt[i.tempDate.getDay()])>-1)&&(r&&t.isNullOrUndefined(e.setPosition)&&i.expectedCount&&s.length+e.recExceptionCount<i.expectedCount?de(i.state,a,n,s,e,i.tempDate.getTime()):i.dateCollection.push([i.tempDate.getTime()]))}}}function ie(e,i,n,r,a){void 0===r&&(r=null);var s=r?r.getMonth():0,o=je.getMonthStartDate(e);return a=t.isNullOrUndefined(a)?i.interval:a,e.setFullYear(o.getFullYear()),e.setMonth(o.getMonth()),e.setDate(o.getDate()),i.month.length?(n++,n%=i.month.length,je.setMonth(e,i.month[n],1),0===n&&je.addYears(e,a,i.month[0])):(r&&r.getFullYear()<e.getFullYear()&&(s=e.getMonth()-1),je.setValidDate(e,a,1,s,r)),n}function ne(e,i,n,r){var a=r.day,s=new Date(e.getTime());s=je.getMonthStartDate(s);var o,l,c=[],p=[],h=[],d=z(e,r),u=0;for(r.month.length&&je.setMonth(s,r.month[0],1),s=Te(s,r.day);ge(s,i)&&d&&n.length+r.recExceptionCount<d;){var v=new Date(s.getTime());if(a.map(function(e){return Ot.test(e)}).indexOf(!0)>-1){for(var m=0;m<=a.length-1;m++){var g=a[m].match(St),f=parseInt(g[0],10);for(s=new Date(s.getTime()),s=Te(s=je.getMonthStartDate(s),a),v.setFullYear(s.getFullYear(),s.getMonth(),s.getDate());je.isSameYear(v,s)&&je.isSameMonth(v,s);)g[g.length-1]===dt[v.getDay()]&&c.push([v.getTime()]),v.setDate(v.getDate()+1);if(v.setDate(v.getDate()-1),o=g[0].indexOf("-")>-1?c.length- -1*f:f-1,o=isNaN(o)?0:o,c.length>0&&(t.isNullOrUndefined(r.setPosition)?me(c,void 0,e,i,n,r,o):p=[he(c,o,h)]),d&&n.length+r.recExceptionCount>=d)return;c=[]}t.isNullOrUndefined(r.setPosition)||(ve(p,void 0,e,i,n,r),h=[]),u=ie(s,r,u,l),s=Te(s,r.day),c=[]}else{var y=[],T=be(a);v.setFullYear(s.getFullYear(),s.getMonth(),s.getDate());var w=new Date(s.getTime());for(l=new Date(s.getTime());je.isSameMonth(w,s);)y.push(s.getTime()),a.indexOf(dt[s.getDay()])>-1&&(c.push(y),y=[]),s.setDate(s.getDate()+T[dt[s.getDay()]]);if(o=r.setPosition<1?c.length+r.setPosition:r.setPosition-1,t.isNullOrUndefined(r.setPosition)){o=0;for(var D=[],b=0;b<c.length;b++)for(var C=0;C<c[b].length;C++)D.push(c[b][C]);c=[D]}if(c.length>0&&me(c,void 0,e,i,n,r,o),d&&n.length+r.recExceptionCount>=d)return;u=ie(s,r,u,l),s=Te(s,r.day),c=[]}}}function re(e,t,i,n){if(n.day.length>1)return void ne(e,t,i,n);var r,a=new Date(e.getTime()),s=z(e,n),o=[],l=0;for(a=je.getMonthStartDate(a),n.month.length&&je.setMonth(a,n.month[0],1),a=Te(a,n.day);ge(a,t)&&s&&i.length+n.recExceptionCount<s;){r=new Date(a.getTime());for(var c=new Date(a.getTime());je.isSameMonth(a,c);)o.push([c.getTime()]),c.setDate(c.getDate()+7);pe(o,e,t,i,n),l=ie(a,n,l,r),a=Te(a,n.day),o=[]}}function ae(e,i,n,r){var a=r.day,s=a.map(function(e){return Ot.test(e)});if(a.length>1&&s.indexOf(!0)>-1)return void se(e,i,n,r);if(r.month.length&&1===a.length&&s.indexOf(!0)>-1)return void re(e,i,n,r);var o,l=new Date(e.getTime()),c=z(e,r),p=r.interval,h=[];for(r.month.length&&je.setMonth(l,r.month[0],l.getDate()),t.isNullOrUndefined(r.setPosition)&&0===r.month.length&&0===r.weekNo.length&&l.setFullYear(e.getFullYear(),0,1),l=Te(l=je.getMonthStartDate(l),r.day);ge(l,i);){for(o=new Date(l.getTime());je.isSameYear(o,l)&&c&&n.length+r.recExceptionCount<=c;)for(o=new Date(l.getTime());je.isSameYear(o,l);){if(!(0===r.month.length||r.month.length>0&&!je.checkMonth(l,r.month))){je.setValidDate(l,1,1),l=Te(l,r.day);break}if(a.length>1){if(je.compareMonth(o,l)){je.setValidDate(l,1,1),l=Te(l,r.day);break}a.indexOf(dt[o.getDay()])>-1&&h.push([o.getTime()]),o.setDate(o.getDate()+1)}else{if(o.getFullYear()>l.getFullYear()){je.setValidDate(l,1,1),l=Te(l,r.day);break}var d=fe(a[0]);dt[o.getDay()]===d&&new Date(o.getFullYear(),o.getMonth(),0)>new Date(e.getFullYear())&&h.push([o.getTime()]),o.setDate(o.getDate()+7)}}if(l.setFullYear(o.getFullYear(),o.getMonth(),o.getDate()),pe(h,e,i,n,r),je.isLastMonth(l)&&(je.setValidDate(l,1,1),l=Te(l,r.day)),l.setFullYear(l.getFullYear()+p-1),c&&n.length+r.recExceptionCount>=c)return;l=Te(l,r.day),h=[]}}function se(e,i,n,r){var a,s,o,l=r.day,c=z(e,r),p=new Date(e.getTime()),h=r.interval,d=[],u=[],v=0;p=je.getMonthStartDate(p);var m=[];for(r.month.length&&je.setMonth(p,r.month[0],1),p=Te(p,r.day);ge(p,i);){s=new Date(p.getTime());for(var g=0;g<=r.month.length;g++)for(var f=0;f<=l.length-1;f++){for(p=Te(p=je.getMonthStartDate(p),r.day),d=[];je.isSameYear(s,p)&&c&&n.length+r.recExceptionCount<=c;)for(;je.isSameYear(s,p);){if(s=new Date(p.getTime()),0===r.month.length||r.month.length>0&&r.month[g]===je.getMonth(s)){var y=l[f].match(St),T=parseInt(y[0],10);for(o=new Date(p.getTime());je.isSameYear(o,p)&&je.isSameMonth(o,p);)y[y.length-1]===dt[o.getDay()]&&d.push([o.getTime()]),o.setDate(o.getDate()+1);o.setDate(o.getDate()-1),a=y[0].indexOf("-")>-1?d.length- -1*T:T-1,a=isNaN(a)?0:a}v=ie(p,r,v,void 0,1),p=Te(p,r.day)}if(p=0===f&&o?new Date(o.getTime()):new Date(s.getTime()),d.length>0&&(t.isNullOrUndefined(r.setPosition)?me(d,void 0,e,i,n,r,a):u=[he(d,a,m)]),c&&n.length+r.recExceptionCount>=c)return}t.isNullOrUndefined(r.setPosition)||(ve(u,void 0,e,i,n,r),m=[]),je.isLastMonth(p)?(je.setValidDate(p,1,1),p.setFullYear(p.getFullYear()+h-1)):p.setFullYear(p.getFullYear()+h),p=Te(p,r.day),r.month.length&&je.setMonth(p,r.month[0],p.getDate())}}function oe(e,t){var i,n={monthCollection:[],index:0};if(1===t.length){var r=t[0].match(St),a=void 0;r.length>1?i=(a=parseInt(r[0],10))<1?e.length+a:a-1:(i=0,e=ce(e))}else i=0,e=ce(e);return n.monthCollection=e,n.index=i,n}function le(e,i,n,r,a,s){var o=s.setPosition<1?e.length+s.setPosition:s.setPosition-1;t.isNullOrUndefined(s.setPosition)&&(o=0,e=ce(e)),e.length>0&&me(e,i,n,r,a,s,o)}function ce(e){for(var t=[],i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)t.push(new Date(e[i][n]).getTime());return e=t.length>0?[t]:[]}function pe(e,t,i,n,r){var a=[],s=oe(e,r.day);e=s.monthCollection;var o=s.index;null!=r.setPosition?ve([he(e,o,a)],void 0,t,i,n,r):e.length>0&&me(e,void 0,t,i,n,r,o),a=[]}function he(e,t,i){for(var n=0;n<e[t].length;n++)i.push(e[t][n]);return i}function de(e,t,i,n,r,a){var s=z(t,r),o=new Date(a);e=Ve(o,r),o>=t&&ge(o,i)&&e&&s&&n.length+r.recExceptionCount<s&&W(n,a)}function ue(e,t,i,n,r){var a=t||0,s=new Date(e,r.month[0]-1,1),o=new Date(e,r.month[0]-1,0).getDate(),l=(s.getDay()-a+7)%7+o,c=Math.ceil(l/7)-1,p=i[n][c];return Ve(new Date(p),r)?c:c-1}function ve(e,t,i,n,r,a){if(e.length>0)for(var s=0;s<e.length;s++){e[s].sort();var o=a.day.map(function(e){return Ot.test(e)}),l="YEARLY"===a.freq&&a.validRules.indexOf("BYMONTH")>-1&&!(o.indexOf(!0)>-1)?ue(new Date(e[0][0]).getFullYear(),0,e,s,a):e[s].length+a.setPosition,c=a.setPosition<1?l:a.setPosition-1;de(t,i,n,r,a,e[s][c])}}function me(e,i,n,r,a,s,o){if(e.length>0){e[o=t.isNullOrUndefined(o)?s.setPosition<1?e.length+s.setPosition:s.setPosition-1:o].sort();for(var l=0;l<e[o].length;l++)de(i,n,r,a,s,e[o][l])}}function ge(e,t){return!t||e<=t}function fe(e){return e.replace(Et,"")}function ye(e,t){var i=[];return t.forEach(function(e){var t=e.match(St);2===t.length?i.push(t[1]):i.push(t[0])}),-1===i.indexOf(dt[e])}function Te(e,t){var i,n=new Date(e.getTime());if(t.length>0){for(var r=[],a=0;a<=t.length-1;a++)i=fe(t[a]),r.push(i);if(-1===r.indexOf(dt[n.getDay()]))do{n.setDate(n.getDate()+1)}while(-1===r.indexOf(dt[n.getDay()]))}return n}function we(e){var t,i={freq:null,interval:1,count:null,until:null,day:[],wkst:null,month:[],weekNo:[],monthDay:[],yearDay:[],setPosition:null,validRules:[]},n=[];if(e.split(";").forEach(function(e){switch((n=e.split("="))[0]){case"UNTIL":t=n[1],i.until=B(t);break;case"BYDAY":i.day=n[1].split(","),i.validRules.push(n[0]);break;case"BYMONTHDAY":i.monthDay=n[1].split(",").map(Number),i.validRules.push(n[0]);break;case"BYMONTH":i.month=n[1].split(",").map(Number),i.validRules.push(n[0]);break;case"BYYEARDAY":i.yearDay=n[1].split(",").map(Number),i.validRules.push(n[0]);break;case"BYWEEKNO":i.weekNo=n[1].split(",").map(Number),i.validRules.push(n[0]);break;case"INTERVAL":i.interval=parseInt(n[1],10);break;case"COUNT":i.count=parseInt(n[1],10);break;case"BYSETPOS":i.setPosition=parseInt(n[1],10)>4?-1:parseInt(n[1],10);break;case"FREQ":i.freq=n[1];break;case"WKST":i.wkst=n[1]}}),"MONTHLY"===i.freq&&0===i.monthDay.length){var r=i.validRules.indexOf("BYDAY");i.validRules.splice(r,1)}return i}function De(e,t,i){return t<=je.getMonthDaysCount(e)&&e>=i}function be(e){var t={};return e.forEach(function(i,n){if(n===e.length-1){for(var r=ht.indexOf(i),a=r;a%7!==ht.indexOf(e[0]);)a++;t[i]=a-r}else t[i]=ht.indexOf(e[n+1])-ht.indexOf(i)}),t}function Ce(e,t){var i,n=t.slice(0),r=je.getMonthDaysCount(e);for(i=n.shift();i;){if(i<0&&(i=i+r+1),i===e.getDate())return!1;i=n.shift()}return!0}function Oe(e,t){var i,n=t.slice(0),r=Ee(e);for(i=n.shift();i;){if(i<0&&(i=i+je.getYearDaysCount(e,0)+1),i===r)return!1;i=n.shift()}return!0}function Ee(e){pt[je.getFullYear(e)]||(pt[je.getFullYear(e)]=je.getYearLastDate(e,0));var t=pt[je.getFullYear(e)],i=e.getTime()-t.getTime();return Math.ceil(i/We)}function Se(e){return e.monthDay.length&&!e.day.length?"date":!e.monthDay.length&&e.day.length?"day":"both"}function xe(e){var t=e.shift();e.push(t)}function Ae(e){for(;ht[0]!==e;)xe(ht)}function Ve(e,t){var i=!0,n=t.day,r=t.month,a=je.getExpectedDays(e,t.monthDay),s=t.yearDay;return t.validRules.forEach(function(t){switch(t){case"BYDAY":ye(e.getDay(),n)&&(i=!1);break;case"BYMONTH":je.checkMonth(e,r)&&(i=!1);break;case"BYMONTHDAY":Ce(e,a)&&(i=!1);break;case"BYYEARDAY":Oe(e,s)&&(i=!1)}}),i}function ke(e){return"Islamic"===e?new ot:new st}function Me(e){return[e.getUTCFullYear(),Re(e.getUTCMonth()+1),Re(e.getUTCDate()),"T",Re(e.getUTCHours()),Re(e.getUTCMinutes()),Re(e.getUTCSeconds()),"Z"].join("")}function Re(e){return("0"+e).slice(-2)}var Pe,Ie,He,je,qe="actionBegin",Le="renderCell",Ne="inlineClick",Fe="data-ready",Ue="content-ready",Be="scroll-ui-update",We=864e5,ze=6e4,Ye=null,_e="e-schedule",Ge="e-icons",Xe="e-table-container",Qe="e-content-table",Ke="e-popup-open",Ze="e-appointment-container",Je="e-text-ellipsis",$e="e-schedule-form",et="e-schedule-event-tooltip",tt=function(){function e(e){this.parent=e,this.l10n=this.parent.localeObj,this.renderHeader(),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("document-click",this.closeHeaderPopup,this)},e.prototype.removeEventListener=function(){this.parent.off("document-click",this.closeHeaderPopup)},e.prototype.closeHeaderPopup=function(e){var i=t.closest(e.event.target,".e-date-range,.e-header-popup,.e-day,.e-selected"),n=t.closest(e.event.target,".e-hor-nav,.e-toolbar-pop"),r=this.parent.element.querySelector(".e-content-wrap");if(this.parent.isAdaptive)if(t.isNullOrUndefined(n)||!n.classList.contains("e-toolbar-pop")&&!n.classList.contains("e-hor-nav")||n.classList.contains("e-hor-nav")&&this.element.querySelector(".e-toolbar-pop").classList.contains(Ke)){t.removeClass([r],"e-scroll-hidden");var a=this.element.querySelector(".e-toolbar-pop");if(!t.isNullOrUndefined(a)){var s=a.ej2_instances[0];!s||!t.isNullOrUndefined(n)&&n.classList.contains("e-hor-nav")&&a.classList.contains(Ke)||s.hide()}}else t.addClass([r],"e-scroll-hidden");t.isNullOrUndefined(i)&&this.hideHeaderPopup()},e.prototype.hideHeaderPopup=function(){this.headerPopup&&this.headerPopup.hide()},e.prototype.renderHeader=function(){this.element=t.createElement("div",{className:"e-schedule-toolbar-container"});var e=t.createElement("div",{className:"e-schedule-toolbar"});this.element.appendChild(e),this.parent.element.insertBefore(this.element,this.parent.element.firstElementChild),this.renderToolbar()},e.prototype.renderToolbar=function(){var e=this,t=this.getItems();this.parent.trigger(qe,{requestType:"toolbarItemRendering",items:t},function(t){e.toolbarObj=new n.Toolbar({items:t.items,overflowMode:"Popup",clicked:e.toolbarClickHandler.bind(e),enableRtl:e.parent.enableRtl,locale:e.parent.locale}),e.toolbarObj.appendTo(e.parent.element.querySelector(".e-schedule-toolbar"));var i=e.toolbarObj.element.querySelector(".e-prev");i&&i.firstElementChild.setAttribute("title",e.l10n.getConstant("previous"));var r=e.toolbarObj.element.querySelector(".e-next");r&&r.firstElementChild.setAttribute("title",e.l10n.getConstant("next")),e.updateAddIcon(),e.updateActiveView(),e.parent.trigger("actionComplete",{requestType:"toolBarItemRendered",items:e.toolbarObj.items})})},e.prototype.updateItems=function(){var e=this;if(this.toolbarObj){var t=this.getItems();this.parent.trigger(qe,{requestType:"toolbarItemRendering",items:t},function(t){e.toolbarObj.items=t.items,e.toolbarObj.dataBind(),e.parent.trigger("actionComplete",{requestType:"toolBarItemRendered",items:e.toolbarObj.items})})}},e.prototype.getPopUpRelativeElement=function(){return this.parent.isAdaptive?this.toolbarObj.element:this.element.querySelector(".e-date-range")},e.prototype.setDayOfWeek=function(e){this.headerCalendar&&(this.headerCalendar.firstDayOfWeek=e,this.headerCalendar.dataBind())},e.prototype.setCalendarDate=function(e){this.headerCalendar&&(this.headerCalendar.value=e,this.headerCalendar.dataBind())},e.prototype.setCalendarMinMaxDate=function(){this.headerCalendar&&(this.headerCalendar.min=this.parent.minDate,this.headerCalendar.max=this.parent.maxDate,this.headerCalendar.dataBind())},e.prototype.getCalendarView=function(){return["Month","MonthAgenda","TimelineMonth"].indexOf(this.parent.currentView)>-1?"Year":["Year","TimelineYear"].indexOf(this.parent.currentView)>-1?"Decade":"Month"},e.prototype.setCalendarView=function(){if(this.headerCalendar){var e=this.getCalendarView();this.headerCalendar.depth=e,this.headerCalendar.start=e,this.headerCalendar.refresh()}},e.prototype.updateActiveView=function(){var e=[].slice.call(this.toolbarObj.element.querySelectorAll(".e-views"));t.removeClass(e,["e-active-view"]),e.length>0&&e[this.parent.viewIndex]&&t.addClass([e[this.parent.viewIndex]],["e-active-view"])},e.prototype.updateDateRange=function(e){var t=this.toolbarObj.element.querySelector(".e-date-range");t&&(t.setAttribute("aria-label",e),t.querySelector(".e-tbar-btn-text").innerHTML=e,this.refresh())},e.prototype.refresh=function(){this.toolbarObj&&this.toolbarObj.refreshOverflow()},e.prototype.updateAddIcon=function(){var e=this.toolbarObj.element.querySelector(".e-add");e&&(this.parent.eventSettings.allowAdding?t.removeClass([e],"e-hidden"):t.addClass([e],"e-hidden"))},e.prototype.getDateRangeText=function(){return L(this.parent.globalize.formatDate(this.parent.selectedDate,{format:"MMMM y",calendar:this.parent.getCalendarMode()}),"single")},e.prototype.getItems=function(){var e=[];if(e.push({align:"Left",prefixIcon:"e-icon-prev",tooltipText:"Previous",overflow:"Show",cssClass:"e-prev",htmlAttributes:{"aria-label":"previous period",role:"navigation"}}),e.push({align:"Left",prefixIcon:"e-icon-next",tooltipText:"Next",overflow:"Show",cssClass:"e-next",htmlAttributes:{"aria-label":"next period",role:"navigation"}}),e.push({align:"Left",text:this.getDateRangeText(),suffixIcon:"e-icon-down-arrow",cssClass:"e-date-range",overflow:"Show",htmlAttributes:{"aria-atomic":"true","aria-live":"assertive","aria-label":"title",role:"navigation"}}),this.parent.isAdaptive||this.parent.enableAdaptiveUI?(e.push({align:"Right",showAlwaysInPopup:this.parent.isAdaptive||this.parent.enableAdaptiveUI,prefixIcon:"e-icon-add",text:this.l10n.getConstant("newEvent"),cssClass:"e-add",overflow:"Show"}),e.push({align:"Right",showAlwaysInPopup:this.parent.isAdaptive||this.parent.enableAdaptiveUI,prefixIcon:"e-icon-today",text:this.l10n.getConstant("today"),cssClass:"e-today",overflow:"Show"})):(e.push({align:"Right",showAlwaysInPopup:this.parent.isAdaptive||this.parent.enableAdaptiveUI,prefixIcon:"e-icon-day",text:this.l10n.getConstant("today"),cssClass:"e-today",overflow:"Show"}),this.parent.views.length>1&&e.push({align:"Right",type:"Separator",cssClass:"e-schedule-seperator"})),this.parent.views.length>1)for(var t=0,i=this.parent.views;t<i.length;t++){var n=i[t];e.push(this.getItemObject(n))}return e},e.prototype.getItemObject=function(e){var t,i;"string"==typeof e?(t=e.toLowerCase(),i=null):(t=e.option.toLowerCase(),i=e.displayName);var n,r=this.parent.isAdaptive||this.parent.enableAdaptiveUI;switch(t){case"day":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-day",text:i||this.l10n.getConstant("day"),cssClass:"e-views e-day"};break;case"week":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-week",text:i||this.l10n.getConstant("week"),cssClass:"e-views e-week"};break;case"workweek":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-workweek",text:i||this.l10n.getConstant("workWeek"),cssClass:"e-views e-work-week"};break;case"month":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-month",text:i||this.l10n.getConstant("month"),cssClass:"e-views e-month"};break;case"year":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-year",text:i||this.l10n.getConstant("year"),cssClass:"e-views e-year"};break;case"agenda":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-agenda",text:i||this.l10n.getConstant("agenda"),cssClass:"e-views e-agenda"};break;case"monthagenda":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-month-agenda",text:i||this.l10n.getConstant("monthAgenda"),cssClass:"e-views e-month-agenda"};break;case"timelineday":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-timeline-day",text:i||this.l10n.getConstant("timelineDay"),cssClass:"e-views e-timeline-day"};break;case"timelineweek":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-timeline-week",text:i||this.l10n.getConstant("timelineWeek"),cssClass:"e-views e-timeline-week"};break;case"timelineworkweek":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-timeline-workweek",text:i||this.l10n.getConstant("timelineWorkWeek"),cssClass:"e-views e-timeline-work-week"};break;case"timelinemonth":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-timeline-month",text:i||this.l10n.getConstant("timelineMonth"),cssClass:"e-views e-timeline-month"};break;case"timelineyear":n={align:"Right",showAlwaysInPopup:r,prefixIcon:"e-icon-timeline-year-"+("Vertical"===e.orientation?"vertical":"horizontal"),text:i||this.l10n.getConstant("timelineYear"),cssClass:"e-views e-timeline-year"}}return n},e.prototype.renderHeaderPopup=function(){var e=t.createElement("div",{className:"e-header-popup"}),n=t.createElement("div",{className:"e-header-calendar"});e.appendChild(n),this.element.appendChild(e),this.headerPopup=new i.Popup(e,{actionOnScroll:"hide",targetType:"relative",relateTo:this.getPopUpRelativeElement(),position:{X:"left",Y:"bottom"},enableRtl:this.parent.enableRtl});var a=this.getCalendarView(),s="Month"===this.parent.currentView&&!t.isNullOrUndefined(this.parent.activeViewOptions.displayDate)&&!this.hasSelectedDate();this.headerCalendar=new r.Calendar({value:s?this.parent.activeViewOptions.displayDate:this.parent.selectedDate,min:this.parent.minDate,max:this.parent.maxDate,firstDayOfWeek:this.parent.activeViewOptions.firstDayOfWeek,enableRtl:this.parent.enableRtl,locale:this.parent.locale,depth:a,start:a,calendarMode:this.parent.calendarMode,change:this.calendarChange.bind(this)}),this.setCalendarTimezone(),this.headerCalendar.appendTo(n),this.headerPopup.hide()},e.prototype.calendarChange=function(e){if(e.value.getTime()!==this.parent.selectedDate.getTime()){var t=w(new Date(e.value));this.parent.changeDate(t)}this.headerPopup.hide()},e.prototype.setCalendarTimezone=function(){this.headerCalendar&&(this.headerCalendar.timezone=this.parent.timezone||this.parent.tzModule.getLocalTimezoneName())},e.prototype.calculateViewIndex=function(e){var i=t.closest(e.originalEvent.target,".e-views");return[].slice.call(this.element.querySelectorAll(".e-views")).indexOf(i)},e.prototype.toolbarClickHandler=function(e){if(e.item){var i,n,r;switch(e.item.cssClass.replace("e-views ","")){case"e-date-range":this.headerPopup||this.renderHeaderPopup(),this.headerPopup.element.classList.contains(Ke)?this.headerPopup.hide():this.headerPopup.show();break;case"e-day":this.parent.changeView("Day",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-week":this.parent.changeView("Week",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-work-week":this.parent.changeView("WorkWeek",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-month":this.parent.changeView("Month",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-year":this.parent.changeView("Year",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-agenda":this.parent.changeView("Agenda",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-month-agenda":this.parent.changeView("MonthAgenda",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-timeline-day":this.parent.changeView("TimelineDay",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-timeline-week":this.parent.changeView("TimelineWeek",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-timeline-work-week":this.parent.changeView("TimelineWorkWeek",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-timeline-month":this.parent.changeView("TimelineMonth",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-timeline-year":this.parent.changeView("TimelineYear",e.originalEvent,void 0,this.calculateViewIndex(e));break;case"e-today":r=w(this.parent.getCurrentTime()),("Agenda"===this.parent.currentView||"MonthAgenda"===this.parent.currentView||!this.parent.isSelectedDate(r)||"Month"===this.parent.currentView&&this.parent.activeViewOptions.displayDate&&!this.hasSelectedDate()&&w(this.parent.activeViewOptions.displayDate)!==r||"Month"===this.parent.currentView&&this.parent.activeViewOptions.numberOfWeeks>0&&!this.hasSelectedDate()&&w(m(this.parent.selectedDate))!==r)&&this.parent.changeDate(r,e.originalEvent);break;case"e-prev":this.parent.changeDate(this.parent.activeView.getNextPreviousDate("previous"),e.originalEvent);break;case"e-next":this.parent.changeDate(this.parent.activeView.getNextPreviousDate("next"),e.originalEvent);break;case"e-add":if(n=this.parent.activeCellsData.startTime.getTime()===this.parent.activeCellsData.endTime.getTime(),this.parent.activeCellsData&&!n)i=this.parent.activeCellsData;else{var a=this.parent.activeViewOptions.timeScale.interval,s=this.parent.activeViewOptions.timeScale.slotCount,o=a*ze/s,l=new Date(this.parent.selectedDate.getTime()),c=this.parent.getCurrentTime();l.setHours(c.getHours(),Math.round(l.getMinutes()/o)*o,0),i={startTime:l,endTime:new Date(new Date(l.getTime()).setMilliseconds(l.getMilliseconds()+o)),isAllDay:!1}}this.parent.eventWindow.openEditor(t.extend(i,{cancel:!1,event:e.originalEvent}),"Add")}if(!t.isNullOrUndefined(this.toolbarObj)){var p=this.toolbarObj.element.querySelector(".e-toolbar-pop");p&&"Input"!==e.item.type&&p.ej2_instances[0].hide({name:"SlideUp",duration:100})}}},e.prototype.hasSelectedDate=function(){var e=w(this.parent.selectedDate).getTime();return e>=this.parent.activeView.getStartDate().getTime()&&e<=this.parent.activeView.getEndDate().getTime()},e.prototype.getHeaderElement=function(){return this.toolbarObj.element},e.prototype.updateHeaderItems=function(e){var i=this.toolbarObj.element.querySelector(".e-prev"),n=this.toolbarObj.element.querySelector(".e-next"),r=this.toolbarObj.element.querySelector(".e-date-range");i&&("add"===e?t.addClass([i],"e-hidden"):t.removeClass([i],"e-hidden")),n&&("add"===e?t.addClass([n],"e-hidden"):t.removeClass([n],"e-hidden")),r&&("add"===e?t.addClass([r],Je):t.removeClass([r],Je))},e.prototype.previousNextIconHandler=function(){var e="Agenda"===this.parent.currentView?[this.parent.getCurrentViewDates()[0]]:this.parent.getCurrentViewDates(),i=this.toolbarObj.element.querySelector(".e-prev"),n=this.toolbarObj.element.querySelector(".e-next"),r=new Date(e[0].getTime()),a=new Date(e[e.length-1].getTime());if("WorkWeek"!==this.parent.currentView&&"TimelineWorkWeek"!==this.parent.currentView||(a=C(r=u(w(this.parent.selectedDate),this.parent.firstDayOfWeek),7*this.parent.activeViewOptions.interval)),"Month"===this.parent.currentView){var s=!t.isNullOrUndefined(this.parent.activeViewOptions.displayDate)||this.parent.activeViewOptions.numberOfWeeks>0;r=s?this.parent.activeView.getStartDate():m(this.parent.selectedDate),a=s?this.parent.activeView.getEndDate():g(O(r,this.parent.activeViewOptions.interval-1))}t.isNullOrUndefined(i)||this.toolbarObj.enableItems(i,r>this.parent.minDate),t.isNullOrUndefined(n)||this.toolbarObj.enableItems(n,a<this.parent.maxDate),this.setCalendarMinMaxDate()},e.prototype.getModuleName=function(){return"headerbar"},e.prototype.destroy=function(){this.headerPopup&&!this.headerPopup.isDestroyed&&(this.headerPopup.destroy(),this.headerPopup=null),this.headerCalendar&&!this.headerCalendar.isDestroyed&&(this.headerCalendar.destroy(),this.headerCalendar=null),this.toolbarObj&&!this.toolbarObj.isDestroyed&&(this.toolbarObj.destroy(),this.removeEventListener(),t.remove(this.element),this.toolbarObj=null),this.element=null,this.parent=null,this.l10n=null},e}(),it=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"scroll"},e.prototype.setWidth=function(){this.parent.element.style.width=t.formatUnit(this.parent.width)},e.prototype.setHeight=function(){this.parent.element.style.height=t.formatUnit(this.parent.height)},e.prototype.addEventListener=function(){this.parent.on(Ue,this.setDimensions,this),this.parent.on("ui-update",this.onPropertyChanged,this)},e.prototype.removeEventListener=function(){this.parent.off(Ue,this.setDimensions),this.parent.off("ui-update",this.onPropertyChanged)},e.prototype.setDimensions=function(){this.setWidth(),this.setHeight();var e={cssProperties:this.parent.getCssProperties(),module:this.getModuleName()};this.parent.notify(Be,e)},e.prototype.onPropertyChanged=function(){this.setDimensions()},e.prototype.destroy=function(){this.removeEventListener()},e}(),nt=function(){function e(e){this.parent=e,this.element=this.parent.element.querySelector("."+Xe),this.touchObj=new t.Touch(this.element,{scroll:this.scrollHandler.bind(this),swipe:this.swipeHandler.bind(this),tapHold:this.tapHoldHandler.bind(this),swipeSettings:{swipeThresholdDistance:1}}),t.EventHandler.add(this.element,"transitionend",this.onTransitionEnd,this),this.touchLeftDirection=this.parent.enableRtl?"Right":"Left",this.touchRightDirection=this.parent.enableRtl?"Left":"Right"}return e.prototype.scrollHandler=function(e){if(!("Agenda"===this.parent.currentView||this.parent.uiStateValues.action||e.originalEvent&&(e.originalEvent.target.classList.contains("e-appointment")||t.closest(e.originalEvent.target,".e-appointment")))){if(this.timeStampStart||(this.timeStampStart=Date.now()),this.element.classList.contains("e-translate")&&this.onTransitionEnd(),"Left"===e.scrollDirection||"Right"===e.scrollDirection){var i={requestType:"dateNavigate",cancel:!1,event:e.originalEvent};if(this.parent.trigger(qe,i),i.cancel)return;var n=this.element.querySelector(".e-content-wrap");if(n&&n.scrollWidth>n.clientWidth)return;this.isScrollTriggered=!0,e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}if(e.scrollDirection===this.touchLeftDirection){this.nextPanel||(this.renderPanel("e-next-panel","next"),this.nextPanel={element:this.parent.activeView.getPanel(),selectedDate:new Date(this.parent.selectedDate.getTime())},this.setDimensions(this.nextPanel.element));a=this.parent.enableRtl?e.distanceX:-e.distanceX;this.element.style.transform="translatex("+(this.getTranslateX(this.element)+a)+"px)"}else if(e.scrollDirection===this.touchRightDirection){var r=0;this.previousPanel||(this.renderPanel("e-previous-panel","previous"),this.previousPanel={element:this.parent.activeView.getPanel(),selectedDate:new Date(this.parent.selectedDate.getTime())},this.setDimensions(this.previousPanel.element),r=this.previousPanel.element.offsetWidth);var a=this.parent.enableRtl?r-e.distanceX:-r+e.distanceX;this.element.style.transform="translatex("+(this.getTranslateX(this.element)+a)+"px)"}}},e.prototype.swipeHandler=function(e){if(this.isScrollTriggered&&!this.parent.uiStateValues.action){this.isScrollTriggered=!1;var i="Left"===e.swipeDirection?this.parent.activeView.renderDates[0]:this.parent.activeView.renderDates.slice(-1)[0];if("Left"===e.swipeDirection&&i<this.parent.maxDate||"Right"===e.swipeDirection&&i>=this.parent.minDate){var n=Date.now()-this.timeStampStart,r=e.distanceX*(t.Browser.isDevice?6:1.66);r>n||e.distanceX>this.parent.element.offsetWidth/2?(this.swapPanels(e.swipeDirection),r>n&&e.distanceX>this.parent.element.offsetWidth/2&&(this.element.style.transitionDuration=r/n/10+"s"),this.confirmSwipe(e.swipeDirection)):this.cancelSwipe();var a={requestType:"dateNavigate",cancel:!1,event:e.originalEvent};this.parent.trigger("actionComplete",a)}else this.cancelSwipe();this.timeStampStart=null}},e.prototype.tapHoldHandler=function(e){var i=t.closest(e.originalEvent.target,".e-appointment");if(!t.isNullOrUndefined(i)&&this.parent.isAdaptive)return void this.parent.quickPopup.tapHoldEventPopup(e.originalEvent)},e.prototype.renderPanel=function(e,t){this.currentPanel?this.parent.setProperties({selectedDate:this.currentPanel.selectedDate},!0):(this.currentPanel={element:this.parent.activeView.getPanel(),selectedDate:new Date(this.parent.selectedDate.getTime())},this.setDimensions(this.currentPanel.element)),this.parent.setProperties({selectedDate:this.parent.activeView.getNextPreviousDate(t)},!0),this.parent.headerModule&&this.parent.headerModule.setCalendarDate(this.parent.selectedDate),this.parent.activeView.getRenderDates(),this.parent.activeView.renderLayout(e)},e.prototype.swapPanels=function(e){if(e===this.touchLeftDirection){t=this.nextPanel;this.nextPanel=this.currentPanel,this.currentPanel=t}else{var t=this.previousPanel;this.previousPanel=this.currentPanel,this.currentPanel=t}},e.prototype.confirmSwipe=function(e){var i=this,n={action:"date",cancel:!1,previousDate:e===this.touchLeftDirection?this.nextPanel.selectedDate:this.previousPanel.selectedDate,currentDate:this.currentPanel.selectedDate};this.parent.trigger("navigating",n,function(n){if(n.cancel)i.swapPanels(e),i.cancelSwipe();else{i.parent.activeView.setPanel(i.currentPanel.element),i.parent.setProperties({selectedDate:i.currentPanel.selectedDate},!0);var r=void 0;r=i.parent.enableRtl?e===i.touchLeftDirection?i.previousPanel?i.previousPanel.element.offsetLeft:i.currentPanel.element.offsetWidth:0:e===i.touchLeftDirection?-i.currentPanel.element.offsetLeft:0,t.addClass([i.element],"e-translate"),i.element.style.transform="translatex("+r+"px)",i.parent.headerModule&&i.parent.headerModule.updateDateRange(i.parent.activeView.getDateRangeText()),i.parent.renderTemplates(),i.parent.crudModule.refreshDataManager()}})},e.prototype.cancelSwipe=function(){this.parent.activeView.setPanel(this.currentPanel.element),this.parent.setProperties({selectedDate:this.currentPanel.selectedDate},!0),this.parent.activeView.getRenderDates(),this.parent.activeView.generateColumnLevels(),t.addClass([this.element],"e-translate");var e=this.previousPanel?this.previousPanel.element.offsetWidth:0;this.element.style.transform="translatex("+(this.parent.enableRtl?e:-this.currentPanel.element.offsetLeft)+"px)"},e.prototype.onTransitionEnd=function(){t.removeClass([this.element],"e-translate"),this.element.style.transitionDuration="",this.element.style.transform="",this.previousPanel&&(t.remove(this.previousPanel.element),this.previousPanel=null,t.removeClass([this.currentPanel.element],"e-previous-panel"),t.addClass([this.currentPanel.element],"e-current-panel")),this.nextPanel&&(t.remove(this.nextPanel.element),this.nextPanel=null,t.removeClass([this.currentPanel.element],"e-next-panel"),t.addClass([this.currentPanel.element],"e-current-panel")),this.currentPanel=null,this.parent.activeView.getPanel().style.width=""},e.prototype.getTranslateX=function(e){var t=window.getComputedStyle(e);return new WebKitCSSMatrix(t.webkitTransform).m41},e.prototype.setDimensions=function(e){e.style.width=this.parent.element.clientWidth+"px"},e.prototype.resetValues=function(){this.currentPanel=null,this.previousPanel=null,this.nextPanel=null,this.timeStampStart=null,this.element.style.transform="",P(this.element),t.removeClass([this.element],"e-translate")},e.prototype.destroy=function(){this.touchObj&&(this.touchObj.destroy(),this.touchObj=null),t.EventHandler.remove(this.element,"transitionend",this.onTransitionEnd),this.resetValues()},e}(),rt=function(){function e(e){this.selectedCells=[],this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDownArrow:"shift+downarrow",shiftUpArrow:"shift+uparrow",shiftRightArrow:"shift+rightarrow",shiftLeftArrow:"shift+leftarrow",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow",altOne:"alt+1",altTwo:"alt+2",altThree:"alt+3",altFour:"alt+4",altFive:"alt+5",altSix:"alt+6",altSeven:"alt+7",altEight:"alt+8",altNine:"alt+9",enter:"enter",escape:"escape",delete:"delete",home:"home",pageUp:"pageup",pageDown:"pagedown",tab:"tab",shiftTab:"shift+tab",ctrlShiftUpArrow:"ctrl+shift+uparrow",ctrlShiftDownArrow:"ctrl+shift+downarrow",ctrlShiftLeftArrow:"ctrl+shift+leftarrow",ctrlShiftRightArrow:"ctrl+shift+rightarrow"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.addEventListener()}return e.prototype.keyActionHandler=function(e){switch(e.action){case"downArrow":case"shiftDownArrow":this.processDown(e,e.shiftKey);break;case"upArrow":case"shiftUpArrow":this.processUp(e,e.shiftKey);break;case"leftArrow":case"shiftLeftArrow":this.processLeft(e,e.shiftKey);break;case"rightArrow":case"shiftRightArrow":this.processRight(e,e.shiftKey);break;case"ctrlLeftArrow":this.parent.changeDate(this.parent.activeView.getNextPreviousDate("previous"),e),this.parent.headerModule&&this.parent.headerModule.element.querySelector(".e-prev button").focus();break;case"ctrlRightArrow":this.parent.changeDate(this.parent.activeView.getNextPreviousDate("next"),e),this.parent.headerModule&&this.parent.headerModule.element.querySelector(".e-next button").focus();break;case"altOne":case"altTwo":case"altThree":case"altFour":case"altFive":case"altSix":case"altSeven":case"altEight":case"altNine":this.processViewNavigation(e);break;case"enter":this.processEnter(e);break;case"home":this.focusFirstCell();break;case"tab":case"shiftTab":this.processTab(e,e.shiftKey);break;case"delete":this.processDelete(e);break;case"ctrlShiftUpArrow":case"ctrlShiftDownArrow":case"ctrlShiftLeftArrow":case"ctrlShiftRightArrow":this.processCtrlShiftNavigationArrows(e);break;case"escape":this.processEscape(e);break;case"fTwelve":this.parent.allowInline&&this.parent.inlineModule&&(e.preventDefault(),this.processFTwelve(e))}},e.prototype.processFTwelve=function(e){var i=e.target;if(i.classList.contains("e-work-cells")||i.classList.contains("e-all-day-cells")){this.parent.activeCellsData=this.getSelectedElements(i);var n=t.extend(this.parent.activeCellsData,{cancel:!1,event:e}),r={element:n.element,groupIndex:n.groupIndex,type:"Cell"};this.parent.notify(Ne,r)}if(i.classList.contains("e-appointment"))return void i.click()},e.prototype.addEventListener=function(){this.parent.on("cell-mouse-down",this.onCellMouseDown,this)},e.prototype.removeEventListener=function(){this.parent.off("cell-mouse-down",this.onCellMouseDown)},e.prototype.onCellMouseDown=function(e){if(!e.event.shiftKey&&(this.initialTarget=this.getClosestCell(e.event),!this.parent.activeViewOptions.readonly&&"MonthAgenda"!==this.parent.currentView&&this.initialTarget&&(e.event.target.classList.contains("e-work-cells")&&3!==e.event.which&&(this.parent.removeSelectedClass(),t.EventHandler.add(this.parent.getContentTable(),"mousemove",this.onMouseSelection,this),t.EventHandler.add(this.parent.getContentTable(),"mouseup",this.onMoveUp,this)),e.event.target.classList.contains("e-all-day-cells")&&3!==e.event.which))){this.parent.removeSelectedClass();var i=this.parent.getAllDayRow();t.EventHandler.add(i,"mousemove",this.onMouseSelection,this),t.EventHandler.add(i,"mouseup",this.onMoveUp,this)}},e.prototype.onMouseSelection=function(e){var i=[].slice.call(this.parent.element.querySelectorAll(".e-appointment"));t.addClass(i,"e-allow-select");var n=this.parent.boundaryValidation(e.pageY,e.pageX);if(n.bottom||n.top||n.left||n.right){var r=this.parent.element.querySelector(".e-content-wrap"),a=r.offsetHeight<=r.scrollHeight&&r.scrollTop>=0&&r.scrollTop+r.offsetHeight<=r.scrollHeight,s=r.offsetWidth<=r.scrollWidth&&r.scrollLeft>=0&&r.scrollLeft+r.offsetWidth<=r.scrollWidth;a&&(n.top||n.bottom)&&(r.scrollTop+=n.top?-e.target.offsetHeight:e.target.offsetHeight),s&&(n.left||n.right)&&(r.scrollLeft+=n.left?-e.target.offsetWidth:e.target.offsetWidth)}var o=this.getClosestCell(e);o&&this.selectCells(!0,o)},e.prototype.getClosestCell=function(e){return t.closest(e.target,".e-work-cells,.e-all-day-cells")},e.prototype.onMoveUp=function(e){var i=this,n=[].slice.call(this.parent.element.querySelectorAll(".e-appointment"));if(t.removeClass(n,"e-allow-select"),e.target.classList.contains("e-work-cells")&&(t.EventHandler.remove(this.parent.getContentTable(),"mousemove",this.onMouseSelection),t.EventHandler.remove(this.parent.getContentTable(),"mouseup",this.onMoveUp)),e.target.classList.contains("e-all-day-cells")){var r=this.parent.getAllDayRow();t.EventHandler.remove(r,"mousemove",this.onMouseSelection),t.EventHandler.remove(r,"mouseup",this.onMoveUp)}if(!this.isPreventAction(e)){var a=t.closest(e.target,".e-work-cells,.e-all-day-cells,.e-header-cells");if("TimelineYear"!==this.parent.currentView||!a.classList.contains("e-other-month")){this.parent.activeCellsData=this.getSelectedElements(a);var s={};this.parent.eventWindow&&this.parent.eventWindow.convertToEventData(this.parent.activeCellsData,s);var o=this.parent.getSelectedElements(),l={data:s,element:this.parent.activeCellsData.element,event:e,requestType:"cellSelect",showQuickPopup:!1};this.parent.trigger("select",l,function(n){if((n.showQuickPopup||i.parent.quickInfoOnSelectionEnd)&&o.length>1){var r=t.extend(i.parent.activeCellsData,{cancel:!1,event:e,name:"cellClick"});i.parent.notify("cellClick",r)}})}}},e.prototype.processEnter=function(e){if(!(this.parent.activeViewOptions.readonly&&!e.target.classList.contains("e-appointment")||this.isPreventAction(e)||"TimelineYear"===this.parent.currentView&&e.target.classList.contains("e-other-month"))){var i=e.target;if(t.closest(i,".e-quick-popup-wrapper"))return void(i.classList.contains("e-event-details")||i.classList.contains("e-event-create")||i.classList.contains("e-event-edit")||i.classList.contains("e-event-delete")||i.classList.contains("e-close")?(i.click(),e.preventDefault()):i.classList.contains("e-subject")&&(this.parent.element.querySelector(".e-event-create").click(),e.preventDefault()));if(i.classList.contains("e-resource-cells")&&i.classList.contains("e-parent-node")){var n=i.querySelector(".e-resource-tree-icon");return void(n&&n.click())}if(!i.classList.contains("e-work-cells")&&!i.classList.contains("e-all-day-cells"))return i.classList.contains("e-inline-subject")&&this.parent.inlineModule?void this.parent.inlineModule.inlineCrudActions(i):i.classList.contains("e-appointment")||i.classList.contains("e-more-event-close")||i.classList.contains("e-all-day-appointment-section")||i.classList.contains("e-more-indicator")?void i.click():i.classList.contains("e-header-date")?(this.parent.setProperties({selectedDate:this.parent.getDateFromElement(i)},!0),this.parent.changeView(this.parent.getNavigateView(),e),void this.processEscape(e)):void 0;this.parent.activeCellsData=this.getSelectedElements(i);var r=t.extend(this.parent.activeCellsData,{cancel:!1,event:e});if(this.parent.allowInline){var a={element:r.element,groupIndex:r.groupIndex,type:"Cell"};this.parent.notify(Ne,a)}else"Year"===this.parent.currentView?i.click():this.parent.notify("cellClick",r)}},e.prototype.getSelectedElements=function(e){var t;if(this.selectedCells.length>1&&e.classList.contains("e-selected-cell")){var i=this.parent.getCellDetails(this.selectedCells[0]),n=this.parent.getCellDetails(this.selectedCells.slice(-1)[0]);i.endTime=n.endTime,i.element=e,t=i}else t=this.parent.getCellDetails(e);return t},e.prototype.getCells=function(e,t,i){var n=this.parent.getContentTable(),r="TimelineYear"===this.parent.currentView,a=r&&!e?".e-work-cells:not(.e-other-month)":"td",s=[].slice.call(n.querySelectorAll(a)),o=n.rows.length,l=n.rows[0].cells.length;if(t&&t.classList.contains("e-all-day-cells")){var c=this.parent.getAllDayRow();s=[].slice.call(c.cells),o=1,l=c.cells.length}var p=s.indexOf(t),h=s.indexOf(i),d=[];if(e){for(var u=0;u<l;u++)for(var v=0;v<o;v++){var m=s[l*v+u];r&&m.classList.contains("e-other-month")||d.push(m)}p=d.indexOf(t),h=d.indexOf(i)}if(p>h){var g=p;p=h,h=g}return(e?d:s).slice(p,h+1)},e.prototype.focusFirstCell=function(){if("Agenda"===this.parent.currentView){var e=this.parent.getContentTable().querySelector(".e-agenda-cells");return e.setAttribute("tabindex","0"),void e.focus()}if(this.parent.eventBase.removeSelectedAppointmentClass(),this.parent.activeView.isTimelineView()&&"TimelineYear"!==this.parent.currentView){var t=this.parent.element.querySelector("."+Qe+" tr:not(.e-hidden) .e-work-cells:not(.e-resource-group-cells)");this.selectCells(!1,t)}else if(this.parent.currentView.indexOf("Year")>-1){var i=".e-work-cells:not(.e-other-month):not(.e-resource-group-cells)";i+="TimelineYear"===this.parent.currentView&&"Vertical"===this.parent.activeViewOptions.orientation?'[data-date="'+this.parent.activeView.startDate().getTime()+'"]':"",this.selectCells(!1,this.parent.element.querySelector(i))}else this.selectCells(!1,this.parent.getWorkCellElements()[0])},e.prototype.isInverseTableSelect=function(){return this.parent.activeView.isInverseTableSelect},e.prototype.selectCells=function(e,t){var i=this;this.parent.removeSelectedClass();var n=t instanceof Array?t.slice(-1)[0]:t;if(e){var r,a=["Day","Week","WorkWeek","TimelineDay","TimelineWeek","TimelineWorkWeek","TimelineMonth","TimelineYear"],s={element:t,requestType:"mousemove",allowMultipleRow:!0};this.parent.inlineModule.removeInlineAppointmentElement(),this.parent.trigger("select",s,function(e){if(!e.allowMultipleRow||!i.parent.allowMultiRowSelection){var t="TimelineYear"===i.parent.currentView;if(t&&"Horizontal"===i.parent.activeViewOptions.orientation||"Month"===i.parent.currentView){var s=t&&i.parent.activeViewOptions.group.resources.length>0;n=s?i.initialTarget:i.initialTarget.parentElement.children[n.cellIndex]}else a.indexOf(i.parent.currentView)>-1&&(n=n.parentElement.children[i.initialTarget.cellIndex])}var o=i.getCells(i.isInverseTableSelect(),i.initialTarget,n);if(i.parent.activeViewOptions.group.resources.length>0){r=i.initialTarget.getAttribute("data-group-index");for(var l=[],c=0,p=o;c<p.length;c++)(m=p[c]).getAttribute("data-group-index")===r&&l.push(m);o=l}if(i.parent.allowMultiCellSelection||(o=[i.initialTarget]),i.selectedCells=o,o.length>2&&!n.classList.contains("e-all-day-cells")){var h=i.getAllDayCells(o);if(i.parent.activeViewOptions.group.resources.length>0){for(var d=[],u=0,v=h;u<v.length;u++){var m=v[u];m.getAttribute("data-group-index")===r&&d.push(m)}h=d}o=o.concat(h)}n.getAttribute("data-group-index")!==r&&i.parent.activeViewOptions.group.resources.length>0&&(n=i.selectedCells[i.selectedCells.length-1]),i.parent.addSelectedClass(o,n)})}else this.initialTarget=n,this.selectedCells=[n],this.parent.addSelectedClass([n],n)},e.prototype.selectAppointment=function(e,i){var n=this.getAppointmentElements();if(!(n.length<0)){this.parent.eventBase.removeSelectedAppointmentClass();var r;if(i.classList.contains("e-appointment")){var a=n.indexOf(i);r=n[e?a-1:a+1]}else r=e?n[n.length-1]:n[0];r&&(this.parent.eventBase.addSelectedAppointments([r]),r.focus(),t.addClass([r],"e-active-appointment-agenda"))}},e.prototype.selectAppointmentElementFromWorkCell=function(e,t){var i=this;if(this.parent.eventBase.removeSelectedAppointmentClass(),this.parent.removeSelectedClass(),t.classList.contains("e-work-cells")||t.classList.contains("e-all-day-cells")){var n=this.getUniqueAppointmentElements(),r=[],a=this.parent.getDateFromElement(t).getTime();if(this.parent.eventsProcessed.filter(function(t){return e?t[i.parent.eventFields.startTime].getTime()<=a:t[i.parent.eventFields.startTime].getTime()>=a}).filter(function(e){n.filter(function(t){JSON.stringify(e.Guid)===JSON.stringify(t.getAttribute("data-guid"))&&r.push(t)})}),r.length>0){var s=e?r[r.length-1]:r[0],o=this.getAppointmentElementsByGuid(s.getAttribute("data-guid"));this.parent.eventBase.addSelectedAppointments(o),o[o.length-1].focus()}}},e.prototype.getAllDayCells=function(e){var t=this.parent.getAllDayRow();if(!t)return[];var i=e[0],n=e[e.length-1],r=this.parent.getCellDetails(i);return this.parent.getCellDetails(n).endTime.getTime()-r.startTime.getTime()>=We?[].slice.call(t.cells).slice(i.cellIndex,n.cellIndex+1):[]},e.prototype.getAppointmentElements=function(){return[].slice.call(this.parent.element.querySelectorAll(".e-appointment"))},e.prototype.getAppointmentElementsByGuid=function(e){return[].slice.call(this.parent.element.querySelectorAll('div[data-guid="'+e+'"]'))},e.prototype.getUniqueAppointmentElements=function(){var e=this.getAppointmentElements(),t=[];return e.map(function(e){return e.getAttribute("data-guid")}).filter(function(i,n,r){r.indexOf(i)===n&&t.push(e[n])}),t},e.prototype.getWorkCellFromAppointmentElement=function(e){var t=this.parent.eventBase.getEventByGuid(e.getAttribute("data-guid"));return this.parent.eventBase.selectWorkCellByTime([t])},e.prototype.processViewNavigation=function(e){var t=parseInt(e.key,10)-1;if(t<this.parent.views.length){var i=this.parent.viewCollections[t].option;this.parent.changeView(i,e,void 0,t),this.parent.headerModule&&this.parent.headerModule.element.querySelector(".e-active-view button").focus()}},e.prototype.cancelUpDownAction=function(e){var t=e&&"Vertical"===this.parent.activeViewOptions.orientation,i=this.parent.activeViewOptions.group.resources.length>0;return!!(t&&i||e&&this.initialTarget.classList.contains("e-other-month"))||!((!this.parent.activeView.isTimelineView()||e)&&"MonthAgenda"!==this.parent.currentView)},e.prototype.processUp=function(e,t){var i="TimelineYear"===this.parent.currentView;if(!t||!this.cancelUpDownAction(i)){var n=e.target,r=this.parent.getSelectedElements(),a=this.parent.eventBase.getSelectedAppointments(),s=this.parent.element.querySelector(".e-more-popup-wrapper"),o=this.getQuickPopupElement();if(r.length>0&&!e.target.classList.contains("e-work-cells")&&(n=r[r.length-1]),a.length>0&&!s.classList.contains(Ke)&&!o.classList.contains(Ke)&&-1!==["Day","Week","WorkWeek","Month"].indexOf(this.parent.currentView)&&(n=this.getWorkCellFromAppointmentElement(a[a.length-1]),this.parent.eventBase.removeSelectedAppointmentClass()),n)if(n.classList.contains("e-work-cells")&&!this.parent.element.querySelector("."+Ke)){var l=this.parent.getTableRows(),c=l.indexOf(n.parentElement),p=void 0;if(i&&t&&0===this.parent.activeViewOptions.group.resources.length&&(p=this.isInverseTableSelect()?this.getVerticalUpDownCell(l,n,c,!0):this.getHorizontalUpDownCell(l,n,c,!0)),(c>0||p)&&c<l.length){if(p=p||l[c-1].cells[n.cellIndex],"Year"===this.parent.currentView&&p.classList.contains("e-other-month")){if(!(this.parent.activeView.getStartDate().getTime()<+p.getAttribute("data-date")))return;p=this.getYearUpDownCell(l,c-1,n.cellIndex,!0)}this.selectCells(t,p)}}else"Agenda"!==this.parent.currentView&&"MonthAgenda"!==this.parent.currentView||this.selectAppointment(!0,n)}},e.prototype.processDown=function(e,t){var i="TimelineYear"===this.parent.currentView;if(!t||!this.cancelUpDownAction(i)){var n=e.target,r=this.parent.getSelectedElements(),a=this.parent.eventBase.getSelectedAppointments(),s=this.parent.element.querySelector(".e-more-popup-wrapper"),o=this.getQuickPopupElement();r.length>0&&!e.target.classList.contains("e-work-cells")&&(n=r[r.length-1]),a.length>0&&!s.classList.contains(Ke)&&!o.classList.contains(Ke)&&-1!==["Day","Week","WorkWeek","Month"].indexOf(this.parent.currentView)&&(n=this.getWorkCellFromAppointmentElement(a[a.length-1]),this.parent.eventBase.removeSelectedAppointmentClass());var l=this.parent.getTableRows();if(n)if(n.classList.contains("e-work-cells")&&!this.parent.element.querySelector("."+Ke)){var c=l.indexOf(n.parentElement),p=void 0;if(i&&t&&0===this.parent.activeViewOptions.group.resources.length&&(p=this.isInverseTableSelect()?this.getVerticalUpDownCell(l,n,c,!1):this.getHorizontalUpDownCell(l,n,c,!1)),c>=0&&(c<l.length-1||p)){if(p=p||l[c+1].cells[n.cellIndex],"Year"===this.parent.currentView&&p.classList.contains("e-other-month")){if(!(this.parent.activeView.getEndDate().getTime()>+p.getAttribute("data-date")))return;p=this.getYearUpDownCell(l,c+1,n.cellIndex,!1)}this.selectCells(t,p)}}else"Agenda"!==this.parent.currentView&&"MonthAgenda"!==this.parent.currentView||this.selectAppointment(!1,n)}},e.prototype.getYearUpDownCell=function(e,t,i,n){for(;e[t]&&e[t].cells[i].classList.contains("e-other-month");)t+=n?-1:1;return e[t].cells[i]},e.prototype.getHorizontalUpDownCell=function(e,t,i,n){var r=e[i+(n?-1:1)],a=r?r.cells[t.cellIndex]:t;if(a.classList.contains("e-other-month")){var s=r.querySelector(".e-work-cells:not(.e-other-month)"),o=new Date(+s.getAttribute("data-date")),l='[data-date="'+new Date(o.getFullYear(),o.getMonth()+1,0).getTime()+'"]';a=a.cellIndex<s.cellIndex?s:r.querySelector(l)}return a},e.prototype.getVerticalUpDownCell=function(e,t,i,n){var r=n&&i>0||!n&&i<e.length-1?e[i+(n?-1:1)].cells[t.cellIndex]:void 0;if(!r||r.classList.contains("e-other-month")){if(e[i].cells[t.cellIndex-(n?1:-1)]){var a=+t.getAttribute("data-date")-(n?We:-We);return this.parent.getContentTable().querySelector('.e-work-cells[data-date="'+a+'"]')}r=t}return r},e.prototype.processLeftRight=function(e){var t="Year"===this.parent.currentView?e.closest("tbody"):this.parent.getContentTable(),i=e.parentNode.sectionRowIndex;return{element:t,rowIndex:i,columnIndex:e.cellIndex,maxIndex:t.rows[i].cells.length}},e.prototype.getQuickPopupElement=function(){return(this.parent.isAdaptive?document.body:this.parent.element).querySelector(".e-quick-popup-wrapper")},e.prototype.isCancelLeftRightAction=function(e,t,i){var n="MonthAgenda"===this.parent.currentView||i&&this.initialTarget.classList.contains("e-other-month");if("Agenda"===this.parent.currentView||t&&n)return!0;if(this.isPreventAction(e)&&t)return!0;var r=this.parent.element.querySelector(".e-more-popup-wrapper"),a=this.getQuickPopupElement();return!(!r.classList.contains(Ke)&&!a.classList.contains(Ke))},e.prototype.processRight=function(e,i){var n="TimelineYear"===this.parent.currentView;if(!this.isCancelLeftRightAction(e,i,n)){var r,a=this.parent.getSelectedElements(),s=this.parent.eventBase.getSelectedAppointments(),o=e.target;if(a.length>0&&!o.classList.contains("e-work-cells")&&!o.classList.contains("e-all-day-cells")&&(o=a[a.length-1]),!(s.length>0)||(o=this.getWorkCellFromAppointmentElement(s[s.length-1]),this.parent.eventBase.removeSelectedAppointmentClass(),o))if(o.classList.contains("e-work-cells")&&e.target.classList.contains("e-work-cells")){var l=this.processLeftRight(o),c=new Date(+o.getAttribute("data-date")),p="Year"===this.parent.currentView&&c.getTime()===g(c).getTime();if(l.columnIndex>=0&&l.columnIndex<l.maxIndex-1&&!p)r=this.calculateNextPrevDate(o,l.element.rows[l.rowIndex].cells[o.cellIndex+1],"right"),n&&i&&r.classList.contains("e-other-month")&&(r=this.getTimelineYearTargetCell(l,o,!0)),t.isNullOrUndefined(r)||this.selectCells(i,r);else if(l.columnIndex===l.maxIndex-1||p)if(!this.isInverseTableSelect()&&l.rowIndex<l.element.rows.length-1&&!p)r=this.calculateNextPrevDate(o,l.element.rows[l.rowIndex+1].cells[0],"right"),r=n&&i&&r.classList.contains("e-other-month")?this.getHorizontalLeftRightCell(l,o,!0):r,t.isNullOrUndefined(r)||this.selectCells(i,r);else if(!i){if(p&&c.getTime()!==this.parent.activeView.getEndDate().getTime())return void this.selectCells(i,this.parent.element.querySelector(':not(.e-other-month)[data-date="'+(c.getTime()+We)+'"]'));var h=this.isInverseTableSelect()?l.rowIndex:0;this.parent.changeDate(this.parent.activeView.getNextPreviousDate("next"),e);var d=this.parent.getContentTable(),u=p?d.rows[h].querySelector(".e-work-cells:not(.e-other-month)"):d.rows[h].cells[0];this.selectCells(!1,u)}}else if(o.classList.contains("e-all-day-cells")){var v=o.cellIndex,m=this.parent.getAllDayRow(),f=m.cells.length;if(v>=0&&v<f-1)this.selectCells(i,m.cells[v+1]);else if(v===f-1&&!i){this.parent.changeDate(this.parent.activeView.getNextPreviousDate("next"),e);var y=this.parent.getAllDayRow();this.selectCells(!1,y.cells[0])}}}},e.prototype.processLeft=function(e,i){var n="TimelineYear"===this.parent.currentView;if(!this.isCancelLeftRightAction(e,i,n)){var r,a=e.target,s=this.parent.getSelectedElements();s.length>0&&!a.classList.contains("e-work-cells")&&!a.classList.contains("e-all-day-cells")&&(a=s[s.length-1]);var o=this.parent.eventBase.getSelectedAppointments();if(!(o.length>0)||(a=this.getWorkCellFromAppointmentElement(o[o.length-1]),this.parent.eventBase.removeSelectedAppointmentClass(),a))if(e.target.classList.contains("e-work-cells")&&a.classList.contains("e-work-cells")){var l=this.processLeftRight(a),c=new Date(+a.getAttribute("data-date")),p="Year"===this.parent.currentView&&c.getTime()===m(c).getTime();if(l.columnIndex>0&&l.columnIndex<l.maxIndex&&!p)r=this.calculateNextPrevDate(a,l.element.rows[l.rowIndex].cells[a.cellIndex-1],"left"),n&&i&&r.classList.contains("e-other-month")&&(r=this.getTimelineYearTargetCell(l,a,!1)),t.isNullOrUndefined(r)||this.selectCells(i,r);else if(0===l.columnIndex||p)if(!this.isInverseTableSelect()&&l.rowIndex>0)r=this.calculateNextPrevDate(a,l.element.rows[l.rowIndex-1].cells[l.maxIndex-1],"left"),r=n&&i&&r.classList.contains("e-other-month")?this.getHorizontalLeftRightCell(l,a,!1):r,t.isNullOrUndefined(r)||this.selectCells(i,r);else if(!i){if(p&&c.getTime()!==this.parent.activeView.getStartDate().getTime())return void this.selectCells(i,this.parent.element.querySelector('[data-date="'+(c.getTime()-We)+'"]'));this.parent.changeDate(this.parent.activeView.getNextPreviousDate("previous"),e);var h=this.parent.getContentTable(),d=this.isInverseTableSelect()?l.rowIndex:h.rows.length-1,u=h.rows[d].cells[l.maxIndex-1];if(p){var v=this.parent.element.querySelectorAll("."+Qe+" tbody");u=v.item(v.length-1).querySelector(':not(.e-other-month)[data-date="'+this.parent.activeView.getEndDate().getTime()+'"]')}this.selectCells(!1,u)}}else if(a.classList.contains("e-all-day-cells")){var g=a.cellIndex,f=this.parent.getAllDayRow(),y=f.cells.length;if(g>0&&g<y)this.selectCells(i,f.cells[g-1]);else if(0===g&&!i){this.parent.changeDate(this.parent.activeView.getNextPreviousDate("previous"),e);var T=this.parent.getAllDayRow();this.selectCells(!1,T.cells[y-1])}}}},e.prototype.getTimelineYearTargetCell=function(e,t,i){return this.isInverseTableSelect()?this.getVerticalLeftRightCell(t,i):this.getHorizontalLeftRightCell(e,t,i)},e.prototype.getHorizontalLeftRightCell=function(e,t,i){var n=e.element.rows[t.parentNode.sectionRowIndex+(i?1:-1)];if(n){var r=i?".e-work-cells:not(.e-other-month)":'[data-date="'+(+t.getAttribute("data-date")-We)+'"]';return n.querySelector(r)}return t},e.prototype.getVerticalLeftRightCell=function(e,t){var i=new Date(+e.getAttribute("data-date")),n=new Date(i.getFullYear(),i.getMonth()+(t?1:-1),1),r=this.parent.getContentTable(),a=r.querySelector('[data-date="'+n.getTime()+'"]');return a.parentNode.sectionRowIndex>e.parentNode.sectionRowIndex?a:r.querySelector('[data-date="'+new Date(n.getFullYear(),n.getMonth()+1,0).getTime()+'"]')},e.prototype.calculateNextPrevDate=function(e,t,i){var n=this.initialTarget.getAttribute("data-group-index");if(this.parent.activeViewOptions.group.resources.length>0&&"Month"===this.parent.currentView&&e&&t&&t.getAttribute("data-group-index")!==n){var r=this.parent.getDateFromElement(e),a="right"===i?new Date(r.setDate(r.getDate()+1)):new Date(r.setDate(r.getDate()-1));t=[].slice.call(this.parent.element.querySelectorAll('td[data-date="'+a.getTime().toString()+'"][data-group-index="'+n+'"]'))[0]}return t},e.prototype.getFocusableElements=function(e){return[].slice.call(e.querySelectorAll('a[href]:not([tabindex="-1"]),input:not([disabled]):not([tabindex="-1"]),textarea:not([disabled]):not([tabindex="-1"]),button:not([disabled]):not([tabindex="-1"]),select:not([disabled]):not([tabindex="-1"]),[tabindex]:not([tabindex="-1"]),[contentEditable=true]:not([tabindex="-1"])'))},e.prototype.processTabOnPopup=function(e,i){var n=this,r=this.getFocusableElements(i),a=(r=r.filter(function(e){var t=n.parent.element.querySelector(".e-popup-footer");return t&&t.offsetParent?!(e.classList.contains("e-edit")||e.classList.contains("e-delete")):!(e.classList.contains("e-event-edit")||e.classList.contains("e-event-delete"))}))[0],s=r[r.length-1];t.isNullOrUndefined(s)||document.activeElement!==s||e.shiftKey||(e.preventDefault(),a.focus()),!t.isNullOrUndefined(a)&&document.activeElement===a&&e.shiftKey&&(e.preventDefault(),s.focus())},e.prototype.processTab=function(e,i){var n=e.target;if(n.classList.contains("e-inline-subject")&&this.parent.inlineModule&&(n=n.closest(".e-appointment"),this.parent.inlineModule.inlineCrudActions(e.target)),"TimelineYear"===this.parent.currentView&&n.classList.contains("e-other-month"))return void(n.classList.contains("e-selected-cell")&&this.parent.removeSelectedClass());var r=t.closest(n,".e-quick-popup-wrapper,.e-more-popup-wrapper");if(r&&r.classList.contains(Ke))return r.classList.contains("e-more-popup-wrapper")&&this.parent.eventBase.removeSelectedAppointmentClass(),void this.processTabOnPopup(e,r);if(n.classList.contains(_e))return void this.parent.eventBase.removeSelectedAppointmentClass();if(n.classList.contains("e-resource-cells")&&this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0){var a=parseInt(n.getAttribute("data-group-index"),10),s='.e-appointment[data-group-index="'+(i?a-1:a)+'"]';if((p=[].slice.call(this.parent.element.querySelectorAll(s))).length>0){this.parent.eventBase.removeSelectedAppointmentClass();var o=i?p.slice(-1)[0]:p[0];this.parent.eventBase.addSelectedAppointments([o]),o.focus(),e.preventDefault()}else if(a+1===this.parent.resourceBase.lastResourceLevel.length)this.parent.element.focus(),e.preventDefault();else if(this.parent.virtualScrollModule){var l=this.parent.element.querySelector(".e-virtual-track"),c=Math.round(l.offsetHeight/this.parent.resourceBase.expandedResources.length);this.parent.element.querySelector(".e-content-wrap").scrollTop=(i?a-1:a+1)*c,this.parent.virtualScrollModule.virtualScrolling()}else this.setScrollPosition(a)}else{if(n.classList.contains("e-appointment")){var p=[].slice.call(this.parent.element.querySelectorAll(".e-appointment")),h="TimelineYear"===this.parent.currentView;if((this.parent.activeView.isTimelineView()&&!h||h&&"Vertical"===this.parent.activeViewOptions.orientation)&&this.parent.activeViewOptions.group.resources.length>0){a=parseInt(n.getAttribute("data-group-index"),10);p=[].slice.call(this.parent.element.querySelectorAll('.e-appointment[data-group-index="'+a+'"]'));var d='.e-resource-cells[data-group-index="'+(i?a:a+1)+'"]',u=this.parent.element.querySelector(d);if(u&&(i&&n.getAttribute("data-guid")===p[0].getAttribute("data-guid")||!i&&n.getAttribute("data-guid")===p.slice(-1)[0].getAttribute("data-guid")))return this.parent.eventBase.removeSelectedAppointmentClass(),this.parent.virtualScrollModule?u.focus({preventScroll:!0}):u.focus(),this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0&&t.isNullOrUndefined(this.parent.virtualScrollModule)&&this.setScrollPosition(a),void e.preventDefault()}var v=this.parent.eventBase.getSelectedAppointments();if(v.length>0&&(n=v[v.length-1]),this.parent.eventBase.removeSelectedAppointmentClass(),!i&&n.getAttribute("data-guid")===p[p.length-1].getAttribute("data-guid")||i&&n.getAttribute("data-guid")===p[0].getAttribute("data-guid"))return;return void("Agenda"!==this.parent.currentView&&"MonthAgenda"!==this.parent.currentView||(this.selectAppointment(i,n),e.preventDefault()))}var m=this.parent.getSelectedElements();if(m.length>0&&!n.classList.contains("e-appointment"))return n=m[m.length-1],this.selectAppointmentElementFromWorkCell(i,n),void e.preventDefault();n&&!n.classList.contains("e-resource-cells")&&this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0&&this.processTabOnResourceCells(n,i)}},e.prototype.processDelete=function(e){var i=document.activeElement;if("MonthAgenda"===this.parent.currentView){var n=this.parent.eventBase.getSelectedEvents().element;i=n&&t.isNullOrUndefined(n.length)?n:n[0]}if(i&&i.classList.contains("e-appointment")){if(t.addClass([i],"e-appointment-border"),this.parent.activeEventData=this.parent.eventBase.getSelectedEvents(),this.parent.activeViewOptions.readonly||i.classList.contains("e-read-only")||!this.parent.eventSettings.allowDeleting)return;this.parent.quickPopup.deleteClick(e)}},e.prototype.processCtrlShiftNavigationArrows=function(e){if(this.parent.activeViewOptions.group.resources.length>0&&document.activeElement.classList.contains("e-appointment")){var t=parseInt(document.activeElement.getAttribute("data-group-index"),10);r=(r="ctrlShiftLeftArrow"===e.action||"ctrlShiftUpArrow"===e.action?t-1:t+1)<0?0:r>this.parent.resourceBase.lastResourceLevel.length?this.parent.resourceBase.lastResourceLevel.length:r;for(var i=[];0===i.length&&r>=0&&r<=this.parent.resourceBase.lastResourceLevel.length;)i=[].slice.call(this.parent.element.querySelectorAll('.e-appointment[data-group-index="'+r+'"]')),r="ctrlShiftLeftArrow"===e.action||"ctrlShiftUpArrow"===e.action?r-1:r+1;var n=i[0];n&&(this.parent.eventBase.removeSelectedAppointmentClass(),this.parent.eventBase.addSelectedAppointments([n]),n.focus())}else if(this.parent.activeViewOptions.group.resources.length>0&&!document.activeElement.classList.contains("e-appointment")){var r=this.parent.resourceBase.renderedResources[0].groupIndex,a='.e-appointment[data-group-index="'+r+'"]',s=[].slice.call(this.parent.element.querySelectorAll(a));if(s.length>0){this.parent.eventBase.removeSelectedAppointmentClass();var o=s[0];this.parent.eventBase.addSelectedAppointments([o]),o.focus(),e.preventDefault()}}},e.prototype.processEscape=function(e){this.parent.quickPopup.onClosePopup(e),this.parent.quickPopup.morePopup.hide(),this.parent.headerModule&&this.parent.headerModule.hideHeaderPopup(),this.parent.inlineModule&&this.parent.inlineModule.removeInlineAppointmentElement()},e.prototype.isPreventAction=function(e){var i=t.closest(e.target,".e-resource-group-cells");return!(!this.parent.activeView.isTimelineView()||t.isNullOrUndefined(i))},e.prototype.processTabOnResourceCells=function(e,t){var i=[].slice.call(this.parent.element.querySelectorAll('[tabIndex="0"]')),n=i.indexOf(e),r=t?i[n-1]:i[n+1];if(r&&r.classList.contains("e-resource-cells")){var a=parseInt(r.getAttribute("data-group-index"),10);if(this.parent.virtualScrollModule){var s=this.parent.element.querySelector(".e-resource-column-wrap");[].slice.call(this.parent.element.querySelectorAll(".e-resource-cells")).forEach(function(e){e.getBoundingClientRect().top<s.getBoundingClientRect().top&&e.setAttribute("tabindex","-1")})}else this.setScrollPosition(a)}},e.prototype.setScrollPosition=function(e){var t=this.parent.element.querySelector('.e-work-cells[data-group-index="'+e+'"]');t&&(this.parent.element.querySelector(".e-content-wrap").scrollTop=t.offsetTop)},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.destroy=function(){this.removeEventListener(),this.keyboardModule.destroy()},e}(),at=function(){function e(e,t){this.initDataManager(e,t)}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof a.DataManager?e:new a.DataManager(e),this.query=t instanceof a.Query?t:new a.Query},e.prototype.generateQuery=function(e,t){var i=this.query.clone();return e&&i.addParams("StartDate",e.toISOString()),t&&i.addParams("EndDate",t.toISOString()),i},e.prototype.getData=function(e){return this.dataManager.executeQuery(e)},e.prototype.destroy=function(){this.dataManager=null,this.query=null},e}(),st=function(){function e(){}return e.prototype.firstDateOfMonth=function(e){return new Date(e.getFullYear(),e.getMonth())},e.prototype.lastDateOfMonth=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)},e.prototype.isMonthStart=function(e){return 1===e.getDate()},e.prototype.getLeapYearDaysCount=function(){return 366},e.prototype.getYearDaysCount=function(e,t){return(e.getFullYear()+t)%4==0?366:365},e.prototype.getDate=function(e){return e.getDate()},e.prototype.getMonth=function(e){return e.getMonth()+1},e.prototype.getFullYear=function(e){return e.getFullYear()},e.prototype.getYearLastDate=function(e,t){return new Date(e.getFullYear()+t,0,0)},e.prototype.getMonthDaysCount=function(e){return this.lastDateOfMonth(e).getDate()},e.prototype.getMonthStartDate=function(e){return new Date(e.getFullYear(),e.getMonth(),1,e.getHours(),e.getMinutes())},e.prototype.getMonthEndDate=function(e){return e.setDate(1),new Date(e.setMonth(e.getMonth()+1))},e.prototype.getExpectedDays=function(e,t){return t},e.prototype.setDate=function(e,t){e.setDate(t)},e.prototype.setValidDate=function(e,i,n,r,a){t.isNullOrUndefined(a)?e.setMonth(e.getMonth()+i,n):e.setMonth((a?r:e.getMonth())+i)},e.prototype.setMonth=function(e,t,i){e.setFullYear(e.getFullYear()),e.setMonth(t-1),e.setDate(i)},e.prototype.addYears=function(e,t){e.setFullYear(e.getFullYear()+t)},e.prototype.isSameMonth=function(e,t){return e.getMonth()===t.getMonth()},e.prototype.checkMonth=function(e,t){return-1===t.indexOf(e.getMonth()+1)},e.prototype.compareMonth=function(e,t){return e.getMonth()>t.getMonth()},e.prototype.isSameYear=function(e,t){return e.getFullYear()===t.getFullYear()},e.prototype.isLastMonth=function(e){return 11===e.getMonth()},e.prototype.isLeapYear=function(e,t){return(e+t)%4==0},e}(),ot=function(){function e(){}return e.prototype.firstDateOfMonth=function(e){var i=this.getHijriDate(e);return t.HijriParser.toGregorian(i.year,i.month,1)},e.prototype.lastDateOfMonth=function(e){var i=this.getHijriDate(e),n=this.getDaysInMonth(i.month,i.year),r=t.HijriParser.toGregorian(i.year,i.month,n),a=new Date(r.getTime());a=new Date(a.setDate(a.getDate()+1));var s=this.getHijriDate(a);return i.month===s.month?a:(s=this.getHijriDate(r),i.month===s.month?r:new Date(r.setDate(r.getDate()-1)))},e.prototype.isMonthStart=function(e){return 1===this.getHijriDate(e).date},e.prototype.getLeapYearDaysCount=function(){return 355},e.prototype.getYearDaysCount=function(e,t){var i=this.getHijriDate(e);return this.isLeapYear(i.year,t)?355:354},e.prototype.getDate=function(e){return this.getHijriDate(e).date},e.prototype.getMonth=function(e){return this.getHijriDate(e).month},e.prototype.getFullYear=function(e){return this.getHijriDate(e).year},e.prototype.getYearLastDate=function(e,i){var n=this.getHijriDate(e);return t.HijriParser.toGregorian(n.year+i,1,0)},e.prototype.getMonthDaysCount=function(e){var t=this.lastDateOfMonth(e);return this.getHijriDate(t).date},e.prototype.getMonthStartDate=function(e){var t=this.firstDateOfMonth(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),e.getHours(),e.getMinutes())},e.prototype.getMonthEndDate=function(e){var t=this.lastDateOfMonth(e);return t.setDate(t.getDate()+1),new Date(t.setMonth(t.getMonth()))},e.prototype.getExpectedDays=function(e,i){for(var n=this.getHijriDate(e),r=[],a=0;a<i.length;a++){var s=t.HijriParser.toGregorian(n.year,n.month,i[a]);r.push(s.getDate())}return r},e.prototype.setDate=function(e,i){var n=this.getHijriDate(e),r=t.HijriParser.toGregorian(n.year,n.month,i);this.updateDateObj(e,r)},e.prototype.setValidDate=function(e,i,n,r,a){var s=t.isNullOrUndefined(a)?e:this.firstDateOfMonth(a),o=this.getHijriDate(s),l=t.HijriParser.toGregorian(o.year,o.month+i,n);this.updateDateObj(e,l)},e.prototype.setMonth=function(e,i,n){var r=this.getHijriDate(e),a=t.HijriParser.toGregorian(r.year,i,n);this.updateDateObj(e,a)},e.prototype.addYears=function(e,i,n){var r=this.getHijriDate(e),a=t.HijriParser.toGregorian(r.year+i,n,1);this.updateDateObj(e,a)},e.prototype.isSameMonth=function(e,t){var i=this.getHijriDate(e),n=this.getHijriDate(t);return i.month===n.month},e.prototype.checkMonth=function(e,t){var i=this.getHijriDate(e);return-1===t.indexOf(i.month)},e.prototype.compareMonth=function(e,t){var i=this.getHijriDate(e),n=this.getHijriDate(t);return i.month>n.month},e.prototype.isSameYear=function(e,t){var i=this.getHijriDate(e),n=this.getHijriDate(t);return i.year===n.year},e.prototype.isLastMonth=function(e){return 12===this.getHijriDate(e).month},e.prototype.updateDateObj=function(e,t){e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate())},e.prototype.isLeapYear=function(e,t){return(14+11*(e+t))%30<11},e.prototype.getDaysInMonth=function(e,t){var i=0;return i=29+(e+1)%2,11===e&&this.isLeapYear(t,0)&&i++,i},e.prototype.getHijriDate=function(e){return t.HijriParser.getHijriDate(e)},e}(),lt=function(){function e(){this.timezoneData=[],this.timezoneData=this.getTimezoneData()}return e.prototype.offset=function(e,t){var i=e.getTimezoneOffset();try{var n=new Date(e.toLocaleString("en-US",{timeZone:t}));return isNaN(n.getTime())?0:(e.getTime()-n.getTime())/6e4+i}catch(e){return 0}},e.prototype.convert=function(e,t,i){"string"==typeof t&&(t=this.offset(e,t)),"string"==typeof i&&(i=this.offset(e,i));var n=e.getTimezoneOffset(),r=(e=new Date(e.getTime()+6e4*(t-i))).getTimezoneOffset();return new Date(e.getTime()+6e4*(r-n))},e.prototype.add=function(e,t){return this.convert(e,e.getTimezoneOffset(),t)},e.prototype.remove=function(e,t){return this.convert(e,t,e.getTimezoneOffset())},e.prototype.removeLocalOffset=function(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset())},e.prototype.getLocalTimezoneName=function(){return window.Intl?Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC":"UTC"},e.prototype.getTimezoneData=function(){return ct},e}(),ct=[{Value:"Pacific/Niue",Text:"(UTC-11:00) Niue"},{Value:"Pacific/Pago_Pago",Text:"(UTC-11:00) Pago Pago"},{Value:"Pacific/Honolulu",Text:"(UTC-10:00) Hawaii Time"},{Value:"Pacific/Rarotonga",Text:"(UTC-10:00) Rarotonga"},{Value:"Pacific/Tahiti",Text:"(UTC-10:00) Tahiti"},{Value:"Pacific/Marquesas",Text:"(UTC-09:30) Marquesas"},{Value:"America/Anchorage",Text:"(UTC-09:00) Alaska Time"},{Value:"Pacific/Gambier",Text:"(UTC-09:00) Gambier"},{Value:"America/Los_Angeles",Text:"(UTC-08:00) Pacific Time"},{Value:"America/Tijuana",Text:"(UTC-08:00) Pacific Time - Tijuana"},{Value:"America/Vancouver",Text:"(UTC-08:00) Pacific Time - Vancouver"},{Value:"America/Whitehorse",Text:"(UTC-08:00) Pacific Time - Whitehorse"},{Value:"Pacific/Pitcairn",Text:"(UTC-08:00) Pitcairn"},{Value:"America/Denver",Text:"(UTC-07:00) Mountain Time"},{Value:"America/Phoenix",Text:"(UTC-07:00) Mountain Time - Arizona"},{Value:"America/Mazatlan",Text:"(UTC-07:00) Mountain Time - Chihuahua, Mazatlan"},{Value:"America/Dawson_Creek",Text:"(UTC-07:00) Mountain Time - Dawson Creek"},{Value:"America/Edmonton",Text:"(UTC-07:00) Mountain Time - Edmonton"},{Value:"America/Hermosillo",Text:"(UTC-07:00) Mountain Time - Hermosillo"},{Value:"America/Yellowknife",Text:"(UTC-07:00) Mountain Time - Yellowknife"},{Value:"America/Belize",Text:"(UTC-06:00) Belize"},{Value:"America/Chicago",Text:"(UTC-06:00) Central Time"},{Value:"America/Mexico_City",Text:"(UTC-06:00) Central Time - Mexico City"},{Value:"America/Regina",Text:"(UTC-06:00) Central Time - Regina"},{Value:"America/Tegucigalpa",Text:"(UTC-06:00) Central Time - Tegucigalpa"},{Value:"America/Winnipeg",Text:"(UTC-06:00) Central Time - Winnipeg"},{Value:"America/Costa_Rica",Text:"(UTC-06:00) Costa Rica"},{Value:"America/El_Salvador",Text:"(UTC-06:00) El Salvador"},{Value:"Pacific/Galapagos",Text:"(UTC-06:00) Galapagos"},{Value:"America/Guatemala",Text:"(UTC-06:00) Guatemala"},{Value:"America/Managua",Text:"(UTC-06:00) Managua"},{Value:"America/Cancun",Text:"(UTC-05:00) America Cancun"},{Value:"America/Bogota",Text:"(UTC-05:00) Bogota"},{Value:"Pacific/Easter",Text:"(UTC-05:00) Easter Island"},{Value:"America/New_York",Text:"(UTC-05:00) Eastern Time"},{Value:"America/Iqaluit",Text:"(UTC-05:00) Eastern Time - Iqaluit"},{Value:"America/Toronto",Text:"(UTC-05:00) Eastern Time - Toronto"},{Value:"America/Guayaquil",Text:"(UTC-05:00) Guayaquil"},{Value:"America/Havana",Text:"(UTC-05:00) Havana"},{Value:"America/Jamaica",Text:"(UTC-05:00) Jamaica"},{Value:"America/Lima",Text:"(UTC-05:00) Lima"},{Value:"America/Nassau",Text:"(UTC-05:00) Nassau"},{Value:"America/Panama",Text:"(UTC-05:00) Panama"},{Value:"America/Port-au-Prince",Text:"(UTC-05:00) Port-au-Prince"},{Value:"America/Rio_Branco",Text:"(UTC-05:00) Rio Branco"},{Value:"America/Halifax",Text:"(UTC-04:00) Atlantic Time - Halifax"},{Value:"America/Barbados",Text:"(UTC-04:00) Barbados"},{Value:"Atlantic/Bermuda",Text:"(UTC-04:00) Bermuda"},{Value:"America/Boa_Vista",Text:"(UTC-04:00) Boa Vista"},{Value:"America/Caracas",Text:"(UTC-04:00) Caracas"},{Value:"America/Curacao",Text:"(UTC-04:00) Curacao"},{Value:"America/Grand_Turk",Text:"(UTC-04:00) Grand Turk"},{Value:"America/Guyana",Text:"(UTC-04:00) Guyana"},{Value:"America/La_Paz",Text:"(UTC-04:00) La Paz"},{Value:"America/Manaus",Text:"(UTC-04:00) Manaus"},{Value:"America/Martinique",Text:"(UTC-04:00) Martinique"},{Value:"America/Port_of_Spain",Text:"(UTC-04:00) Port of Spain"},{Value:"America/Porto_Velho",Text:"(UTC-04:00) Porto Velho"},{Value:"America/Puerto_Rico",Text:"(UTC-04:00) Puerto Rico"},{Value:"America/Santo_Domingo",Text:"(UTC-04:00) Santo Domingo"},{Value:"America/Thule",Text:"(UTC-04:00) Thule"},{Value:"America/St_Johns",Text:"(UTC-03:30) Newfoundland Time - St. Johns"},{Value:"America/Araguaina",Text:"(UTC-03:00) Araguaina"},{Value:"America/Asuncion",Text:"(UTC-03:00) Asuncion"},{Value:"America/Belem",Text:"(UTC-03:00) Belem"},{Value:"America/Argentina/Buenos_Aires",Text:"(UTC-03:00) Buenos Aires"},{Value:"America/Campo_Grande",Text:"(UTC-03:00) Campo Grande"},{Value:"America/Cayenne",Text:"(UTC-03:00) Cayenne"},{Value:"America/Cuiaba",Text:"(UTC-03:00) Cuiaba"},{Value:"America/Fortaleza",Text:"(UTC-03:00) Fortaleza"},{Value:"America/Godthab",Text:"(UTC-03:00) Godthab"},{Value:"America/Maceio",Text:"(UTC-03:00) Maceio"},{Value:"America/Miquelon",Text:"(UTC-03:00) Miquelon"},{Value:"America/Montevideo",Text:"(UTC-03:00) Montevideo"},{Value:"Antarctica/Palmer",Text:"(UTC-03:00) Palmer"},{Value:"America/Paramaribo",Text:"(UTC-03:00) Paramaribo"},{Value:"America/Punta_Arenas",Text:"(UTC-03:00) Punta Arenas"},{Value:"America/Recife",Text:"(UTC-03:00) Recife"},{Value:"Antarctica/Rothera",Text:"(UTC-03:00) Rothera"},{Value:"America/Bahia",Text:"(UTC-03:00) Salvador"},{Value:"America/Santiago",Text:"(UTC-03:00) Santiago"},{Value:"Atlantic/Stanley",Text:"(UTC-03:00) Stanley"},{Value:"America/Noronha",Text:"(UTC-02:00) Noronha"},{Value:"America/Sao_Paulo",Text:"(UTC-02:00) Sao Paulo"},{Value:"Atlantic/South_Georgia",Text:"(UTC-02:00) South Georgia"},{Value:"Atlantic/Azores",Text:"(UTC-01:00) Azores"},{Value:"Atlantic/Cape_Verde",Text:"(UTC-01:00) Cape Verde"},{Value:"America/Scoresbysund",Text:"(UTC-01:00) Scoresbysund"},{Value:"Africa/Abidjan",Text:"(UTC+00:00) Abidjan"},{Value:"Africa/Accra",Text:"(UTC+00:00) Accra"},{Value:"Africa/Bissau",Text:"(UTC+00:00) Bissau"},{Value:"Atlantic/Canary",Text:"(UTC+00:00) Canary Islands"},{Value:"Africa/Casablanca",Text:"(UTC+00:00) Casablanca"},{Value:"America/Danmarkshavn",Text:"(UTC+00:00) Danmarkshavn"},{Value:"Europe/Dublin",Text:"(UTC+00:00) Dublin"},{Value:"Africa/El_Aaiun",Text:"(UTC+00:00) El Aaiun"},{Value:"Atlantic/Faroe",Text:"(UTC+00:00) Faeroe"},{Value:"Etc/UTC",Text:"(UTC+00:00) UTC (no daylight saving)"},{Value:"Europe/Lisbon",Text:"(UTC+00:00) Lisbon"},{Value:"Europe/London",Text:"(UTC+00:00) London"},{Value:"Africa/Monrovia",Text:"(UTC+00:00) Monrovia"},{Value:"Atlantic/Reykjavik",Text:"(UTC+00:00) Reykjavik"},{Value:"UTC",Text:"UTC"},{Value:"Africa/Algiers",Text:"(UTC+01:00) Algiers"},{Value:"Europe/Amsterdam",Text:"(UTC+01:00) Amsterdam"},{Value:"Europe/Andorra",Text:"(UTC+01:00) Andorra"},{Value:"Europe/Berlin",Text:"(UTC+01:00) Berlin"},{Value:"Europe/Brussels",Text:"(UTC+01:00) Brussels"},{Value:"Europe/Budapest",Text:"(UTC+01:00) Budapest"},{Value:"Europe/Belgrade",Text:"(UTC+01:00) Central European Time - Belgrade"},{Value:"Europe/Prague",Text:"(UTC+01:00) Central European Time - Prague"},{Value:"Africa/Ceuta",Text:"(UTC+01:00) Ceuta"},{Value:"Europe/Copenhagen",Text:"(UTC+01:00) Copenhagen"},{Value:"Europe/Gibraltar",Text:"(UTC+01:00) Gibraltar"},{Value:"Africa/Lagos",Text:"(UTC+01:00) Lagos"},{Value:"Europe/Luxembourg",Text:"(UTC+01:00) Luxembourg"},{Value:"Europe/Madrid",Text:"(UTC+01:00) Madrid"},{Value:"Europe/Malta",Text:"(UTC+01:00) Malta"},{Value:"Europe/Monaco",Text:"(UTC+01:00) Monaco"},{Value:"Africa/Ndjamena",Text:"(UTC+01:00) Ndjamena"},{Value:"Europe/Oslo",Text:"(UTC+01:00) Oslo"},{Value:"Europe/Paris",Text:"(UTC+01:00) Paris"},{Value:"Europe/Rome",Text:"(UTC+01:00) Rome"},{Value:"Europe/Stockholm",Text:"(UTC+01:00) Stockholm"},{Value:"Europe/Tirane",Text:"(UTC+01:00) Tirane"},{Value:"Africa/Tunis",Text:"(UTC+01:00) Tunis"},{Value:"Europe/Vienna",Text:"(UTC+01:00) Vienna"},{Value:"Europe/Warsaw",Text:"(UTC+01:00) Warsaw"},{Value:"Europe/Zurich",Text:"(UTC+01:00) Zurich"},{Value:"Asia/Amman",Text:"(UTC+02:00) Amman"},{Value:"Europe/Athens",Text:"(UTC+02:00) Athens"},{Value:"Asia/Beirut",Text:"(UTC+02:00) Beirut"},{Value:"Europe/Bucharest",Text:"(UTC+02:00) Bucharest"},{Value:"Africa/Cairo",Text:"(UTC+02:00) Cairo"},{Value:"Europe/Chisinau",Text:"(UTC+02:00) Chisinau"},{Value:"Asia/Damascus",Text:"(UTC+02:00) Damascus"},{Value:"Asia/Gaza",Text:"(UTC+02:00) Gaza"},{Value:"Europe/Helsinki",Text:"(UTC+02:00) Helsinki"},{Value:"Asia/Jerusalem",Text:"(UTC+02:00) Jerusalem"},{Value:"Africa/Johannesburg",Text:"(UTC+02:00) Johannesburg"},{Value:"Africa/Khartoum",Text:"(UTC+02:00) Khartoum"},{Value:"Europe/Kiev",Text:"(UTC+02:00) Kiev"},{Value:"Africa/Maputo",Text:"(UTC+02:00) Maputo"},{Value:"Europe/Kaliningrad",Text:"(UTC+02:00) Moscow-01 - Kaliningrad"},{Value:"Asia/Nicosia",Text:"(UTC+02:00) Nicosia"},{Value:"Europe/Riga",Text:"(UTC+02:00) Riga"},{Value:"Europe/Sofia",Text:"(UTC+02:00) Sofia"},{Value:"Europe/Tallinn",Text:"(UTC+02:00) Tallinn"},{Value:"Africa/Tripoli",Text:"(UTC+02:00) Tripoli"},{Value:"Europe/Vilnius",Text:"(UTC+02:00) Vilnius"},{Value:"Africa/Windhoek",Text:"(UTC+02:00) Windhoek"},{Value:"Asia/Baghdad",Text:"(UTC+03:00) Baghdad"},{Value:"Europe/Istanbul",Text:"(UTC+03:00) Istanbul"},{Value:"Europe/Minsk",Text:"(UTC+03:00) Minsk"},{Value:"Europe/Moscow",Text:"(UTC+03:00) Moscow+00 - Moscow"},{Value:"Africa/Nairobi",Text:"(UTC+03:00) Nairobi"},{Value:"Asia/Qatar",Text:"(UTC+03:00) Qatar"},{Value:"Asia/Riyadh",Text:"(UTC+03:00) Riyadh"},{Value:"Antarctica/Syowa",Text:"(UTC+03:00) Syowa"},{Value:"Asia/Tehran",Text:"(UTC+03:30) Tehran"},{Value:"Asia/Baku",Text:"(UTC+04:00) Baku"},{Value:"Asia/Dubai",Text:"(UTC+04:00) Dubai"},{Value:"Indian/Mahe",Text:"(UTC+04:00) Mahe"},{Value:"Indian/Mauritius",Text:"(UTC+04:00) Mauritius"},{Value:"Europe/Samara",Text:"(UTC+04:00) Moscow+01 - Samara"},{Value:"Indian/Reunion",Text:"(UTC+04:00) Reunion"},{Value:"Asia/Tbilisi",Text:"(UTC+04:00) Tbilisi"},{Value:"Asia/Yerevan",Text:"(UTC+04:00) Yerevan"},{Value:"Asia/Kabul",Text:"(UTC+04:30) Kabul"},{Value:"Asia/Aqtau",Text:"(UTC+05:00) Aqtau"},{Value:"Asia/Aqtobe",Text:"(UTC+05:00) Aqtobe"},{Value:"Asia/Ashgabat",Text:"(UTC+05:00) Ashgabat"},{Value:"Asia/Dushanbe",Text:"(UTC+05:00) Dushanbe"},{Value:"Asia/Karachi",Text:"(UTC+05:00) Karachi"},{Value:"Indian/Kerguelen",Text:"(UTC+05:00) Kerguelen"},{Value:"Indian/Maldives",Text:"(UTC+05:00) Maldives"},{Value:"Antarctica/Mawson",Text:"(UTC+05:00) Mawson"},{Value:"Asia/Yekaterinburg",Text:"(UTC+05:00) Moscow+02 - Yekaterinburg"},{Value:"Asia/Tashkent",Text:"(UTC+05:00) Tashkent"},{Value:"Asia/Colombo",Text:"(UTC+05:30) Colombo"},{Value:"Asia/Kolkata",Text:"(UTC+05:30) India Standard Time"},{Value:"Asia/Katmandu",Text:"(UTC+05:45) Katmandu"},{Value:"Asia/Almaty",Text:"(UTC+06:00) Almaty"},{Value:"Asia/Bishkek",Text:"(UTC+06:00) Bishkek"},{Value:"Indian/Chagos",Text:"(UTC+06:00) Chagos"},{Value:"Asia/Dhaka",Text:"(UTC+06:00) Dhaka"},{Value:"Asia/Omsk",Text:"(UTC+06:00) Moscow+03 - Omsk"},{Value:"Asia/Thimphu",Text:"(UTC+06:00) Thimphu"},{Value:"Antarctica/Vostok",Text:"(UTC+06:00) Vostok"},{Value:"Indian/Cocos",Text:"(UTC+06:30) Cocos"},{Value:"Asia/Yangon",Text:"(UTC+06:30) Rangoon"},{Value:"Asia/Bangkok",Text:"(UTC+07:00) Bangkok"},{Value:"Indian/Christmas",Text:"(UTC+07:00) Christmas"},{Value:"Antarctica/Davis",Text:"(UTC+07:00) Davis"},{Value:"Asia/Saigon",Text:"(UTC+07:00) Hanoi"},{Value:"Asia/Hovd",Text:"(UTC+07:00) Hovd"},{Value:"Asia/Jakarta",Text:"(UTC+07:00) Jakarta"},{Value:"Asia/Krasnoyarsk",Text:"(UTC+07:00) Moscow+04 - Krasnoyarsk"},{Value:"Asia/Brunei",Text:"(UTC+08:00) Brunei"},{Value:"Asia/Shanghai",Text:"(UTC+08:00) China Time - Beijing"},{Value:"Asia/Choibalsan",Text:"(UTC+08:00) Choibalsan"},{Value:"Asia/Hong_Kong",Text:"(UTC+08:00) Hong Kong"},{Value:"Asia/Kuala_Lumpur",Text:"(UTC+08:00) Kuala Lumpur"},{Value:"Asia/Macau",Text:"(UTC+08:00) Macau"},{Value:"Asia/Makassar",Text:"(UTC+08:00) Makassar"},{Value:"Asia/Manila",Text:"(UTC+08:00) Manila"},{Value:"Asia/Irkutsk",Text:"(UTC+08:00) Moscow+05 - Irkutsk"},{Value:"Asia/Singapore",Text:"(UTC+08:00) Singapore"},{Value:"Asia/Taipei",Text:"(UTC+08:00) Taipei"},{Value:"Asia/Ulaanbaatar",Text:"(UTC+08:00) Ulaanbaatar"},{Value:"Australia/Perth",Text:"(UTC+08:00) Western Time - Perth"},{Value:"Asia/Pyongyang",Text:"(UTC+08:30) Pyongyang"},{Value:"Asia/Dili",Text:"(UTC+09:00) Dili"},{Value:"Asia/Jayapura",Text:"(UTC+09:00) Jayapura"},{Value:"Asia/Yakutsk",Text:"(UTC+09:00) Moscow+06 - Yakutsk"},{Value:"Pacific/Palau",Text:"(UTC+09:00) Palau"},{Value:"Asia/Seoul",Text:"(UTC+09:00) Seoul"},{Value:"Asia/Tokyo",Text:"(UTC+09:00) Tokyo"},{Value:"Australia/Darwin",Text:"(UTC+09:30) Central Time - Darwin"},{Value:"Antarctica/DumontDUrville",Text:'(UTC+10:00) Dumont D"Urville'},{Value:"Australia/Brisbane",Text:"(UTC+10:00) Eastern Time - Brisbane"},{Value:"Pacific/Guam",Text:"(UTC+10:00) Guam"},{Value:"Asia/Vladivostok",Text:"(UTC+10:00) Moscow+07 - Vladivostok"},{Value:"Pacific/Port_Moresby",Text:"(UTC+10:00) Port Moresby"},{Value:"Pacific / Chuuk",Text:"(UTC+10:00) Truk"},{Value:"Australia/Adelaide",Text:"(UTC+10:30) Central Time - Adelaide"},{Value:"Antarctica/Casey",Text:"(UTC+11:00) Casey"},{Value:"Australia/Hobart",Text:"(UTC+11:00) Eastern Time - Hobart"},{Value:"Australia/Sydney",Text:"(UTC+11:00) Eastern Time - Melbourne, Sydney"},{Value:"Pacific/Efate",Text:"(UTC+11:00) Efate"},{Value:"Pacific/Guadalcanal",Text:"(UTC+11:00) Guadalcanal"},{Value:"Pacific/Kosrae",Text:"(UTC+11:00) Kosrae"},{Value:"Asia/Magadan",Text:"(UTC+11:00) Moscow+08 - Magadan"},{Value:"Pacific / Norfolk",Text:"(UTC+11:00) Norfolk"},{Value:"Pacific/Noumea",Text:"(UTC+11:00) Noumea"},{Value:"Pacific/Pohnpei",Text:"(UTC+11:00) Ponape"},{Value:"Pacific/Funafuti",Text:"(UTC+12:00) Funafuti"},{Value:"Pacific/Kwajalein",Text:"(UTC+12:00) Kwajalein"},{Value:"Pacific/Majuro",Text:"(UTC+12:00) Majuro"},{Value:"Asia/Kamchatka",Text:"(UTC+12:00) Moscow+09 - Petropavlovsk - Kamchatskiy"},{Value:"Pacific / Nauru",Text:"(UTC+12:00) Nauru"},{Value:"Pacific/Tarawa",Text:"(UTC+12:00) Tarawa"},{Value:"Pacific/Wake",Text:"(UTC+12:00) Wake"},{Value:"Pacific/Wallis",Text:"(UTC+12:00) Wallis"},{Value:"Pacific/Auckland",Text:"(UTC+13:00) Auckland"},{Value:"Pacific/Enderbury",Text:"(UTC+13:00) Enderbury"},{Value:"Pacific/Fakaofo",Text:"(UTC+13:00) Fakaofo"},{Value:"Pacific/Fiji",Text:"(UTC+13:00) Fiji"},{Value:"Pacific/Tongatapu",Text:"(UTC+13:00) Tongatapu"},{Value:"Pacific/Apia",Text:"(UTC+14:00) Apia"},{Value:"Pacific/Kiritimati",Text:"(UTC+14:00) Kiritimati"}],pt={},ht=["SU","MO","TU","WE","TH","FR","SA"],dt=["SU","MO","TU","WE","TH","FR","SA"],ut=43,vt=["first","second","third","fourth","last"],mt="summaryTimes",gt="summaryOn",ft="every",yt="summaryUntil",Tt="summaryDay",wt="summaryWeek",Dt="summaryMonth",bt="summaryYear",Ct={SU:"sun",MO:"mon",TU:"tue",WE:"wed",TH:"thu",FR:"fri",SA:"sat"},Ot=/\d/,Et=/[^A-Z]+/,St=/[a-z]+|[^a-z]+/gi,xt=function(){function e(e){this.slots=[],this.isDoubleTapped=!1,this.parent=e}return e.prototype.processData=function(e,i,n){var r=this,a=this.parent.activeView.startDate(),s=this.parent.activeView.endDate(),o=this.parent.eventFields,l=[],c=1,p=!1,h=this.parent.resourceBase?this.parent.resourceBase.resourceCollection:[];e.length>0&&t.isNullOrUndefined(e[0][o.id])&&(p=!0);for(var d=this,u=0,v=e;u<v.length;u++)!function(e){p&&(e[o.id]=c++),e=d.updateEventDateTime(e),i?d.processTimezoneChange(e,n):d.parent.isPrinting||d.parent.uiStateValues.isResize||(e=d.processTimezone(e));for(var a=0;a<h.length;a++)null!==e[h[a].field]&&0!==e[h[a].field]||(e[h[a].field]=void 0);if(t.isNullOrUndefined(e[o.recurrenceRule])||""!==e[o.recurrenceRule]||(e[o.recurrenceRule]=null),t.isNullOrUndefined(e[o.recurrenceRule])||!t.isNullOrUndefined(e[o.recurrenceID])||d.parent.crudModule&&d.parent.crudModule.crudObj.isCrudAction)if(d.parent.crudModule&&d.parent.crudModule.crudObj.isCrudAction)if(!t.isNullOrUndefined(e[o.recurrenceRule])&&t.isNullOrUndefined(e[o.recurrenceID]))for(var s=0,u=d.generateOccurrence(e,null,n,!0);s<u.length;s++)!function(e){var t=d.parent.eventsProcessed.filter(function(t){return t[o.startTime].getTime()-e[o.startTime].getTime()==0&&t[o.id]===e[o.id]});e.Guid=t.length>0?t[0].Guid:d.generateGuid(),l.push(e)}(u[s]);else{var v=d.parent.eventsProcessed.filter(function(t){return t[r.parent.eventFields.id]===e[r.parent.eventFields.id]});e.Guid=v.length>0?v[0].Guid:d.generateGuid(),l.push(e)}else e.Guid=d.generateGuid(),l.push(e);else l=l.concat(d.generateOccurrence(e,null,n,!0))}(v[u]);this.parent.eventsProcessed=[];var m=l.filter(function(e){return!e[r.parent.eventFields.isBlock]});this.parent.eventsProcessed=this.filterEvents(a,s,m);for(var g=l.filter(function(e){return e[r.parent.eventFields.isBlock]}),f=0,y=g;f<y.length;f++){var T=y[f];T[o.isAllDay]&&(w(new Date(T[o.startTime].getTime()))<w(new Date(T[o.endTime].getTime()))||(T[o.startTime]=w(T[o.startTime]),T[o.endTime]=C(w(T[o.endTime]),1)))}return this.parent.blockProcessed=g,m},e.prototype.updateEventDateTime=function(e){return"string"==typeof e[this.parent.eventFields.startTime]&&(e[this.parent.eventFields.startTime]=V(e[this.parent.eventFields.startTime])),"string"==typeof e[this.parent.eventFields.endTime]&&(e[this.parent.eventFields.endTime]=V(e[this.parent.eventFields.endTime])),e},e.prototype.getProcessedEvents=function(e){void 0===e&&(e=this.parent.eventsData);for(var i=[],n=0,r=e;n<r.length;n++){var a=r[n];!t.isNullOrUndefined(a[this.parent.eventFields.recurrenceRule])&&t.isNullOrUndefined(a[this.parent.eventFields.recurrenceID])?i=i.concat(this.generateOccurrence(a)):i.push(a)}return i},e.prototype.timezonePropertyChange=function(e){var t=this.parent.eventsData.concat(this.parent.blockData),i=this.processData(t,!0,e);this.parent.notify(Fe,{processedData:i})},e.prototype.timezoneConvert=function(e){var t=this.parent.eventFields;if(e[t.startTimezone]=e[t.startTimezone]||e[t.endTimezone],e[t.endTimezone]=e[t.endTimezone]||e[t.startTimezone],this.parent.timezone){var i=e[t.startTimezone],n=e[t.endTimezone];e[t.startTime]=this.parent.tzModule.convert(e[t.startTime],this.parent.timezone,i),e[t.endTime]=this.parent.tzModule.convert(e[t.endTime],this.parent.timezone,n)}},e.prototype.processTimezoneChange=function(e,t){var i=this.parent.eventFields;e[i.isAllDay]||(t&&this.parent.timezone?(e[i.startTime]=this.parent.tzModule.convert(e[i.startTime],t,this.parent.timezone),e[i.endTime]=this.parent.tzModule.convert(e[i.endTime],t,this.parent.timezone)):!t&&this.parent.timezone?(e[i.startTime]=this.parent.tzModule.add(e[i.startTime],this.parent.timezone),e[i.endTime]=this.parent.tzModule.add(e[i.endTime],this.parent.timezone)):t&&!this.parent.timezone&&(e[i.startTime]=this.parent.tzModule.remove(e[i.startTime],t),e[i.endTime]=this.parent.tzModule.remove(e[i.endTime],t)))},e.prototype.processTimezone=function(e,t){void 0===t&&(t=!1);var i=this.parent.eventFields;if(e[i.startTimezone]||e[i.endTimezone]){var n=e[i.startTimezone]||e[i.endTimezone],r=e[i.endTimezone]||e[i.startTimezone];t?this.parent.timezone?(e[i.startTime]=this.parent.tzModule.convert(e[i.startTime],n,this.parent.timezone),e[i.endTime]=this.parent.tzModule.convert(e[i.endTime],r,this.parent.timezone),e[i.startTime]=this.parent.tzModule.remove(e[i.startTime],this.parent.timezone),e[i.endTime]=this.parent.tzModule.remove(e[i.endTime],this.parent.timezone)):(e[i.startTime]=this.parent.tzModule.remove(e[i.startTime],n),e[i.endTime]=this.parent.tzModule.remove(e[i.endTime],r)):(e[i.startTime]=this.parent.tzModule.add(e[i.startTime],n),e[i.endTime]=this.parent.tzModule.add(e[i.endTime],r),this.parent.timezone&&(e[i.startTime]=this.parent.tzModule.convert(e[i.startTime],n,this.parent.timezone),e[i.endTime]=this.parent.tzModule.convert(e[i.endTime],r,this.parent.timezone)))}else this.parent.timezone&&(t?(e[i.startTime]=this.parent.tzModule.remove(e[i.startTime],this.parent.timezone),e[i.endTime]=this.parent.tzModule.remove(e[i.endTime],this.parent.timezone)):(e[i.startTime]=this.parent.tzModule.add(e[i.startTime],this.parent.timezone),e[i.endTime]=this.parent.tzModule.add(e[i.endTime],this.parent.timezone)));return e},e.prototype.filterBlockEvents=function(e){var i,n=this.parent.eventFields,r=e[n.startTime],a=e[n.endTime];if(this.parent.activeViewOptions.group.resources.length>0){var s=this.getGroupIndexFromEvent(e);i=this.parent.resourceBase.lastResourceLevel[s]}for(var o=t.extend([],this.parent.blockProcessed,null,!0),l=0,c=o;l<c.length;l++){var p=c[l];p[n.isAllDay]&&p[n.endTime].getTime()>w(new Date(p[n.endTime].getTime())).getTime()&&(p[n.startTime]=w(p[n.startTime]),p[n.endTime]=C(w(p[n.endTime]),1))}return this.filterEvents(r,a,o,i)},e.prototype.filterEvents=function(e,t,i,n){void 0===i&&(i=this.parent.eventsProcessed);var r=this.parent.eventFields,s=new a.Predicate(r.startTime,"greaterthanorequal",e).and(new a.Predicate(r.endTime,"greaterthanorequal",e)).and(new a.Predicate(r.startTime,"lessthan",t)).or(new a.Predicate(r.startTime,"lessthanorequal",e).and(new a.Predicate(r.endTime,"greaterthan",e))),o=new a.DataManager({json:i}).executeLocal((new a.Query).where(s));return n&&(o=this.filterEventsByResource(n,o)),this.sortByTime(o)},e.prototype.filterEventsByRange=function(e,t,i){var n=this,r=[];return r=t&&i?this.filterEvents(t,i,e):t&&!i?e.filter(function(e){return e[n.parent.eventFields.startTime]>=t}):!t&&i?e.filter(function(e){return e[n.parent.eventFields.endTime]<=i}):e,this.sortByTime(r)},e.prototype.filterEventsByResource=function(e,t){void 0===t&&(t=this.parent.eventsProcessed);for(var i={},n=this.parent.resourceBase.resourceCollection,r=0;r<n.length;r++)i[n[r].field]=e.groupOrder[r];var a=Object.keys(i);return t.filter(function(e){return a.every(function(t){return e[t]instanceof Array?e[t].indexOf(i[t])>-1:e[t]===i[t]})})},e.prototype.sortByTime=function(e){if(this.parent.eventSettings.sortComparer)e=this.parent.eventSettings.sortComparer.call(this.parent,e);else{var t=this.parent.eventFields;e.sort(function(e,i){var n=e[t.startTime],r=i[t.startTime];return n.getTime()-r.getTime()})}return e},e.prototype.sortByDateTime=function(e){if(this.parent.eventSettings.sortComparer)e=this.parent.eventSettings.sortComparer.call(this.parent,e);else{var t=this.parent.eventFields;e.sort(function(e,i){var n=e[t.startTime],r=i[t.startTime],a=e[t.endTime],s=i[t.endTime],o=a.getTime()-n.getTime(),l=s.getTime()-r.getTime();return n.getTime()-r.getTime()||l-o})}return e},e.prototype.getSmallestMissingNumber=function(e){for(var t=Math.max.apply(Math,e),i=0;i<t;i++)if(-1===e.indexOf(i))return i;return t+1},e.prototype.splitEventByDay=function(e){var i=this.parent.eventFields,n=[],r=e[i.startTime],a=e[i.endTime];if(w(new Date(r.getTime()))<w(new Date(a.getTime())))for(var s=new Date(r.getTime()),o=C(w(new Date(r.getTime())),1),l=0===a.getHours()&&0===a.getMinutes()?a:C(a,1),c=1,p=A(r.getTime(),l.getTime());o<=a&&s.getTime()!==o.getTime();){var h=t.extend({},e);h[i.startTime]=s,h[i.endTime]=o,h.data={index:c,count:p},h.Guid=this.generateGuid(),h.isSpanned=!0,n.push(h),s=o,w(new Date(s.getTime())).getTime()===w(new Date(a.getTime())).getTime()&&o.getTime()!==a.getTime()?(o=new Date(s.getTime()),o=new Date(o.setHours(a.getHours(),a.getMinutes(),a.getSeconds()))):o=C(w(new Date(s.getTime())),1),c++}else n.push(e);return n},e.prototype.splitEvent=function(e,i){var n=this.parent.eventFields,r=w(e[n.startTime]).getTime(),a=w(e[n.endTime]).getTime();D(e[n.endTime])<=0&&(a=r>(b=C(w(e[n.endTime]),-1).getTime())?r:b);var s=r,o=a,l=[];if(r!==a){r<i[0].getTime()&&(r=i[0].getTime()),a>i[i.length-1].getTime()&&(a=i[i.length-1].getTime());for(var c=r,p=0;p<this.slots.length;p++){var h=this.slots[p];if("WorkWeek"===this.parent.currentView||"TimelineWorkWeek"===this.parent.currentView||this.parent.activeViewOptions.group.byDate||this.parent.activeViewOptions.showWeekend){for(var d=[],u=0,v=h;u<v.length;u++){var m=v[u];d.push(new Date(m))}var g=this.getRenderedDates(d);if(!t.isNullOrUndefined(g)&&g.length>0){h=[];for(var f=0,y=g;f<y.length;f++){var T=y[f];h.push(T.getTime())}}}if("number"==typeof h){var b=h;(h=[]).push(b)}var O=h[0];if((c=c<=O&&a>=O?O:c)>a||O>a)break;if(!this.parent.activeViewOptions.group.byDate&&this.parent.activeViewOptions.showWeekend&&"WorkWeek"!==this.parent.currentView&&"TimelineWorkWeek"!==this.parent.currentView){var E=h.indexOf(c);if(-1!==E){var S=h.indexOf(a),x=-1!==S,A=(S=x?S:h.length-1)-E+1,V=h[E]!==s,k=h[S]!==o;if(l.push(this.cloneEventObject(e,h[E],h[S],A,V,k)),x)break}}else if(this.dateInRange(c,h[0],h[h.length-1])){for(var M=[],R=0;R<h.length;R++)this.dateInRange(h[R],s,o)&&M.push(h[R]);if(M.length>0)if(this.parent.activeViewOptions.group.byDate)for(var P=0,I=M;P<I.length;P++){var H=I[P];l.push(this.cloneEventObject(e,H,H,1,H!==s,H!==o))}else{var V=M[0]!==s,k=M[M.length-1]!==o;l.push(this.cloneEventObject(e,M[0],M[M.length-1],M.length,V,k))}}}}else l.push(this.cloneEventObject(e,r,a,1,!1,!1));return l},e.prototype.cloneEventObject=function(e,i,n,r,a,s){var o=this.parent.eventFields,l=t.extend({},e,null,!0),c={count:r,isLeft:a,isRight:s};return c[o.startTime]=e[o.startTime],c[o.endTime]=e[o.endTime],l.data=c,l[o.startTime]=new Date(i),l[o.endTime]=new Date(n),l},e.prototype.dateInRange=function(e,t,i){return t<=e&&e<=i},e.prototype.getSelectedEventElements=function(e){if(this.removeSelectedAppointmentClass(),this.parent.selectedElements.length<=0)this.parent.selectedElements.push(e);else if(this.parent.selectedElements.filter(function(t){return t.getAttribute("data-guid")===e.getAttribute("data-guid")}).length<=0)for(var t='div[data-guid="'+e.getAttribute("data-guid")+'"]',i=0,n=[].slice.call(this.parent.element.querySelectorAll(t));i<n.length;i++){var r=n[i];this.parent.selectedElements.push(r)}else{var a=this.parent.selectedElements.filter(function(t){return t.getAttribute("data-guid")!==e.getAttribute("data-guid")});this.parent.selectedElements=a}return e&&this.parent.selectedElements.length>0&&this.addSelectedAppointments(this.parent.selectedElements),this.parent.selectedElements},e.prototype.getSelectedEvents=function(){var e=this,t=[],i=[];return[].slice.call(this.parent.element.querySelectorAll(".e-appointment-border")).filter(function(n){0===t.filter(function(e){return e.Guid===n.getAttribute("data-guid")}).length&&t.push(e.getEventByGuid(n.getAttribute("data-guid"))),i.push(n)}),{event:t.length>1?t:t[0],element:i.length>1?i:i[0]}},e.prototype.removeSelectedAppointmentClass=function(){for(var e=this.getSelectedAppointments(),i=0,n=e;i<n.length;i++)n[i].setAttribute("aria-selected","false");t.removeClass(e,"e-appointment-border"),"Agenda"!==this.parent.currentView&&"MonthAgenda"!==this.parent.currentView||t.removeClass(e,"e-active-appointment-agenda")},e.prototype.addSelectedAppointments=function(e){for(var i=0,n=e;i<n.length;i++)n[i].setAttribute("aria-selected","true");"MonthAgenda"!==this.parent.currentView&&this.parent.removeSelectedClass(),t.addClass(e,"e-appointment-border")},e.prototype.getSelectedAppointments=function(){return[].slice.call(this.parent.element.querySelectorAll(".e-appointment-border,.e-appointment:focus"))},e.prototype.focusElement=function(e){if(!this.parent.eventWindow.dialogObject||!this.parent.eventWindow.dialogObject.visible){var i=document.activeElement,n=this.parent.getSelectedElements();if(!(n.length>0&&(i&&(this.parent.element.contains(i)||-1!==n.indexOf(i))||e))){var r=this.getSelectedAppointments();return r.length>0?void r[r.length-1].focus():void 0}if(this.parent.keyboardInteractionModule){var a=!t.isNullOrUndefined(this.parent.activeCellsData)&&this.parent.activeCellsData.element||n[n.length-1];this.parent.keyboardInteractionModule.selectCells(a instanceof Array,a)}}},e.prototype.selectWorkCellByTime=function(e){var t;if("Agenda"===this.parent.currentView||"MonthAgenda"===this.parent.currentView)return t;if(e.length>0){var i=e[e.length-1],n=i[this.parent.eventFields.startTime],r=new Date(+n).setMinutes(0,0,0),a=this.isAllDayAppointment(i);("Month"===this.parent.currentView||a)&&(r=new Date(+n).setHours(0,0,0,0));var s=void 0;s=a&&-1!==["Day","Week","WorkWeek"].indexOf(this.parent.currentView)?this.parent.getAllDayRow():this.parent.getContentTable();var o='[data-date="'+new Date(r).getTime()+'"]';if(this.parent.activeViewOptions.group.resources.length>0&&(o+='[data-group-index="'+this.getGroupIndexFromEvent(i)+'"]'),t=s.querySelector(o))return this.parent.activeCellsData=this.parent.getCellDetails(t),this.parent.keyboardInteractionModule&&this.parent.keyboardInteractionModule.selectCells(!1,t),t}return t},e.prototype.getGroupIndexFromEvent=function(e){for(var i,n,r,a,s=this.parent.resourceBase.resourceCollection.length-1;s>=0;s--){var o=e[this.parent.resourceBase.resourceCollection[s].field];if(!t.isNullOrUndefined(o)){n=this.parent.resourceBase.resourceCollection[s],i=s,r=n.name,a=n.field;break}}t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)&&(r=this.parent.resourceCollection.slice(-1)[0].name,i=this.parent.resourceCollection.length-1,a=this.parent.resourceCollection.slice(-1)[0].field,n=this.parent.resourceCollection.filter(function(e,t){return e.name===r?(i=t,e):null})[0]);var l=e[a]instanceof Array?e[a][0]:e[a];if(i>0){var c=this.parent.resourceCollection[i-1].field;return this.parent.resourceBase.getIndexFromResourceId(l,r,n,e,c)}return this.parent.resourceBase.getIndexFromResourceId(l,r,n)},e.prototype.isAllDayAppointment=function(e){var t=this.parent.eventFields,i=e[t.isAllDay],n=(e[t.endTime].getTime()-e[t.startTime].getTime())/We>=1;return!!(i||"TimeSlot"!==this.parent.eventSettings.spannedEventPlacement&&n)},e.prototype.addEventListener=function(){this.parent.on("document-click",this.appointmentBorderRemove,this)},e.prototype.removeEventListener=function(){this.parent.off("document-click",this.appointmentBorderRemove)},e.prototype.appointmentBorderRemove=function(e){var i=e.event.target;t.closest(i,".e-appointment")?"MonthAgenda"!==this.parent.currentView&&this.parent.removeSelectedClass():t.closest(i,"."+Ke)||this.removeSelectedAppointmentClass()},e.prototype.wireAppointmentEvents=function(e,i,n){void 0===n&&(n=!1);var r=!t.isNullOrUndefined(i)&&i[this.parent.eventFields.isReadonly];t.EventHandler.add(e,"click",this.eventClick,this),this.parent.isAdaptive||this.parent.activeViewOptions.readonly||r||(t.EventHandler.add(e,"touchstart",this.eventTouchClick,this),t.EventHandler.add(e,"dblclick",this.eventDoubleClick,this)),this.parent.activeViewOptions.readonly||r||n||(this.parent.resizeModule&&this.parent.resizeModule.wireResizeEvent(e),this.parent.dragAndDropModule&&this.parent.dragAndDropModule.wireDragEvent(e))},e.prototype.eventTouchClick=function(e){var t=this;setTimeout(function(){return t.isDoubleTapped=!1},250),e.preventDefault(),this.isDoubleTapped?this.eventDoubleClick(e):this.isDoubleTapped||(this.isDoubleTapped=!0,this.eventClick(e))},e.prototype.renderResizeHandler=function(e,i,n){if(this.parent.resizeModule&&this.parent.allowResizing&&!this.parent.activeViewOptions.readonly&&!n)for(var r=0,a=Object.keys(i);r<a.length;r++){var s=a[r],o=t.createElement("div",{className:"e-event-resize"});switch(s){case"isLeft":i.isLeft||(o.appendChild(t.createElement("div",{className:"e-left-right-resize"})),t.addClass([o],this.parent.enableRtl?"e-right-handler":"e-left-handler"),t.prepend([o],e));break;case"isRight":i.isRight||(o.appendChild(t.createElement("div",{className:"e-left-right-resize"})),t.addClass([o],this.parent.enableRtl?"e-left-handler":"e-right-handler"),t.append([o],e));break;case"isTop":i.isTop||(o.appendChild(t.createElement("div",{className:"e-top-bottom-resize"})),t.addClass([o],"e-top-handler"),t.prepend([o],e));break;case"isBottom":i.isBottom||(o.appendChild(t.createElement("div",{className:"e-top-bottom-resize"})),t.addClass([o],"e-bottom-handler"),t.append([o],e))}}},e.prototype.eventClick=function(e){var i=this,n=e.target;if(!(n.classList.contains("e-drag-clone")||n.classList.contains("e-resize-clone")||n.classList.contains("e-inline-subject")))if((e.ctrlKey||e.metaKey)&&1===e.which&&this.parent.keyboardInteractionModule){this.parent.quickPopup.quickPopup.hide(),this.parent.selectedElements=[].slice.call(this.parent.element.querySelectorAll(".e-appointment-border"));var r=t.closest(e.target,".e-appointment");this.getSelectedEventElements(r),this.activeEventData(e,!1);var a={data:this.parent.activeEventData.event,element:this.parent.activeEventData.element,event:e,requestType:"eventSelect"};this.parent.trigger("select",a);o=t.extend(this.parent.activeEventData,{cancel:!1,originalEvent:e});this.parent.trigger("eventClick",o)}else{this.removeSelectedAppointmentClass(),this.activeEventData(e,!0);var s={data:this.parent.activeEventData.event,element:this.parent.activeEventData.element,event:e,requestType:"eventSelect"};this.parent.trigger("select",s);var o=t.extend(this.parent.activeEventData,{cancel:!1,originalEvent:e});this.parent.trigger("eventClick",o,function(e){if(e.cancel)i.removeSelectedAppointmentClass(),i.parent.quickPopup&&i.parent.quickPopup.quickPopupHide();else if("Agenda"!==i.parent.currentView&&"MonthAgenda"!==i.parent.currentView||t.addClass([i.parent.activeEventData.element],"e-active-appointment-agenda"),i.parent.allowInline){var n={data:e.event,element:e.element,type:"Event"};i.parent.notify(Ne,n)}else i.parent.notify("eventClick",e)})}},e.prototype.eventDoubleClick=function(e){this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(!0),"touchstart"===e.type&&this.activeEventData(e,!0),this.removeSelectedAppointmentClass(),this.parent.activeEventData.element.classList.contains("e-inline-appointment")||this.parent.activeEventData.element.querySelector(".e-inline-subject")||(!t.isNullOrUndefined(this.parent.activeEventData.event)&&t.isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceID])?this.parent.eventWindow.openEditor(this.parent.activeEventData.event,"Save"):(this.parent.currentAction="EditOccurrence",this.parent.quickPopup.openRecurrenceAlert()))},e.prototype.getEventByGuid=function(e){return this.parent.eventsProcessed.filter(function(t){return t.Guid===e})[0]},e.prototype.getEventById=function(e){var t=this;return this.parent.eventsData.filter(function(i){return i[t.parent.eventFields.id]===e})[0]},e.prototype.generateGuid=function(){return"xyxxxxyx-xxxy-yxxx-xyxx-xxyxxxxyyxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.prototype.getEventIDType=function(){return 0!==this.parent.eventsData.length?typeof this.parent.eventsData[0][this.parent.eventFields.id]:0!==this.parent.blockData.length?typeof this.parent.blockData[0][this.parent.eventFields.id]:"string"},e.prototype.getEventMaxID=function(e){var i=this;if(this.parent.eventsData.length<1&&this.parent.blockData.length<1)return 1;var n,r=this.getEventIDType();if("string"===r&&(n=this.generateGuid()),"number"===r){var a=this.parent.eventsData.concat(this.parent.blockData),s=Math.max.apply(Math,a.map(function(e){return e[i.parent.eventFields.id]}));n=(s=t.isNullOrUndefined(e)?s:s+e)+1}return n},e.prototype.activeEventData=function(e,i){var n=this,r=t.closest(e.target,".e-appointment"),a=r.getAttribute("data-guid");i&&(this.addSelectedAppointments([].slice.call(this.parent.element.querySelectorAll('div[data-guid="'+a+'"]'))),r.focus());var s=this.getEventByGuid(a);s&&s.isSpanned&&(s=this.parent.eventsData.filter(function(e){return e[n.parent.eventFields.id]===s[n.parent.eventFields.id]})[0]),this.parent.activeEventData={event:s,element:r}},e.prototype.generateOccurrence=function(e,i,n,r){var a=e[this.parent.eventFields.startTime],s=e[this.parent.eventFields.endTime],o=e[this.parent.eventFields.recurrenceRule],l=s.getTime()-a.getTime();i=new Date((i||this.parent.activeView.startDate()).getTime()-l);var c,p=e[this.parent.eventFields.recurrenceException];"Agenda"!==this.parent.currentView&&r&&(c=b(this.parent.activeView.startDate(),this.parent.activeView.endDate())+1);var h=this.parent.timezone||this.parent.tzModule.getLocalTimezoneName(),d=U(a,o,p,this.parent.activeViewOptions.firstDayOfWeek,c,i,this.parent.calendarMode,n,h);"Agenda"===this.parent.currentView&&-1===o.indexOf("COUNT")&&-1===o.indexOf("UNTIL")&&(t.isNullOrUndefined(e.generatedDates)?e.generatedDates={start:new Date(d[0]),end:new Date(d[d.length-1])}:(d[0]<e.generatedDates.start.getTime()&&(e.generatedDates.start=new Date(d[0])),d[d.length-1]>e.generatedDates.end.getTime()&&(e.generatedDates.end=new Date(d[d.length-1]))));for(var u=[],v=0,m=d;v<m.length;v++){var g=m[v],f=t.extend({},e,null,!0);f[this.parent.eventFields.startTime]=new Date(g),f[this.parent.eventFields.endTime]=new Date(new Date(g).setMilliseconds(l)),f[this.parent.eventFields.recurrenceID]=f[this.parent.eventFields.id],delete f[this.parent.eventFields.recurrenceException],delete f[this.parent.eventFields.followingID],f.Guid=this.generateGuid(),u.push(f)}return u},e.prototype.getParentEvent=function(e,i){void 0===i&&(i=!1);var n;do{(e=this.getFollowingEvent(e))&&(n=t.extend({},e,null,!0))}while(e&&i);if(i&&n){var r=this.getEventCollections(n),a=r.follow.slice(-1)[0];r.occurrence.length>0&&!n[this.parent.eventFields.recurrenceException]&&(a=r.occurrence.slice(-1)[0]),a&&(n[this.parent.eventFields.recurrenceRule]=a[this.parent.eventFields.recurrenceRule])}return n},e.prototype.getEventCollections=function(e,t){var i=[],n=[],r=e;do{(r=this.getFollowingEvent(r,!0))&&i.push(r),n=n.concat(this.getOccurrenceEvent(r||e))}while(r);var a={};if(t){var s=this.parent.eventFields;a={follow:i.filter(function(e){return e[s.startTime]>=t[s.startTime]}),occurrence:n.filter(function(e){return e[s.startTime]>=t[s.startTime]})}}else a={follow:i,occurrence:n};return a},e.prototype.getFollowingEvent=function(e,t){var i,n=this.parent.eventFields;return i=t?e[n.id]:e[n.recurrenceID]||e[n.followingID],this.parent.eventsData.filter(function(e){return e[t?n.followingID:n.id]===i}).shift()},e.prototype.isFollowingEvent=function(e,t){var i=e[this.parent.eventFields.startTime],n=t[this.parent.eventFields.startTime];return i.getHours()===n.getHours()&&i.getMinutes()===n.getMinutes()&&i.getSeconds()===n.getSeconds()},e.prototype.getOccurrenceEvent=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1);var n=t?"Guid":i?this.parent.eventFields.followingID:this.parent.eventFields.recurrenceID,r=t?"Guid":this.parent.eventFields.id;return(t?this.parent.eventsProcessed:this.parent.eventsData).filter(function(t){return t[n]===e[r]})},e.prototype.getOccurrencesByID=function(e){for(var i=this.parent.eventFields,n=[],r=0,a=this.parent.eventsData.filter(function(t){return t[i.id]===e});r<a.length;r++){var s=a[r];t.isNullOrUndefined(s[i.recurrenceRule])||(n=n.concat(this.generateOccurrence(s)))}return n},e.prototype.getOccurrencesByRange=function(e,i){for(var n=this.parent.eventFields,r=[],a=0,s=this.parent.eventsData;a<s.length;a++){var o=s[a];t.isNullOrUndefined(o[n.recurrenceRule])||(r=r.concat(this.generateOccurrence(o)))}return r.filter(function(r){return r[n.startTime]>=e&&r[n.endTime]<=i&&!t.isNullOrUndefined(r[n.recurrenceID])})},e.prototype.getDeletedOccurrences=function(e){var i,n=this.parent.eventFields,r=[];if((i="string"==typeof e||"number"==typeof e?this.parent.eventsData.filter(function(t){return t[n.id]===e})[0]:t.extend({},e,null,!0))[n.recurrenceException])for(var a=i[n.recurrenceException].split(","),s=this,o=0,l=a.length;o<l;o++)!function(o,l){if(0===s.parent.eventsData.filter(function(e){return e[n.recurrenceID]===i[n.id]&&e[n.recurrenceException]===a[o]}).length){var c=B(a[o]),p=t.extend({},e,null,!0);p[n.recurrenceID]=i[n.id],delete p[n.followingID],p[n.recurrenceException]=a[o];var h=new Date(c.getTime()),d=i[n.endTime].getTime()-i[n.startTime].getTime(),u=new Date(h.getTime());u.setMilliseconds(d),p[n.startTime]=new Date(h.getTime()),p[n.endTime]=new Date(u.getTime()),r.push(p)}}(o);return r},e.prototype.applyResourceColor=function(e,i,n,r,a){if(this.parent.resourceBase){var s=this.parent.resourceBase.getResourceColor(i,r);s&&(e.style[n]=t.isNullOrUndefined(a)?s:function(e,t){return e=e.replace("#",""),"rgba("+parseInt(e.substring(0,e.length/3),16)+", "+parseInt(e.substring(e.length/3,2*e.length/3),16)+", "+parseInt(e.substring(2*e.length/3,3*e.length/3),16)+", "+t+")"}(s,a))}},e.prototype.createBlockAppointmentElement=function(e,i){var n,r=e[this.parent.eventFields.subject]||this.parent.eventSettings.fields.subject.default,a=t.createElement("div",{className:"e-block-appointment",attrs:{"data-id":"Appointment_"+e[this.parent.eventFields.id],"aria-readonly":"true","aria-selected":"false"}});if(t.isNullOrUndefined(this.parent.activeViewOptions.eventTemplate))n=[t.createElement("div",{className:"e-subject",innerHTML:r})];else{var s=this.parent.element.id+"_"+this.parent.activeViewOptions.eventTemplateName+"eventTemplate",o="eventTemplate"+(this.parent.activeViewOptions.group.resources.length>0&&-1===this.parent.currentView.indexOf("Year")?"_"+i:"");n=this.parent.getAppointmentTemplate()(e,this.parent,o,s,!1)}return t.append(n,a),this.setWrapperAttributes(a,i),a},e.prototype.setWrapperAttributes=function(e,i){t.isNullOrUndefined(this.cssClass)||t.addClass([e],this.cssClass),this.parent.activeViewOptions.group.resources.length>0&&e.setAttribute("data-group-index",i.toString())},e.prototype.getReadonlyAttribute=function(e){return(e[this.parent.eventFields.isReadonly]||this.parent.readonly).toString()},e.prototype.isBlockRange=function(e){for(var i=e instanceof Array?e:[e],n=!1,r=this.parent.eventFields,a=0,s=i;a<s.length;a++){var o=s[a],l=[];t.isNullOrUndefined(o[r.recurrenceRule])||!t.isNullOrUndefined(o[r.recurrenceID])&&o[r.id]!==o[r.recurrenceID]?l.push(o):l=this.generateOccurrence(o);for(var c=0,p=l;c<p.length;c++){var h=p[c];if(this.filterBlockEvents(h).length>0){n=!0;break}}}return this.parent.uiStateValues.isBlock=n,n},e.prototype.getFilterEventsList=function(e,t){return new a.DataManager(e).executeLocal((new a.Query).where(t))},e.prototype.getSeriesEvents=function(e,i){var n=this.parent.eventFields;i=t.isNullOrUndefined(i)?e[n.startTime]:i;var r,s,o,l=[],c=e[n.id],p=e[n.followingID],h="EditSeries"===this.parent.currentAction?"greaterthan":"greaterthanorequal";do{o=new a.Predicate(n.followingID,"equal",c).and(new a.Predicate(n.startTime,h,i)),r=(s=this.getFilterEventsList(this.parent.eventsData,o)).slice(-1)[0],t.isNullOrUndefined(r)||r[n.id]===p?p=null:(l.push(r),c=r[n.id],p=r[n.followingID])}while(1===s.length&&!t.isNullOrUndefined(r[n.followingID]));return l},e.prototype.getEditedOccurrences=function(e,t){for(var i,n=this.parent.eventFields,r=[],s=0,o=e;s<o.length;s++){var l=o[s],c=new a.Predicate(n.recurrenceID,"equal",l[n.id]).or(new a.Predicate(n.recurrenceID,"equal",l[n.followingID]).and(new a.Predicate(n.recurrenceID,"notequal",void 0)).and(new a.Predicate(n.recurrenceID,"notequal",null)));"EditFollowingEvents"!==this.parent.currentAction&&"DeleteFollowingEvents"!==this.parent.currentAction||(c=c.and(new a.Predicate(n.startTime,"greaterthanorequal",t))),i=this.getFilterEventsList(this.parent.eventsData,c),r=r.concat(i)}return r},e.prototype.getRenderedDates=function(e){var t,i=0,n=e.length;if(e[0]<this.parent.minDate&&e[e.length-1]>this.parent.maxDate){for(var r=0;r<e.length;r++)w(e[r]).getTime()===w(new Date(this.parent.minDate)).getTime()&&(i=r),w(e[r]).getTime()===w(new Date(this.parent.maxDate)).getTime()&&(n=r);t=e.filter(function(t){return t>=e[i]&&t<=e[n]})}return t},e.prototype.isValidEvent=function(e,t,i,n){var r=i.getTime()>n.startHour.getTime()&&t.getTime()<n.endHour.getTime(),a=n.startHour.getTime()<=t.getTime()&&e[this.parent.eventFields.startTime].getTime()>=n.startHour.getTime()&&e[this.parent.eventFields.endTime].getTime()<n.endHour.getTime()&&t.getTime()===i.getTime();return r||a},e.prototype.allDayExpandScroll=function(e){var i=0;[].slice.call(this.parent.element.querySelectorAll(".e-header-row")).forEach(function(e){[].slice.call(e.children).forEach(function(e){e.style.top=i+"px"}),i+=e.offsetHeight}),i=e.offsetHeight-i,this.parent.element.querySelector(".e-all-day-cells").style.height=i/12+"em",this.parent.uiStateValues.expand?t.addClass([e],"e-all-day-scroll"):t.removeClass([e],"e-all-day-scroll")},e.prototype.updateEventMinimumDuration=function(e,t,i){if((H(i)-H(t))/ze<this.parent.eventSettings.minimumEventDuration){var n=new Date(t);if(n.setMinutes(n.getMinutes()+this.parent.eventSettings.minimumEventDuration),(i=n).getTime()>e.endHour.getTime()){var r=new Date(e.endHour.getTime());r.setMinutes(r.getMinutes()-this.parent.eventSettings.minimumEventDuration),t=r,i=e.endHour}}return{startDate:t,endDate:i}},e.prototype.unWireEvents=function(){for(var e=0,i=[].slice.call(this.parent.element.querySelectorAll(".e-appointment"));e<i.length;e++){var n=i[e];t.EventHandler.clearEvents(n)}},e.prototype.destroy=function(){this.unWireEvents(),this.parent=null},e}(),At=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vt=function(e){function i(i){var n=e.call(this,i)||this;return n.dateRender=[],n.renderedEvents=[],n.renderedAllDayEvents=[],n.overlapEvents=[],n.moreEvents=[],n.overlapList=[],n.allDayEvents=[],n.slotCount=n.parent.activeViewOptions.timeScale.slotCount,n.interval=n.parent.activeViewOptions.timeScale.interval,n.allDayLevel=0,n.startHour=n.parent.activeView.getStartHour(),n.endHour=n.parent.activeView.getEndHour(),n.element=n.parent.activeView.getPanel(),n.fields=n.parent.eventFields,n.animation=new t.Animation({progress:n.animationUiUpdate.bind(n)}),n.addEventListener(),n}return At(i,e),i.prototype.renderAppointments=function(){if(!t.isNullOrUndefined(this.parent)){this.parent.dragAndDropModule&&this.parent.dragAndDropModule.setDragArea();for(var e=[].slice.call(this.parent.element.querySelectorAll(".e-block-appointment,.e-appointment,.e-row-count-wrapper")),i=!(!this.parent.crudModule||!this.parent.crudModule.crudObj.isCrudAction),n=0,r=e;n<r.length;n++){var a=r[n];if(!i||a.classList.contains("e-all-day-appointment")||a.classList.contains("e-row-count-wrapper"))t.remove(a);else for(var s=parseInt(a.getAttribute("data-group-index"),10),o=0,l=this.parent.crudModule.crudObj.sourceEvent.length;o<l;o++)s!==this.parent.crudModule.crudObj.sourceEvent[o].groupIndex&&s!==this.parent.crudModule.crudObj.targetEvent[o].groupIndex||t.remove(a)}if(this.element.querySelector(".e-work-cells")&&(this.allDayElement=[].slice.call(this.element.querySelectorAll(".e-all-day-cells")),this.setAllDayRowHeight(0),0!==this.parent.eventsProcessed.length||0!==this.parent.blockProcessed.length)){var c=this.element.querySelector(".e-all-day-appointment-section");t.EventHandler.remove(c,"click",this.rowExpandCollapse),t.EventHandler.add(c,"click",this.rowExpandCollapse,this),this.renderedEvents=[],this.renderedAllDayEvents=[],this.initializeValues(),this.processBlockEvents(),this.renderEvents("normalEvents"),this.allDayEvents.length>0&&(this.allDayEvents=this.allDayEvents.filter(function(e,t,i){return t===i.map(function(e){return e.Guid}).indexOf(e.Guid)}),t.removeClass(this.allDayElement,"e-animate"),this.slots.push(this.parent.activeView.renderDates.map(function(e){return+e})),this.renderEvents("allDayEvents")),this.parent.notify(Ue,{}),t.addClass(this.allDayElement,"e-animate"),i&&(this.parent.crudModule.crudObj.isCrudAction=!1),this.parent.renderTemplates()}}},i.prototype.initializeValues=function(){if(this.resources=this.parent.activeViewOptions.group.resources.length>0?this.parent.uiStateValues.isGroupAdaptive?[this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]]:this.parent.resourceBase.lastResourceLevel:[],this.cellHeight=parseFloat(this.parent.element.querySelector(".e-content-wrap tbody tr").getBoundingClientRect().height.toFixed(2)),this.dateRender[0]=this.parent.activeView.renderDates,this.parent.activeViewOptions.group.resources.length>0)for(var e=0,t=this.resources.length;e<t;e++)this.dateRender[e]=this.resources[e].renderDates},i.prototype.getHeight=function(e,t){var i=(H(t)-H(e))/ze*(this.cellHeight*this.slotCount)/this.interval;return i=i<=0?this.cellHeight:i},i.prototype.appendEvent=function(e,i,n,r){var a=[].slice.call(this.element.querySelectorAll(".e-appointment-wrapper"));this.parent.enableRtl?t.setStyleAttribute(i,{right:r}):t.setStyleAttribute(i,{left:r});var s=i.classList.contains("e-block-appointment")?"blockEvent":"event",o={data:t.extend({},e,null,!0),element:i,cancel:!1,type:s};this.parent.trigger("eventRendered",o,function(e){e.cancel||a[n].appendChild(i)})},i.prototype.processBlockEvents=function(){for(var e=0,t=0,i=this.getResourceList();t<i.length;t++)for(var n=i[t],r=this.dateRender[n],a=0,s=r.length;a<s;a++){for(var o=new Date(r[a].getTime()),l=C(r[a],1),c=0,p=this.filterEvents(o,l,this.parent.blockProcessed,this.resources[n]);c<p.length;c++){var h=p[c];this.parent.resourceBase&&this.setValues(h,n),this.renderBlockEvents(h,a,n,e),this.cssClass=null,this.groupOrder=null}e+=1}},i.prototype.renderBlockEvents=function(e,i,n,r){var a=this.isSpannedEvent(e,i,n),s=a[this.fields.startTime],o=a[this.fields.endTime],l=S(w(new Date(this.dateRender[n][i].getTime())),this.startHour,this.endHour);if(s<=o&&this.isValidEvent(e,s,o,l)){var c=void 0,p=void 0;if(a[this.fields.isAllDay]){var h=this.parent.element.querySelector(".e-content-wrap table");p=t.formatUnit(h.offsetHeight),c=t.formatUnit(0)}else p=t.formatUnit(this.getHeight(s,o)),c=t.formatUnit(this.getTopValue(s,i,n));var d=this.createBlockAppointmentElement(e,n);t.setStyleAttribute(d,{width:"100%",height:p,top:c});var u=this.parent.activeViewOptions.group.byDate?this.resources.length*i+n:r;this.appendEvent(e,d,u,"0px")}},i.prototype.renderEvents=function(e){t.removeClass(this.allDayElement,"e-animate");for(var i,n="allDayEvents"===e?this.sortByDateTime(this.allDayEvents):void 0,r=0,a=this,s=0,o=this.getResourceList();s<o.length;s++)!function(s){i=!0,a.parent.crudModule&&a.parent.crudModule.crudObj.isCrudAction&&"allDayEvents"!==e&&!a.parent.uiStateValues.isGroupAdaptive&&0===a.parent.crudModule.crudObj.sourceEvent.filter(function(e){return e.groupIndex===s}).length&&0===a.parent.crudModule.crudObj.targetEvent.filter(function(e){return e.groupIndex===s}).length&&(i=!1),a.slots=[];var o=a.dateRender[s],l=a.getRenderedDates(o)||o;a.slots.push(o.map(function(e){return+e}));for(var c=0,p=o.length;c<p&&o[c]<=l[l.length-1];c++){a.renderedEvents=[];var h=new Date(o[c].getTime()),d=C(o[c],1),u=a.filterEvents(h,d,n,a.resources[s]);if(i)for(var v=0,m=u;v<m.length;v++){var g=m[v];if(a.parent.resourceBase&&a.setValues(g,s),"allDayEvents"===e)a.renderAllDayEvents(g,c,s,r);else if(a.isAllDayAppointment(g))a.allDayEvents.push(t.extend({},g,null,!0));else{if(a.parent.eventSettings.enableMaxHeight&&a.getOverlapIndex(g,c,!1,s)>0)continue;a.renderNormalEvents(g,c,s,r)}a.cssClass=null,a.groupOrder=null}else for(var f=0,y=u;f<y.length;f++){var T=y[f];a.isAllDayAppointment(T)&&a.allDayEvents.push(t.extend({},T,null,!0))}r+=1}}(o[s])},i.prototype.setValues=function(e,t){this.parent.activeViewOptions.group.resources.length>0?(this.cssClass=this.resources[t].cssClass,this.groupOrder=this.resources[t].groupOrder):this.cssClass=this.parent.resourceBase.getCssClass(e)},i.prototype.getResourceList=function(){return Array.apply(null,{length:this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive?this.resources.length:1}).map(function(e,t){return t})},i.prototype.createAppointmentElement=function(e,i,n,r){var a=this.parent.eventFields,s=e[a.subject]||this.parent.eventSettings.fields.subject.default||this.parent.localeObj.getConstant("addTitle"),o=t.createElement("div",{className:"e-appointment",attrs:{"data-id":"Appointment_"+e[a.id],"data-guid":e.Guid,role:"button",tabindex:"0","aria-readonly":this.parent.eventBase.getReadonlyAttribute(e),"aria-selected":"false","aria-grabbed":"true","aria-label":this.parent.getAnnouncementString(e)}});e[this.fields.isReadonly]&&t.addClass([o],"e-read-only");var l=t.createElement("div",{className:"e-appointment-details"});if(o.appendChild(l),this.parent.activeViewOptions.group.resources.length>0){var c=this.parent.uiStateValues.isGroupAdaptive?this.parent.uiStateValues.groupIndex:r;o.setAttribute("data-group-index",c.toString())}var p,h=n;if(t.isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)){var d=t.createElement("div",{className:"e-subject",innerHTML:s});if(i)if(e[a.isAllDay])p=[d];else{p=[];var u=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(e[a.startTime])}),v=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(e[a.endTime])});t.addClass([d],"e-text-center"),h.isLeft||p.push(u),p.push(d),h.isRight||p.push(v)}else{var m=this.parent.getTimeString(e[a.startTime])+" - "+this.parent.getTimeString(e[a.endTime]);p=[d,t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:m}),t.createElement("div",{className:"e-location",innerHTML:e[a.location]||this.parent.eventSettings.fields.location.default||""})]}}else{var g=this.parent.element.id+"_"+this.parent.activeViewOptions.eventTemplateName+"eventTemplate",f=this.parent.uiStateValues.isGroupAdaptive?this.parent.uiStateValues.groupIndex:r,y="eventTemplate"+(this.parent.activeViewOptions.group.resources.length>0?"_"+f:"");p=this.parent.getAppointmentTemplate()(e,this.parent,y,g,!1)}if(t.append(p,l),!(this.parent.isAdaptive||t.isNullOrUndefined(e[a.recurrenceRule])&&t.isNullOrUndefined(e[a.recurrenceID]))){var T=e[a.id]===e[a.recurrenceID]?"e-recurrence-icon":"e-recurrence-edit-icon",w=t.createElement("div",{className:Ge+" "+T});i?l.appendChild(w):o.appendChild(w)}return this.renderSpannedIcon(i?l:o,h),t.isNullOrUndefined(this.cssClass)||t.addClass([o],this.cssClass),this.applyResourceColor(o,e,"backgroundColor",this.groupOrder),this.renderResizeHandler(o,h,e[this.fields.isReadonly]),o},i.prototype.createMoreIndicator=function(e,i,n){var r=n+i,a=e[r];if(a.childElementCount<=0){var s=t.createElement("div",{className:"e-row-count-wrapper",id:"e-row-count-wrapper-"+r.toString()}),o=t.createElement("div",{className:"e-more-indicator",attrs:{tabindex:"0",role:"list","data-index":r.toString(),"data-count":"1"},innerHTML:"+1&nbsp;"+(this.parent.isAdaptive?"":this.parent.localeObj.getConstant("more"))});s.appendChild(o),a.appendChild(s),t.EventHandler.add(o,"click",this.rowExpandCollapse,this)}else{var l=a.querySelector(".e-more-indicator"),c=parseInt(l.getAttribute("data-count"),10)+1;l.setAttribute("data-count",c.toString()),l.innerHTML="+"+this.parent.globalize.formatNumber(c)+"&nbsp;"+(this.parent.isAdaptive?"":this.parent.localeObj.getConstant("more"))}},i.prototype.renderSpannedIcon=function(e,i){var n=t.createElement("div",{className:"e-indicator "+Ge});if(i.isLeft){var r=n.cloneNode();t.addClass([r],"e-left-icon"),t.prepend([r],e)}if(i.isRight){var a=n.cloneNode();t.addClass([a],"e-right-icon"),t.append([a],e)}if(i.isTop){var s=n.cloneNode();t.addClass([s],"e-up-icon"),t.prepend([s],e)}if(i.isBottom){var o=n.cloneNode();t.addClass([o],"e-down-icon"),t.append([o],e)}},i.prototype.isSpannedEvent=function(e,i,n){var r=w(this.dateRender[n][i]),a=this.getRenderedDates(this.dateRender[n])||[r];0===a.filter(function(e){return e.getDay()===i}).length&&(r=w(a[0]));var s=this.parent.eventFields,o=S(r,this.startHour,this.endHour),l=t.extend({},e,null,!0);l.isSpanned={isBottom:!1,isTop:!1},e[s.startTime].getTime()<o.startHour.getTime()&&(l[s.startTime]=o.startHour,l.isSpanned.isTop=!0),e[s.endTime].getTime()>o.endHour.getTime()&&(l[s.endTime]=o.endHour,l.isSpanned.isBottom=!0);var c=this.updateEventMinimumDuration(o,l[s.startTime],l[s.endTime]);return l[s.startTime]=c.startDate,l[s.endTime]=c.endDate,l},i.prototype.renderAllDayEvents=function(e,i,n,r,a){var s=this,o=this.getRenderedDates(this.dateRender[n])||this.dateRender[n];this.parent.activeViewOptions.group.byDate&&(this.slots[0]=[this.dateRender[n][i].getTime()],o=[this.dateRender[n][i]]);var l=this.splitEvent(e,o)[0],c=this.element.querySelector(".e-all-day-cells:first-child"),p=c.offsetTop,h=new Date(l[this.parent.eventFields.startTime].getTime()),d=new Date(l[this.parent.eventFields.endTime].getTime()),u=0,v=1,m=o[0].getTime()<=h.getTime()&&C(o.slice(-1)[0],1).getTime()>=h.getTime();if(h<=d&&m){var g=[];if(this.renderedAllDayEvents[n]&&(g=this.renderedAllDayEvents[n].filter(function(t){return t.Guid===e.Guid}),this.parent.activeViewOptions.group.byDate&&(g=g.filter(function(e){return e[s.parent.eventFields.startTime]>=o[i]&&e[s.parent.eventFields.endTime]<=C(new Date(+o[i]),1)}))),0===g.length){var f=l.data.count,y=this.getOverlapIndex(l,i,!0,n);l.Index=y,this.allDayLevel=this.allDayLevel<y?y:this.allDayLevel;var T=l.data.isRight?0:"Day"===this.parent.currentView?4:7;f>=0&&(u=100*f-T),t.isNullOrUndefined(this.renderedAllDayEvents[n])&&(this.renderedAllDayEvents[n]=[]),this.renderedAllDayEvents[n].push(t.extend({},l,null,!0));var w,D=[].slice.call(this.element.querySelector(".e-all-day-row").children),b=this.parent.activeViewOptions.group.byDate?this.resources.length*i+n:r,O=this.element.querySelector(".e-all-day-appointment-wrapper:nth-child("+(b+1)+")");w=a?this.parent.inlineModule.createInlineAppointmentElement(e):this.createAppointmentElement(e,!0,l.data,n),t.addClass([w],"e-all-day-appointment");var E=t.extend({},l.data,null,!0);e.data=E;var S={data:e,element:w,cancel:!1};this.parent.trigger("eventRendered",S,function(i){if(!i.cancel){O.appendChild(w);var n=w.offsetHeight;if(v+=(0===y?p:p+y*n)+1,t.setStyleAttribute(w,{width:u+"%",top:t.formatUnit(v)}),y>1){s.moreEvents.push(w);for(var r=0,a=f;r<a;r++)s.createMoreIndicator(D,r,b)}c.setAttribute("data-count",s.allDayLevel.toString());var o=4+(!s.parent.uiStateValues.expand&&s.allDayLevel>2?3*n:(s.allDayLevel+1)*n);s.setAllDayRowHeight(o),s.addOrRemoveClass(),s.wireAppointmentEvents(w,e)}})}}},i.prototype.renderNormalEvents=function(e,i,n,r,a){var s=this.isSpannedEvent(e,i,n),o=s[this.fields.startTime],l=s[this.fields.endTime],c="0%",p=0,h=S(w(new Date(this.dateRender[n][i].getTime())),this.startHour,this.endHour),d=this.isValidEvent(e,o,l,h);if(o<=l&&d){var u=this.getHeight(o,l);o.getTime()>h.startHour.getTime()&&(p=this.getTopValue(o,i,n));var v=this.getOverlapIndex(s,i,!1,n);s.Index=v,this.overlapList.push(s),this.overlapList.length>1?(t.isNullOrUndefined(this.overlapEvents[v])&&(this.overlapEvents[v]=[]),this.overlapEvents[v].push(s)):(this.overlapEvents=[],this.overlapEvents.push([s]));var m={index:v,left:"0%",width:c=this.getEventWidth(),day:i,dayIndex:r,record:s,resource:n},g=this.adjustOverlapElements(m);c=g.appWidth,t.isNullOrUndefined(this.renderedEvents[n])&&(this.renderedEvents[n]=[]),this.renderedEvents[n].push(t.extend({},s,null,!0));var f=void 0;f=a?this.parent.inlineModule.createInlineAppointmentElement(e):this.createAppointmentElement(e,!1,s.isSpanned,n),t.setStyleAttribute(f,{width:this.parent.eventSettings.enableMaxHeight?"100%":g.appWidth,height:u+"px",top:p+"px"});var y=15*f.querySelectorAll(".e-indicator").length,T=u-40-y,D=f.querySelector(".e-subject");!this.parent.isAdaptive&&D&&(D.style.maxHeight=t.formatUnit(T));var b=this.parent.activeViewOptions.group.byDate?this.resources.length*i+n:r,C={};C[this.fields.startTime]=e[this.fields.startTime],C[this.fields.endTime]=e[this.fields.endTime],s.data=C,this.appendEvent(s,f,b,g.appLeft),this.wireAppointmentEvents(f,e),u<this.cellHeight&&[].slice.call(f.querySelectorAll(".e-event-resize")).forEach(function(e){e.style.height=Math.ceil(u/e.offsetHeight)+"px"})}},i.prototype.getEventWidth=function(){var e=(("Day"===this.parent.currentView?97:94)-this.overlapEvents.length)/this.overlapEvents.length;return(e<0?0:e)+"%"},i.prototype.getEventLeft=function(e,t){var i=(parseFloat(e)+1)*t;return(i>99?99:i)+"%"},i.prototype.getTopValue=function(e,t,i){var n=S(w(this.dateRender[i][t]),this.startHour,this.endHour).startHour,r=60*(e.getHours()-n.getHours())+(e.getMinutes()-n.getMinutes());return this.parent.activeViewOptions.timeScale.enable?r*this.cellHeight*this.slotCount/this.interval:0},i.prototype.getOverlapIndex=function(e,i,n,r){var a=this,s=this.parent.eventFields,o=[],l=-1;if(this.overlapEvents=[],n){if(!t.isNullOrUndefined(this.renderedAllDayEvents[r])){var c=w(new Date(this.dateRender[r][i].getTime()));o=this.renderedAllDayEvents[r].filter(function(e){return w(e[s.startTime]).getTime()<=c.getTime()&&w(e[s.endTime]).getTime()>=c.getTime()}),this.parent.activeViewOptions.group.resources.length>0&&(o=this.filterEventsByResource(this.resources[r],o))}}else{var p=t.isNullOrUndefined(this.renderedEvents[r])?[]:this.renderedEvents[r],h=[],d=e[s.startTime],u=e[s.endTime];this.overlapList=p.filter(function(e){return e[s.endTime]>d&&e[s.startTime]<=u||e[s.startTime]>=u&&e[s.endTime]<=d||e[s.endTime].getTime()===e[s.startTime].getTime()&&e[s.startTime].getTime()===d.getTime()&&e[s.endTime]<u}),this.parent.activeViewOptions.group.resources.length>0&&(this.overlapList=this.filterEventsByResource(this.resources[r],this.overlapList)),this.overlapList.forEach(function(e){var t=p.filter(function(t){return t[s.endTime]>e[s.startTime]&&t[s.startTime]<=e[s.endTime]});a.parent.activeViewOptions.group.resources.length>0&&(t=a.filterEventsByResource(a.resources[r],t));var i=t.filter(function(e){return-1===a.overlapList.indexOf(e)});i.length>0&&(h=h.concat(i))});for(var v=0;v<h.length-1;v++)for(var m=v+1;m<h.length;m++)h[v][s.id]===h[m][s.id]&&(h.splice(m,1),m--);this.overlapList=this.overlapList.concat(h);for(var g=0,f=o=this.overlapList;g<f.length;g++){var y=f[g],T=y.Index;t.isNullOrUndefined(this.overlapEvents[T])?this.overlapEvents[T]=[y]:this.overlapEvents[T].push(y)}}if(n||(o=o.filter(function(t){return t[s.startTime]===e[s.startTime]&&t[s.endTime]>e[s.endTime]||t[s.endTime]>e[s.startTime]&&t[s.startTime]<e[s.endTime]||t[s.endTime]===e[s.startTime]&&t[s.startTime]===e[s.endTime]||t[s.startTime].getTime()===e[s.startTime].getTime()&&t[s.endTime].getTime()===e[s.endTime].getTime()||t[s.startTime].getTime()===e[s.startTime].getTime()&&t[s.endTime].getTime()<e[s.endTime].getTime()||t[s.endTime].getTime()>e[s.endTime].getTime()})),o.length>0){var D=o.map(function(e){return e.Index});l=D.length>0?this.getSmallestMissingNumber(D):0}return-1===l?0:l},i.prototype.adjustOverlapElements=function(e){for(var i={appWidth:e.width,appLeft:e.left},n=0,r=this.overlapEvents.length;n<r;n++)if(!t.isNullOrUndefined(this.overlapEvents[n]))for(var a=0,s=this.overlapEvents[n].length;a<s;a++){var o=this.parent.activeViewOptions.group.byDate?this.resources.length*e.day+e.resource:e.dayIndex,l=this.element.querySelector("#e-appointment-wrapper-"+o);if(l.childElementCount>0){var c=this.overlapEvents[n][a].Guid;if(l.querySelectorAll('div[data-guid="'+c+'"]').length>0&&c!==e.record.Guid){var p=l.querySelector('div[data-guid="'+c+'"]');parseFloat(e.width)<=parseFloat(p.style.width)?(this.parent.enableRtl?p.style.right=this.getEventLeft(e.width,n):p.style.left=this.getEventLeft(e.width,n),p.style.width=parseFloat(e.width)+"%",i.appWidth=p.style.width):i.appWidth=p.style.width}else{var h=e.width;t.isNullOrUndefined(this.overlapEvents[n-1])&&(h=this.getEventWidth()),i.appWidth=h,i.appLeft=this.getEventLeft(h,e.index)}}}return i},i.prototype.setAllDayRowHeight=function(e){var i=this.parent.element.querySelector(".e-date-header-wrap");"auto"!==this.parent.height&&this.parent.enableAllDayScroll||t.addClass([i],"e-all-day-auto");var n=this.parent.element.querySelector(".e-all-day-row");if(n.style.height="",this.parent.uiStateValues.expand&&"auto"!==this.parent.height&&this.parent.enableAllDayScroll)n.style.height=e/12+"em",this.parent.eventBase.allDayExpandScroll(i);else{i.scrollTop=0;for(var r=0,a=this.allDayElement;r<a.length;r++)a[r].style.height=e/12+"em";t.removeClass([i],"e-all-day-scroll")}this.animation.animate(this.allDayElement[0])},i.prototype.addOrRemoveClass=function(){var e=this;this.moreEvents.filter(function(i){!e.parent.uiStateValues.expand&&e.allDayLevel>2?(t.addClass([i],"e-appointment-hide"),i.setAttribute("tabindex","-1")):(t.removeClass([i],"e-appointment-hide"),i.setAttribute("tabindex","0"))});var i=this.element.querySelector(".e-all-day-appointment-section");this.parent.uiStateValues.expand?(t.removeClass([i],"e-appointment-expand"),t.addClass([i],"e-appointment-collapse")):(t.removeClass([i],"e-appointment-collapse"),t.addClass([i],"e-appointment-expand")),this.allDayLevel>2?t.removeClass([i],"e-disable"):t.addClass([i],"e-disable"),[].slice.call(this.element.querySelectorAll(".e-row-count-wrapper")).forEach(function(i){!e.parent.uiStateValues.expand&&e.allDayLevel>2?t.removeClass([i],"e-disable"):t.addClass([i],"e-disable")})},i.prototype.getEventHeight=function(){var e=t.createElement("div",{className:"e-appointment",styles:"visibility:hidden"});this.element.querySelector(".e-all-day-appointment-wrapper:first-child").appendChild(e);var i=e.offsetHeight;return t.remove(e),i},i.prototype.rowExpandCollapse=function(){var e=this.element.querySelector(".e-all-day-appointment-section");this.parent.uiStateValues.expand=e.classList.contains("e-appointment-expand");var t;this.parent.uiStateValues.expand?(e.setAttribute("title",this.parent.localeObj.getConstant("collapseAllDaySection")),e.setAttribute("aria-label","Collapse section"),t=(this.allDayLevel+1)*this.getEventHeight()+4):(e.setAttribute("title",this.parent.localeObj.getConstant("expandAllDaySection")),e.setAttribute("aria-label","Expand section"),t=3*this.getEventHeight()+4),this.setAllDayRowHeight(t),this.addOrRemoveClass(),this.animation.animate(e)},i.prototype.animationUiUpdate=function(){this.parent.notify(Ue,{})},i.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||(this.removeEventListener(),this.allDayElement=null,this.renderedAllDayEvents=null,this.renderedEvents=null,this.slotCount=null,this.interval=null,this.startHour=null,this.endHour=null,this.element=null,this.fields=null,this.animation=null,e.prototype.destroy.call(this))},i}(xt),kt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Mt=function(e){function i(t){var i=e.call(this,t)||this;return i.renderedEvents=[],i.monthHeaderHeight=0,i.moreIndicatorHeight=19,i.renderType="day",i.element=i.parent.activeView.getPanel(),i.fields=i.parent.eventFields,i.maxHeight=i.parent.eventSettings.enableMaxHeight&&!i.parent.eventSettings.enableIndicator&&!i.parent.rowAutoHeight,i.withIndicator=i.parent.eventSettings.enableMaxHeight&&i.parent.eventSettings.enableIndicator&&!i.parent.rowAutoHeight,i.maxOrIndicator=i.maxHeight||i.withIndicator,i.moreIndicatorHeight=i.parent.rowAutoHeight&&i.parent.eventSettings.ignoreWhitespace?0:i.moreIndicatorHeight,i.addEventListener(),i}return kt(i,e),i.prototype.removeEventWrapper=function(e){if(e.length>0)for(var i=0,n=e="Month"===this.parent.currentView?e:[e[0]];i<n.length;i++){var r=n[i];!r.classList.contains("e-more-indicator")&&r.parentElement&&r.parentElement.parentNode&&t.remove(r.parentElement)}},i.prototype.renderAppointments=function(){this.parent.dragAndDropModule&&this.parent.dragAndDropModule.setDragArea();var e=this.parent.element.querySelector(".e-content-wrap");this.parent.rowAutoHeight&&(this.parent.uiStateValues.top=e.scrollTop,this.parent.uiStateValues.left=e.scrollLeft);var i=[].slice.call(this.element.querySelectorAll(".e-appointment-wrapper"));if(this.parent.crudModule&&this.parent.crudModule.crudObj.isCrudAction)for(var n=0,r=this.parent.crudModule.crudObj.sourceEvent.length;n<r;n++){var a=[].slice.call(this.element.querySelectorAll('.e-appointment-wrapper [data-group-index="'+this.parent.crudModule.crudObj.sourceEvent[n].groupIndex+'"]'));if(this.removeEventWrapper(a),this.parent.crudModule.crudObj.targetEvent[n]&&this.parent.crudModule.crudObj.sourceEvent[n].groupIndex!==this.parent.crudModule.crudObj.targetEvent[n].groupIndex){var s=[].slice.call(this.element.querySelectorAll('.e-appointment-wrapper [data-group-index="'+this.parent.crudModule.crudObj.targetEvent[n].groupIndex+'"]'));this.removeEventWrapper(s)}}else for(var o=0,l=i;o<l.length;o++){var c=l[o];t.remove(c)}if(this.removeHeightProperty(Qe),this.element.querySelector(".e-work-cells")){if("Month"===this.parent.currentView){var p=t.createElement("div",{className:"e-appointment-wrapper"}),d=this.parent.element.querySelector(".e-work-cells");d.appendChild(p),this.monthHeaderHeight=p.offsetTop-d.offsetTop,d.removeChild(p)}this.eventHeight=h(this.element,"e-appointment");var u=e.scrollTop;if(this.parent.rowAutoHeight&&this.parent.virtualScrollModule&&!t.isNullOrUndefined(this.parent.currentAction)&&(e.scrollTop=e.scrollTop-1),this.parent.activeViewOptions.group.resources.length>0?(this.renderResourceEvents(),this.parent.virtualScrollModule&&this.parent.virtualScrollModule.updateFocusedWorkCell()):this.renderEventsHandler(this.parent.activeView.renderDates,this.parent.activeViewOptions.workDays),this.parent.rowAutoHeight){this.updateBlockElements();var v={cssProperties:this.parent.getCssProperties(),module:this.parent.getModuleName(),isPreventScrollUpdate:!0,scrollPosition:{left:this.parent.uiStateValues.left,top:this.parent.uiStateValues.top}};if(this.parent.virtualScrollModule&&(this.parent.currentAction?(e.scrollTop=u,this.parent.currentAction=null):this.parent.virtualScrollModule.updateVirtualScrollHeight()),this.parent.enablePersistence||this.parent.notify(Ue,{}),this.parent.notify(Be,v),"Month"===this.parent.currentView&&this.parent.showWeekNumber){var m=[].slice.call(this.parent.element.querySelectorAll(".e-content-wrap table tr td:first-child"));[].slice.call(this.parent.element.querySelectorAll(".e-week-number")).forEach(function(e,i){var n=m[i].offsetHeight;t.setStyleAttribute(e,{height:n+"px"})}),this.parent.element.querySelector(".e-week-number-wrapper").scrollTop=this.parent.element.querySelector(".e-content-wrap").scrollTop}}this.parent.renderTemplates()}},i.prototype.renderEventsHandler=function(e,i,n){this.renderedEvents=[];var r,a,s=0;if(n?(s=n.groupIndex,this.cssClass=n.cssClass,this.groupOrder=n.groupOrder,r=this.parent.eventBase.filterEventsByResource(n,this.parent.eventsProcessed),a=this.parent.eventBase.filterEventsByResource(n,this.parent.blockProcessed),this.workCells=[].slice.call(this.element.querySelectorAll('.e-work-cells[data-group-index="'+s+'"]'))):(r=this.parent.eventsProcessed,a=this.parent.blockProcessed,this.workCells=[].slice.call(this.element.querySelectorAll(".e-work-cells"))),this.sortByDateTime(r),this.sortByDateTime(a),"Month"===this.parent.currentView&&this.parent.rowAutoHeight&&0===this.parent.activeViewOptions.group.resources.length){var o=[].slice.call(this.parent.element.querySelectorAll(".e-content-wrap table tr td:first-child")),l="auto"===this.parent.height?(this.parent.element.querySelector(".e-content-wrap").clientHeight+this.parent.element.querySelector(".e-date-header-wrap").clientHeight)/o.length:this.parent.element.querySelector(".e-schedule-table").clientHeight/o.length;o.forEach(function(e){t.setStyleAttribute(e,{height:l+"px"})})}var c=this.workCells[this.parent.activeView.isTimelineView()?0:this.workCells.length-1].getBoundingClientRect();this.cellWidth=c.width,this.cellHeight=c.height,this.dateRender=e;var p=this.getRenderedDates(e);this.getSlotDates(i||this.parent.activeViewOptions.workDays),this.processBlockEvents(a,s,n);for(var h=0,d=r;h<d.length;h++){var u=d[h];this.parent.resourceBase&&!n&&(this.cssClass=this.parent.resourceBase.getCssClass(u));for(var v=0,m=this.splitEvent(u,p||this.dateRender);v<m.length;v++){var g=m[v];if(this.maxHeight){var f="Month"===this.parent.currentView?g[this.fields.startTime]:this.getStartTime(g,g.data);if(this.getIndex(f)>0)continue}this.updateIndicatorIcon(g),this.renderEvents(g,s,r)}}this.cssClass=null,this.groupOrder=null},i.prototype.processBlockEvents=function(e,i,n){for(var r=0,a=e;r<a.length;r++){var s=a[r];this.parent.resourceBase&&!n&&(this.cssClass=this.parent.resourceBase.getCssClass(s));var o=[];if("day"!==this.renderType||s[this.fields.isAllDay])o.push(s);else{var l=t.extend({},s,null,!0),c=this.isSameDate(l[this.fields.startTime],l[this.fields.endTime]);if(l.isBlockIcon=c,!c&&D(l[this.fields.startTime])>0&&((p=t.extend({},s,null,!0))[this.fields.endTime]=C(w(new Date(s[this.fields.startTime]+"")),1),p.isBlockIcon=!0,l[this.fields.startTime]=p[this.fields.endTime],o.push(p)),!(c=this.isSameDate(l[this.fields.startTime],l[this.fields.endTime]))&&D(l[this.fields.endTime])>0){var p=t.extend({},s,null,!0);p[this.fields.startTime]=w(new Date(s[this.fields.endTime]+"")),p.isBlockIcon=!0,o.push(p),l[this.fields.endTime]=p[this.fields.startTime]}o.push(l)}for(var h=0,d=o;h<d.length;h++)for(var u=d[h],v=0,m=this.splitEvent(u,this.dateRender);v<m.length;v++){var g=m[v];this.renderBlockEvents(g,i,!!u.isBlockIcon)}}},i.prototype.isSameDate=function(e,t){return new Date(+e).setHours(0,0,0,0)===new Date(+t).setHours(0,0,0,0)},i.prototype.renderBlockEvents=function(e,i,n){var r=e.data,a=this.getStartTime(e,r),s=this.getEndTime(e,r),o=this.parent.getIndexOfDate(this.dateRender,w(new Date(a.getTime())));if(!(o<0||a>s)){var l=this.getCellTd(o),c=this.getPosition(a,s,e[this.fields.isAllDay],o);if(n)this.renderBlockIndicator(l,c,i);else{var p=r.count,h=this.getEventWidth(a,s,e[this.fields.isAllDay],p);h=h<=0?this.cellWidth:h;var d=this.parent.enableRtl?0:c,u=this.parent.enableRtl?c:0,v=this.cellHeight-this.monthHeaderHeight,m=this.getRowTop(i),g=this.createBlockAppointmentElement(e,i);t.setStyleAttribute(g,{width:h+"px",height:v+"px",left:d+"px",right:u+"px",top:m+"px"}),this.renderEventElement(e,g,l)}}},i.prototype.renderBlockIndicator=function(e,i,n){var r=t.createElement("div",{className:"e-icons e-block-indicator"});t.isNullOrUndefined(e.querySelector(".e-block-indicator"))&&e.appendChild(r)},i.prototype.getStartTime=function(e,t){return e[this.fields.startTime]},i.prototype.getEndTime=function(e,t){return e[this.fields.endTime]},i.prototype.getCellTd=function(e){return this.workCells[e]},i.prototype.getEventWidth=function(e,t,i,n){return n*this.cellWidth-1},i.prototype.getPosition=function(e,t,i,n){return 0},i.prototype.getRowTop=function(e){return 0},i.prototype.updateIndicatorIcon=function(e){if(-1!==this.parent.currentView.indexOf("Timeline")&&"TimelineMonth"!==this.parent.currentView&&!e[this.fields.isAllDay]){var t=e.data,i=this.parent.activeView.getStartHour(),n=this.parent.activeView.getEndHour(),r=S(e[this.fields.startTime],i,n),a=S(e[this.fields.endTime],i,n),s=t[this.fields.startTime],o=t[this.fields.endTime];if(t.isLeft=t.isLeft||s.getTime()<r.startHour.getTime(),t.isRight=t.isRight||o.getTime()>a.endHour.getTime(),w(s).getTime()!==w(o).getTime()){var l=r.startHour,c=a.endHour,p=new Date(w(s));if(p.setHours(c.getHours(),c.getMinutes(),c.getSeconds()),t.isLeft=t.isLeft||s.getTime()>=(l.getDate()===r.endHour.getDate()?p.getTime():C(p,1).getTime()),o.getTime()!==w(o).getTime()){var h=new Date(w(o));t.isRight=t.isRight||o.getTime()<=h.setHours(l.getHours(),l.getMinutes(),l.getSeconds())}}}},i.prototype.renderResourceEvents=function(){var e=this.parent.uiStateValues.isGroupAdaptive?[this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]]:this.parent.resourceBase.lastResourceLevel;if(this.parent.crudModule&&this.parent.crudModule.crudObj.isCrudAction){for(var t=0,i=this.parent.crudModule.crudObj.sourceEvent.length;t<i;t++){var n=this.parent.crudModule.crudObj.sourceEvent[t];if(this.renderEventsHandler(n.renderDates,n.workDays,n),this.parent.crudModule.crudObj.sourceEvent[t].groupIndex!==this.parent.crudModule.crudObj.targetEvent[t].groupIndex){var r=this.parent.crudModule.crudObj.targetEvent[t];this.renderEventsHandler(r.renderDates,r.workDays,r)}}this.parent.crudModule.crudObj.isCrudAction=!1}else for(var a=0,s=e;a<s.length;a++){var o=s[a];this.renderEventsHandler(o.renderDates,o.workDays,o)}},i.prototype.getSlotDates=function(e){this.slots=[];for(var t=this.dateRender.map(function(e){return+e}),i=this.parent.activeViewOptions.showWeekend?7:e.length;t.length>0;)this.slots.push(t.splice(0,i))},i.prototype.createAppointmentElement=function(e,i,n){void 0===n&&(n=!1);var r=e[this.fields.subject]||this.parent.eventSettings.fields.subject.default||this.parent.localeObj.getConstant("addTitle"),a=t.extend({},e,e.data,!0),s={"data-id":"Appointment_"+e[this.fields.id],role:"button",tabindex:"0","aria-readonly":this.parent.eventBase.getReadonlyAttribute(e),"aria-selected":"false","aria-grabbed":"true","aria-label":this.parent.getAnnouncementString(a,r)};n||(s["data-guid"]=e.Guid),this.parent.activeViewOptions.group.resources.length>0&&(s["data-group-index"]=i.toString());var o=t.createElement("div",{className:"e-appointment",attrs:s});t.isNullOrUndefined(this.cssClass)||t.addClass([o],this.cssClass),e[this.fields.isReadonly]&&t.addClass([o],"e-read-only");var l=t.createElement("div",{className:"e-appointment-details"});o.appendChild(l);var c,p=e.data,h=this.getEventData(e);if(t.isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)){var d=e[this.fields.location]||this.parent.eventSettings.fields.location.default||"",u=t.createElement("div",{className:"e-subject",innerHTML:r+(d?";&nbsp"+d:"")}),v=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(p[this.fields.startTime])}),m=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(p[this.fields.endTime])});if("Month"===this.parent.currentView)e[this.fields.isAllDay]?(c=[u],t.addClass([u],"e-text-center")):p.count<=1&&!p.isLeft&&!p.isRight?c=[v,u]:(c=[],t.addClass([u],"e-text-center"),p.isLeft||c.push(v),c.push(u),p.isRight||c.push(m));else{var g=void 0;if(e[this.fields.isAllDay])g=[u,t.createElement("div",{className:"e-time",innerHTML:this.parent.localeObj.getConstant("allDay")})];else{var f=this.parent.getTimeString(p[this.fields.startTime])+" - "+this.parent.getTimeString(p[this.fields.endTime]);g=[u,t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:f}),t.createElement("div",{className:"e-location",innerHTML:d})]}var y=t.createElement("div",{className:"e-inner-wrap"});t.append(g,y),c=[y]}}else{var T=this.parent.element.id+"_"+this.parent.activeViewOptions.eventTemplateName+"eventTemplate",w="eventTemplate"+(this.parent.activeViewOptions.group.resources.length>0?"_"+i:"");c=this.parent.getAppointmentTemplate()(h,this.parent,w,T,!1)}return t.append(c,l),this.appendEventIcons(e,l),this.renderResizeHandler(o,e.data,e[this.fields.isReadonly]),o},i.prototype.appendEventIcons=function(e,i){var n=e.data;if(!t.isNullOrUndefined(e[this.fields.recurrenceRule])||!t.isNullOrUndefined(e[this.fields.recurrenceID])){var r=e[this.fields.id]===e[this.fields.recurrenceID]?"e-recurrence-icon":"e-recurrence-edit-icon";i.appendChild(t.createElement("div",{className:Ge+" "+r+(this.parent.isAdaptive?" e-disable":"")}))}if(n.isLeft){var a=t.createElement("div",{className:"e-indicator e-icons e-left-icon"});t.prepend([a],i)}if(n.isRight){var s=t.createElement("div",{className:"e-indicator e-icons e-right-icon"});t.append([s],i)}},i.prototype.renderEvents=function(e,i,n){var r=e[this.fields.startTime],a=e[this.fields.endTime],s=this.parent.getIndexOfDate(this.dateRender,w(r));if(!(s<0||r.getTime()<this.parent.minDate.getTime()||a.getTime()>this.parent.maxDate.getTime())){var o=this.getIndex(r);e.Index=o;var l=this.eventHeight;this.renderedEvents.push(t.extend({},e,null,!0));var c=e.data.count;if(r.getTime()<=a.getTime()){var p=c*this.cellWidth-5,h=this.workCells[s],d=o*(l+0),u=this.monthHeaderHeight+(o+1)*(l+0)+this.moreIndicatorHeight,v=this.maxOrIndicator?o<1:this.cellHeight>u;if(this.parent.rowAutoHeight||v){var m=void 0;if(m=this.inlineValue?this.parent.inlineModule.createInlineAppointmentElement():this.createAppointmentElement(e,i),this.applyResourceColor(m,e,"backgroundColor",this.groupOrder),this.wireAppointmentEvents(m,e),t.setStyleAttribute(m,{width:p+"px",top:d+"px"}),this.renderEventElement(e,m,h),this.parent.rowAutoHeight){var g=h.parentElement.firstElementChild;this.updateCellHeight(g,u)}}else for(var f=0;f<c;f++){var y=this.workCells[s+f];if(y&&t.isNullOrUndefined(y.querySelector(".e-more-indicator"))){var T=new Date(this.dateRender[s+f].getTime()),D=C(this.dateRender[s+f],1),b=y.getAttribute("data-group-index"),O=this.getFilteredEvents(T,D,b),E=this.cellHeight-this.monthHeaderHeight-this.moreIndicatorHeight;l=this.withIndicator?E:l;var S=Math.floor(E/(l+0)),x=O.length-S<=0?1:O.length-S,A=this.getMoreIndicatorElement(x,T,D);t.isNullOrUndefined(b)||A.setAttribute("data-group-index",b),A.style.top=E+"px",A.style.width=this.cellWidth-2+"px",this.renderElement(y,A),t.EventHandler.add(A,"click",this.moreIndicatorClick,this)}}}}},i.prototype.updateCellHeight=function(e,i){i>e.offsetHeight&&t.setStyleAttribute(e,{height:i+"px"})},i.prototype.updateBlockElements=function(){for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-block-appointment"));e<i.length;e++){var n=i[e],r=t.closest(n,"tr");this.monthHeaderHeight=n.offsetParent.offsetTop-r.offsetTop,n.style.height=r.offsetHeight-1-this.monthHeaderHeight+"px";var a=r.firstElementChild,s=Math.round(n.offsetWidth/a.offsetWidth);n.style.width=a.offsetWidth*s+"px"}},i.prototype.getFilteredEvents=function(e,i,n,r){var a;if(t.isNullOrUndefined(n))a=this.filterEvents(e,i);else{var s=this.parent.resourceBase.lastResourceLevel[parseInt(n,10)];a=this.filterEvents(e,i,t.isNullOrUndefined(r)?void 0:r,s)}return a},i.prototype.getOverlapEvents=function(e,t){for(var i=[],n=0,r=t;n<r.length;n++){var a=r[n],s=w(e).getTime();w(a[this.fields.startTime]).getTime()<=s&&w(a[this.fields.endTime]).getTime()>=s&&i.push(a)}return i},i.prototype.getIndex=function(e){var t=-1,i=this.renderedEvents;if(i.length>0){var n=this.getOverlapEvents(e,i).map(function(e){return e.Index});t=n.length>0?this.getSmallestMissingNumber(n):0}return-1===t?0:t},i.prototype.moreIndicatorClick=function(e){var i=this,n=t.closest(e.target,".e-more-indicator"),r=new Date(parseInt(n.getAttribute("data-start-date"),10)),a=new Date(parseInt(n.getAttribute("data-end-date"),10)),s=n.getAttribute("data-group-index"),o={cancel:!1,event:e,element:n,isPopupOpen:!0,startTime:r,endTime:a,viewName:this.parent.getNavigateView()};s&&(o.groupIndex=parseInt(s,10)),this.parent.trigger("moreEventsClick",o,function(t){if(!t.cancel)if(t.isPopupOpen){var n=i.getFilteredEvents(r,a,s),o={date:r,event:n,element:e.target};i.parent.quickPopup.moreEventClick(o,a,s)}else i.parent.setProperties({selectedDate:r},!0),i.parent.changeView(t.viewName,e)})},i.prototype.renderEventElement=function(e,t,i){var n=this,r=t.classList.contains("e-block-appointment")?"blockEvent":"event",a=t.classList.contains("e-appointment"),s={data:this.getEventData(e),element:t,cancel:!1,type:r};this.parent.trigger("eventRendered",s,function(e){e.cancel?n.renderedEvents.pop():n.renderElement(i,t,a)})},i.prototype.getEventData=function(e){var i=t.extend({},e,null,!0);return i[this.fields.startTime]=e.data[this.fields.startTime],i[this.fields.endTime]=e.data[this.fields.endTime],i},i.prototype.renderElement=function(e,i,n){void 0===n&&(n=!1),this.maxOrIndicator&&n&&this.setMaxEventHeight(i,e);var r=e.querySelector(".e-appointment-wrapper");if(r)r.appendChild(i);else{var a=t.createElement("div",{className:"e-appointment-wrapper"});a.appendChild(i),e.appendChild(a)}},i.prototype.getMoreIndicatorElement=function(e,i,n){return t.createElement("div",{className:"e-more-indicator",innerHTML:"+"+this.parent.globalize.formatNumber(e)+"&nbsp;"+(this.parent.isAdaptive?"":this.parent.localeObj.getConstant("more")),attrs:{tabindex:"0","data-start-date":i.getTime().toString(),"data-end-date":n.getTime().toString(),role:"list"}})},i.prototype.removeHeightProperty=function(e){for(var t=0,i=[].slice.call(this.element.querySelectorAll("."+e+" tbody tr"));t<i.length;t++)i[t].firstElementChild.style.height=""},i.prototype.setMaxEventHeight=function(e,i){var n=R(i.querySelector(".e-date-header")),r=i.offsetHeight-n-(this.maxHeight?0:this.moreIndicatorHeight);t.setStyleAttribute(e,{height:r+"px","align-items":"center"})},i.prototype.destroy=function(){this.element=null,this.fields=null,this.maxHeight=null,this.withIndicator=null,this.maxOrIndicator=null,this.moreIndicatorHeight=null,this.removeEventListener(),e.prototype.destroy.call(this)},i}(xt),Rt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pt=function(e){function i(t,i){var n=e.call(this,t)||this;n.startHour=n.parent.activeView.getStartHour(),n.endHour=n.parent.activeView.getEndHour(),n.slotCount=n.parent.activeViewOptions.timeScale.slotCount,n.interval=n.parent.activeViewOptions.timeScale.interval,n.day=0,n.rowIndex=0,n.cellTops=[],n.renderType=i,n.eventContainers=[].slice.call(n.element.querySelectorAll("."+Ze));var r=[].slice.call(n.element.querySelectorAll("."+Qe+" tbody tr"));return n.dayLength=0===r.length?0:r[0].children.length,n.content=n.parent.element.querySelector("."+Qe),n}return Rt(i,e),i.prototype.getSlotDates=function(){this.slots=[],this.slots.push(this.parent.activeView.renderDates.map(function(e){return+e})),this.parent.activeViewOptions.headerRows.length>0&&"Hour"!==this.parent.activeViewOptions.headerRows.slice(-1)[0].option?(this.renderType="day",this.cellWidth=this.content.offsetWidth/this.dateRender.length,this.slotsPerDay=1):this.slotsPerDay=this.dayLength/this.dateRender.length},i.prototype.getOverlapEvents=function(e,t){var i=[];if("day"===this.renderType)for(var n=0,r=t;n<r.length;n++)w((o=r[n])[this.fields.startTime]).getTime()<=w(new Date(e.getTime())).getTime()&&w(o[this.fields.endTime]).getTime()>=w(new Date(e.getTime())).getTime()&&i.push(o);else for(var a=0,s=t;a<s.length;a++){var o=s[a],l=o.data;l.trimStartTime.getTime()<=e.getTime()&&l.trimEndTime.getTime()>e.getTime()&&i.push(o)}return i},i.prototype.getSortComparerIndex=function(e,t){var i=-1,n=this.renderedEvents;if(n.length>0){var r=this.getOverlapSortComparerEvents(e,t,n).map(function(e){return e.Index});i=r.length>0?this.getSmallestMissingNumber(r):0}return-1===i?0:i},i.prototype.getOverlapSortComparerEvents=function(e,t,i){for(var n=[],r=0,a=i;r<a.length;r++){var s=a[r];if("day"===this.renderType)w(s[this.fields.startTime]).getTime()<=w(new Date(e.getTime())).getTime()&&w(s[this.fields.endTime]).getTime()>=w(new Date(e.getTime())).getTime()&&n.push(s);else{var o=s.data;(o.trimStartTime.getTime()<=e.getTime()&&e.getTime()<o.trimEndTime.getTime()||e.getTime()<=o.trimStartTime.getTime()&&o.trimStartTime.getTime()<t.getTime())&&n.push(s)}}return n},i.prototype.renderResourceEvents=function(){this.removeHeightProperty("e-resource-column-table");var e=this.parent.uiStateValues.isGroupAdaptive?[this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]]:this.parent.resourceBase.renderedResources;if(this.parent.crudModule&&this.parent.crudModule.crudObj.isCrudAction){for(var t=0,i=this.parent.crudModule.crudObj.sourceEvent.length;t<i;t++){var n=this.parent.crudModule.crudObj.sourceEvent[t];if(this.rowIndex=n.groupIndex,this.renderEventsHandler(this.parent.activeView.renderDates,this.parent.activeViewOptions.workDays,n),this.parent.crudModule.crudObj.targetEvent[t]&&this.parent.crudModule.crudObj.sourceEvent[t].groupIndex!==this.parent.crudModule.crudObj.targetEvent[t].groupIndex){var r=this.parent.crudModule.crudObj.targetEvent[t];this.rowIndex=r.groupIndex,this.renderEventsHandler(this.parent.activeView.renderDates,this.parent.activeViewOptions.workDays,r)}}this.parent.crudModule.crudObj.isCrudAction=!1}else for(t=0;t<e.length;t++)this.rowIndex=t,this.renderEventsHandler(this.parent.activeView.renderDates,this.parent.activeViewOptions.workDays,e[t])},i.prototype.renderEvents=function(e,i,n){var r=e[this.fields.startTime],a=e[this.fields.endTime];if(!(r.getTime()<this.parent.minDate.getTime()||a.getTime()>this.parent.maxDate.getTime())){var s=e.data;r=this.getStartTime(e,s),a=this.getEndTime(e,s);var o=S(e[this.fields.startTime],this.startHour,this.endHour),l=this.updateEventMinimumDuration(o,r,a);if(r=l.startDate,a=l.endDate,this.day=this.parent.getIndexOfDate(this.dateRender,w(new Date(r.getTime()))),!(this.day<0)){var c=this.getCellTd(),p=t.isNullOrUndefined(this.parent.eventSettings.sortComparer)?this.getIndex(r):this.getSortComparerIndex(r,a);e.Index=p;var h=this.eventHeight,d=s.count,u=t.extend({},e,null,!0);u[this.fields.startTime]=s[this.fields.startTime],u[this.fields.endTime]=s[this.fields.endTime];var v=S(w(new Date(this.dateRender[this.day].getTime())),this.startHour,this.endHour),m=this.isValidEvent(u,r,a,v);if(r<=a&&m){var g=this.getEventWidth(r,a,e[this.fields.isAllDay],d);g="day"===this.renderType?g-2:g;var f=0,y=0,T=this.getPosition(r,a,e[this.fields.isAllDay],this.day);g=g<=0?this.cellWidth:g,this.renderedEvents.push(t.extend({},e,null,!0)),t.isNullOrUndefined(this.cellTops[i])&&(this.cellTops[i]=this.getRowTop(i));var D=this.cellTops[i],b=D+(this.maxHeight?0:2)+p*(h+2);f=this.parent.enableRtl?0:T,y=this.parent.enableRtl?T:0;var O=(p+1)*(h+2)+this.moreIndicatorHeight,E=this.maxOrIndicator?p<1:this.cellHeight>O;if(this.parent.rowAutoHeight||E){var x=void 0;if(x=t.isNullOrUndefined(this.inlineValue)?this.createAppointmentElement(e,i):this.parent.inlineModule.createInlineAppointmentElement(),this.applyResourceColor(x,e,"backgroundColor",this.groupOrder),t.setStyleAttribute(x,{width:g+"px",left:f+"px",right:y+"px",top:b+"px"}),this.wireAppointmentEvents(x,e),this.renderEventElement(e,x,c),this.parent.rowAutoHeight){var A=this.getFirstChild(i);this.updateCellHeight(A,O)}"TimelineMonth"!==this.parent.activeViewOptions.option&&this.parent.activeViewOptions.timeScale.enable&&g<this.cellWidth&&[].slice.call(x.querySelectorAll(".e-event-resize")).forEach(function(e){e.style.width=Math.ceil(g/e.getBoundingClientRect().width)+"px"})}else for(var V=0;V<d;V++){var k=c.querySelector(".e-more-indicator"),M=this.parent.enableRtl?y:f;M=Math.floor(M/this.cellWidth)*this.cellWidth;var R=this.interval/this.slotCount,P="TimelineMonth"===this.parent.activeViewOptions.option||"day"===this.renderType||0!==V?new Date(this.dateRender[this.day+V].getTime()):new Date(r),I=C(this.dateRender[this.day+V],1);if("TimelineMonth"===this.parent.activeViewOptions.option||"day"===this.renderType){var j=this.getPosition(P,I,e[this.fields.isAllDay],this.day+V);this.renderTimelineMoreIndicator(r,P,I,h,R,i,n,D,f,y,c,k,M,j)}else for(var q=(H(a)-H(r))/ze*this.slotCount/this.interval,L=0;L<q&&(P=0===L?new Date(P.getTime()):new Date(P.getTime()+6e4*R),!((I=new Date(P.getTime()+6e4*R)).getTime()>a.getTime()));L++){var N=this.getPosition(P,I,!1,this.day+V);if(M>N)break;M=N,this.renderTimelineMoreIndicator(r,P,I,h,R,i,n,D,f,y,c,k,M,N)}}}this.parent.renderTemplates()}}},i.prototype.renderTimelineMoreIndicator=function(e,i,n,r,a,s,o,l,c,p,h,d,u,v){if(c=this.parent.enableRtl?p=v:v,u=this.parent.enableRtl?p:c,u=Math.floor(u/this.cellWidth)*this.cellWidth,h&&t.isNullOrUndefined(d)||!this.isAlreadyAvail(u,h)){var m="TimelineMonth"===this.parent.activeViewOptions.option||"day"===this.renderType?new Date(+e):i,g=new Date(m.setMinutes(Math.floor(m.getMinutes()/a)*a)),f=new Date(g.getTime()+6e4*a),y=void 0;this.parent.activeViewOptions.group.resources.length>0&&!t.isNullOrUndefined(s)&&(y=s.toString());var T=this.getFilterEvents(i,n,g,f,y,o),w=this.cellHeight-this.moreIndicatorHeight;r=this.withIndicator?w-2:r;var D=Math.floor(w/(r+2)),b=T.length-D<=0?1:T.length-D,C=void 0;C="day"===this.renderType?this.getMoreIndicatorElement(b,i,n):this.getMoreIndicatorElement(b,g,f),t.isNullOrUndefined(y)||C.setAttribute("data-group-index",y),C.style.top=l+w+"px",C.style.width=this.cellWidth+"px",C.style.left=Math.floor(c/this.cellWidth)*this.cellWidth+"px",C.style.right=Math.floor(p/this.cellWidth)*this.cellWidth+"px",this.renderElement(h,C),t.EventHandler.add(C,"click",this.moreIndicatorClick,this)}},i.prototype.updateCellHeight=function(e,i){if(i>this.cellHeight){if(t.setStyleAttribute(e,{height:i+"px"}),this.parent.activeViewOptions.group.resources.length>0){var n=this.parent.element.querySelector('.e-resource-column-table tbody td[data-group-index="'+e.getAttribute("data-group-index")+'"]');n&&t.setStyleAttribute(n,{height:i+"px"})}var r=this.parent.element.querySelector(".e-month-header-wrapper table tr:nth-child("+(e.parentElement.rowIndex+1)+") td");r&&t.setStyleAttribute(r,{height:i+"px"})}},i.prototype.getFirstChild=function(e){var t="."+Qe+" tbody td",i="";return this.parent.activeViewOptions.group.resources.length>0&&(i='[data-group-index="'+e.toString()+'"]'),this.parent.element.querySelector(t+i)},i.prototype.updateBlockElements=function(){for(var e=0,t=[].slice.call(this.element.querySelectorAll(".e-block-appointment"));e<t.length;e++){var i=t[e],n=parseInt(i.getAttribute("data-group-index"),10),r=this.getFirstChild(n);i.style.height=r.offsetHeight+"px";var a=Math.round(i.offsetWidth/r.offsetWidth);i.style.width=r.offsetWidth*a+"px"}for(var s=0,o=[].slice.call(this.element.querySelectorAll(".e-block-indicator"));s<o.length;s++){var i=o[s],n=parseInt(i.getAttribute("data-group-index"),10);i.style.top=this.getRowTop(n)+this.getFirstChild(n).offsetHeight-18+"px"}},i.prototype.getStartTime=function(e,t){var i=e[this.fields.startTime],n=S(i,this.startHour,this.endHour);return i=n.startHour.getTime()>=t[this.fields.startTime]?n.startHour:n.endHour.getTime()<=t[this.fields.startTime]?this.getNextDay(n.startHour,t):t[this.fields.startTime],t.trimStartTime=e[this.fields.isAllDay]?n.startHour:t[this.fields.startTime],i},i.prototype.getNextDay=function(e,t){for(var i,n=1;n<=this.dateRender.length;n++)if(i=C(e,n),-1!==this.parent.getIndexOfDate(this.dateRender,w(new Date(e.getTime()))))return t.count=t.count-1,i;return i},i.prototype.getEndTime=function(e,t){var i=e[this.fields.endTime],n=S(i,this.startHour,this.endHour);return"TimelineMonth"===this.parent.currentView||!this.parent.activeViewOptions.timeScale.enable||this.parent.activeViewOptions.headerRows.length>0&&"Hour"!==this.parent.activeViewOptions.headerRows.slice(-1)[0].option?i=t[this.fields.endTime]:(i=t[this.fields.endTime],n.endHour.getTime()<=t[this.fields.endTime]&&(i=n.endHour),n.startHour.getTime()>=t[this.fields.endTime].getTime()&&!e.isAllDay&&(i=this.getPreviousDay(n.startHour,n.endHour,t))),t.trimEndTime=e[this.fields.isAllDay]?n.endHour:t[this.fields.endTime],i},i.prototype.getPreviousDay=function(e,t,i){for(var n=1;n<=this.dateRender.length;n++){var r=C(t,-n);if(-1!==this.parent.getIndexOfDate(this.dateRender,w(new Date(e.getTime())))){(r=w(new Date(r.getTime()))).setHours(t.getHours(),t.getMinutes(),t.getSeconds());var a=i.count,s=i[this.fields.endTime];return i.count=0!==s.getHours()||0!==s.getMinutes()?a-1:a,r}}return i[this.fields.endTime]},i.prototype.getEventWidth=function(e,t,i,n){return"day"===this.renderType||i?n*this.slotsPerDay*this.cellWidth:this.isSameDay(e,t)?this.getSameDayEventsWidth(e,t):this.getSpannedEventsWidth(e,t,n)},i.prototype.getSameDayEventsWidth=function(e,t){return(H(t)-H(e))/ze*(this.cellWidth*this.slotCount)/this.interval},i.prototype.getSpannedEventsWidth=function(e,t,i){var n,r=i*this.slotsPerDay*this.cellWidth,a=S(w(new Date(e.getTime())),this.startHour,this.endHour),s=this.getSameDayEventsWidth(a.startHour,e);if(-1===this.parent.getIndexOfDate(this.dateRender,w(new Date(t.getTime()))))n=0;else{var o=S(w(new Date(t.getTime())),this.startHour,this.endHour);n=this.getSameDayEventsWidth(t,o.endHour),n=this.slotsPerDay*this.cellWidth===n?0:n}var l=s+n;return r>l?r-l:r-s},i.prototype.isSameDay=function(e,t){return this.parent.getIndexOfDate(this.dateRender,w(new Date(e.getTime())))===this.parent.getIndexOfDate(this.dateRender,w(new Date(t.getTime())))},i.prototype.getAppointmentLeft=function(e,t,i){var n=this.isSameDay(t,e.startHour)?(H(t)-H(e.startHour))/(ze*this.interval)*this.slotCount:0;return 0===i?n:Math.round((H(e.endHour)-H(e.startHour))/ze/this.interval*this.slotCount)*i+n},i.prototype.getPosition=function(e,t,i,n){if("day"===this.renderType||i)return n*this.slotsPerDay*this.cellWidth;var r=S(w(new Date(this.dateRender[n].getTime())),this.startHour,this.endHour);return(r.endHour.getTime()<=t.getTime()&&r.startHour.getTime()>=e.getTime()?this.getAppointmentLeft(r,r.startHour,n):r.endHour.getTime()<=t.getTime()?this.getAppointmentLeft(r,e,n):r.startHour.getTime()>=e.getTime()?this.getAppointmentLeft(r,r.startHour,n):this.getAppointmentLeft(r,e,n))*this.cellWidth},i.prototype.getFilterEvents=function(e,t,i,n,r,a){return"day"===this.renderType?this.getFilteredEvents(e,t,r,a):this.getFilteredEvents(i,n,r,a)},i.prototype.isAlreadyAvail=function(e,t){for(var i=[].slice.call(t.querySelectorAll(".e-more-indicator")),n=0;n<i.length;n++){var r=void 0;if(i&&(r=this.parent.enableRtl?i[n].style.right:i[n].style.left),parseInt(r,10)===Math.floor(e))return!0}return!1},i.prototype.getRowTop=function(e){return this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive?this.parent.element.querySelector('.e-content-wrap tbody td[data-group-index="'+e.toString()+'"]').offsetTop:0},i.prototype.getCellTd=function(){var e=this.parent.uiStateValues.isGroupAdaptive?0:this.rowIndex;return this.eventContainers[e]},i.prototype.renderBlockIndicator=function(e,i,n){if(!(this.parent.headerRows.length>0&&("Hour"!==this.parent.headerRows[this.parent.headerRows.length-1].option||"Date"!==this.parent.headerRows[this.parent.headerRows.length-1].option)||(i=Math.floor(i/this.cellWidth)*this.cellWidth+this.cellWidth-22,this.isAlreadyAvail(i,e)))){var r=t.createElement("div",{className:"e-icons e-block-indicator"});this.parent.activeViewOptions.group.resources.length>0&&r.setAttribute("data-group-index",n.toString()),this.parent.enableRtl?r.style.right=i+"px":r.style.left=i+"px",r.style.top=this.getRowTop(n)+this.cellHeight-18+"px",this.renderElement(e,r)}},i.prototype.setMaxEventHeight=function(e,i){t.setStyleAttribute(e,{height:this.cellHeight-(this.maxHeight?0:2)-(this.maxHeight?0:this.moreIndicatorHeight)+"px"})},i.prototype.destroy=function(){this.renderType=null,this.eventContainers=null,this.dayLength=null,this.content=null,e.prototype.destroy.call(this),this.parent=null},i}(Mt),It=function(){function e(e){this.parent=e,this.parent.on(Ne,this.inlineEdit,this)}return e.prototype.inlineEdit=function(e){if(this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(),"Cell"===e.type){var t=this.parent.element.querySelector(".e-more-popup-wrapper");t&&t.classList.contains(Ke)&&this.parent.quickPopup.morePopup.hide(),this.removeInlineAppointmentElement(),this.cellEdit(e)}else this.parent.element.querySelector(".e-inline-subject")!==e.element.querySelector(".e-inline-subject")&&this.removeInlineAppointmentElement(),this.eventEdit(e)},e.prototype.cellEdit=function(e){var t=this.generateEventData(),i=e.element.cellIndex,n=this.getEventDaysCount(t);n>1&&(n=Math.round(n),i-=--n);var r=w(new Date(""+t[this.parent.eventFields.startTime])).getTime(),a=w(new Date(""+t[this.parent.eventFields.endTime])).getTime(),s=e.groupIndex||0;if("Day"===this.parent.currentView||"Week"===this.parent.currentView||"WorkWeek"===this.parent.currentView){var o=t[this.parent.eventFields.startTime].getDay();this.createVerticalViewInline(t,o,s,i)}else"Month"===this.parent.currentView?this.createMonthViewInline(t,s,r,a):this.createTimelineViewInline(t,r,a,s);var l=this.parent.element.querySelector(".e-inline-subject");l&&l.focus()},e.prototype.eventEdit=function(e){var i,n=e.element.querySelector(".e-inline-subject");if(n)i=n.value;else{var r=e.element.querySelector(".e-subject"),a=e.element.querySelector(".e-time");if(i=r.innerText,n=t.createElement("input",{className:"e-inline-subject",attrs:{value:i}}),t.addClass([r],"e-disable"),t.closest(e.element,".e-more-popup-wrapper"))e.element.insertBefore(n,r);else if(["Agenda","MonthAgenda"].indexOf(this.parent.currentView)>-1){var s=e.element.querySelector(".e-subject-wrap");s.insertBefore(n,s.firstChild)}else{var o=["TimelineDay","TimelineWeek","TimelineWorkWeek","TimelineMonth"].indexOf(this.parent.currentView)>-1?".e-inner-wrap":".e-appointment-details";e.element.querySelector(o).insertBefore(n,a)}n.focus()}n.setSelectionRange(i.length,i.length)},e.prototype.createVerticalViewInline=function(e,t,i,n){var r,a=this.getEventDaysCount(e),s=new Vt(this.parent);s.initializeValues();var o=s.dateRender[i].map(function(e){return e.getDay()}).indexOf(t);if(a>=1){s.allDayElement=[].slice.call(this.parent.element.querySelectorAll(".e-all-day-cells")),(r=s.slots).push.apply(r,this.parent.activeView.renderDates.map(function(e){return+e}));var l=[].slice.call(this.parent.element.querySelectorAll(".e-all-day-appointment")),c=0;l.length>0&&(c=Math.floor(this.parent.element.querySelector(".e-all-day-row").getBoundingClientRect().height/l[0].offsetHeight)-1),s.allDayLevel=c,s.renderAllDayEvents(e,o,i,n,this.parent.allowInline)}else s.renderNormalEvents(e,o,i,n,this.parent.allowInline)},e.prototype.createMonthViewInline=function(e,t,i,n){var r=this.getEventDaysCount(e),a=this.parent.eventBase.cloneEventObject(e,i,n,r,!1,!1),s=new Mt(this.parent);s.dateRender=this.parent.activeView.renderDates,s.inlineValue=this.parent.allowInline;var o=this.parent.activeView.renderDates,l=this.parent.activeViewOptions.workDays,c=".e-work-cells";if(this.parent.activeViewOptions.group.resources.length>0){c+='[data-group-index="'+t+'"]';var p=this.parent.resourceBase.lastResourceLevel[t];o=p.renderDates,l=p.workDays}s.workCells=[].slice.call(this.parent.element.querySelectorAll(c)),s.cellWidth=s.workCells[0].offsetWidth,s.cellHeight=s.workCells[0].offsetHeight,s.eventHeight=h(this.parent.monthModule.element,"e-appointment"),s.getSlotDates(l);for(var d=s.getRenderedDates(o),u=0,v=s.splitEvent(a,d||o);u<v.length;u++){var m=v[u];s.renderEvents(m,t)}this.parent.element.querySelector(".e-inline-subject").focus()},e.prototype.createTimelineViewInline=function(e,t,i,n){var r=this.getEventDaysCount(e),a=this.parent.eventBase.cloneEventObject(e,t,i,r,!1,!1),s=new Pt(this.parent,this.parent.activeViewOptions.timeScale.enable?"hour":"day");s.dateRender=this.parent.activeView.renderDates,s.eventContainers=[].slice.call(this.parent.element.querySelectorAll("."+Ze));var o=this.parent.element.querySelector(".e-work-cells");s.inlineValue=this.parent.allowInline,s.cellWidth=o.offsetWidth,s.cellHeight=o.offsetHeight;var l=0===this.parent.element.querySelectorAll("."+Qe+" tbody tr").length?0:this.parent.element.querySelectorAll("."+Qe+" tbody tr")[0].children.length;s.slotsPerDay=l/s.dateRender.length,s.eventHeight=h(s.element,"e-appointment"),s.renderEvents(a,n)},e.prototype.getEventDaysCount=function(e){var t=e[this.parent.eventFields.startTime],i=e[this.parent.eventFields.endTime];return Math.abs(i.getTime()-t.getTime())/We},e.prototype.generateEventData=function(e){var t=this.parent.element.querySelector(".e-inline-subject"),i=t?t.value:e?e.innerHTML:"",n={};return n[this.parent.eventFields.id]=this.parent.eventBase.getEventMaxID(),n[this.parent.eventFields.subject]=i,n[this.parent.eventFields.startTime]=this.parent.activeCellsData.startTime,n[this.parent.eventFields.endTime]=this.parent.activeCellsData.endTime,n[this.parent.eventFields.isAllDay]=this.parent.activeCellsData.isAllDay,this.parent.eventWindow.setDefaultValueToObject(n),this.parent.resourceBase&&this.parent.resourceBase.setResourceValues(n,this.parent.activeCellsData.groupIndex),n},e.prototype.documentClick=function(){var e=this.parent.element.querySelector(".e-inline-subject");e&&""!==e.value?this.inlineCrudActions(e):this.removeInlineAppointmentElement()},e.prototype.inlineCrudActions=function(e){if(t.closest(e,".e-inline-appointment")){var i=this.generateEventData(e);this.parent.addEvent(i)}else{var n=t.closest(e,".e-appointment"),r=this.parent.getEventDetails(n);r[this.parent.eventFields.subject]=e.value;var a=void 0;r[this.parent.eventFields.id]===r[this.parent.eventFields.recurrenceID]&&(a="EditOccurrence",r[this.parent.eventFields.id]=this.parent.eventBase.getEventMaxID()),this.parent.saveEvent(r,a)}this.removeInlineAppointmentElement()},e.prototype.createInlineAppointmentElement=function(e){var i=t.createElement("div",{className:"e-appointment e-inline-appointment"}),n=t.createElement("div",{className:"e-appointment-details"});i.appendChild(n);var r=t.createElement("input",{className:"e-inline-subject"});return n.appendChild(r),e&&this.parent.eventBase.applyResourceColor(i,e,"backgroundColor"),i},e.prototype.removeInlineAppointmentElement=function(){var e=[].slice.call(this.parent.element.querySelectorAll(".e-inline-appointment"));e.length>0&&e.forEach(function(e){return t.remove(e)});var i=this.parent.element.querySelector(".e-inline-subject");if(i){var n=t.closest(i,".e-appointment");t.removeClass([n.querySelector(".e-subject")],"e-disable"),t.remove(i)}},e.prototype.destroy=function(){this.parent.off(Ne,this.inlineEdit)},e}(),Ht=function(){function e(){}return e.prototype.renderFormValidator=function(e,t,i,n){var r=this;this.element=i,this.formObj=new o.FormValidator(e,{locale:n,customPlacement:function(e,t){r.errorPlacement(e,t)},rules:t,validationComplete:function(e){r.validationComplete(e)},focusout:function(e){r.focusOut(e)}})},e.prototype.focusOut=function(e){var t=e.relatedTarget;t&&(t.classList.contains("e-dlg-closeicon-btn")||t.classList.contains("e-close")||t.classList.contains("e-all-day-cells")||t.classList.contains("e-header-cells")||t.classList.contains("e-event-details")||t.classList.contains("e-work-cells")||t.classList.contains("e-event-cancel"))?this.ignoreError=!0:this.ignoreError=!1},e.prototype.validationComplete=function(e){var t=this.element.querySelector("#"+e.inputName+"_Error");t&&(t.style.display="failure"===e.status?"":"none")},e.prototype.errorPlacement=function(e,i){var n=i.getAttribute("for"),r=this.element.querySelector("#"+n+"_Error");r||this.ignoreError||this.createTooltip(e,i,n,""),t.isNullOrUndefined(r)||(r.querySelector(".e-error").innerHTML=i.innerHTML)},e.prototype.createTooltip=function(e,i,n,r){var a,s,o=e.getBoundingClientRect();this.element.classList.contains("e-quick-popup-wrapper")?(a=this.element,s=this.element.getBoundingClientRect()):s=(a=this.element.querySelector(".e-schedule-dialog .e-dlg-content")).getBoundingClientRect();var l=t.createElement("div",{className:"e-tooltip-wrap e-popup e-schedule-error",id:n+"_Error",styles:"display:"+r+";top:"+(o.bottom-s.top+a.scrollTop+9)+"px;left:"+(o.left-s.left+a.scrollLeft+o.width/2)+"px;"}),c=t.createElement("div",{className:"e-tip-content"});c.appendChild(i);var p=t.createElement("div",{className:"e-arrow-tip e-tip-top"});p.appendChild(t.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),p.appendChild(t.createElement("div",{className:"e-arrow-tip-inner e-tip-top"})),l.appendChild(c),l.appendChild(p),a.appendChild(l),l.style.left=parseInt(l.style.left,10)-l.offsetWidth/2+"px"},e.prototype.destroyToolTip=function(){if(this.element)for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-schedule-error"));e<i.length;e++){var n=i[e];t.remove(n)}this.formObj&&this.formObj.element&&this.formObj.reset()},e.prototype.destroy=function(){this.formObj&&this.formObj.element&&!this.formObj.isDestroyed&&this.formObj.destroy(),this.formObj=null,this.element=null},e}(),jt=function(){function e(e){this.isMultipleEventSelect=!1,this.isCrudAction=!1,this.parent=e,this.l10n=this.parent.localeObj,this.fieldValidator=new Ht,this.render(),this.addEventListener()}return e.prototype.render=function(){this.renderQuickPopup(),this.renderMorePopup(),this.renderQuickDialog()},e.prototype.renderQuickPopup=function(){var e=t.createElement("div",{className:"e-quick-popup-wrapper e-popup-close"});this.parent.isAdaptive?(document.body.appendChild(e),t.addClass([e],"e-device")):this.parent.element.appendChild(e),this.quickPopup=new i.Popup(e,{targetType:this.parent.isAdaptive?"container":"relative",enableRtl:this.parent.enableRtl,open:this.quickPopupOpen.bind(this),close:this.quickPopupClose.bind(this),hideAnimation:this.parent.isAdaptive?{name:"ZoomOut"}:{name:"FadeOut",duration:150},showAnimation:this.parent.isAdaptive?{name:"ZoomIn"}:{name:"FadeIn",duration:150},collision:this.parent.isAdaptive?{X:"fit",Y:"fit"}:this.parent.enableRtl?{X:"flip",Y:"fit"}:{X:"none",Y:"fit"},position:this.parent.isAdaptive||this.parent.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"},viewPortElement:this.parent.isAdaptive?document.body:this.parent.element,zIndex:this.parent.isAdaptive?1004:3})},e.prototype.renderMorePopup=function(){var e='<div class="e-more-event-popup"><div class="e-more-event-header"><div class="e-more-event-close" title="'+this.l10n.getConstant("close")+'" tabindex="0"></div><div class="e-more-event-date-header"><div class="e-header-day"></div><div class="e-header-date e-navigate" tabindex="0"></div></div></div></div>',n=t.createElement("div",{className:"e-more-popup-wrapper e-popup-close",innerHTML:e});this.parent.isAdaptive?(document.body.appendChild(n),t.addClass([n],"e-device")):this.parent.element.appendChild(n),this.morePopup=new i.Popup(n,{targetType:this.parent.isAdaptive?"container":"relative",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut",duration:300},showAnimation:{name:"ZoomIn",duration:300},open:this.morePopupOpen.bind(this),close:this.morePopupClose.bind(this),collision:this.parent.isAdaptive?{X:"fit",Y:"fit"}:this.parent.enableRtl?{X:"flip",Y:"fit"}:{X:"flip",Y:"flip"},viewPortElement:this.parent.isAdaptive?document.body:this.parent.element,zIndex:this.parent.isAdaptive?1002:2});var r=this.morePopup.element.querySelector(".e-more-event-close");this.renderButton("e-round",Ge+" e-close-icon",!1,r,this.closeClick),t.EventHandler.add(this.morePopup.element.querySelector(".e-header-date"),"click",this.navigationClick,this)},e.prototype.renderQuickDialog=function(){var e=[{buttonModel:{cssClass:"e-quick-alertok e-flat",isPrimary:!0},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-quick-alertcancel e-flat",isPrimary:!1},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-quick-dialog-cancel e-disable e-flat",isPrimary:!1},click:this.dialogButtonClick.bind(this)}];if(this.parent.eventSettings.editFollowingEvents){var n={buttonModel:{cssClass:"e-quick-alertfollowing e-flat",isPrimary:!1},click:this.dialogButtonClick.bind(this)};e.splice(1,0,n)}this.quickDialog=new i.Dialog({animationSettings:{effect:"Zoom"},buttons:e,cssClass:"e-quick-dialog",closeOnEscape:!0,enableRtl:this.parent.enableRtl,beforeClose:this.beforeQuickDialogClose.bind(this),isModal:!0,position:{X:"center",Y:"center"},showCloseIcon:!0,target:document.body,visible:!1,width:"auto"});var r=t.createElement("div",{id:this.parent.element.id+"QuickDialog"});this.parent.element.appendChild(r),this.quickDialog.appendTo(r);var a=this.quickDialog.element.querySelector(".e-quick-alertok");a&&(a.setAttribute("aria-label",this.l10n.getConstant("occurrence")),a.setAttribute("aria-label",a.innerHTML));var s=this.quickDialog.element.querySelector(".e-quick-alertcancel");s&&(s.setAttribute("aria-label",this.l10n.getConstant("series")),s.setAttribute("aria-label",s.innerHTML)),this.quickDialog.element.querySelector(".e-dlg-closeicon-btn")&&this.quickDialog.element.querySelector(".e-dlg-closeicon-btn").setAttribute("title",this.l10n.getConstant("close"))},e.prototype.renderButton=function(e,i,n,r,a){new s.Button({cssClass:e,disabled:n,enableRtl:this.parent.enableRtl,iconCss:i}).appendTo(r),t.EventHandler.add(r,"click",a,this),t.removeClass([r],Ge)},e.prototype.quickDialogClass=function(e){var i=["e-quick-dialog-occurrence-event","e-quick-dialog-series-event","e-quick-dialog-delete","e-quick-dialog-cancel","e-quick-dialog-alert-btn","e-disable"],n=this.quickDialog.element.querySelector(".e-quick-alertok"),r=this.quickDialog.element.querySelector(".e-quick-alertcancel"),a=this.quickDialog.element.querySelector(".e-quick-alertfollowing");switch(t.removeClass([n,r],i),t.addClass([this.quickDialog.element.querySelector(".e-quick-dialog-cancel")],"e-disable"),this.parent.eventSettings.editFollowingEvents&&(t.addClass([a],"e-disable"),t.removeClass([this.quickDialog.element],"e-following-events-dialog")),e){case"Recurrence":t.addClass([n],"e-quick-dialog-occurrence-event"),t.addClass([r],"e-quick-dialog-series-event"),this.parent.eventSettings.editFollowingEvents&&(t.removeClass([a],"e-disable"),t.addClass([this.quickDialog.element],"e-following-events-dialog"),t.addClass([a],"e-quick-dialog-following-events"));break;case"Delete":t.addClass([n],"e-quick-dialog-delete"),t.addClass([r],"e-quick-dialog-cancel");break;case"Alert":t.addClass([n],["e-quick-alertok","e-quick-dialog-alert-btn"]),t.addClass([r],["e-quick-alertcancel","e-disable"])}},e.prototype.applyFormValidation=function(){var e=this.quickPopup.element.querySelector("."+$e),t={};t[this.parent.eventSettings.fields.subject.name]=this.parent.eventSettings.fields.subject.validation,this.fieldValidator.renderFormValidator(e,t,this.quickPopup.element,this.parent.locale)},e.prototype.openRecurrenceAlert=function(){var e=this.quickDialog.element.querySelector(".e-quick-alertok");e&&(e.innerHTML=this.l10n.getConstant("Delete"===this.parent.currentAction?"deleteEvent":"editEvent"),e.setAttribute("aria-label",e.innerHTML));var i=this.quickDialog.element.querySelector(".e-quick-alertfollowing");i&&(i.innerHTML=this.l10n.getConstant("editFollowingEvent"),i.setAttribute("aria-label",i.innerHTML));var n=this.quickDialog.element.querySelector(".e-quick-alertcancel");n&&(n.innerHTML=this.l10n.getConstant("Delete"===this.parent.currentAction?"deleteSeries":"editSeries"),n.setAttribute("aria-label",n.innerHTML)),this.quickDialog.content=this.l10n.getConstant("editContent"),this.quickDialog.header=this.l10n.getConstant("Delete"===this.parent.currentAction?"deleteTitle":"editTitle"),this.quickDialogClass("Recurrence");var r=this.parent.activeEventData.event;if(this.parent.eventSettings.editFollowingEvents&&"EditOccurrence"===this.parent.currentAction&&!t.isNullOrUndefined(r[this.parent.eventFields.recurrenceID])&&r[this.parent.eventFields.recurrenceID]!==r[this.parent.eventFields.id]){var a=this.quickDialog.element.querySelector(".e-quick-alertfollowing");t.addClass([a],"e-disable")}this.showQuickDialog("RecurrenceAlert")},e.prototype.openRecurrenceValidationAlert=function(e){this.quickDialogClass("Alert");var i=this.quickDialog.element.querySelector(".e-quick-alertok");i.innerHTML=this.l10n.getConstant("ok"),i.setAttribute("aria-label",i.innerHTML);var n=this.quickDialog.element.querySelector(".e-quick-alertcancel");n.innerHTML=this.l10n.getConstant("cancel"),n.setAttribute("aria-label",n.innerHTML),this.quickDialog.header=this.l10n.getConstant("alert");var r;switch(e){case"wrongPattern":t.addClass([n],"e-disable"),this.quickDialog.content=this.l10n.getConstant("wrongPattern");break;case"createError":t.addClass([n],"e-disable"),this.quickDialog.content=this.l10n.getConstant("createError");break;case"sameDayAlert":t.addClass([n],"e-disable"),this.quickDialog.content=this.l10n.getConstant("sameDayAlert");break;case"seriesChangeAlert":r=this.quickDialog.element.querySelector(".e-quick-dialog-cancel"),t.removeClass([n,r],"e-disable"),this.quickDialog.content=this.l10n.getConstant("seriesChangeAlert"),i.innerHTML=this.l10n.getConstant("yes"),n.innerHTML=this.l10n.getConstant("no"),r.innerHTML=this.l10n.getConstant("cancel");break;case"occurrenceAlert":t.addClass([n],"e-disable"),this.quickDialog.content=this.l10n.getConstant("occurenceAlert")}(!this.parent.enableRecurrenceValidation&&"wrongPattern"===e||this.parent.enableRecurrenceValidation)&&this.showQuickDialog("RecurrenceValidationAlert")},e.prototype.openDeleteAlert=function(){if(!this.parent.activeViewOptions.readonly){var e=this.quickDialog.element.querySelector(".e-quick-alertok");e&&(e.innerHTML=this.l10n.getConstant("delete"),e.setAttribute("aria-label",e.innerHTML));var t=this.quickDialog.element.querySelector(".e-quick-alertcancel");t&&(t.innerHTML=this.l10n.getConstant("cancel"),t.setAttribute("aria-label",t.innerHTML)),this.quickDialog.content=this.parent.activeEventData.event.length>1?this.l10n.getConstant("deleteMultipleContent"):this.l10n.getConstant("deleteContent"),this.quickDialog.header=this.parent.activeEventData.event.length>1?this.l10n.getConstant("deleteMultipleEvent"):this.l10n.getConstant("deleteEvent"),this.quickDialogClass("Delete"),this.showQuickDialog("DeleteAlert")}},e.prototype.openValidationError=function(e,t){this.quickDialog.header=this.l10n.getConstant("alert"),this.quickDialog.content=this.l10n.getConstant(e);var i=this.quickDialog.element.querySelector(".e-quick-alertok");i&&(i.innerHTML=this.l10n.getConstant("ok"),i.setAttribute("aria-label",i.innerHTML));var n=this.quickDialog.element.querySelector(".e-quick-alertcancel");n&&(n.innerHTML=this.l10n.getConstant("cancel"),i.setAttribute("aria-label",n.innerHTML)),this.quickDialogClass("Alert"),this.showQuickDialog("ValidationAlert",t)},e.prototype.showQuickDialog=function(e,i){var n=this;this.quickDialog.dataBind();var r={type:e,cancel:!1,element:this.quickDialog.element,data:t.extend({},i||this.parent.activeEventData.event,null,!0)};this.parent.trigger("popupOpen",r,function(e){e.cancel||n.quickDialog.show()})},e.prototype.createMoreEventList=function(e,i,n){var r=this,a=this.parent.eventFields,s=t.createElement("div",{className:"e-more-event-content"}),o=t.createElement("div",{className:"e-more-appointment-wrapper"});if(0===e.length)o=t.createElement("div",{className:"e-more-event-content",innerHTML:this.l10n.getConstant("emptyContainer")});else for(var l=this,c=0,p=e;c<p.length;c++)!function(e){var s=e[a.subject]||l.parent.eventSettings.fields.subject.default||l.parent.localeObj.getConstant("addTitle"),c=t.createElement("div",{className:"e-appointment",attrs:{"data-id":""+e[a.id],"data-guid":e.Guid,role:"button",tabindex:"0","aria-readonly":l.parent.eventBase.getReadonlyAttribute(e),"aria-selected":"false","aria-grabbed":"true","aria-label":l.parent.getAnnouncementString(e)}}),p=void 0;if(t.isNullOrUndefined(l.parent.activeViewOptions.eventTemplate))c.appendChild(t.createElement("div",{className:"e-subject",innerHTML:s}));else{var h=l.parent.element.id+"_"+l.parent.activeViewOptions.eventTemplateName+"eventTemplate";p=l.parent.getAppointmentTemplate()(e,l.parent,"eventTemplate",h,!1),t.append(p,c)}if(t.isNullOrUndefined(n)||c.setAttribute("data-group-index",n),!t.isNullOrUndefined(e[a.recurrenceRule])){var d=e[a.id]===e[a.recurrenceID]?"e-recurrence-icon":"e-recurrence-edit-icon";c.appendChild(t.createElement("div",{className:Ge+" "+d}))}var u={data:t.extend({},e,null,!0),element:c,cancel:!1};l.parent.trigger("eventRendered",u,function(t){if(!t.cancel){o.appendChild(c);var n=r.parent.isAdaptive||"Year"===r.parent.currentView;r.parent.eventBase.wireAppointmentEvents(c,e,n),r.parent.eventBase.applyResourceColor(c,e,"backgroundColor",i)}})}(p[c]);return s.appendChild(o),s},e.prototype.tapHoldEventPopup=function(e){var i=t.closest(e.target,".e-appointment");this.isMultipleEventSelect=!1,this.parent.selectedElements=[],this.isMultipleEventSelect=!0,this.parent.eventBase.getSelectedEventElements(i),this.parent.activeEventData=this.parent.eventBase.getSelectedEvents();var n=i.getAttribute("data-guid"),r=this.parent.eventBase.getEventByGuid(n);if(!t.isNullOrUndefined(r)){var a=r[this.parent.eventFields.subject]||this.l10n.getConstant("noTitle"),s='<div class="e-multiple-event-popup"><div class="e-popup-header"><button class="e-close" title="'+this.l10n.getConstant("close")+'"></button><div class="e-subject">'+a+'</div><button class="e-edit" title="'+this.l10n.getConstant("edit")+'"></button><button class="e-delete" title="'+this.l10n.getConstant("delete")+'"></button></div></div>';this.quickPopup.element.innerHTML=s;var o=this.quickPopup.element.querySelector(".e-close");this.renderButton("e-flat e-round e-small",Ge+" e-close-icon",!1,o,this.closeClick);var l=this.parent.activeViewOptions.readonly||r[this.parent.eventFields.isReadonly],c=!this.parent.eventSettings.allowEditing||l,p=!this.parent.eventSettings.allowDeleting||l,h=this.quickPopup.element.querySelector(".e-edit");h&&this.renderButton("e-flat e-round e-small",Ge+" e-edit-icon",c,h,this.editClick);var d=this.quickPopup.element.querySelector(".e-delete");d&&this.renderButton("e-flat e-round e-small",Ge+" e-delete-icon",p,d,this.deleteClick),this.beforeQuickPopupOpen(i)}},e.prototype.isCellBlocked=function(e){var t={};if(t[this.parent.eventFields.startTime]=this.parent.activeCellsData.startTime,t[this.parent.eventFields.endTime]=this.parent.activeCellsData.endTime,t[this.parent.eventFields.isAllDay]=this.parent.activeCellsData.isAllDay,this.parent.activeViewOptions.group.resources.length>0){var i=e.element instanceof Array?e.element[0]:e.element,n=parseInt(i.getAttribute("data-group-index"),10);this.parent.resourceBase.setResourceValues(t,isNaN(n)?null:n)}return this.parent.eventBase.isBlockRange(t)},e.prototype.cellClick=function(e){var i=new Date(e.startTime.getTime());if(!this.parent.showQuickInfo||!this.parent.eventSettings.allowAdding||"MonthAgenda"===this.parent.currentView||this.isCellBlocked(e)||!this.parent.isMinMaxDate(new Date(i.setHours(0,0,0,0))))return void this.quickPopupHide();var n=e.event.target;if(this.parent.isAdaptive){this.quickPopupHide();var r=this.parent.element.querySelector(".e-new-event");t.isNullOrUndefined(r)&&(r=t.createElement("div",{className:"e-new-event",innerHTML:'<div class="e-title">+ '+this.l10n.getConstant("newEvent")+"</div>"}));var a=t.closest(n,".e-work-cells,.e-all-day-cells");return void(a&&a.appendChild(r))}var s=t.closest(n,".e-work-cells,.e-all-day-cells,.e-header-cells");if(!t.isNullOrUndefined(s)&&!n.classList.contains("e-more-indicator")){if(this.quickPopup.relateTo===s&&this.quickPopup.element.classList.contains(Ke)){var l=this.quickPopup.element.querySelector(".e-subject");return void(l&&l.focus())}var c={};c[this.parent.eventFields.startTime]=this.parent.activeCellsData.startTime,c[this.parent.eventFields.endTime]=this.parent.activeCellsData.endTime,c[this.parent.eventFields.isAllDay]=this.parent.activeCellsData.isAllDay;var p=t.createElement("div",{className:"e-cell-popup"});p.appendChild(this.getPopupHeader("Cell",c)),p.appendChild(this.getPopupContent("Cell",e,c)),p.appendChild(this.getPopupFooter("Cell",c));var h=p.querySelector(".e-subject");h&&o.Input.createInput({element:h,properties:{placeholder:this.l10n.getConstant("addTitle")}}),t.isNullOrUndefined(this.parent.eventSettings.fields.subject.default)||(h.value=this.parent.eventSettings.fields.subject.default);var d=p.querySelector(".e-close");d&&this.renderButton("e-flat e-round e-small",Ge+" e-close-icon",!1,d,this.popupClose);var u=p.querySelector(".e-event-details");u&&this.renderButton("e-flat","",!1,u,this.detailsClick);var v=p.querySelector(".e-event-create");v&&this.renderButton("e-flat e-primary","",this.parent.activeViewOptions.readonly,v,this.saveClick),this.morePopup&&this.morePopup.hide(),this.quickPopup.content=p,this.quickPopup.relateTo=s,this.quickPopup.dataBind(),this.beforeQuickPopupOpen(s)}},e.prototype.isSameEventClick=function(e){if(this.quickPopup.relateTo===t.closest(e.element,".e-appointment")&&this.quickPopup.element.classList.contains(Ke)){var i=this.quickPopup.element.querySelector(".e-edit");if(i&&i.focus(),!this.parent.isAdaptive){var n=this.quickPopup.element.querySelector(".e-event-edit");n&&n.focus()}return!0}return!1},e.prototype.isQuickTemplate=function(e){return"Both"===this.parent.quickInfoTemplates.templateType||this.parent.quickInfoTemplates.templateType===e},e.prototype.eventClick=function(e){if(this.parent.eventTooltip&&this.parent.eventTooltip.close(),this.parent.showQuickInfo)if(this.parent.isAdaptive&&this.isMultipleEventSelect)this.updateTapHoldEventPopup(t.closest(e.element,".e-appointment"));else{if(this.isSameEventClick(e))return;var i=e.event,n=t.createElement("div",{className:"e-event-popup"});n.appendChild(this.getPopupHeader("Event",i)),n.appendChild(this.getPopupContent("Event",e,i)),n.appendChild(this.getPopupFooter("Event",i));var r=this.parent.activeViewOptions.readonly||i[this.parent.eventFields.isReadonly],a=!this.parent.eventSettings.allowEditing||r,s=!this.parent.eventSettings.allowDeleting||r,o=n.querySelector(".e-edit"),l="e-flat e-round e-small";o&&this.renderButton(l,Ge+" e-edit-icon",a,o,this.editClick);var c=n.querySelector(".e-delete");c&&this.renderButton(l,Ge+" e-delete-icon",s,c,this.deleteClick);var p=n.querySelector(".e-close");p&&this.renderButton(l,Ge+" e-close-icon",!1,p,this.popupClose);var h=n.querySelector(".e-event-edit");h&&this.renderButton("e-flat e-primary","",a,h,this.editClick);var d=n.querySelector(".e-event-delete");d&&this.renderButton("e-flat","",s,d,this.deleteClick),this.morePopup&&!t.closest(e.element,".e-more-appointment-wrapper")&&this.morePopup.hide(),this.quickPopup.content=n,this.quickPopup.relateTo=this.parent.isAdaptive?document.body:t.closest(e.element,".e-appointment"),this.quickPopup.dataBind(),this.beforeQuickPopupOpen(e.element)}},e.prototype.getPopupHeader=function(e,i){var n=t.createElement("div",{className:"e-popup-header"});if(this.isQuickTemplate(e)&&this.parent.quickInfoTemplates.header){var r=t.extend({},i,{elementType:e.toLowerCase()},!0),a=this.parent.element.id,s=[].slice.call(this.parent.getQuickInfoTemplatesHeader()(r,this.parent,"header",a+"_headerTemplate",!1));t.append([].slice.call(s),n)}else{var o=void 0,l=void 0;switch(e){case"Cell":o='<div class="e-header-icon-wrapper"><button class="e-close" title="'+this.l10n.getConstant("close")+'"></button></div>';break;case"Event":l=this.getFormattedString(i),o='<div class="e-header-icon-wrapper"><button class="e-edit e-icons" title="'+this.l10n.getConstant("edit")+'"></button><button class="e-delete e-icons" title="'+this.l10n.getConstant("delete")+'"></button><button class="e-close" title="'+this.l10n.getConstant("close")+'"></button></div><div class="e-subject-wrap"><div class="e-subject e-text-ellipsis" title="'+l.eventSubject+'">'+l.eventSubject+"</div></div >"}var c=t.createElement("div",{innerHTML:o});t.append([].slice.call(c.childNodes),n)}return n},e.prototype.getPopupContent=function(e,i,n){var r=t.createElement("div",{className:"e-popup-content"});if(this.isQuickTemplate(e)&&this.parent.quickInfoTemplates.content){var a=t.extend({},n,{elementType:e.toLowerCase()},!0),s=this.parent.element.id,o=[].slice.call(this.parent.getQuickInfoTemplatesContent()(a,this.parent,"content",s+"_contentTemplate",!1));t.append([].slice.call(o),r)}else{var l=void 0,c=void 0,p=this.getResourceText(i,e.toLowerCase());switch(e){case"Cell":c=this.getFormattedString(n),l='<table class="e-popup-table"><tbody><tr><td><form class="'+$e+'" onsubmit="return false;"><input class="e-subject e-field" type="text" name="'+this.parent.eventFields.subject+'" /></form></td></tr><tr><td><div class="e-date-time"><div class="e-date-time-icon e-icons"></div><div class="e-date-time-details '+Je+'">'+c.details+"</div></div>"+(this.parent.activeViewOptions.group.resources.length>0?'<div class="e-resource"><div class="e-resource-icon e-icons "></div><div class="e-resource-details e-text-ellipsis">'+p+"</div></div>":"")+"</td></tr></tbody></table>";break;case"Event":l='<div class="e-date-time"><div class="e-date-time-icon e-icons"></div><div class="e-date-time-wrapper e-text-ellipsis"><div class="e-date-time-details e-text-ellipsis">'+this.getFormattedString(n).details+"</div>",n[this.parent.eventFields.recurrenceRule]&&(l+='<div class="e-recurrence-summary e-text-ellipsis">'+this.getRecurrenceSummary(n)+"</div>"),l+="</div></div>",n[this.parent.eventFields.location]&&(l+='<div class="e-location"><div class="e-location-icon e-icons"></div><div class="e-location-details e-text-ellipsis">'+n[this.parent.eventFields.location]+"</div></div>"),(n[this.parent.eventFields.startTimezone]||n[this.parent.eventFields.endTimezone])&&(l+='<div class="e-time-zone"><div class="e-time-zone-icon e-icons"></div><div class="e-time-zone-details e-text-ellipsis">'+this.getTimezone(n)+"</div></div>"),n[this.parent.eventFields.description]&&(l+='<div class="e-description"><div class="e-description-icon e-icons"></div><div class="e-description-details e-text-ellipsis">'+n[this.parent.eventFields.description]+"</div></div>"),this.parent.resourceCollection.length>0&&(l+='<div class="e-resource"><div class="e-resource-icon e-icons"></div><div class="e-resource-details e-text-ellipsis">'+p+"</div></div>")}var h=t.createElement("div",{innerHTML:l});t.append([].slice.call(h.childNodes),r)}return r},e.prototype.getPopupFooter=function(e,i){var n=t.createElement("div",{className:"e-popup-footer"});if(this.isQuickTemplate(e)&&this.parent.quickInfoTemplates.footer){var r=t.extend({},i,{elementType:e.toLowerCase()},!0),a=this.parent.element.id,s=[].slice.call(this.parent.getQuickInfoTemplatesFooter()(r,this.parent,"footer",a+"_footerTemplate",!1));t.append([].slice.call(s),n)}else{var o=void 0;switch(e){case"Cell":o='<button class="e-event-details e-text-ellipsis" title="'+this.l10n.getConstant("moreDetails")+'">'+this.l10n.getConstant("moreDetails")+'</button><button class="e-event-create e-text-ellipsis" title="'+this.l10n.getConstant("save")+'">'+this.l10n.getConstant("save")+"</button>";break;case"Event":o=this.parent.isAdaptive?"":'<button class="e-event-edit e-text-ellipsis" title="'+this.l10n.getConstant("edit")+'">'+this.l10n.getConstant("edit")+'</button><button class="e-event-delete e-text-ellipsis" title="'+this.l10n.getConstant("delete")+'">'+this.l10n.getConstant("delete")+"</button>"}var l=t.createElement("div",{innerHTML:o});t.append([].slice.call(l.childNodes),n)}return n},e.prototype.getResourceText=function(e,i){if(0===this.parent.resourceCollection.length)return null;var n="";if(0===this.parent.activeViewOptions.group.resources.length){var r=this.parent.resourceBase.resourceCollection.slice(-1)[0],a=r.dataSource;if("event"===i)for(var s=e.event,o=0,l=a;o<l.length;o++)!function(e){var t=s[r.field];if(t instanceof Array){if(t.indexOf(e[r.idField])>-1){var i=t[t.indexOf(e[r.idField])],o=a.filter(function(e){return e[r.idField]===i})[0];n+=""===n?o[r.textField]:", "+o[r.textField]}}else e[r.idField]===t&&(n=e[r.textField].toString())}(l[o]);else n=a[0][r.textField].toString()}else if("event"===i){for(var c,s=e.event,a=void 0,p=this.parent.resourceBase.resourceCollection.length-1;p>=0;p--)if(a=s[this.parent.resourceBase.resourceCollection[p].field],!t.isNullOrUndefined(a)){c=this.parent.resourceBase.resourceCollection[p];break}Array.isArray(a)||(a=[a]);var h=[],d=c.dataSource;a.forEach(function(e){var t,i=M(d,c.idField,e);i>-1&&(t=d[i][c.textField]),t&&h.push(t)}),n=h.join(", ")}else{var u=e,v=t.isNullOrUndefined(u.groupIndex)?0:u.groupIndex,m=this.parent.resourceBase.lastResourceLevel[v];n=m.resourceData[m.resource.textField]}return n},e.prototype.getFormattedString=function(e){var t=this.parent.eventFields,i=e[t.subject]||this.l10n.getConstant("noTitle"),n=e[t.startTime],r=e[t.endTime],a=this.getDateFormat(n,"long"),s=e[t.isAllDay]&&0===r.getHours()&&0===r.getMinutes()?this.getDateFormat(C(new Date(r.getTime()),-1),"long"):this.getDateFormat(r,"long"),o=this.parent.getTimeString(n),l=this.parent.getTimeString(r),c="",p=r.getDate()!==n.getDate()&&(r.getTime()-n.getTime())/36e5<24?1:0;return e[t.isAllDay]?(c=a+" ("+this.l10n.getConstant("allDay")+")",(r.getTime()-n.getTime())/We>1&&(c+="&nbsp;-&nbsp;"+s+" ("+this.l10n.getConstant("allDay")+")")):c=(r.getTime()-n.getTime())/We>=1||p>0?a+" ("+o+")&nbsp;-&nbsp;"+s+" ("+l+")":a+" ("+o+"&nbsp;-&nbsp;"+l+")",{eventSubject:i,details:c}},e.prototype.moreEventClick=function(e,i,n){var r=this;this.quickPopupHide(!0);var a=this.morePopup.element.querySelector(".e-more-event-content");a&&t.remove(a);var s=e.date.getTime().toString(),o=t.closest(e.element,".e-more-indicator,.e-work-cells"),l=this.parent.globalize.formatDate(e.date,{format:"E",calendar:this.parent.getCalendarMode()});this.morePopup.element.querySelector(".e-header-day").innerHTML=L(l,"single");var c=this.morePopup.element.querySelector(".e-header-date");c.innerHTML=this.getDateFormat(e.date,"d"),c.setAttribute("data-date",s),c.setAttribute("data-end-date",i.getTime().toString());var p;t.isNullOrUndefined(n)||(c.setAttribute("data-group-index",n),p=this.parent.resourceBase.lastResourceLevel[parseInt(n,10)].groupOrder);var h=this.createMoreEventList(e.event,p,n);if(this.morePopup.element.querySelector(".e-more-event-popup").appendChild(h),t.removeClass(this.morePopup.element.querySelector(".e-more-event-date-header").childNodes,"e-current-date"),w(e.date).getTime()===w(this.parent.getCurrentTime()).getTime()&&t.addClass(this.morePopup.element.querySelector(".e-more-event-date-header").childNodes,"e-current-date"),!this.parent.isAdaptive)if(-1!==this.parent.currentView.indexOf("Timeline")){var d=o.getAttribute("data-group-index"),u=new Date(parseInt(o.getAttribute("data-start-date"),10));u.setHours(u.getHours(),u.getMinutes(),0);var v=u.getTime().toString();if(t.isNullOrUndefined(d))this.morePopup.relateTo=this.parent.element.querySelector('.e-content-wrap tbody tr td[data-date="'+v+'"]');else if(this.morePopup.relateTo=this.parent.element.querySelector('.e-content-wrap tbody tr td[data-group-index="'+d+'"][data-date="'+v+'"]'),t.isNullOrUndefined(this.morePopup.relateTo))for(var m=[].slice.call(this.parent.element.querySelectorAll('.e-content-wrap tbody tr td[data-group-index="'+d+'"]')),g=0;g<m.length;g++)m[g].getAttribute("data-date")<v&&(this.morePopup.relateTo=m[g])}else this.morePopup.relateTo=t.closest(o,".e-work-cells");this.parent.renderTemplates();var f={type:"EventContainer",cancel:!1,element:this.morePopup.element,data:e};this.parent.trigger("popupOpen",f,function(e){e.cancel||r.morePopup.show()})},e.prototype.saveClick=function(e){this.applyFormValidation(),this.dialogEvent=e,this.isCrudAction=!0,this.quickPopupHide()},e.prototype.detailsClick=function(e){var i=this.quickPopup.element.querySelector(".e-subject");i&&""!==i.value&&t.extend(this.parent.activeCellsData,{subject:i.value}),this.dialogEvent=e,this.isCrudAction=!1,this.fieldValidator.destroyToolTip(),this.quickPopupHide(),this.parent.eventWindow.openEditor(this.parent.activeCellsData,"Add")},e.prototype.editClick=function(e){this.dialogEvent=e,this.quickPopupHide(!0);var i=this.parent.activeEventData.event;this.parent.currentAction="EditSeries",t.isNullOrUndefined(i[this.parent.eventFields.recurrenceRule])?this.parent.eventWindow.openEditor(i,this.parent.currentAction):(this.parent.currentAction="EditOccurrence",this.openRecurrenceAlert())},e.prototype.deleteClick=function(e){this.dialogEvent=e,this.quickPopupHide(!0),this.parent.currentAction="Delete",this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]?this.openRecurrenceAlert():this.openDeleteAlert()},e.prototype.updateMoreEventContent=function(){if(!this.morePopup.element.classList.contains("e-popup-close")){var e=this.morePopup.element.querySelector(".e-more-event-content");e&&t.remove(e);var i,n,r=this.morePopup.element.querySelector(".e-header-date"),a=new Date(parseInt(r.getAttribute("data-date"),10)),s=new Date(parseInt(r.getAttribute("data-end-date"),10)),o=r.getAttribute("data-group-index");t.isNullOrUndefined(o)||(n=(i=this.parent.resourceBase.lastResourceLevel[parseInt(o,10)]).groupOrder);var l=this.parent.eventBase.filterEvents(a,s,this.parent.eventsProcessed,i),c=this.createMoreEventList(l,n,o);this.morePopup.element.querySelector(".e-more-event-popup").appendChild(c)}},e.prototype.closeClick=function(e){this.dialogEvent=e,"Year"===this.parent.currentView&&this.parent.activeCellsData&&this.parent.activeCellsData.element&&this.parent.selectCell(this.parent.activeCellsData.element),this.quickPopupHide(),this.morePopup.hide()},e.prototype.dialogButtonClick=function(e){this.dialogEvent=e,this.quickDialog.hide();var t=e.target,i=this.quickDialog.element.querySelector(".e-quick-alertcancel"),n=this.parent.activeEventData.event;if(t.classList.contains("e-quick-dialog-occurrence-event"))switch(this.parent.currentAction="Delete"===this.parent.currentAction?"DeleteOccurrence":"EditOccurrence",this.parent.currentAction){case"EditOccurrence":this.parent.eventWindow.openEditor(n,this.parent.currentAction);break;case"DeleteOccurrence":this.parent.crudModule.deleteEvent(n,this.parent.currentAction)}else if(t.classList.contains("e-quick-dialog-following-events"))switch(this.parent.currentAction="Delete"===this.parent.currentAction?"DeleteFollowingEvents":"EditFollowingEvents",this.parent.currentAction){case"EditFollowingEvents":this.parent.eventWindow.openEditor(n,this.parent.currentAction);break;case"DeleteFollowingEvents":this.parent.crudModule.deleteEvent(n,this.parent.currentAction)}else if(t.classList.contains("e-quick-dialog-series-event"))switch(this.parent.currentAction="Delete"===this.parent.currentAction?"DeleteSeries":"EditSeries",this.parent.currentAction){case"EditSeries":this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(n,!0),this.parent.currentAction);break;case"DeleteSeries":this.parent.crudModule.deleteEvent(n,this.parent.currentAction)}else t.classList.contains("e-quick-dialog-delete")?this.parent.crudModule.deleteEvent(n,this.parent.currentAction):!i.classList.contains("e-disable")&&(t.classList.contains("e-quick-alertok")||t.classList.contains("e-quick-alertcancel")&&!i.classList.contains("e-quick-dialog-cancel"))&&(this.parent.uiStateValues.isIgnoreOccurrence=t.classList.contains("e-quick-alertcancel"),this.parent.eventWindow.eventSave(e,this.l10n.getConstant("ok")))},e.prototype.updateTapHoldEventPopup=function(e){var i=this.parent.eventBase.getSelectedEventElements(e);if(this.parent.activeEventData=this.parent.eventBase.getSelectedEvents(),i.length>0){var n=this.parent.eventBase.getEventByGuid(i[0].getAttribute("data-guid")),r=1===i.length?n[this.parent.eventFields.subject]||this.l10n.getConstant("noTitle"):"("+i.length+")&nbsp;"+this.l10n.getConstant("selectedItems");this.quickPopup.element.querySelector(".e-subject").innerHTML=r,i.length>1?t.addClass([this.quickPopup.element.querySelector(".e-edit-icon")],"e-hidden"):t.removeClass([this.quickPopup.element.querySelector(".e-edit-icon")],"e-hidden")}else this.parent.selectedElements=[],this.quickPopupHide()},e.prototype.getTimezone=function(e){var t="";return t+=e[this.parent.eventFields.startTimezone]||"",t+=""===t?"":" - ",t+=e[this.parent.eventFields.endTimezone]||""},e.prototype.getRecurrenceSummary=function(e){var t=this.parent.eventWindow.getRecurrenceEditorInstance();if(t){var i=t.getRuleSummary(e[this.parent.eventFields.recurrenceRule]);return i.charAt(0).toUpperCase()+i.slice(1)}return""},e.prototype.getDateFormat=function(e,t){return L(this.parent.globalize.formatDate(e,{skeleton:t,calendar:this.parent.getCalendarMode()}),"single")},e.prototype.getDataFromTarget=function(e){if(e.classList.contains("e-appointment"))return this.parent.activeEventData.event;var t={startTime:this.parent.activeCellsData.startTime,endTime:this.parent.activeCellsData.endTime,isAllDay:this.parent.activeCellsData.isAllDay,groupIndex:this.parent.activeCellsData.groupIndex},i=this.parent.activeCellsData;return this.parent.eventWindow.convertToEventData(i,t),t},e.prototype.beforeQuickDialogClose=function(e){var i=this,n={event:e.event||this.dialogEvent,type:t.isNullOrUndefined(this.parent.activeEventData.event)?"ValidationAlert":t.isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])?"DeleteAlert":"RecurrenceAlert",cancel:!1,data:this.parent.activeEventData.event,element:this.quickDialog.element};this.parent.trigger("popupClose",n,function(e){e.cancel||i.parent.eventBase.focusElement(!0)})},e.prototype.beforeQuickPopupOpen=function(e){var n=this;this.parent.renderTemplates();var r=this.quickPopup.element.querySelector(".e-event-popup"),a=this.parent.isAdaptive?r?"ViewEventInfo":"EditEventInfo":"QuickInfo",s={type:a,cancel:!1,data:t.extend({},this.getDataFromTarget(e),null,!0),target:e,element:this.quickPopup.element};this.parent.trigger("popupOpen",s,function(s){if(s.cancel)n.quickPopupHide(),n.destroyPopupButtons("quickPopup"),s.element.classList.contains(Ke)&&n.quickPopupClose(),P(n.quickPopup.element),n.isMultipleEventSelect=!1;else{var o=n.quickPopup.element.style.display;if(n.quickPopup.element.style.display="block",n.parent.isAdaptive)n.quickPopup.element.removeAttribute("style"),n.quickPopup.element.style.display="block",n.quickPopup.element.style.height=t.formatUnit("EditEventInfo"===a?65:window.innerHeight);else{n.quickPopup.offsetX=10,n.quickPopup.collision={X:n.parent.enableRtl?"flip":"none",Y:"fit"},n.quickPopup.position={X:n.parent.enableRtl?"left":"right",Y:n.parent.enableRtl?"bottom":"top"},n.quickPopup.dataBind(),n.quickPopup.refreshPosition(null,!0);var l=i.isCollide(n.quickPopup.element,n.parent.element);if(l.indexOf(n.parent.enableRtl?"left":"right")>-1&&(n.quickPopup.offsetX=-e.offsetWidth-10-n.quickPopup.element.offsetWidth,n.quickPopup.dataBind(),i.isCollide(n.quickPopup.element,n.parent.element).indexOf("left")>-1&&(n.quickPopup.position={X:"center",Y:"center"},n.quickPopup.collision={X:"fit",Y:"fit"},n.quickPopup.offsetX=-n.quickPopup.element.offsetWidth/2,n.quickPopup.dataBind())),n.parent.virtualScrollModule&&(l.indexOf("top")>-1||l.indexOf("bottom")>-1)){var c=d(n.parent.element.querySelector(".e-content-wrap table"));n.quickPopup.offsetY=c,n.quickPopup.dataBind()}}r&&n.applyEventColor(),n.quickPopup.element.style.display=o,n.quickPopup.dataBind(),n.quickPopup.show()}})},e.prototype.applyEventColor=function(){var e="";e="Agenda"===this.parent.currentView||"MonthAgenda"===this.parent.currentView?this.parent.enableRtl?"border-right-color":"border-left-color":"background-color";var t=this.parent.activeEventData.element.style[e];if(""!==t){var i=this.quickPopup.element.querySelector(".e-popup-header"),n=this.quickPopup.element.querySelector(".e-popup-footer");n&&n.offsetParent&&(i=this.quickPopup.element.querySelector(".e-subject"))&&(i.style.borderLeftColor=t,t="rgba("+t.match(/\d+/g).join()+",0.3)"),i&&(i.style.backgroundColor=t)}},e.prototype.quickPopupOpen=function(){if(this.parent.isAdaptive)return void(this.quickPopup.element.style.top="0px");if(this.quickPopup.element.querySelector(".e-cell-popup")){var e=this.quickPopup.element.querySelector(".e-subject");e&&e.focus()}else{var t=this.quickPopup.element.querySelector(".e-event-edit");t&&t.focus();var i=this.quickPopup.element.querySelector(".e-edit");i&&i.focus()}},e.prototype.quickPopupClose=function(){this.parent.eventBase.focusElement(),this.quickPopup.relateTo="e-work-cells",this.fieldValidator.destroyToolTip(),this.quickPopup.element.querySelectorAll(".e-formvalidator").length&&this.fieldValidator.destroy(),this.destroyPopupButtons("quickPopup"),P(this.quickPopup.element)},e.prototype.morePopupOpen=function(){if(this.parent.isAdaptive)return this.morePopup.element.style.top="0px",this.morePopup.element.style.left="0px",void(this.morePopup.element.style.height=t.formatUnit(window.innerHeight));this.morePopup.element.querySelector(".e-header-date").focus(),this.morePopup.refreshPosition()},e.prototype.morePopupClose=function(){var e=this.parent.element.querySelector(".e-more-appointment-wrapper");e&&t.remove(e)},e.prototype.popupClose=function(e){this.dialogEvent=e,this.isCrudAction=!1,this.quickPopupHide(!0)},e.prototype.quickPopupHide=function(e){var t=this;if(this.quickPopup.element.classList.contains(Ke)){var i,n=this.quickPopup.element.querySelector(".e-cell-popup");if(n){var r=this.quickPopup.element.querySelector(".e-formvalidator");if(this.isCrudAction&&r&&!r.ej2_instances[0].validate())return;var a=this.parent.eventFields,s=this.parent.eventWindow.getObjectFromFormData("e-quick-popup-wrapper");this.parent.eventWindow.setDefaultValueToObject(s),s[a.id]=this.parent.eventBase.getEventMaxID(),s[a.startTime]=this.parent.activeCellsData.startTime,s[a.endTime]=this.parent.activeCellsData.endTime,s[a.isAllDay]=this.parent.activeCellsData.isAllDay,this.parent.resourceBase&&this.parent.resourceBase.setResourceValues(s),i=s}else i=this.parent.activeEventData.event;var o=this.quickPopup.element.querySelector(".e-event-popup"),l={event:this.dialogEvent,type:this.parent.isAdaptive?o?"ViewEventInfo":"EditEventInfo":"QuickInfo",cancel:!1,data:i,element:this.quickPopup.element,target:n?this.parent.activeCellsData.element:this.parent.activeEventData.element};this.parent.trigger("popupClose",l,function(i){if(!i.cancel&&t.quickPopup.element.classList.contains("e-popup-open")){if(n&&t.isCrudAction&&(t.parent.currentAction="Add",t.parent.crudModule.addEvent(i.data)),e){var r=t.quickPopup.hideAnimation;t.quickPopup.hideAnimation=null,t.quickPopup.hide(),t.quickPopup.hideAnimation=r}else t.quickPopup.hide();t.isMultipleEventSelect=!1,t.isCrudAction=!1}})}},e.prototype.navigationClick=function(e){var i=t.closest(e.target,".e-navigate");if(!t.isNullOrUndefined(i)){var n=this.parent.getDateFromElement(e.currentTarget);t.isNullOrUndefined(n)||(this.closeClick(e),this.parent.setProperties({selectedDate:n},!0),this.parent.changeView(this.parent.getNavigateView(),e))}},e.prototype.documentClick=function(e){var i=e.event.target,n=".e-quick-popup-wrapper,.e-header-cells,.e-all-day-cells,.e-work-cells,.e-appointment,.e-popup",r=this.parent.element.querySelector(".e-quick-popup-wrapper");(r&&r.childElementCount>0&&!t.closest(i,n)||!t.closest(i,n))&&(this.quickPopupHide(),this.parent.removeNewEventElement());var a=this.parent.element.querySelector(".e-inline-subject");a&&a!==i&&this.parent.allowInline&&this.parent.inlineModule.documentClick(),t.closest(i,".e-appointment,.e-header-cells")&&this.parent.removeNewEventElement(),t.closest(i,".e-more-popup-wrapper")||!i.classList||i.classList.contains("e-more-indicator")||t.closest(i,"."+Ke)||t.closest(i,".e-work-cells")||this.morePopup.hide()},e.prototype.onClosePopup=function(e){t.isNullOrUndefined(e)||(this.dialogEvent=e),this.quickPopupHide(),this.parent.eventBase.focusElement()},e.prototype.addEventListener=function(){this.parent.on("cellClick",this.cellClick,this),this.parent.on("eventClick",this.eventClick,this),this.parent.on("document-click",this.documentClick,this),this.parent.on(Fe,this.updateMoreEventContent,this)},e.prototype.removeEventListener=function(){this.parent.off("cellClick",this.cellClick),this.parent.off("eventClick",this.eventClick),this.parent.off("document-click",this.documentClick),this.parent.off(Fe,this.updateMoreEventContent)},e.prototype.destroyPopupButtons=function(e){for(var t="quickPopup"===e?this.quickPopup:this.morePopup,i=0,n=[].slice.call(t.element.querySelectorAll(".e-control.e-btn"));i<n.length;i++){var r=n[i].ej2_instances[0];r&&r.destroy()}},e.prototype.refreshQuickDialog=function(){this.destroyQuickDialog(),this.renderQuickDialog()},e.prototype.refreshQuickPopup=function(){this.destroyQuickPopup(),this.renderQuickPopup()},e.prototype.refreshMorePopup=function(){this.destroyMorePopup(),this.renderMorePopup()},e.prototype.destroyQuickDialog=function(){this.quickDialog.element&&(this.quickDialog.destroy(),t.remove(this.quickDialog.element),this.quickDialog=null)},e.prototype.destroyQuickPopup=function(){this.quickPopup.element&&(this.destroyPopupButtons("quickPopup"),this.quickPopup.destroy(),t.remove(this.quickPopup.element),this.quickPopup=null)},e.prototype.destroyMorePopup=function(){this.morePopup.element&&(this.destroyPopupButtons("morePopup"),this.morePopup.destroy(),t.remove(this.morePopup.element),this.morePopup=null)},e.prototype.destroy=function(){this.quickPopup.element.querySelectorAll(".e-formvalidator").length&&this.fieldValidator.destroy(),this.removeEventListener(),this.destroyQuickPopup(),this.destroyMorePopup(),this.destroyQuickDialog(),this.parent=null,this.l10n=null,this.isCrudAction=null,this.fieldValidator=null,this.isMultipleEventSelect=null},e}(),qt=function(){function e(e){this.parent=e,this.tooltipObj=new i.Tooltip({animation:{close:{effect:"FadeOut"}},content:"No title",position:"BottomRight",offsetY:10,mouseTrail:!this.parent.isAdaptive,showTipPointer:!1,cssClass:this.parent.cssClass+" "+et,target:this.getTargets(),beforeRender:this.onBeforeRender.bind(this),beforeClose:this.onBeforeClose.bind(this),enableRtl:this.parent.enableRtl}),this.tooltipObj.appendTo(this.parent.element)}return e.prototype.getTargets=function(){var e=[];return this.parent.activeViewOptions.group.headerTooltipTemplate&&e.push(".e-resource-cells"),this.parent.eventSettings.enableTooltip&&e.push(".e-appointment"),e.join(",")},e.prototype.onBeforeRender=function(e){if(t.isNullOrUndefined(e.target.getAttribute("data-tooltip-id"))){if(e.target.classList.contains("e-resource-cells")&&this.parent.activeViewOptions.group.resources.length>0){var i=void 0;if(this.parent.activeView.isTimelineView()){var n=parseInt(e.target.getAttribute("data-group-index"),10);i=this.parent.resourceBase.lastResourceLevel[n]}else{var r=e.target.parentNode.sectionRowIndex,a=e.target.cellIndex;i=this.parent.activeView.getColumnLevels()[r][a]}var s={resource:i.resource,resourceData:i.resourceData},o=t.createElement("div"),l=this.parent.element.id+"_headerTooltipTemplate",c=[].slice.call(this.parent.getHeaderTooltipTemplate()(s,this.parent,"headerTooltipTemplate",l,!1));return t.append(c,o),this.setContent(o),void this.parent.renderTemplates()}var p=this.parent.eventBase.getEventByGuid(e.target.getAttribute("data-guid"));if(!t.isNullOrUndefined(p)){if(t.isNullOrUndefined(this.parent.eventSettings.tooltipTemplate)){var h=this.parent.globalize,d=this.parent.eventFields,u=new Date(""+p[d.startTime]),v=new Date(""+p[d.endTime]);v=0===v.getHours()&&0===v.getMinutes()?new Date(v.setMilliseconds(-1e3)):v;var m=w(new Date(""+u)),g=w(new Date(""+v)),f=p[d.subject]||this.parent.eventSettings.fields.subject.default||this.parent.localeObj.getConstant("addTitle"),y=t.isNullOrUndefined(p[d.location])?"":p[d.location],T="",D="",b="";T=h.formatDate(u,{type:"date",skeleton:"MMMd",calendar:this.parent.getCalendarMode()}),D=h.formatDate(u,{type:"date",skeleton:"medium",calendar:this.parent.getCalendarMode()}),b=h.formatDate(v,{type:"date",skeleton:"medium",calendar:this.parent.getCalendarMode()}),T=L(T,"single"),D=L(D,"single"),b=L(b,"single");var C=h.formatDate(u,{type:"time",skeleton:"short",calendar:this.parent.getCalendarMode()}),O=h.formatDate(v,{type:"time",skeleton:"short",calendar:this.parent.getCalendarMode()}),E=void 0,S='<div><div class="e-subject">'+f+'</div><div class="e-location">'+y+'</div><div class="e-details">'+(E=m.getTime()===g.getTime()?L(E=h.formatDate(u,{type:"date",skeleton:"long",calendar:this.parent.getCalendarMode()}),"single"):m.getFullYear()===g.getFullYear()?T+" - "+b:D+" - "+b)+'</div><div class="e-all-day">'+(p[d.isAllDay]?this.parent.localeObj.getConstant("allDay"):C+" - "+O)+"</div></div>";this.setContent(S)}else{var o=t.createElement("div"),l=this.parent.element.id+"_tooltipTemplate",c=[].slice.call(this.parent.getEventTooltipTemplate()(p,this.parent,"tooltipTemplate",l,!1));t.append(c,o),this.setContent(o)}this.parent.renderTemplates()}}},e.prototype.onBeforeClose=function(){this.parent.resetTemplates(["tooltipTemplate","headerTooltipTemplate"])},e.prototype.setContent=function(e){this.tooltipObj.setProperties({content:e},!0)},e.prototype.close=function(){this.tooltipObj.close()},e.prototype.destroy=function(){this.tooltipObj.destroy(),t.addClass([this.parent.element],"e-control"),this.tooltipObj=null,this.parent=null},e}(),Lt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Nt=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},Ft="e-input-wrapper",Ut="e-form-left",Bt="e-recurrence-count",Wt="e-hide-recurrence-element",zt="e-primary",Yt={none:"",daily:"days",weekly:"weeks",monthly:"months",yearly:"years"},_t={sun:"SU",mon:"MO",tue:"TU",wed:"WE",thu:"TH",fri:"FR",sat:"SA"},Gt=["e-days","e-non-week","e-end-on","e-interval","e-year-expander","e-month-expander"],Xt=["e-non-week"],Qt=["e-days","e-year-expander"],Kt=["e-days"],Zt=["e-days","e-non-week","e-year-expander","e-month-expander"],Jt=["e-end-on-date","e-end-on-count"],$t=["e-end-on-date"],ei=["e-end-on-count"],ti=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.defaultLocale={none:"None",daily:"Daily",weekly:"Weekly",monthly:"Monthly",month:"Month",yearly:"Yearly",never:"Never",until:"Until",count:"Count",first:"First",second:"Second",third:"Third",fourth:"Fourth",last:"Last",repeat:"Repeat",repeatEvery:"Repeat every",on:"Repeat On",end:"End",onDay:"Day",days:"Day(s)",weeks:"Week(s)",months:"Month(s)",years:"Year(s)",every:"every",summaryTimes:"time(s)",summaryOn:"on",summaryUntil:"until",summaryRepeat:"Repeats",summaryDay:"day(s)",summaryWeek:"week(s)",summaryMonth:"month(s)",summaryYear:"year(s)",monthWeek:"Month Week",monthPosition:"Month Position",monthExpander:"Month Expander",yearExpander:"Year Expander",repeatInterval:"Repeat Interval"},n.renderStatus=!1,n.dayButtons=[],n.monthButtons=[],n}return Lt(i,e),i.prototype.startState=function(e,t,i){this.showFormElement(),this.updateForm(e),this.freshOnEndForm(),this.updateEndOnForm(t),this.selectMonthDay(i),this.updateUntilDate(i),this.onMonthDay.setProperties({checked:!0})},i.prototype.preRender=function(){this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.calendarUtil=ke(this.calendarMode)},i.prototype.applyCustomClass=function(e){e&&t.addClass([this.element],e.split(" "))},i.prototype.initialize=function(){t.addClass([this.element],"e-"+this.getModuleName()),this.renderComponent(),t.isNullOrUndefined(this.value)||""===this.value?(t.isNullOrUndefined(this.repeatType.value)||(this.startState(this.repeatType.value.toString().toUpperCase(),"never",this.startDate),this.updateForm(this.repeatType.value.toString())),this.selectedType>0&&this.setProperties({value:this.getRecurrenceRule()},!1)):this.setRecurrenceRule(this.value),this.applyCustomClass(this.cssClass)},i.prototype.triggerChangeEvent=function(){var e=this;if(this.renderStatus){var t=this.getRecurrenceRule();this.trigger("change",{value:t},function(t){return e.setProperties({value:t.value},!1)})}},i.prototype.resetDayButton=function(){[].slice.call(this.element.querySelectorAll(".e-days button")).forEach(function(e){return t.removeClass([e],["e-active",zt])})},i.prototype.daySelection=function(e){this.resetDayButton();var i=[0,1,2,3,4,5,6];this.rotateArray(i,this.firstDayOfWeek);var n=this.element.querySelector('.e-days button[data-index="'+i.indexOf(e)+'"]');n&&t.addClass([n],["e-active",zt])},i.prototype.rtlClass=function(e){e?t.addClass([this.element],"e-rtl"):t.removeClass([this.element],"e-rtl")},i.prototype.updateUntilDate=function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+60),this.untilDateObj.setProperties({value:t})},i.prototype.selectMonthDay=function(e){var t=["sun","mon","tue","wed","thu","fri","sat"];this.monthDate.setProperties({value:this.calendarUtil.getDate(e)}),this.monthWeekDays.setProperties({value:_t[t[e.getDay()]]}),this.monthValue.setProperties({value:""+this.calendarUtil.getMonth(e)}),this.monthWeekPos.setProperties({value:this.getDayPosition(e)}),this.daySelection(e.getDay())},i.prototype.updateForm=function(e){var i=this;this.repeatType.setProperties({value:e});var n=this.element.querySelector(".e-end-on");switch("daily"===e?t.classList(n,[Ut],["e-form-right"]):t.classList(n,["e-form-right"],[Ut]),e){case"none":Gt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"weekly":Xt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"monthly":Qt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"yearly":Kt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"daily":Zt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)})}},i.prototype.updateEndOnForm=function(e){var i=this;switch(this.endType.setProperties({value:e}),e){case"never":Jt.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"until":ei.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)});break;case"count":$t.forEach(function(e){return t.addClass([i.element.querySelector("."+e)],Wt)})}},i.prototype.freshOnEndForm=function(){var e=this;Jt.forEach(function(i){var n=e.element.querySelector("."+i);n&&t.removeClass([n],Wt)})},i.prototype.showFormElement=function(){var e=this;Gt.forEach(function(i){var n=e.element.querySelector("."+i);n&&t.removeClass([n],Wt)})},i.prototype.renderDropdowns=function(){var e=this,t=this;this.repeatType=new l.DropDownList({dataSource:this.getRepeatData(),floatLabelType:"Always",enableRtl:this.enableRtl,index:this.selectedType,fields:{text:"text",value:"value"},placeholder:this.localeObj.getConstant("repeat"),htmlAttributes:{title:this.localeObj.getConstant("repeat")},change:function(i){t.setProperties({selectedType:e.frequencies.indexOf(i.value)},!1),t.element.querySelector(".e-repeat-content").innerHTML=t.localeObj.getConstant(Yt[i.value]),t.showFormElement(),t.updateForm(i.value),t.resetFormValues(),t.triggerChangeEvent()}}),this.repeatType.appendTo(this.element.querySelector(".e-repeat-element")),this.endType=new l.DropDownList({dataSource:this.getEndData(),popupWidth:this.getPopupWidth(),enableRtl:this.enableRtl,index:1,fields:{text:"text",value:"value"},change:function(e){t.freshOnEndForm(),t.updateEndOnForm(e.value),t.resetFormValues(),t.triggerChangeEvent()}}),this.endType.appendTo(this.element.querySelector(".e-end-on-element"));var i=function(i){return new l.DropDownList({dataSource:i,popupWidth:e.getPopupWidth(),enableRtl:e.enableRtl,fields:{text:"text",value:"value"},index:1,change:function(e){t.onWeekDay.setProperties({checked:!0}),t.resetFormValues(),t.triggerChangeEvent()}})};this.monthWeekPos=i(this.getMonthPosData()),this.monthWeekPos.appendTo(this.element.querySelector(".e-month-pos")),this.monthWeekDays=i(this.getDayData("wide")),this.monthWeekDays.appendTo(this.element.querySelector(".e-month-week")),this.monthValue=new l.DropDownList({dataSource:this.getMonthData(),fields:{text:"text",value:"value"},enableRtl:this.enableRtl,index:7,change:function(e){t.resetFormValues(),t.triggerChangeEvent()}}),this.monthValue.appendTo(this.element.querySelector(".e-year-expander-element"))},i.prototype.setDefaultValue=function(){for(var e=0,t=[].slice.call(this.element.querySelectorAll(".e-control .e-numerictextbox"));e<t.length;e++){var i=t[e].ej2_instances[0];i.element.classList.contains("e-repeat-interval")?(i.value=1,i.dataBind()):i.element.classList.contains(Bt)&&(i.value=10,i.dataBind())}},i.prototype.resetFormValues=function(){for(var e=0,t=[].slice.call(this.element.querySelectorAll('.e-control [type="text"]'));e<t.length;e++){var i=t[e],n=void 0;if(i.classList.contains("e-datepicker"))(n=i.ej2_instances[0]).value?(n.value=n.value,n.dataBind()):this.updateUntilDate(this.startDate);else if(i.classList.contains("e-dropdownlist"))(n=i.ej2_instances[0]).index=n.index||0,n.dataBind();else if(i.classList.contains("e-numerictextbox")){var r=void 0;r=(n=i.ej2_instances[0]).element.classList.contains("e-repeat-interval")?1:n.element.classList.contains(Bt)?10:this.startDate.getDate(),n.value=n.value||r,n.dataBind()}}},i.prototype.getPopupWidth=function(){return t.Browser.isDevice?"100%":"auto"},i.prototype.renderDatePickers=function(){var e=this;this.untilDateObj=new r.DatePicker({firstDayOfWeek:this.firstDayOfWeek,enableRtl:this.enableRtl,locale:this.locale,min:this.minDate,max:this.maxDate,format:t.isNullOrUndefined(this.dateFormat)?this.getFormat("dateFormats"):this.dateFormat,change:function(t){t.value&&e.triggerChangeEvent()}}),this.untilDateObj.appendTo(this.element.querySelector(".e-until-date"))},i.prototype.getFormat=function(e){return"en"===this.locale||"en-US"===this.locale?t.getValue(e+".short",t.getDefaultDateObject(this.getCalendarMode())):t.getValue("main."+this.locale+".dates.calendars."+this.getCalendarMode()+"."+e+".short",t.cldrData)},i.prototype.dayButtonRender=function(){for(var e=this,i=this,n=0,r=[].slice.call(this.element.querySelectorAll(".e-days button"));n<r.length;n++){var a=r[n],o=new s.Button({isToggle:!0,enableRtl:this.enableRtl},a);this.dayButtons.push(o),t.EventHandler.add(a,"click",function(n){var r=[].slice.call(e.element.querySelectorAll(".e-days button."+zt)),a=n.target;a.classList.contains(zt)?r.length>1&&(t.removeClass([a],zt),i.triggerChangeEvent()):(t.addClass([a],zt),i.triggerChangeEvent())})}},i.prototype.radioButtonRender=function(){var e=this;this.onMonthDay=new s.RadioButton({label:this.localeObj.getConstant("onDay"),enableRtl:this.enableRtl,name:"monthType",value:"day",change:function(){e.resetFormValues(),e.triggerChangeEvent()}}),this.onMonthDay.appendTo(this.element.querySelector(".e-month-expander-element")),this.monthButtons.push(this.onMonthDay),this.onWeekDay=new s.RadioButton({label:this.localeObj.getConstant("monthExpander"),cssClass:"e-month-type",name:"monthType",enableRtl:this.enableRtl,value:"daypos",change:function(){e.resetFormValues(),e.triggerChangeEvent()}}),this.onWeekDay.appendTo(this.element.querySelector(".e-month-expander-wrapper")),this.monthButtons.push(this.onWeekDay)},i.prototype.numericTextboxRender=function(){var e=this;this.recurrenceCount=new o.NumericTextBox({value:10,format:"#",enableRtl:this.enableRtl,min:1,max:999,change:function(){e.triggerChangeEvent()}}),this.recurrenceCount.appendTo(this.element.querySelector("."+Bt)),this.monthDate=new o.NumericTextBox({value:1,format:"#",enableRtl:this.enableRtl,min:1,max:31,change:function(){e.onMonthDay.setProperties({checked:!0}),e.triggerChangeEvent()}}),this.monthDate.appendTo(this.element.querySelector(".e-month-day")),this.repeatInterval=new o.NumericTextBox({value:1,format:"#",min:1,max:999,enableRtl:this.enableRtl,floatLabelType:"Always",placeholder:this.localeObj.getConstant("repeatEvery"),change:function(){e.triggerChangeEvent()}}),this.repeatInterval.appendTo(this.element.querySelector(".e-repeat-interval"))},i.prototype.renderComponent=function(){this.setTemplate(),this.renderDropdowns(),this.renderDatePickers(),this.dayButtonRender(),this.radioButtonRender(),this.numericTextboxRender()},i.prototype.rotateArray=function(e,t){for(var i,n=0;n<t;n++)i=e.shift(),e.push(i)},i.prototype.getEndData=function(){var e=this,t=[];return["never","until","count"].forEach(function(i){t.push({text:e.localeObj.getConstant(i),value:i})}),t},i.prototype.getDayPosition=function(e){var t=new Date(e.getTime()),i=new Date(e.getTime()),n=e.getDay(),r=[];for(t=this.calendarUtil.getMonthStartDate(t),i=this.calendarUtil.getMonthEndDate(i);t<i;)t.getDay()===n&&r.push(t.getTime()),t.setDate(t.getDate()+1);return r.indexOf(e.getTime())===r.length-1?-1:r.indexOf(e.getTime())+1},i.prototype.getRepeatData=function(){var e=[],t=this;return this.frequencies.forEach(function(i){var n="none"===i?"never":i;e.push({text:t.localeObj.getConstant(n),value:i})}),e},i.prototype.getMonthPosData=function(){var e={first:1,second:2,third:3,fourth:4,last:-1},t=this,i=[];return["first","second","third","fourth","last"].forEach(function(n){i.push({text:t.localeObj.getConstant(n),value:e[n]})}),i},i.prototype.getDayData=function(e){var i,n=["sun","mon","tue","wed","thu","fri","sat"],r=[];if(this.rotateArray(n,this.firstDayOfWeek),"en"===this.locale||"en-US"===this.locale){a="days.stand-alone.";i=t.getValue(a+e,t.getDefaultDateObject(this.getCalendarMode()))}else{var a="main."+this.locale+".dates.calendars."+this.getCalendarMode()+".days.stand-alone."+e;i=t.getValue(a,t.cldrData)}for(var s=0,o=n;s<o.length;s++){var l=o[s],c=t.getValue(l,i);r.push({text:"narrow"===e?c:L(c,"single"),value:_t[l]})}return r},i.prototype.getMonthData=function(){var e,i=[];if("en"===this.locale||"en-US"===this.locale){n="months.stand-alone.wide";e=t.getValue(n,t.getDefaultDateObject(this.getCalendarMode()))}else{var n="main."+this.locale+".dates.calendars."+this.getCalendarMode()+".months.stand-alone.wide";e=t.getValue(n,t.cldrData)}for(var r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];i.push({text:L(t.getValue(s,e),"single"),value:s})}return i},i.prototype.setTemplate=function(){var e=this.getDayData("narrow"),t=this.getDayData("wide");this.element.innerHTML='<div class="e-editor"><div class="e-input-wrapper e-form-left"><input type="text" tabindex="0" class="e-repeat-element"label="'+"e-repeat-element".substr(2)+'" /></div><div class="'+Ft+' e-interval e-form-right"><table  class="e-recurrence-table e-repeat-content-wrapper"><tr><td><input type="text" tabindex="0" class="e-repeat-interval"title="'+this.localeObj.getConstant("repeatEvery")+'" /></td><td><span class="e-repeat-content"></span></td></tr></table></div><div class="e-input-wrapper-side e-days '+Ut+'"><div class=e-week-expander-label>'+this.localeObj.getConstant("on")+'</div><button type="button" class="e-round" data-index="0" title="'+t[0].text+'">'+e[0].text+'</button><button type="button" class="e-round" data-index="1" title="'+t[1].text+'">'+e[1].text+'</button><button type="button" class="e-round" data-index="2" title="'+t[2].text+'">'+e[2].text+'</button><button type="button" class="e-round" data-index="3" title="'+t[3].text+'">'+e[3].text+'</button><button type="button" class="e-round" data-index="4" title="'+t[4].text+'">'+e[4].text+'</button><button type="button" class="e-round" data-index="5" title="'+t[5].text+'">'+e[5].text+'</button><button type="button" class="e-round" data-index="6" title="'+t[6].text+'">'+e[6].text+'</button></div><div class="e-input-wrapper-side e-non-week '+Ut+'"><div class=e-month-expander-label>'+this.localeObj.getConstant("on")+'</div><div class="e-year-expander"><input class="e-year-expander-element" type="text" tabindex="0" title="'+this.localeObj.getConstant("yearExpander")+'"/></div><div class="e-month-expander"><table class="e-recurrence-table e-month-expand-wrapper"><tr><td><div class="'+Ft+' e-month-expander-checkbox-wrapper"><input class="e-month-expander-element"title="'+this.localeObj.getConstant("monthExpander")+'" type="radio"></div></td><td colspan="2"><div class="'+Ft+' e-monthday-element"><input type="text" tabindex="0" class="e-month-day"title="'+this.localeObj.getConstant("on")+'" /></div></td></tr><tr><td><div class="'+Ft+' e-month-expander-checkbox-wrapper" style="min-width: 30px;margin-bottom:18px;"><input class="e-month-expander-wrapper"title="'+this.localeObj.getConstant("monthExpander")+'" type="radio"></div></td><td><div class="'+Ft+' e-week-position" ><input type="text" tabindex="0" class="e-month-pos"title="'+this.localeObj.getConstant("monthPosition")+'" /></div></td><td><div class="'+Ft+' e-day-position"><input type="text" tabindex="0" class="e-month-week"title="'+this.localeObj.getConstant("monthWeek")+'" /></div></td></tr></table></div></div><div class="e-input-wrapper-side e-end-on e-form-right"><div class=e-end-on-label>'+this.localeObj.getConstant("end")+'</div><div class="'+Ft+' e-end-on-left"><input type="text" tabindex="0" class="e-end-on-element"title="'+this.localeObj.getConstant("end")+'" /></div><div class="'+Ft+' e-end-on-date" ><input type="text" tabindex="0" class="e-until-date"title="'+this.localeObj.getConstant("until")+'" /></div><div class="'+Ft+' e-end-on-count"><input type="text" tabindex="0" class="'+Bt+'"title="'+this.localeObj.getConstant("count")+'" /></div></div></div></div>'},i.prototype.getSelectedDaysData=function(){var e="BYDAY=",t=[].slice.call(this.element.querySelectorAll(".e-days button."+zt)),i=["SU","MO","TU","WE","TH","FR","SA"];this.rotateArray(i,this.firstDayOfWeek);for(var n=0;n<t.length;n++)e+=i[parseInt(t[n].getAttribute("data-index"),10)]+(n===t.length-1?"":",");return e+";"},i.prototype.getSelectedMonthData=function(){return this.onWeekDay.checked?"BYDAY="+this.monthWeekDays.value+";BYSETPOS="+this.monthWeekPos.value+";":"BYMONTHDAY="+this.monthDate.value+";"},i.prototype.getIntervalData=function(){return"INTERVAL="+this.repeatInterval.value+";"},i.prototype.getEndOnCount=function(){return"COUNT="+this.recurrenceCount.value+";"},i.prototype.getYearMonthRuleData=function(){return"BYMONTH="+this.monthValue.value+";"},i.prototype.updateWeekButton=function(e){var t=["SU","MO","TU","WE","TH","FR","SA"];this.rotateArray(t,this.firstDayOfWeek);for(var i=0,n=this.dayButtons;i<n.length;i++){var r=n[i],a=parseInt(r.element.getAttribute("data-index"),10);-1!==e.indexOf(t[a])?r.setProperties({isPrimary:!0}):r.setProperties({isPrimary:!1})}},i.prototype.updateMonthUI=function(){if(this.ruleObject.monthDay.length)this.monthDate.setProperties({value:this.ruleObject.monthDay[0]}),this.onMonthDay.setProperties({checked:!0});else{this.onWeekDay.setProperties({checked:!0}),this.monthWeekPos.setProperties({value:this.ruleObject.setPosition});for(var e=0,t=Object.keys(_t);e<t.length;e++){var i=t[e];if(_t[i]===this.ruleObject.day[0]){this.monthWeekDays.setProperties({value:this.ruleObject.day[0]});break}}}},i.prototype.updateUI=function(e,t){switch(this.repeatInterval.setProperties({value:this.ruleObject.interval}),t){case"until":this.untilDateObj.setProperties({value:this.ruleObject.until});break;case"count":this.recurrenceCount.setProperties({value:this.ruleObject.count})}switch(e){case"weekly":this.updateWeekButton(this.ruleObject.day);break;case"yearly":this.monthValue.setProperties({index:this.ruleObject.month[0]-1}),this.updateMonthUI();break;case"monthly":this.updateMonthUI()}},i.prototype.getUntilData=function(){return this.untilDateObj.value?"UNTIL="+Me(this.untilDateObj.value)+";":""},i.prototype.destroyComponents=function(){this.recurrenceCount.isDestroyed||this.recurrenceCount.destroy(),this.monthDate.isDestroyed||this.monthDate.destroy(),this.repeatInterval.isDestroyed||this.repeatInterval.destroy(),this.untilDateObj.isDestroyed||this.untilDateObj.destroy(),this.repeatType.isDestroyed||this.repeatType.destroy(),this.endType.isDestroyed||this.endType.destroy(),this.monthWeekPos.isDestroyed||this.monthWeekPos.destroy(),this.monthWeekDays.isDestroyed||this.monthWeekDays.destroy(),this.monthValue.isDestroyed||this.monthValue.destroy(),this.dayButtons.forEach(function(e){e.isDestroyed||e.destroy()}),this.dayButtons=[],this.monthButtons.forEach(function(e){e.isDestroyed||e.destroy()}),this.monthButtons=[]},i.prototype.resetFields=function(){this.startState("none","never",this.startDate),this.setDefaultValue()},i.prototype.updateRuleUntilDate=function(e){if(this.untilDateObj.value&&e){var t=this.untilDateObj.value,i=new Date(t.getFullYear(),t.getMonth(),t.getDate(),e.getHours(),e.getMinutes(),e.getMilliseconds());this.untilDateObj.setProperties({value:i})}},i.prototype.getCalendarMode=function(){return this.calendarMode.toLowerCase()},i.prototype.getRuleSummary=function(e){return void 0===e&&(e=this.getRecurrenceRule()),N(e,this.localeObj,this.locale,this.calendarMode)},i.prototype.getRecurrenceDates=function(e,i,n,r,a){return a=t.isNullOrUndefined(a)?this.startDate:a,U(e,i,n,this.firstDayOfWeek,r,a,this.calendarMode)},i.prototype.getRecurrenceRule=function(){var e="FREQ=";switch(this.repeatType.value){case"daily":e+="DAILY;";break;case"weekly":e+="WEEKLY;"+this.getSelectedDaysData();break;case"monthly":e+="MONTHLY;"+this.getSelectedMonthData();break;case"yearly":e+="YEARLY;"+this.getSelectedMonthData()+this.getYearMonthRuleData();break;case"none":return""}switch(e+=this.getIntervalData(),this.endType.value){case"until":e+=this.getUntilData();break;case"count":e+=this.getEndOnCount()}return e},i.prototype.setRecurrenceRule=function(e,t){if(void 0===t&&(t=this.startDate),!e)return void this.repeatType.setProperties({value:"none"});this.renderStatus=!1,this.ruleObject=we(e);var i=this.ruleObject.count?"count":this.ruleObject.until?"until":"never";switch(this.ruleObject.freq){case"DAILY":this.startState("daily",i,t),this.updateUI("daily",i);break;case"WEEKLY":this.startState("weekly",i,t),this.updateUI("weekly",i);break;case"MONTHLY":this.startState("monthly",i,t),this.updateUI("monthly",i);break;case"YEARLY":this.startState("yearly",i,t),this.updateUI("yearly",i)}this.renderStatus=!0,this.triggerChangeEvent()},i.prototype.destroy=function(){this.destroyComponents(),e.prototype.destroy.call(this);var i=["e-"+this.getModuleName()];for(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),t.removeClass([this.element],i);this.element.firstElementChild;)this.element.removeChild(this.element.firstElementChild)},i.prototype.getModuleName=function(){return"recurrenceeditor"},i.prototype.getPersistData=function(){return this.addOnPersist([])},i.prototype.render=function(){this.initialize(),this.rtlClass(this.enableRtl),this.renderStatus=!0,this.renderComplete()},i.prototype.onPropertyChanged=function(e,i){for(var n=0,r=Object.keys(e);n<r.length;n++)switch(r[n]){case"startDate":this.selectMonthDay(e.startDate),this.updateUntilDate(e.startDate),this.endType.setProperties({index:0});break;case"enableRtl":this.rtlClass(e.enableRtl);break;case"cssClass":i.cssClass&&t.removeClass([this.element],i.cssClass.split(" ")),e.cssClass&&t.addClass([this.element],e.cssClass.split(" "));break;case"selectedType":this.repeatType.setProperties({index:this.selectedType});break;case"minDate":this.untilDateObj.setProperties({minDate:this.minDate});break;case"maxDate":this.untilDateObj.setProperties({maxDate:this.maxDate});break;case"value":this.getRecurrenceRule()!==this.value&&this.setRecurrenceRule(this.value);break;case"calendarMode":this.calendarMode=e.calendarMode,this.calendarUtil=ke(e.calendarMode);break;case"locale":case"frequencies":case"firstDayOfWeek":this.refresh();break;case"dateFormat":this.untilDateObj.setProperties({format:e.dateFormat})}},Nt([t.Property(["none","daily","weekly","monthly","yearly"])],i.prototype,"frequencies",void 0),Nt([t.Property(0)],i.prototype,"firstDayOfWeek",void 0),Nt([t.Property(new Date)],i.prototype,"startDate",void 0),Nt([t.Property()],i.prototype,"dateFormat",void 0),Nt([t.Property("Gregorian")],i.prototype,"calendarMode",void 0),Nt([t.Property()],i.prototype,"cssClass",void 0),Nt([t.Property()],i.prototype,"value",void 0),Nt([t.Property(new Date(1900,0,1))],i.prototype,"minDate",void 0),Nt([t.Property(new Date(2099,11,31))],i.prototype,"maxDate",void 0),Nt([t.Property(0)],i.prototype,"selectedType",void 0),Nt([t.Event()],i.prototype,"change",void 0),i=Nt([t.NotifyPropertyChanges],i)}(t.Component),ii=function(){function e(e){this.parent=e,this.l10n=this.parent.localeObj,this.fields=this.parent.eventFields,this.eventWindowTime={startTime:new Date,endTime:new Date},this.renderEventWindow()}return e.prototype.renderEventWindow=function(){this.element=t.createElement("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);var e={animationSettings:{effect:"Zoom"},content:this.getEventWindowContent(),cssClass:"e-schedule-dialog",enableRtl:this.parent.enableRtl,height:this.parent.isAdaptive?"100%":"auto",minHeight:"300px",isModal:!0,showCloseIcon:!this.parent.isAdaptive,target:document.body,visible:!1,width:"500px",beforeOpen:this.onBeforeOpen.bind(this),beforeClose:this.onBeforeClose.bind(this)};this.parent.isAdaptive?(e.cssClass="e-schedule-dialog e-device",e.header='<div class="e-title-header"><div class="e-back-icon e-icons"></div><div class="e-title-text">'+this.l10n.getConstant("newEvent")+'</div><div class="e-save-icon e-icons"></div></div>'):(e.buttons=[{buttonModel:{content:this.l10n.getConstant("deleteButton"),cssClass:"e-event-delete",disabled:!this.parent.eventSettings.allowDeleting||this.parent.readonly},click:this.eventDelete.bind(this)},{buttonModel:{content:this.l10n.getConstant("saveButton"),cssClass:"e-primary e-event-save",isPrimary:!0,disabled:!this.parent.eventSettings.allowAdding||this.parent.readonly},click:this.eventSave.bind(this)},{buttonModel:{cssClass:"e-event-cancel",content:this.l10n.getConstant("cancelButton")},click:this.dialogClose.bind(this)}],e.header='<div class="e-title-text">'+this.l10n.getConstant("newEvent")+"</div>"),this.dialogObject=new i.Dialog(e,this.element),this.dialogObject.element.querySelector(".e-dlg-closeicon-btn")&&this.dialogObject.element.querySelector(".e-dlg-closeicon-btn").setAttribute("title",this.l10n.getConstant("close")),t.addClass([this.element.parentElement],"e-schedule-dialog-container"),this.parent.isAdaptive&&(t.EventHandler.add(this.element.querySelector(".e-back-icon"),"click",this.dialogClose,this),t.EventHandler.add(this.element.querySelector(".e-save-icon"),"click",this.eventSave,this)),t.EventHandler.add(this.dialogObject.element,"keydown",this.preventEventSave,this),this.applyFormValidation()},e.prototype.refresh=function(){this.destroy(!0),this.renderEventWindow()},e.prototype.refreshRecurrenceEditor=function(){if(this.recurrenceEditor){var e=this.recurrenceEditor.element;this.recurrenceEditor.destroy(),this.createRecurrenceEditor(e)}},e.prototype.setRecurrenceEditor=function(e){this.parent.editorTemplate&&(this.recurrenceEditor=e)},e.prototype.openEditor=function(e,i,n,r){if(this.parent.currentAction=i,this.parent.removeNewEventElement(),this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(!0),this.parent.inlineModule.removeInlineAppointmentElement(),"Add"===i){var a={};this.cellClickAction=!n,this.parent.activeCellsData=e;var s=e;this.cellClickAction?this.convertToEventData(s,a):(this.parent.activeCellsData={startTime:s.startTime||s[this.fields.startTime],endTime:s.endTime||s[this.fields.endTime],isAllDay:s.isAllDay||s[this.fields.isAllDay],element:s.element,groupIndex:s.groupIndex},a=s),e=a}switch(t.isNullOrUndefined(this.parent.editorTemplate)||this.renderFormElements(this.element.querySelector(".e-schedule-form"),e),!this.parent.isAdaptive&&t.isNullOrUndefined(this.parent.editorTemplate)&&t.removeClass([this.dialogObject.element.querySelector(".e-recurrenceeditor")],"e-disable"),this.recurrenceEditor&&(this.recurrenceEditor.firstDayOfWeek=this.parent.activeViewOptions.firstDayOfWeek),i){case"Add":this.onCellDetailsUpdate(e,r);break;case"Save":case"EditOccurrence":case"EditSeries":case"EditFollowingEvents":"EditOccurrence"===i&&!this.parent.isAdaptive&&t.isNullOrUndefined(this.parent.editorTemplate)&&t.addClass([this.dialogObject.element.querySelector(".e-recurrenceeditor")],"e-disable"),this.cellClickAction=!1,this.onEventDetailsUpdate(e)}},e.prototype.setDialogContent=function(){this.dialogObject.content=this.getEventWindowContent(),this.dialogObject.dataBind()},e.prototype.preventEventSave=function(e){this.parent&&!this.parent.allowKeyboardInteraction&&"Enter"===e.code&&(this.isEnterKey=!0)},e.prototype.onBeforeOpen=function(e){var i=this,n={type:"Editor",data:this.eventData,cancel:!1,element:this.element,target:this.cellClickAction?this.parent.activeCellsData.element:this.parent.activeEventData.element};this.cellClickAction&&(n.duration=this.getSlotDuration());var r=this.getInstance("e-event-save");r&&(r.disabled=!(this.cellClickAction?this.parent.eventSettings.allowAdding:this.parent.eventSettings.allowEditing),r.dataBind());var s=this.getInstance("e-event-delete");s&&(s.disabled=!this.parent.eventSettings.allowDeleting,s.dataBind());var o=new a.Deferred;return this.parent.trigger("popupOpen",n,function(n){if(e.cancel=n.cancel,i.duration=i.cellClickAction?n.duration:null,i.refreshDateTimePicker(i.duration),i.cellClickAction&&n.duration!==i.getSlotDuration()&&t.isNullOrUndefined(i.parent.editorTemplate)){var r=i.getInstance("e-start"),a=i.getInstance("e-end");a.value=new Date(r.value.getTime()+ze*n.duration),a.dataBind()}i.parent.editorTemplate&&i.element.querySelector(".e-recurrenceeditor")&&!i.recurrenceEditor&&(i.recurrenceEditor=i.getInstance("e-recurrenceeditor")),o.resolve(e)}),o},e.prototype.onBeforeClose=function(e){var t=this;e.isInteracted&&(this.isCrudAction=!1);var i={type:"Editor",event:e.event||this.dialogEvent,data:this.eventCrudData,cancel:!1,element:this.element,target:this.cellClickAction?this.parent.activeCellsData.element:this.parent.activeEventData.element},n=new a.Deferred;return this.parent.trigger("popupClose",i,function(i){e.cancel=i.cancel,i.cancel||(t.isCrudAction&&(e.cancel=t.processCrudActions(i.data),t.isCrudAction=e.cancel),t.isCrudAction||(t.resetForm(),t.parent.eventBase.focusElement(!0),t.eventCrudData=null)),n.resolve(e)}),n},e.prototype.getEventWindowContent=function(){var e=t.createElement("div",{className:"e-form-container"}),i=t.createElement("form",{id:this.parent.element.id+"EditForm",className:$e,attrs:{onsubmit:"return false;"}});return this.renderFormElements(i),e.appendChild(i),e},e.prototype.renderFormElements=function(e,i){if(t.isNullOrUndefined(this.parent.editorTemplate))e.appendChild(this.getDefaultEventWindowContent());else{if(i){this.recurrenceEditor&&(this.recurrenceEditor.destroy(),this.recurrenceEditor=null),this.destroyComponents();for(var n=0,r=[].slice.call(e.children);n<r.length;n++){var a=r[n];t.remove(a)}}var s=this.parent.element.id+"_editorTemplate",o=[].slice.call(this.parent.getEditorTemplate()(i||{},this.parent,"editorTemplate",s,!1));t.append(o,e),this.parent.renderTemplates()}},e.prototype.getDefaultEventWindowContent=function(){var e=this.createDivElement("e-dialog-parent"),i=this.createDivElement("e-title-location-row");e.appendChild(i),i.appendChild(this.renderTextBox("e-subject")),i.querySelector(".e-subject").setAttribute("title",this.parent.editorTitles.subject),i.appendChild(this.renderTextBox("e-location")),i.querySelector(".e-location").setAttribute("title",this.parent.editorTitles.location);var n=this.createDivElement("e-start-end-row");e.appendChild(n),n.appendChild(this.renderDateTimePicker("e-start",this.onTimeChange.bind(this))),n.querySelector(".e-start").setAttribute("title",this.parent.editorTitles.startTime),n.appendChild(this.renderDateTimePicker("e-end")),n.querySelector(".e-end").setAttribute("title",this.parent.editorTitles.endTime);var r=this.createDivElement("e-all-day-time-zone-row");e.appendChild(r),r.appendChild(this.renderCheckBox("e-all-day")),r.appendChild(this.renderCheckBox("e-time-zone"));var a=this.createDivElement("e-time-zone-row");e.appendChild(a),a.appendChild(this.renderDropDown("e-start-time-zone")),a.appendChild(this.renderDropDown("e-end-time-zone"));var o=this.createDivElement("e-repeat-parent-row");e.appendChild(o);var l=this.renderCheckBox("e-repeat"),c=t.createElement("span",{className:"e-recurrence-container"}),p=t.createElement("button",{className:"e-recurrence-edit-button",attrs:{type:"button",title:this.l10n.getConstant("editRecurrence")}});if(this.buttonObj=new s.Button({iconCss:"e-recurrence-edit e-icons",cssClass:"e-medium "+this.parent.cssClass}),c.appendChild(p),this.buttonObj.appendTo(p),l.appendChild(c),o.appendChild(l),this.parent.isAdaptive?t.EventHandler.add(p,"click",this.loadRecurrenceEditor,this):this.createRecurrenceEditor(e),this.parent.resourceCollection.length>0){for(var h=this.createDivElement("e-resources-row"),d=0,u=this.parent.resourceBase.resourceCollection;d<u.length;d++){var v=u[d];h.appendChild(this.renderResourceDetails(v))}e.appendChild(h)}var m=this.createDivElement("e-description-row");m.appendChild(this.renderTextBox("e-description")),m.querySelector(".e-description").setAttribute("title",this.parent.editorTitles.description),e.appendChild(m);var g=t.createElement("button",{attrs:{type:"hidden",title:"submit",style:"display:none"}});return e.appendChild(g),e},e.prototype.createRecurrenceEditor=function(e){var t=this.createDivElement();e.appendChild(t),this.recurrenceEditor=this.renderRecurrenceEditor(),this.recurrenceEditor.appendTo(t),this.updateMinMaxDateToEditor()},e.prototype.createDivElement=function(e){return t.createElement("div",{className:e})},e.prototype.createInputElement=function(e,i,n){return t.createElement(n||"input",{className:e,attrs:{type:"text",name:i,value:"",id:i,title:""===this.l10n.getConstant(i.charAt(0).toLowerCase()+i.slice(1))?i:this.l10n.getConstant(i.charAt(0).toLowerCase()+i.slice(1))}})},e.prototype.getSlotDuration=function(){return this.parent.activeViewOptions.timeScale.interval/this.parent.activeViewOptions.timeScale.slotCount},e.prototype.renderDateTimePicker=function(e,i){var n=this.createDivElement(e+"-container"),a=this.getFieldName(e),s=this.createInputElement(e+" e-field",a);return n.appendChild(s),new r.DateTimePicker({change:i,firstDayOfWeek:this.parent.activeViewOptions.firstDayOfWeek,calendarMode:this.parent.calendarMode,min:this.parent.minDate,max:new Date(new Date(+this.parent.maxDate).setHours(23,59,59)),cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,locale:this.parent.locale,floatLabelType:"Always",timeFormat:this.parent.activeViewOptions.timeFormat,format:(t.isNullOrUndefined(this.parent.dateFormat)?this.getFormat("dateFormats"):this.parent.dateFormat)+" "+this.parent.activeViewOptions.timeFormat,placeholder:this.getFieldLabel(e),step:this.getSlotDuration(),width:"100%"}).appendTo(s),n},e.prototype.refreshDateTimePicker=function(e){for(var t=0,i=[].slice.call(this.element.querySelectorAll(".e-start,.e-end"));t<i.length;t++){var n=i[t].ej2_instances[0];n.firstDayOfWeek=this.parent.activeViewOptions.firstDayOfWeek,n.timeFormat=this.parent.activeViewOptions.timeFormat,n.step=e||this.getSlotDuration(),n.dataBind()}},e.prototype.onTimeChange=function(){var e=this.getInstance("e-start");if(e.element.parentElement.classList.contains("e-input-focus")){var i=this.getInstance("e-end"),n=0;this.cellClickAction?(n=ze*this.duration,this.eventWindowTime.startTime=e.value):n=this.eventData[this.fields.endTime].getTime()-this.eventData[this.fields.startTime].getTime();var r=t.isNullOrUndefined(e.value)?null:new Date(e.value.getTime()+n);this.cellClickAction&&(this.eventWindowTime.endTime=r),i.value=r,i.dataBind()}this.recurrenceEditor&&this.recurrenceEditor.updateRuleUntilDate(this.eventWindowTime.startTime)},e.prototype.renderResourceDetails=function(e){var t=e.field,i="e-"+t,n=e.title,r=this.createDivElement(i+"-container e-resources"),a=this.createInputElement(i+" e-field",t);r.appendChild(a);var s='<div class="e-resource-template"><div class="e-resource-color" style="background-color:${'+e.colorField+'}"></div><div class="e-resource-text">${'+e.textField+"}</div></div>";return e.allowMultiple?new l.MultiSelect({cssClass:this.parent.cssClass||"",dataSource:e.dataSource,change:this.onMultiselectResourceChange.bind(this),itemTemplate:s,fields:{text:e.textField,value:e.idField},htmlAttributes:{title:n,name:t},floatLabelType:"Always",placeholder:n,popupHeight:"230px",popupWidth:"447px",mode:"Box"}).appendTo(a):new l.DropDownList({cssClass:this.parent.cssClass||"",change:this.onDropdownResourceChange.bind(this),dataSource:e.dataSource,enableRtl:this.parent.enableRtl,fields:{text:e.textField,value:e.idField},htmlAttributes:{title:n,name:t},floatLabelType:"Always",placeholder:n,popupHeight:"230px",popupWidth:"447px",itemTemplate:s}).appendTo(a),r},e.prototype.renderDropDown=function(e){var t=this,i=this.getFieldName(e),n=this.createDivElement(e+"-container"),r=this.createInputElement(e+" e-field",i);return n.appendChild(r),new l.DropDownList({allowFiltering:!0,change:this.onTimezoneChange.bind(this),cssClass:this.parent.cssClass||"",dataSource:this.parent.timezoneDataSource,enableRtl:this.parent.enableRtl,fields:{text:"Text",value:"Value"},filterBarPlaceholder:this.parent.localeObj.getConstant("searchTimezone"),noRecordsTemplate:this.parent.localeObj.getConstant("noRecords"),filtering:function(e){var i=new a.Query;i=""!==e.text?i.where("Text","contains",e.text,!0):i,e.updateData(t.parent.timezoneDataSource,i)},htmlAttributes:{title:this.getFieldLabel(e),name:i},floatLabelType:"Always",placeholder:this.getFieldLabel(e),popupHeight:"230px"}).appendTo(r),n},e.prototype.onMultiselectResourceChange=function(e){if(e.value&&this.parent.activeViewOptions.group.byGroupID&&!(this.parent.resourceCollection.length<=1))for(var t=this.parent.resourceBase.resourceCollection,i=e.element.getAttribute("name")||this.getColumnName(e.element),n=0;n<t.length;n++)if(t[n].field===i&&n<t.length-1){for(var r=this.createInstance(n),a=[],s=this,o=0;o<e.value.length;o++)!function(i){var r=t[n+1],o=r.dataSource.filter(function(t){return t[r.groupIDField]===e.value[i]})[0][t[n+1].groupIDField],l=s.filterDatasource(n,o);a=a.concat(l)}(o);r.dataSource=a,r.dataBind()}},e.prototype.createInstance=function(e){var t=this.parent.resourceBase.resourceCollection[e+1];return this.element.querySelector(".e-"+t.field).ej2_instances[0]},e.prototype.onDropdownResourceChange=function(e){if(e.value&&!(this.parent.resourceCollection.length<=1)&&this.parent.activeViewOptions.group.byGroupID)for(var t=e.element.getAttribute("name")||this.getColumnName(e.element),i=this.parent.resourceBase.resourceCollection,n=0;n<i.length;n++)if(n<i.length-1&&i[n].field===t){var r=this.createInstance(n),a=e.itemData[i[n].idField];r.dataSource=this.filterDatasource(n,a),r.dataBind();var s=r.dataSource[0][i[n+1].idField];r.value=i[n+1].allowMultiple?[s]:s,r.dataBind()}},e.prototype.filterDatasource=function(e,t){var i=this.parent.resourceBase.resourceCollection[e+1];return i.dataSource.filter(function(e){return e[i.groupIDField]===t})},e.prototype.onTimezoneChange=function(e){if((e.element.getAttribute("name")||this.getColumnName(e.element))===this.parent.eventFields.startTimezone){var t=this.getInstance("e-start-time-zone"),i=this.getInstance("e-end-time-zone");i.value=t.value,i.dataBind()}},e.prototype.renderCheckBox=function(e){var t=this.createDivElement(e+"-container"),i=this.getFieldName(e),n=this.createInputElement(e+" e-field",i);t.appendChild(n);var r=new s.CheckBox({change:this.onChange.bind(this),cssClass:e+" "+this.parent.cssClass,enableRtl:this.parent.enableRtl,label:this.getFieldLabel(e)});return r.appendTo(n),n.setAttribute("name",i),"Repeat"===i&&(this.repeatStatus=r),t},e.prototype.renderTextBox=function(e){var t=this.createDivElement(e+"-container"),i=this.getFieldName(e),n="e-description"===e?"textarea":"input",r=this.createInputElement(e+" e-field",i,n);return t.appendChild(r),o.Input.createInput({element:r,floatLabelType:"Always",properties:{enableRtl:this.parent.enableRtl,placeholder:this.getFieldLabel(e)}}),t},e.prototype.getFieldName=function(e){var t="";switch(e){case"e-subject":t=this.fields.subject;break;case"e-location":t=this.fields.location;break;case"e-start":t=this.fields.startTime;break;case"e-end":t=this.fields.endTime;break;case"e-description":t=this.fields.description;break;case"e-all-day":t=this.fields.isAllDay;break;case"e-start-time-zone":t=this.fields.startTimezone;break;case"e-end-time-zone":t=this.fields.endTimezone;break;case"e-time-zone":t="Timezone";break;case"e-repeat":t="Repeat"}return t},e.prototype.getFieldLabel=function(e){var t="";switch(e){case"e-subject":t=this.parent.editorTitles.subject;break;case"e-location":t=this.parent.editorTitles.location;break;case"e-description":t=this.parent.editorTitles.description;break;case"e-start":t=this.parent.editorTitles.startTime;break;case"e-end":t=this.parent.editorTitles.endTime;break;case"e-start-time-zone":t=this.parent.editorTitles.startTimezone;break;case"e-end-time-zone":t=this.parent.editorTitles.endTimezone;break;case"e-repeat":t=this.parent.editorTitles.recurrenceRule;break;case"e-all-day":t=this.parent.editorTitles.isAllDay;break;case"e-time-zone":t=this.l10n.getConstant("timezone")}return t},e.prototype.onChange=function(e){var t=e.event.currentTarget.querySelector("input");t.classList.contains("e-all-day")?this.onAllDayChange(e.checked):t.classList.contains("e-time-zone")?this.timezoneChangeStyle(e.checked):t.classList.contains("e-repeat")&&this.onRepeatChange(e.checked)},e.prototype.renderRepeatDialog=function(){var e=t.createElement("div");this.repeatDialogObject=new i.Dialog({header:this.l10n.getConstant("recurrence"),visible:!1,content:'<div class="e-rec-editor"></div>',closeOnEscape:!0,width:"90%",buttons:[{click:this.repeatSaveDialog.bind(this),buttonModel:{content:this.l10n.getConstant("save"),cssClass:"e-save",isPrimary:!0}},{click:this.repeatCancelDialog.bind(this),buttonModel:{cssClass:"e-cancel",content:this.l10n.getConstant("cancel")}}],target:this.element,animationSettings:{effect:"Zoom"},enableRtl:this.parent.enableRtl,isModal:!0,cssClass:"e-recurrence-dialog",open:this.repeatOpenDialog.bind(this)}),this.element.appendChild(e),this.repeatDialogObject.appendTo(e),this.createRecurrenceEditor(this.repeatDialogObject.element.querySelector(".e-rec-editor"))},e.prototype.loadRecurrenceEditor=function(){this.repeatDialogObject.show(),this.recurrenceEditor&&this.repeatRule&&this.recurrenceEditor.setRecurrenceRule(this.repeatRule)},e.prototype.onRepeatChange=function(e){if(e)this.repeatDialogObject||this.renderRepeatDialog(),this.recurrenceEditor.setProperties({startDate:this.repeatStartDate,selectedType:0}),this.loadRecurrenceEditor();else{this.repeatDialogObject&&this.repeatDialogObject.hide(),this.repeatRule="",this.recurrenceEditor&&(this.recurrenceEditor.setRecurrenceRule(this.repeatRule),this.updateRepeatLabel(this.repeatRule));var i=this.element.querySelector(".e-recurrence-container");t.addClass([i],"e-hide")}},e.prototype.repeatSaveDialog=function(){this.repeatRule=this.recurrenceEditor.getRecurrenceRule();var e=this.element.querySelector(".e-recurrence-container");this.recurrenceEditor.getRecurrenceRule()?t.removeClass([e],"e-hide"):(t.addClass([e],"e-hide"),this.repeatStatus.setProperties({checked:!1})),this.updateRepeatLabel(this.repeatRule),this.closeRepeatDialog()},e.prototype.closeRepeatDialog=function(){this.repeatDialogObject.hide()},e.prototype.repeatCancelDialog=function(){this.closeRepeatDialog(),this.recurrenceEditor&&this.recurrenceEditor.setRecurrenceRule(this.repeatTempRule),this.repeatTempRule||this.repeatStatus.setProperties({checked:!1})},e.prototype.repeatOpenDialog=function(){this.repeatTempRule=this.recurrenceEditor.getRecurrenceRule()},e.prototype.onCellDetailsUpdate=function(e,i){if(this.parent.eventSettings.allowAdding){this.element.querySelector("."+$e).removeAttribute("data-id"),this.element.querySelector(".e-title-text").innerHTML=this.l10n.getConstant("newEvent"),e.Timezone=!1,this.repeatStartDate=e[this.fields.startTime],this.repeatRule="",t.isNullOrUndefined(this.parent.eventSettings.fields.subject.default)||(e[this.fields.subject]=this.parent.eventSettings.fields.subject.default),t.isNullOrUndefined(this.parent.eventSettings.fields.location.default)||(e[this.fields.location]=this.parent.eventSettings.fields.location.default),t.isNullOrUndefined(this.parent.eventSettings.fields.description.default)||(e[this.fields.description]=this.parent.eventSettings.fields.description.default),this.showDetails(e),e[this.fields.recurrenceRule]&&this.recurrenceEditor&&(this.recurrenceEditor.setRecurrenceRule(e[this.fields.recurrenceRule],e[this.fields.startTime]),this.repeatRule=e[this.fields.recurrenceRule]);var n=this.element.querySelector(".e-event-delete");if(n&&t.addClass([n],"e-disable"),this.recurrenceEditor&&this.recurrenceEditor.setProperties({startDate:e[this.fields.startTime],selectedType:t.isNullOrUndefined(i)?t.isNullOrUndefined(e[this.fields.recurrenceRule])?0:this.recurrenceEditor.selectedType:i}),this.parent.isAdaptive&&t.isNullOrUndefined(this.parent.editorTemplate)){var r=this.element.querySelector(".e-recurrence-container");t.addClass([r],"e-hide"),this.updateRepeatLabel(this.repeatRule)}else{var a=this.element.querySelector(".e-event-save");this.disableButton(a,!1)}this.dialogObject.show()}},e.prototype.convertToEventData=function(e,t){e.subject&&(t[this.fields.subject]=e.subject),t[this.fields.startTime]=e.startTime,t[this.fields.endTime]=e.endTime,t[this.fields.isAllDay]=e.isAllDay,e.RecurrenceRule&&(t[this.fields.recurrenceRule]=e.RecurrenceRule),(this.parent.resourceCollection.length>0||this.parent.activeViewOptions.group.resources.length>0)&&this.parent.resourceBase.setResourceValues(t)},e.prototype.applyFormValidation=function(){var e=function(e){return e&&Object.keys(e).length>0?e:void 0},t=this.element.querySelector("."+$e),i={};i[this.parent.eventSettings.fields.subject.name]=e(this.parent.eventSettings.fields.subject.validation),i[this.parent.eventSettings.fields.location.name]=e(this.parent.eventSettings.fields.location.validation),i[this.parent.eventSettings.fields.startTime.name]=e(this.parent.eventSettings.fields.startTime.validation),i[this.parent.eventSettings.fields.endTime.name]=e(this.parent.eventSettings.fields.endTime.validation),i[this.parent.eventSettings.fields.description.name]=e(this.parent.eventSettings.fields.description.validation),this.fieldValidator=new Ht,this.fieldValidator.renderFormValidator(t,i,this.element,this.parent.locale)},e.prototype.showDetails=function(e){var i=t.extend({},e,null,!0);0===i[this.fields.endTime].getHours()&&0===i[this.fields.endTime].getMinutes()&&this.trimAllDay(i),this.eventData=i;for(var n=this.getFormElements("e-schedule-dialog"),r=Object.keys(i),a=0,s=n;a<s.length;a++){var o=s[a],l=o.name||this.getColumnName(o);t.isNullOrUndefined(l)||""===l||(-1!==r.indexOf(l)?this.setValueToElement(o,i[l]):this.setDefaultValueToElement(o))}if(t.isNullOrUndefined(this.parent.editorTemplate)){this.onAllDayChange(i[this.fields.isAllDay]);var c=this.getInstance("e-time-zone.e-field");t.isNullOrUndefined(i[this.fields.startTimezone])&&t.isNullOrUndefined(i[this.fields.endTimezone])||(c.checked=!0,c.dataBind()),this.timezoneChangeStyle(c.checked),delete i.Timezone}},e.prototype.getColumnName=function(e){var i=e.getAttribute("data-name")||"";if(""===i){var n=!1,r="";e.classList.contains("e-dropdownlist")?(r="e-ddl",n=!0):e.classList.contains("e-multiselect")?(r="e-multiselect",n=!0):e.classList.contains("e-datetimepicker")?r="e-datetimepicker":e.classList.contains("e-datepicker")?r="e-datepicker":e.classList.contains("e-checkbox")&&(r="e-checkbox");var a=n?"."+r+":not(.e-control)":"."+r,s=t.closest(e,a)||e.querySelector("."+r);if(s){var o=s.querySelector("[name]");o&&(i=o.name)}}return i},e.prototype.onAllDayChange=function(e){var i,n=this.getInstance("e-start"),r=this.getInstance("e-end"),a=this.element.querySelector(".e-time-zone-container");e?(i=t.isNullOrUndefined(this.parent.dateFormat)?this.getFormat("dateFormats"):this.parent.dateFormat,t.addClass(this.element.querySelectorAll(".e-time-icon"),"e-icon-disable"),t.addClass([a],"e-disable"),this.element.querySelector(".e-time-zone-row")&&t.removeClass([this.element.querySelector(".e-time-zone-row")],"e-enable"),n.format=r.format=i):(i=t.isNullOrUndefined(this.parent.dateFormat)?this.getFormat("dateFormats")+" "+this.parent.activeViewOptions.timeFormat:this.parent.dateFormat+" "+this.parent.activeViewOptions.timeFormat,t.removeClass(this.element.querySelectorAll(".e-time-icon"),"e-icon-disable"),t.removeClass([a],"e-disable"),this.element.querySelector(".e-checkbox-wrapper .e-time-zone").checked&&t.addClass([this.element.querySelector(".e-time-zone-row")],"e-enable"),n.format=r.format=i),this.cellClickAction&&this.updateDateTime(e,n,r),n.dataBind(),r.dataBind(),t.isNullOrUndefined(this.recurrenceEditor)||this.recurrenceEditor.updateRuleUntilDate(n.value)},e.prototype.updateDateTime=function(e,t,i){var n,r;if(e)if(n=w(new Date(this.eventWindowTime.startTime.getTime())),this.parent.activeCellsData.isAllDay){var a=C(new Date(this.eventWindowTime.endTime.getTime()),-1).getTime();r=+this.eventWindowTime.startTime>a?this.eventWindowTime.endTime:new Date(a)}else r=w(new Date(this.eventWindowTime.endTime.getTime()));else{var s=this.parent.activeCellsData.startTime;if((n=new Date(this.eventWindowTime.startTime.getTime())).setHours(s.getHours(),s.getMinutes(),s.getSeconds()),this.parent.activeCellsData.isAllDay){var o=this.parent.getStartEndTime(this.parent.workHours.start);n.setHours(o.getHours(),o.getMinutes(),o.getSeconds()),(r=new Date(n.getTime())).setMilliseconds(ze*this.getSlotDuration())}else(r=new Date(n.getTime())).setMilliseconds(this.parent.activeCellsData.endTime.getTime()-this.parent.activeCellsData.startTime.getTime())}this.eventWindowTime={startTime:new Date(n.getTime()),endTime:new Date(r.getTime())},t.value=n,i.value=r,t.dataBind(),i.dataBind()},e.prototype.getFormat=function(e){return"en"===this.parent.locale||"en-US"===this.parent.locale?t.getValue(e+".short",t.getDefaultDateObject(this.parent.getCalendarMode())):t.getValue("main."+this.parent.locale+".dates.calendars."+this.parent.getCalendarMode()+"."+e+".short",t.cldrData)},e.prototype.onEventDetailsUpdate=function(e){if(this.parent.eventSettings.allowEditing){if(this.parent.isAdaptive||t.removeClass([this.element.querySelector(".e-event-delete")],"e-disable"),this.element.querySelector(".e-title-text").innerHTML=this.l10n.getConstant("editEvent"),this.element.querySelector("."+$e).setAttribute("data-id",e[this.fields.id].toString()),t.isNullOrUndefined(this.parent.editorTemplate)){e=t.extend({},e,null,!0);var i=this.getInstance("e-time-zone.e-field"),n=void 0;e[this.fields.startTimezone]||e[this.fields.endTimezone]?(n=!0,this.parent.eventBase.timezoneConvert(e)):n=!1,e.Timezone=n,i.checked=n,i.dataBind()}if(this.showDetails(e),e[this.fields.recurrenceRule]&&this.recurrenceEditor?this.recurrenceEditor.setRecurrenceRule(e[this.fields.recurrenceRule],e[this.fields.startTime]):!this.parent.isAdaptive&&this.recurrenceEditor&&(this.recurrenceEditor.setProperties({startDate:e[this.fields.startTime]}),this.recurrenceEditor.setRecurrenceRule("")),this.repeatStartDate=e[this.fields.startTime],this.repeatRule="",e[this.fields.recurrenceRule]&&(this.recurrenceEditor&&this.recurrenceEditor.setRecurrenceRule(e[this.fields.recurrenceRule],e[this.fields.startTime]),this.repeatRule=e[this.fields.recurrenceRule]),this.parent.isAdaptive&&t.isNullOrUndefined(this.parent.editorTemplate)){var r=this.element.querySelector(".e-recurrence-container");e[this.fields.recurrenceRule]?(t.removeClass([r],"e-hide"),this.repeatStatus.setProperties({checked:!0})):(t.addClass([r],"e-hide"),this.repeatStatus.setProperties({checked:!1})),this.updateRepeatLabel(this.repeatRule)}var a=this.parent.readonly||e[this.fields.isReadonly];if(this.parent.isAdaptive){var s=this.element.querySelector(".e-save-icon");s&&(a?t.addClass([s],"e-icon-disable"):t.removeClass([s],"e-icon-disable"))}else{var o=this.element.querySelector(".e-event-save"),l=this.element.querySelector(".e-event-delete");this.disableButton(o,a),this.disableButton(l,a)}this.dialogObject.show()}},e.prototype.disableButton=function(e,t){e&&(e.ej2_instances[0].disabled=t)},e.prototype.renderRecurrenceEditor=function(){return new ti({calendarMode:this.parent.calendarMode,cssClass:this.parent.cssClass,dateFormat:this.parent.dateFormat,enableRtl:this.parent.enableRtl,firstDayOfWeek:this.parent.activeViewOptions.firstDayOfWeek,locale:this.parent.locale})},e.prototype.updateMinMaxDateToEditor=function(){var e=this.element.querySelector(".e-start"),t=this.element.querySelector(".e-end");if(e&&t){var i=e.ej2_instances[0],n=t.ej2_instances[0];i.min=this.parent.minDate,i.max=this.parent.maxDate,n.min=this.parent.minDate,n.max=this.parent.maxDate,i.dataBind(),n.dataBind()}if(this.recurrenceEditor){var r=this.recurrenceEditor.element.querySelector(".e-until-date");if(r){var a=r.ej2_instances[0];a.min=this.parent.minDate,a.max=this.parent.maxDate,a.dataBind()}}},e.prototype.updateRepeatLabel=function(e){this.parent.isAdaptive&&!this.repeatDialogObject&&this.renderRepeatDialog();var t=e?this.l10n.getConstant("repeats")+" "+this.recurrenceEditor.getRuleSummary(e):this.l10n.getConstant("repeat");this.repeatStatus.setProperties({label:t})},e.prototype.dialogClose=function(e){if(this.isEnterKey)return void(this.isEnterKey=!1);this.dialogEvent=e,this.isCrudAction=!1,this.parent.activeEventData={event:void 0,element:void 0},this.parent.currentAction=null,this.dialogObject.hide()},e.prototype.resetForm=function(){this.fieldValidator.destroyToolTip(),this.resetFormFields(),this.parent.isAdaptive||!this.recurrenceEditor||this.recurrenceEditor.isDestroyed||this.recurrenceEditor.resetFields()},e.prototype.timezoneChangeStyle=function(e){var i=this.element.querySelector(".e-time-zone-row"),n=this.parent.tzModule.getLocalTimezoneName();if(e){t.addClass([i],"e-enable");var r=this.getInstance("e-start-time-zone"),a=this.getInstance("e-end-time-zone"),s=r.dataSource;r.value&&this.parent.timezone||s.some(function(e){return e.Value===n})||(s.push({Value:n,Text:n}),r.dataSource=s,a.dataSource=s,r.dataBind(),a.dataBind()),r.value=r.value||this.parent.timezone||n,a.value=a.value||this.parent.timezone||n,r.dataBind(),a.dataBind()}else t.removeClass([i],"e-enable")},e.prototype.resetFormFields=function(){for(var e=0,i=this.getFormElements("e-schedule-dialog");e<i.length;e++){var n=i[e],r=n.name||this.getColumnName(n);t.isNullOrUndefined(r)||""===r||this.setDefaultValueToElement(n)}},e.prototype.eventSave=function(e,t){if(this.isEnterKey)return void(this.isEnterKey=!1);var i=this.element.querySelector("."+$e);if(!i||!i.classList.contains("e-formvalidator")||i.ej2_instances[0].validate()){var n=this.getEventDataFromEditor();this.processEventValidation(n.tempData,t)||(this.eventCrudData=n.eventData,this.dialogEvent=e,this.isCrudAction=!0,this.dialogObject.hide())}},e.prototype.getEventDataFromEditor=function(){var e=t.extend({},this.getObjectFromFormData("e-schedule-dialog"));e.Timezone||(e[this.fields.startTimezone]=null,e[this.fields.endTimezone]=null),delete e.Timezone,delete e.Repeat,this.setDefaultValueToObject(e),e[this.fields.recurrenceRule]=this.recurrenceEditor?this.recurrenceEditor.getRecurrenceRule()||null:void 0;var i=t.extend({},e,null,!0);return e[this.fields.isAllDay]&&(e[this.fields.startTime]=t.isNullOrUndefined(e[this.fields.startTime])?null:w(new Date(e[this.fields.startTime].getTime())),e[this.fields.endTime]=t.isNullOrUndefined(e[this.fields.endTime])?null:C(w(new Date(e[this.fields.endTime].getTime())),1)),{eventData:e,tempData:i}},e.prototype.processEventValidation=function(e,i){var n;if(t.isNullOrUndefined(this.parent.editorTemplate)){if(!e[this.fields.startTime]||!e[this.fields.endTime])return this.parent.quickPopup.openValidationError("invalidDateError"),!0;if(e[this.fields.startTime]>e[this.fields.endTime])return this.parent.quickPopup.openValidationError("startEndError"),!0}if(this.recurrenceEditor&&this.recurrenceEditor.value&&""!==this.recurrenceEditor.value){var r=!0;if("seriesChangeAlert"===(n=this.recurrenceValidation(e[this.fields.startTime],e[this.fields.endTime],i))&&this.parent.uiStateValues.isIgnoreOccurrence&&(r=!1),!t.isNullOrUndefined(n)&&r&&(!this.parent.enableRecurrenceValidation&&"wrongPattern"===n||this.parent.enableRecurrenceValidation))return this.parent.quickPopup.openRecurrenceValidationAlert(n),!0}return!1},e.prototype.processCrudActions=function(e){var i=this;this.parent.uiStateValues.isBlock=!1;var n=this.getResourceData(e),r=(this.parent.activeViewOptions.group.resources.length>0||this.parent.resourceCollection.length>0)&&!this.parent.activeViewOptions.group.allowGroupEdit&&!t.isNullOrUndefined(n),a=this.getEventIdFromForm();if(t.isNullOrUndefined(a))this.parent.currentAction="Add",r?this.resourceSaveEvent(e,this.parent.currentAction):(e[this.fields.id]=this.parent.eventBase.getEventMaxID(),this.parent.addEvent(e));else{var s="string"===this.parent.eventBase.getEventIDType()?a:parseInt(a,10),o=this.parent.eventsData.filter(function(e){return e[i.fields.id]===s})[0];if(t.isNullOrUndefined(o)&&(o=this.parent.blockData.filter(function(e){return e[i.fields.id]===s})[0]),(e=t.extend({},o,e))[this.fields.isReadonly])return!1;var l=void 0;if(!t.isNullOrUndefined(o[this.fields.recurrenceRule])){if(l=this.parent.currentAction,e.Guid=this.parent.activeEventData.event.Guid,"EditOccurrence"===this.parent.currentAction&&(e[this.fields.recurrenceID]?(s=e[this.fields.recurrenceID],l=null):(e[this.fields.id]=this.parent.eventBase.getEventMaxID(),e.Guid=this.parent.activeEventData.event.Guid),this.parent.enableRecurrenceValidation&&this.editOccurrenceValidation(s,e)))return!0;"EditSeries"===this.parent.currentAction||e[this.fields.id]!==o[this.fields.id]?e[this.fields.recurrenceID]=o[this.fields.id]:"EditFollowingEvents"===this.parent.currentAction&&(e[this.fields.id]=this.parent.eventBase.getEventMaxID(),e[this.fields.followingID]=o[this.fields.id])}r?this.resourceSaveEvent(e,"Save",l):this.parent.saveEvent(e,l)}return this.parent.uiStateValues.isBlock},e.prototype.getResourceData=function(e){var i=null;return!t.isNullOrUndefined(this.parent.resourceBase)&&!t.isNullOrUndefined(this.parent.resourceBase.resourceCollection)&&this.parent.resourceBase.resourceCollection.length>0&&(i=e[this.parent.resourceBase.resourceCollection.slice(-1)[0].field]),i},e.prototype.getObjectFromFormData=function(e){for(var i={},n=0,r=this.getFormElements(e);n<r.length;n++){var a=r[n],s=a.name||this.getColumnName(a);t.isNullOrUndefined(s)||""===s||(i[s]=this.getValueFromElement(a))}return i},e.prototype.setDefaultValueToObject=function(e){t.isNullOrUndefined(e[this.fields.subject])||(e[this.fields.subject]=e[this.fields.subject]||this.parent.eventSettings.fields.subject.default||this.l10n.getConstant("addTitle")),t.isNullOrUndefined(e[this.fields.location])||(e[this.fields.location]=e[this.fields.location]||this.parent.eventSettings.fields.location.default),t.isNullOrUndefined(e[this.fields.description])||(e[this.fields.description]=e[this.fields.description]||this.parent.eventSettings.fields.description.default)},e.prototype.recurrenceValidation=function(e,i,n){var r,a=this.recurrenceEditor,s=this.getInstance("e-repeat-interval.e-numerictextbox").value;if(n!==this.l10n.getConstant("ok")){var o=this.parent.activeEventData.event,l=[];if(("EditSeries"===this.parent.currentAction||"EditFollowingEvents"===this.parent.currentAction)&&!t.isNullOrUndefined(o)){var c=o[this.parent.eventFields.startTime],p=this.parent.eventBase.getSeriesEvents(this.eventData,c);if(p.length>0)l=this.parent.eventBase.getEditedOccurrences(p,c);else{var h=this.parent.eventBase.getEventById(o[this.parent.eventFields.id]);l=this.parent.eventBase.getEditedOccurrences([h],c)}"EditSeries"!==this.parent.currentAction||t.isNullOrUndefined(this.eventData[this.parent.eventFields.recurrenceException])||l.push(this.eventData)}if(l.length>0&&(r="seriesChangeAlert"),"until"===this.getInstance("e-end-on-left .e-ddl .e-dropdownlist").value&&this.getInstance("e-end-on-date .e-datepicker").value<e&&(r="wrongPattern"),t.isNullOrUndefined(r)){var d=a.value.split(";")[1].split("=")[1].split(","),u={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6},v=[],m=[],g=void 0;switch(a.value.split(";")[0].split("=")[1]){case"DAILY":(i.getTime()-e.getTime())/36e5>24*s&&(r="createError");break;case"WEEKLY":d=a.value.split(";")[1].split("=")[1].split(",");for(f=0;f<d.length*(s+1);f++)v[f]=d.length>f?u[d[f]]:v[f-d.length]+7*s;g=v.sort(function(e,t){return e-t});for(var f=1;f<g.length;f++)m.push(g[f]-g[f-1]);((i.getTime()-e.getTime())/36e5>=24*Math.min.apply(Math,m)||t.isNullOrUndefined(s))&&(r="createError");break;case"MONTHLY":i.getTime()>=new Date(+e).setMonth(e.getMonth()+s)&&(r="createError");break;case"YEARLY":i.getTime()>=new Date(+e).setFullYear(e.getFullYear()+s)&&(r="createError")}}}else i.getTime()>=new Date(+e).setMonth(e.getMonth()+s)&&(r="createError"),t.isNullOrUndefined(r)&&this.parent.quickPopup.quickDialog.hide();return t.isNullOrUndefined(s)&&(r="createError"),r},e.prototype.getRecurrenceIndex=function(e,t){for(var i,n=0;n<e.length;n++)if(t[this.fields.startTime].valueOf()===e[n][this.fields.startTime].valueOf()){i=n;break}return i},e.prototype.trimAllDay=function(e){if(e[this.fields.isAllDay]){var t=C(new Date(+e[this.fields.endTime]),-1).getTime();e[this.fields.endTime]=+e[this.fields.startTime]>t?e[this.fields.endTime]:new Date(t)}},e.prototype.editOccurrenceValidation=function(e,i,n){var r=this;void 0===n&&(n=this.eventData);var a=this.parent.getOccurrencesByID(e);this.parent.eventsData.filter(function(t){return t[r.fields.recurrenceID]===e}).map(function(e){return a.push(t.extend({},e))}),i=t.extend({},i),this.trimAllDay(i);for(var s=0,o=a;s<o.length;s++){var l=o[s];this.trimAllDay(l)}this.parent.eventBase.sortByTime(a);var c=this.getRecurrenceIndex(a,n);if(t.isNullOrUndefined(c))return!1;if(0===c){if(!t.isNullOrUndefined(a[c+1])){if(!(w(new Date(+a[c+1][this.fields.startTime])).getTime()>w(new Date(+i[this.fields.endTime])).getTime())&&w(new Date(+a[a.length-1][this.fields.endTime])).getTime()>=w(new Date(+i[this.fields.startTime])).getTime())return this.parent.quickPopup.openRecurrenceValidationAlert("sameDayAlert"),!0;if(w(new Date(+a[a.length-1][this.fields.endTime])).getTime()<w(new Date(+i[this.fields.startTime])).getTime())return this.parent.quickPopup.openRecurrenceValidationAlert("occurrenceAlert"),!0}return!1}if(c===a.length-1){if(!(w(new Date(+a[c-1][this.fields.endTime])).getTime()<w(new Date(+i[this.fields.startTime])).getTime())&&w(new Date(+a[a.length-1-c][this.fields.startTime])).getTime()<=w(new Date(+i[this.fields.endTime])).getTime())return this.parent.quickPopup.openRecurrenceValidationAlert("sameDayAlert"),!0;if(w(new Date(+a[a.length-1-c][this.fields.endTime])).getTime()>w(new Date(+i[this.fields.startTime])).getTime())return this.parent.quickPopup.openRecurrenceValidationAlert("occurrenceAlert"),!0}else{if(!(w(new Date(+a[c-1][this.fields.endTime])).getTime()<w(new Date(+i[this.fields.startTime])).getTime()||w(new Date(+a[0][this.fields.startTime])).getTime()>w(new Date(+i[this.fields.startTime])).getTime())||!(w(new Date(+a[c+1][this.fields.startTime])).getTime()>w(new Date(+i[this.fields.endTime])).getTime()||w(new Date(+a[a.length-1][this.fields.endTime])).getTime()<w(new Date(+i[this.fields.startTime])).getTime()))return this.parent.quickPopup.openRecurrenceValidationAlert("sameDayAlert"),!0;if(w(new Date(+a[c+1][this.fields.endTime])).getTime()<w(new Date(+i[this.fields.startTime])).getTime()||w(new Date(+a[c-1][this.fields.startTime])).getTime()>w(new Date(+i[this.fields.endTime])).getTime())return this.parent.quickPopup.openRecurrenceValidationAlert("occurrenceAlert"),!0}return!1},e.prototype.resourceSaveEvent=function(e,i,n){var r=this,a=this.parent.resourceBase.resourceCollection.slice(-1)[0],s=e[a.field];s=s instanceof Array?s:[s];for(var o=this.parent.resourceBase.lastResourceLevel,l=[],c=this,p=0;p<s.length;p++){var h=function(p){var h=t.extend({},e,null,!0);h[c.fields.id]=c.parent.eventBase.getEventMaxID();var d=[],u=function(){if("Save"===i&&p===s.length-1)if(d.length>0){d[0][r.fields.id]=e[r.fields.id];for(var t=1;t<d.length;t++)d[t][r.fields.id]=r.parent.eventBase.getEventMaxID(p),l.push(d[t]),r.parent.saveEvent(d[0],n)}else h[r.fields.id]=e[r.fields.id],r.parent.saveEvent(h,n);else if(d.length>0)for(var a=0;a<d.length;a++)d[a][r.fields.id]=r.parent.eventBase.getEventMaxID(a),l.push(d[a]);else h[r.fields.id]=r.parent.eventBase.getEventMaxID(p),l.push(h)};if(c.parent.activeViewOptions.group.byGroupID&&!t.isNullOrUndefined(o)){var v=a.dataSource,m=c.parent.resourceCollection,g=void 0;if((g=m.length>1?M(v,a.idField,s[p],h,m):M(v,a.idField,s[p]))<0)return{value:void 0};for(var f=v[g][a.groupIDField],y=o.filter(function(e){return e.resourceData[a.idField]===s[p]}).filter(function(e){return e.resourceData[a.groupIDField]===f})[0].groupOrder,T=0;T<c.parent.resourceBase.resourceCollection.length;T++){w=c.parent.resourceBase.resourceCollection[T].field;h[w]=y[T]instanceof Array?y[T][0]:y[T]}u()}else{for(g=0;g<c.parent.resourceBase.resourceCollection.length-1;g++){var w=c.parent.resourceBase.resourceCollection[g].field;if(h[w]instanceof Array&&h[w].length>1)for(var D=0;D<h[w].length;D++){var b=t.extend({},h,null,!0);b[w]=e[w][D],b[a.field]=s[p],d.push(b)}else if(0===d.length)h[w]=e[w]instanceof Array?e[w][0]:e[w],h[a.field]=s[p];else for(var C=0;C<d.length;C++)d[C][w]=e[w]instanceof Array?e[w][0]:e[w]}h[a.field]=s[p],u()}}(p);if("object"==typeof h)return h.value}if(l.length>0){for(var d=0,u=l;d<u.length;d++){var v=u[d];v[this.fields.recurrenceException]=null,v[this.fields.recurrenceID]=null}this.parent.addEvent(l)}},e.prototype.getEventIdFromForm=function(){return this.element.querySelector("."+$e).getAttribute("data-id")},e.prototype.getFormElements=function(e){return"e-schedule-dialog"===e?[].slice.call(this.element.querySelectorAll(".e-field")):[].slice.call(this.parent.element.querySelectorAll("."+e+" .e-field"))},e.prototype.getValueFromElement=function(e){return e.classList.contains("e-datepicker")?e.ej2_instances[0].value:e.classList.contains("e-datetimepicker")?e.ej2_instances[0].value:e.classList.contains("e-dropdownlist")?e.ej2_instances[0].value:e.classList.contains("e-multiselect")?e.ej2_instances[0].value:e.classList.contains("e-checkbox")?e.ej2_instances[0].checked:"checkbox"===e.type?e.checked:t.SanitizeHtmlHelper.sanitize(e.value)},e.prototype.setValueToElement=function(e,t){if(e.classList.contains("e-datepicker"))(i=e.ej2_instances[0]).value=t,i.dataBind();else if(e.classList.contains("e-datetimepicker"))(i=e.ej2_instances[0]).element.classList.contains("e-start")?this.eventWindowTime.startTime=new Date(""+t):this.eventWindowTime.endTime=new Date(""+t),i.value=t,i.dataBind();else if(e.classList.contains("e-dropdownlist"))(i=e.ej2_instances[0]).value=t,i.dataBind();else if(e.classList.contains("e-multiselect"))(i=e.ej2_instances[0]).value=[],i.value=t instanceof Array?t:[t],i.dataBind();else if(e.classList.contains("e-checkbox")){var i=e.ej2_instances[0];i.checked=t,i.dataBind()}else"checkbox"!==e.type?e.value=t||"":e.checked=t},e.prototype.setDefaultValueToElement=function(e){if(e.classList.contains("e-datepicker"))(t=e.ej2_instances[0]).value=this.parent.getCurrentTime(),t.dataBind();else if(e.classList.contains("e-datetimepicker")){var t=e.ej2_instances[0],i=this.parent.getCurrentTime();this.eventWindowTime={startTime:i,endTime:i},t.value=i,t.dataBind()}else e.classList.contains("e-dropdownlist")?((t=e.ej2_instances[0]).value=null,t.dataBind()):e.classList.contains("e-multiselect")?((t=e.ej2_instances[0]).value=[],t.dataBind()):e.classList.contains("e-checkbox")?((t=e.ej2_instances[0]).checked=!1,t.dataBind()):"checkbox"===e.type?e.checked=!1:e.value=""},e.prototype.getInstance=function(e){var t=this.element.querySelector("."+e);return t?t.ej2_instances[0]:null},e.prototype.eventDelete=function(e){if(this.isEnterKey)return void(this.isEnterKey=!1);switch(this.parent.currentAction){case"EditOccurrence":t.isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])?this.parent.currentAction="Delete":this.parent.currentAction="DeleteOccurrence";break;case"EditSeries":this.parent.currentAction="DeleteSeries";break;case"Save":this.parent.currentAction="Delete";break;case"EditFollowingEvents":t.isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])||(this.parent.currentAction="DeleteFollowingEvents")}this.dialogEvent=e,this.isCrudAction=!1,this.dialogObject.hide(),this.parent.quickPopup.openDeleteAlert()},e.prototype.getRecurrenceEditorInstance=function(){return this.parent.isAdaptive&&!this.repeatDialogObject&&this.renderRepeatDialog(),this.recurrenceEditor},e.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements("e-schedule-dialog");e<t.length;e++){var i=t[e],n=void 0;i.classList.contains("e-datetimepicker")?n=i.ej2_instances:i.classList.contains("e-datepicker")?n=i.ej2_instances:i.classList.contains("e-checkbox")?n=i.ej2_instances:i.classList.contains("e-dropdownlist")?n=i.ej2_instances:i.classList.contains("e-multiselect")&&(n=i.ej2_instances),n&&n[0]&&n[0].destroy()}this.buttonObj&&this.buttonObj.destroy()},e.prototype.destroy=function(e){this.parent&&!this.parent.isDestroyed&&this.parent.resetTemplates(["editorTemplate"]),this.destroyComponents(),this.recurrenceEditor&&(this.recurrenceEditor.destroy(),this.recurrenceEditor=null),this.fieldValidator&&(this.fieldValidator.destroy(),this.fieldValidator=null),this.repeatDialogObject&&(this.repeatDialogObject.destroy(),this.repeatDialogObject=null),this.dialogObject&&(this.dialogObject.element&&t.EventHandler.remove(this.dialogObject.element,"keydown",this.preventEventSave),this.dialogObject.destroy(),this.dialogObject=null),this.element&&(t.remove(this.element),this.element=null),e||(this.l10n=null,this.parent=null,this.fields=null,this.buttonObj=null,this.repeatStatus=null,this.eventWindowTime=null)},e}(),ni=function(){function e(e){this.translateY=0,this.itemSize=60,this.bufferCount=3,this.renderedLength=0,this.averageRowHeight=0,this.isScrollHeightNull=!0,this.parent=e,this.addEventListener()}return e.prototype.addEventListener=function(){!this.parent||this.parent&&this.parent.isDestroyed||this.parent.on("virtual-scroll",this.virtualScrolling,this)},e.prototype.removeEventListener=function(){!this.parent||this.parent&&this.parent.isDestroyed||this.parent.off("virtual-scroll",this.virtualScrolling)},e.prototype.getRenderedCount=function(){return this.setItemSize(),Math.ceil(this.parent.element.clientHeight/this.itemSize)+this.bufferCount},e.prototype.setTranslateValue=function(){var e=this.parent.element.querySelector(".e-resource-column-wrap"),t=this.parent.element.querySelector(".e-content-wrap"),i=this.parent.element.querySelector(".e-event-table"),n=this.parent.element.querySelector(".e-current-timeline");this.renderVirtualTrackHeight(t,e),this.setTranslate(e,t,i,n)},e.prototype.renderVirtualTrackHeight=function(e,i){if(this.parent.resourceBase.setExpandedResources(),this.isScrollHeightNull){var n=t.createElement("div",{className:"e-virtual-track"}),r=[].slice.call(i.querySelectorAll("table td")),a=parseInt(r[0].getAttribute("data-group-index"),10),s=parseInt(r[r.length-1].getAttribute("data-group-index"),10);this.parent.resourceBase.renderedResources=this.parent.resourceBase.expandedResources.filter(function(e){return e.groupIndex>=a&&e.groupIndex<=s}),this.setItemSize(),n.style.height=this.parent.resourceBase.expandedResources.length*this.itemSize+"px",this.isScrollHeightNull=!1;var o=this.parent.element.querySelector(".e-virtual-track");t.isNullOrUndefined(o)||t.remove(o),e.appendChild(n)}},e.prototype.renderVirtualTrack=function(e){var i=t.createElement("div",{className:"e-virtual-track"});i.style.height=this.parent.resourceBase.expandedResources.length*this.itemSize+"px",e.appendChild(i)},e.prototype.updateVirtualScrollHeight=function(){var e=this.parent.element.querySelector(".e-virtual-track"),t=this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length-1].groupIndex;if(this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length-1].groupIndex!==t){var i=this.parent.element.querySelector("."+Qe);this.renderedLength=i.querySelector("tbody").children.length,e.style.height=i.offsetHeight+(this.parent.resourceBase.expandedResources.length-this.renderedLength)*i.offsetHeight/this.renderedLength+"px"}else e.style.height="";this.averageRowHeight=e.offsetHeight/this.parent.resourceBase.expandedResources.length},e.prototype.updateVirtualTrackHeight=function(e){var t=this.parent.resourceBase.renderedResources.length;if(t!==this.getRenderedCount()){e.style.height=this.parent.element.querySelector(".e-content-wrap").clientHeight+"px";var i=this.parent.element.querySelector(".e-resource-column-wrap"),n=this.parent.element.querySelector(".e-content-wrap"),r=this.parent.element.querySelector(".e-event-table");this.translateY=0,this.setTranslate(i,n,r)}else{var a=this.parent.resourceBase.renderedResources[t-1].groupIndex,s=t+(this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length-1].groupIndex-a);s=s>this.parent.resourceBase.expandedResources.length?this.parent.resourceBase.expandedResources.length:s,e.style.height=s*this.itemSize+"px"}},e.prototype.setItemSize=function(){this.itemSize=h(this.parent.activeView.element,"e-work-cells")||this.itemSize},e.prototype.renderEvents=function(){this.setTabIndex(),this.parent.refreshEvents(!1),this.parent.notify(Ue,{}),this.parent.hideSpinner()},e.prototype.virtualScrolling=function(){var e=this;this.parent.quickPopup&&(this.parent.quickPopup.quickPopupHide(),this.parent.quickPopup.morePopup.hide());var i=this.parent.element.querySelector(".e-resource-column-wrap"),n=this.parent.element.querySelector(".e-content-wrap"),r=this.parent.element.querySelector(".e-event-table"),a=this.parent.element.querySelector(".e-current-timeline"),s=this.parent.element.querySelector("."+Qe);this.renderedLength=i.querySelector("tbody").children.length;var o=parseInt(i.querySelector("tbody td").getAttribute("data-group-index"),10),l=this.parent.rowAutoHeight?s.offsetHeight-n.offsetHeight:this.bufferCount*this.itemSize;t.addClass([n],"e-transition");var c=[];if(n.scrollTop-this.translateY<0?c=this.upScroll(n,o):n.scrollTop-this.translateY>l&&(c=this.downScroll(n,o)),!t.isNullOrUndefined(c)&&c.length>0){this.parent.showSpinner();var p=this.parent.getSelectedElements();this.focusedEle=p[p.length-1]||this.focusedEle,this.updateContent(i,n,r,c),this.setTranslate(i,n,r,a),this.parent.dragAndDropModule&&"drag"===this.parent.dragAndDropModule.actionObj.action&&this.parent.dragAndDropModule.navigationWrapper(),window.clearTimeout(this.timeValue),this.timeValue=window.setTimeout(function(){e.renderEvents()},250)}},e.prototype.upScroll=function(e,t){var i=0;i=~~(e.scrollTop/this.itemSize)+Math.ceil(e.clientHeight/this.itemSize)-this.renderedLength,this.parent.rowAutoHeight&&(i=i>t?t-this.bufferCount:i),i=i>0?i:0;var n=this.getBufferCollection(i,i+this.renderedLength);if(this.parent.resourceBase.renderedResources=n,0===t)this.translateY=e.scrollTop;else{var r=this.parent.rowAutoHeight?this.averageRowHeight:this.itemSize;r=r>0?r:this.itemSize,this.translateY=e.scrollTop-this.bufferCount*r>0?e.scrollTop-this.bufferCount*r:0}return n},e.prototype.downScroll=function(e,t){if(this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length-1].groupIndex===this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length-1].groupIndex)return null;var i=0;i=~~(e.scrollTop/this.itemSize),this.parent.rowAutoHeight&&(i=(i=~~((e.scrollTop-this.translateY)/this.averageRowHeight)+t)>t+this.bufferCount?i:t+this.bufferCount);var n=i+this.renderedLength;n=n>this.parent.resourceBase.expandedResources.length?i+(this.parent.resourceBase.expandedResources.length-i):n;var r=this.getBufferCollection(n-this.renderedLength,n);return this.translateY=e.scrollTop,r},e.prototype.updateContent=function(e,i,n,r){var a=e.querySelector("tbody").children.length;document.activeElement&&document.activeElement.classList.contains("e-resource-cells")&&(this.isResourceCell=!0,this.parent.element.focus());for(var s=0;s<a;s++)t.remove(e.querySelector("tbody tr")),t.remove(i.querySelector("tbody tr")),t.remove(n.querySelector("div"));this.parent.resourceBase.renderedResources=r;var o=this.parent.resourceBase.getContentRows(r,!0),l=this.parent.activeView.getContentRows(),c=this.parent.activeView.getEventRows(r.length);t.append(o,e.querySelector("tbody")),t.append(l,i.querySelector("tbody")),t.append(c,n)},e.prototype.getBufferCollection=function(e,t){return this.parent.resourceBase.expandedResources.slice(e,t)},e.prototype.setTranslate=function(e,i,n,r){t.setStyleAttribute(e.querySelector("table"),{transform:"translateY("+this.translateY+"px)"}),t.setStyleAttribute(i.querySelector("table"),{transform:"translateY("+this.translateY+"px)"}),t.setStyleAttribute(n,{transform:"translateY("+this.translateY+"px)"}),t.isNullOrUndefined(r)||t.setStyleAttribute(r,{transform:"translateY("+this.translateY+"px)"})},e.prototype.updateFocusedWorkCell=function(){if(this.focusedEle){var e=parseInt(this.focusedEle.getAttribute("data-date"),10),t=parseInt(this.focusedEle.getAttribute("data-group-index"),10),i=this.parent.element.querySelector('.e-work-cells[data-date="'+e+'"][data-group-index="'+t+'"]');i&&this.parent.addSelectedClass([i],i,!0),this.focusedEle=null}},e.prototype.setTabIndex=function(){var e=this.parent.element.querySelector(".e-resource-column-wrap"),t=[].slice.call(this.parent.element.querySelectorAll(".e-resource-cells"));t&&e&&t.forEach(function(t){t.getBoundingClientRect().top>=e.getBoundingClientRect().top&&t.setAttribute("tabindex","0")});var i=this.parent.element.querySelector('.e-resource-cells[tabindex="0"]');this.isResourceCell&&i&&(i.focus(),this.isResourceCell=!1)},e.prototype.destroy=function(){this.removeEventListener()},e}(),ri=function(){function e(e){this.parent=e}return e.prototype.render=function(e,t){void 0===t&&(t=!0),this.initializeLayout(e),this.parent.activeView&&t&&this.parent.crudModule.refreshDataManager()},e.prototype.initializeLayout=function(e){if(this.parent.activeView){var i=["cellTemplate","eventTemplate","tooltipTemplate","majorSlotTemplate","minorSlotTemplate","headerTooltipTemplate","dateHeaderTemplate","dayHeaderTemplate","mothHeaderTemplate","headerIndentTemplate","resourceHeaderTemplate","cellHeaderTemplate"];this.parent.resetTemplates(i),this.parent.activeView.removeEventListener(),this.parent.activeView.destroy()}switch(e){case"Day":this.parent.activeView=this.parent.dayModule;break;case"Week":this.parent.activeView=this.parent.weekModule;break;case"WorkWeek":this.parent.activeView=this.parent.workWeekModule;break;case"Month":this.parent.activeView=this.parent.monthModule;break;case"Year":this.parent.activeView=this.parent.yearModule;break;case"Agenda":this.parent.activeView=this.parent.agendaModule;break;case"MonthAgenda":this.parent.activeView=this.parent.monthAgendaModule;break;case"TimelineDay":this.parent.activeView=this.parent.timelineViewsModule,this.parent.activeView.viewClass="e-timeline-day-view";break;case"TimelineWorkWeek":this.parent.activeView=this.parent.timelineViewsModule,this.parent.activeView.viewClass="e-timeline-work-week-view";break;case"TimelineWeek":this.parent.activeView=this.parent.timelineViewsModule,this.parent.activeView.viewClass="e-timeline-week-view";break;case"TimelineMonth":this.parent.activeView=this.parent.timelineMonthModule;break;case"TimelineYear":this.parent.activeView=this.parent.timelineYearModule}if(t.isNullOrUndefined(this.parent.activeView)){var n=this.parent.viewCollections[0].option;if(n)return this.parent.setProperties({currentView:n},!0),this.parent.headerModule&&(this.parent.headerModule.updateActiveView(),this.parent.headerModule.setCalendarView()),this.initializeLayout(n);throw Error("Inject required modules")}this.parent.activeView.viewIndex=this.parent.viewIndex,this.updateLabelText(e),this.parent.activeView.addEventListener(),this.parent.activeView.getRenderDates(),this.parent.uiStateValues.isGroupAdaptive=this.parent.activeViewOptions.group.resources.length>0&&(this.parent.enableAdaptiveUI&&!this.parent.isAdaptive||this.parent.isAdaptive&&this.parent.activeViewOptions.group.enableCompactView),this.parent.virtualScrollModule&&(this.parent.virtualScrollModule.destroy(),this.parent.virtualScrollModule=null),-1!==this.parent.currentView.indexOf("Timeline")&&-1===this.parent.currentView.indexOf("Year")&&this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(this.parent.virtualScrollModule=new ni(this.parent),this.parent.uiStateValues.top=0),this.updateHeader(),this.parent.activeView.renderLayout("e-current-panel"),this.parent.renderTemplates(),this.parent.eventTooltip&&(this.parent.eventTooltip.destroy(),this.parent.eventTooltip=null),(this.parent.eventSettings.enableTooltip||this.parent.activeViewOptions.group.resources.length>0&&this.parent.activeViewOptions.group.headerTooltipTemplate)&&(this.parent.eventTooltip=new qt(this.parent))},e.prototype.updateHeader=function(){this.parent.headerModule&&(this.parent.headerModule.setDayOfWeek(this.parent.activeViewOptions.firstDayOfWeek),this.parent.activeViewOptions.readonly?t.addClass([this.parent.element],"e-read-only"):this.parent.element.classList.contains("e-read-only")&&t.removeClass([this.parent.element],"e-read-only"),this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText()),this.parent.headerModule.updateHeaderItems("remove"))},e.prototype.updateLabelText=function(e){var t=this.parent.activeView.getLabelText(e);this.parent.element.setAttribute("role","main"),this.parent.element.setAttribute("aria-label",t)},e}(),ai=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),si=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},oi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ai(i,e),si([t.Property(!0)],i.prototype,"highlight",void 0),si([t.Property("09:00")],i.prototype,"start",void 0),si([t.Property("18:00")],i.prototype,"end",void 0),i}(t.ChildProperty),li=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ci=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},pi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return li(i,e),ci([t.Property(!0)],i.prototype,"enable",void 0),ci([t.Property(60)],i.prototype,"interval",void 0),ci([t.Property(2)],i.prototype,"slotCount",void 0),ci([t.Property()],i.prototype,"minorSlotTemplate",void 0),ci([t.Property()],i.prototype,"majorSlotTemplate",void 0),i}(t.ChildProperty),hi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),di=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},ui=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return hi(i,e),di([t.Property("Both")],i.prototype,"templateType",void 0),di([t.Property()],i.prototype,"header",void 0),di([t.Property()],i.prototype,"content",void 0),di([t.Property()],i.prototype,"footer",void 0),i}(t.ChildProperty),vi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mi=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},gi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return vi(i,e),mi([t.Property()],i.prototype,"option",void 0),mi([t.Property()],i.prototype,"template",void 0),i}(t.ChildProperty),fi=function(){function e(e){this.parent=e,this.crudObj={sourceEvent:null,targetEvent:null,isCrudAction:!1}}return e.prototype.getQuery=function(){var e=this.parent.activeView.startDate(),t=this.parent.activeView.endDate();return this.parent.dataModule.generateQuery(e,t)},e.prototype.getTable=function(){return this.parent.eventSettings.query?this.parent.eventSettings.query.clone().fromTable:null},e.prototype.refreshDataManager=function(){var e=this;if(this.parent.activeView){var t=this.parent.activeView.startDate(),i=this.parent.activeView.endDate();this.parent.dataModule.getData(this.parent.dataModule.generateQuery(t,i)).then(function(t){return e.dataManagerSuccess(t)}).catch(function(t){return e.dataManagerFailure(t)})}},e.prototype.dataManagerSuccess=function(e){var i=this;!this.parent||this.parent&&this.parent.isDestroyed||this.parent.trigger("dataBinding",e,function(e){var n=t.extend([],e.result,null,!0);i.parent.eventsData=n.filter(function(e){return!e[i.parent.eventFields.isBlock]}),i.parent.blockData=n.filter(function(e){return e[i.parent.eventFields.isBlock]}),i.parent.refreshEvents(!1),i.parent.dragAndDropModule&&"drag"===i.parent.dragAndDropModule.actionObj.action&&i.parent.dragAndDropModule.navigationWrapper(),i.parent.trigger("dataBound",null,function(){i.parent.hideSpinner(),i.parent.isPrinting&&i.parent.notify("print",{})})})},e.prototype.dataManagerFailure=function(e){var t=this;!this.parent||this.parent&&this.parent.isDestroyed||this.parent.trigger("actionFailure",{error:e},function(){return t.parent.hideSpinner()})},e.prototype.refreshData=function(e){var i=this,n={requestType:e.requestType,cancel:!1,data:e.data,addedRecords:e.editParams.addedRecords,changedRecords:e.editParams.changedRecords,deletedRecords:e.editParams.deletedRecords};if(this.parent.dragAndDropModule&&this.parent.dragAndDropModule.actionObj&&this.parent.dragAndDropModule.actionObj.element&&(this.parent.dragAndDropModule.actionObj.element.style.display="none"),this.parent.resizeModule&&this.parent.resizeModule.actionObj&&this.parent.resizeModule.actionObj.element&&(this.parent.resizeModule.actionObj.element.style.display="none"),this.parent.activeViewOptions.group.resources.length>0&&!this.parent.activeViewOptions.group.allowGroupEdit&&!this.parent.rowAutoHeight&&!this.parent.virtualScrollModule&&this.parent.activeViewOptions.group.byGroupID&&("eventCreated"===e.requestType||"eventRemoved"===e.requestType)){this.crudObj.isCrudAction=!0,this.crudObj.sourceEvent=[];for(var r=this,a=0,s=e.data instanceof Array?0===e.data.length&&"eventRemoved"===e.requestType?e.editParams.deletedRecords:e.data:"string"!=typeof e.data&&"number"!=typeof e.data||"eventRemoved"!==e.requestType?[e.data]:e.editParams.deletedRecords;a<s.length;a++)!function(i){r.crudObj.isCrudAction=!("eventRemoved"===e.requestType&&!t.isNullOrUndefined(i.parent));var n=r.parent.eventBase.getGroupIndexFromEvent(i);n>-1&&0===r.parent.crudModule.crudObj.sourceEvent.filter(function(e){return e.groupIndex===n}).length&&r.crudObj.isCrudAction&&r.crudObj.sourceEvent.push(r.parent.resourceBase.lastResourceLevel[n])}(s[a]);this.crudObj.targetEvent=this.crudObj.sourceEvent}this.parent.dataModule.dataManager.dataSource.offline?this.parent.trigger("actionComplete",n,function(e){e.cancel||i.refreshDataManager()}):e.promise.then(function(){!i.parent||i.parent&&i.parent.isDestroyed||i.parent.trigger("actionComplete",n,function(e){e.cancel||i.refreshDataManager()})}).catch(function(e){!i.parent||i.parent&&i.parent.isDestroyed||i.parent.trigger("actionFailure",{error:e})})},e.prototype.addEvent=function(e){var i=this;if(this.parent.eventSettings.allowAdding&&!this.parent.activeViewOptions.readonly){if(!this.isBlockEvent(e)&&this.parent.eventBase.isBlockRange(e))return void this.parent.quickPopup.openValidationError("blockAlert",e);var n=e instanceof Array?e:[e],r={requestType:"eventCreate",cancel:!1,data:n,addedRecords:n,changedRecords:[],deletedRecords:[]};this.parent.trigger(qe,r,function(e){if(!e.cancel){var n=i.parent.eventFields,r={addedRecords:[],changedRecords:[],deletedRecords:[]},a=void 0;if(e.addedRecords instanceof Array){for(var s=0,o=e.addedRecords;s<o.length;s++){var l=o[s];l=i.parent.eventBase.updateEventDateTime(l);var c=t.extend({},i.parent.eventBase.processTimezone(l,!0),null,!0);r.addedRecords.push(c)}a=i.parent.dataModule.dataManager.saveChanges(r,n.id,i.getTable(),i.getQuery())}else{var p=i.parent.eventBase.processTimezone(e.addedRecords,!0);r.addedRecords.push(p),a=i.parent.dataModule.dataManager.insert(p,i.getTable(),i.getQuery())}var h={requestType:"eventCreated",cancel:!1,data:e.addedRecords,promise:a,editParams:r};i.refreshData(h)}})}},e.prototype.saveEvent=function(e,i){var n=this;if(this.parent.eventSettings.allowEditing&&!this.parent.activeViewOptions.readonly){if("EditFollowingEvents"!==this.parent.currentAction&&!this.isBlockEvent(e)&&this.parent.eventBase.isBlockRange(e))return void this.parent.quickPopup.openValidationError("blockAlert",e);if(this.parent.currentAction=i,i)switch(i){case"Save":this.processSave(e);break;case"EditOccurrence":this.processOccurrences(e,i);break;case"EditFollowingEvents":this.processFollowSeries(e,i);break;case"EditSeries":this.processEntireSeries(e,i)}else{var r={requestType:"eventChange",cancel:!1,data:e,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};this.parent.trigger(qe,r,function(e){if(!e.cancel){var i=void 0,r=n.parent.eventFields,a={addedRecords:[],changedRecords:[],deletedRecords:[]};if(e.changedRecords instanceof Array){for(var s=0,o=e.changedRecords;s<o.length;s++){var l=o[s];l=n.parent.eventBase.updateEventDateTime(l);var c=t.extend({},n.parent.eventBase.processTimezone(l,!0),null,!0);a.changedRecords.push(c)}i=n.parent.dataModule.dataManager.saveChanges(a,r.id,n.getTable(),n.getQuery())}else{var p=n.parent.eventBase.processTimezone(e.changedRecords,!0);a.changedRecords.push(p),i=n.parent.dataModule.dataManager.update(r.id,p,n.getTable(),n.getQuery())}var h={requestType:"eventChanged",cancel:!1,data:e.changedRecords,promise:i,editParams:a};n.refreshData(h)}})}}},e.prototype.deleteEvent=function(e,t){var i=this;if(this.parent.eventSettings.allowDeleting&&!this.parent.activeViewOptions.readonly){this.parent.currentAction=t;var n=[];if(n="string"==typeof e||"number"==typeof e?this.parent.eventsData.filter(function(t){return t[i.parent.eventFields.id]===e}):e instanceof Array?e:[e],t)switch(t){case"Delete":this.processDelete(n);break;case"DeleteOccurrence":this.processOccurrences(n,t);break;case"DeleteFollowingEvents":this.processFollowSeries(n,t);break;case"DeleteSeries":this.processEntireSeries(n,t)}else{var r={requestType:"eventRemove",cancel:!1,data:e,addedRecords:[],changedRecords:[],deletedRecords:n};this.parent.trigger(qe,r,function(e){if(!e.cancel){var t=void 0,n=i.parent.eventFields,r={addedRecords:[],changedRecords:[],deletedRecords:[]};e.deletedRecords.length>1?(r.deletedRecords=r.deletedRecords.concat(e.deletedRecords),t=i.parent.dataModule.dataManager.saveChanges(r,n.id,i.getTable(),i.getQuery())):(r.deletedRecords.push(e.deletedRecords[0]),t=i.parent.dataModule.dataManager.remove(n.id,e.deletedRecords[0],i.getTable(),i.getQuery())),i.parent.eventBase.selectWorkCellByTime(e.deletedRecords);var a={requestType:"eventRemoved",cancel:!1,data:e.deletedRecords,promise:t,editParams:r};i.refreshData(a)}})}}},e.prototype.processOccurrences=function(e,t){var i=this,n=[],r=!1;if(e instanceof Array)for(var a=0,s=e;a<s.length;a++){var o=s[a];n.push({occurrence:o,parent:this.getParentEvent(o)})}else n={occurrence:e,parent:this.getParentEvent(e)};var l=e instanceof Array?e:[e],c={requestType:"EditOccurrence"===t?"eventChange":"eventRemove",cancel:!1,addedRecords:[],changedRecords:l,deletedRecords:[]};c.data=n,this.parent.trigger(qe,c,function(e){if(!e.cancel){for(var a=i.parent.eventFields,s={addedRecords:[],changedRecords:[],deletedRecords:[]},o=n instanceof Array?n:[n],l=0,c=e.changedRecords.length;l<c;l++)!function(n,l){var c=e.changedRecords[n],p=o[n].parent,h=p[a.recurrenceException],d=void 0,u=void 0;switch(t){case"EditOccurrence":d=i.parent.eventsProcessed.filter(function(e){return e.Guid===c.Guid})[0],(u=i.excludeDateCheck(d[a.startTime],h))!==p[a.recurrenceException]?(p[a.recurrenceException]=u,c[a.recurrenceException]=Me(d[a.startTime]),c[a.recurrenceID]=p[a.id],c[a.followingID]=null,s.changedRecords.push(i.parent.eventBase.processTimezone(p,!0)),s.addedRecords.push(i.parent.eventBase.processTimezone(c,!0))):s.changedRecords.push(i.parent.eventBase.processTimezone(c,!0));break;case"DeleteOccurrence":c[a.recurrenceException]||(p[a.recurrenceException]=i.excludeDateCheck(c[a.startTime],h),s.changedRecords.push(i.parent.eventBase.processTimezone(p,!0))),c[a.id]!==p[a.id]&&(s.deletedRecords.push(c),r=!0)}}(l);var p=i.parent.dataModule.dataManager.saveChanges(s,a.id,i.getTable(),i.getQuery());i.parent.eventBase.selectWorkCellByTime(e.changedRecords);var h={requestType:"EditOccurrence"===t?"eventChanged":"eventRemoved",cancel:!1,data:r?e.deletedRecords:e.changedRecords,promise:p,editParams:s};i.refreshData(h)}})},e.prototype.processFollowSeries=function(e,t){var i=this,n=[];if(e instanceof Array)for(var r=0,a=e;r<a.length;r++){var s=a[r];n.push({occurrence:s,parent:this.getParentEvent(s)})}else n={occurrence:e,parent:this.getParentEvent(e)};var o=e instanceof Array?e:[e],l={requestType:"EditFollowingEvents"===t?"eventChange":"eventRemove",cancel:!1,addedRecords:[],changedRecords:o,deletedRecords:[]};l.data=n,this.parent.trigger(qe,l,function(e){if(!e.cancel){for(var r=i.parent.eventFields,a={addedRecords:[],changedRecords:[],deletedRecords:[]},s=n instanceof Array?n:[n],o=0,l=e.changedRecords.length;o<l;o++)!function(n,o){var l=e.changedRecords[n],c=s[n].parent,p=i.parent.eventBase.getEventCollections(c,l),h=void 0;switch(t){case"EditFollowingEvents":if(i.processRecurrenceRule(c,l),h=!i.parent.eventBase.isFollowingEvent(c,l),l[r.followingID]=h?null:c[r.id],l[r.recurrenceID]=null,a.addedRecords.push(i.parent.eventBase.processTimezone(l,!0)),a.changedRecords.push(i.parent.eventBase.processTimezone(c,!0)),!i.parent.uiStateValues.isIgnoreOccurrence){if(l[r.recurrenceException]=null,p.occurrence.length>0){var d=p.occurrence.slice(-1)[0][r.recurrenceRule];-1===d.indexOf("COUNT")&&(l[r.recurrenceRule]=d)}p.follow.length>0&&(l[r.recurrenceRule]=p.follow.slice(-1)[0][r.recurrenceRule],a.deletedRecords=a.deletedRecords.concat(p.follow)),h&&(p.occurrence=p.occurrence.filter(function(e){return e[r.recurrenceID]===l[r.id]})),a.deletedRecords=a.deletedRecords.concat(p.occurrence)}break;case"DeleteFollowingEvents":i.processRecurrenceRule(c,l[r.startTime]),a.changedRecords.push(i.parent.eventBase.processTimezone(c,!0)),a.deletedRecords=a.deletedRecords.concat(p.occurrence).concat(p.follow)}}(o);var c=i.parent.dataModule.dataManager.saveChanges(a,r.id,i.getTable(),i.getQuery());i.parent.eventBase.selectWorkCellByTime(e.changedRecords);var p={requestType:"EditFollowingEvents"===t?"eventChanged":"eventRemoved",cancel:!1,data:e.changedRecords,promise:c,editParams:a};i.refreshData(p)}})},e.prototype.processEntireSeries=function(e,t){var i=this,n=[],r=!1;if(e instanceof Array)for(var a=0,s=e;a<s.length;a++){var o=s[a];n.push(this.getParentEvent(o,!0))}else n=this.getParentEvent(e,!0);var l=e instanceof Array?e:[e],c={requestType:"EditSeries"===t?"eventChange":"eventRemove",cancel:!1,addedRecords:[],changedRecords:l,deletedRecords:[]};c.data=n,this.parent.trigger(qe,c,function(e){if(!e.cancel){for(var a=i.parent.eventFields,s={addedRecords:[],changedRecords:[],deletedRecords:[]},o=n instanceof Array?n:[n],l=0,c=e.changedRecords.length;l<c;l++)!function(n,l){var c=e.changedRecords[n],p=o[n],h=i.parent.eventBase.getEventCollections(p),d=h.follow.concat(h.occurrence);switch(t){case"EditSeries":if(c[a.startTime]>p[a.startTime]&&c[a.recurrenceRule]&&i.processRecurrenceRule(p,c),c[a.id]=p[a.id],c[a.recurrenceID]=null,c[a.followingID]=null,i.parent.uiStateValues.isIgnoreOccurrence&&c[a.recurrenceException]){var u=i.parent.eventsData.filter(function(e){return e[a.id]===c[a.id]});u.length>0&&(c[a.recurrenceRule]=u[0][a.recurrenceRule])}else c[a.recurrenceException]=null,s.deletedRecords=s.deletedRecords.concat(d);s.changedRecords.push(i.parent.eventBase.processTimezone(c,!0)),i.parent.uiStateValues.isIgnoreOccurrence=!1;break;case"DeleteSeries":s.deletedRecords=s.deletedRecords.concat(d.concat(p)),r=!0}}(l);var p=i.parent.dataModule.dataManager.saveChanges(s,a.id,i.getTable(),i.getQuery());i.parent.eventBase.selectWorkCellByTime(e.changedRecords);var h={requestType:"EditSeries"===t?"eventChanged":"eventRemoved",cancel:!1,data:r?e.deletedRecords:e.changedRecords,promise:p,editParams:s};i.refreshData(h)}})},e.prototype.processDelete=function(e){for(var i=this,n=[],r=0,a=e;r<a.length;r++){var s=a[r];s[this.parent.eventFields.recurrenceRule]?n.push({occurrence:s,parent:this.getParentEvent(s)}):n.push(s)}var o={requestType:"eventRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:e};o.data=n,this.parent.trigger(qe,o,function(e){if(!e.cancel){for(var r=i.parent.eventFields,a={addedRecords:[],changedRecords:[],deletedRecords:[]},s=0,o=e.deletedRecords.length;s<o;s++)!function(s,o){var l=t.isNullOrUndefined(e.deletedRecords[s][i.parent.eventFields.recurrenceRule]);if(!l){var c=n[s].parent,p=a.changedRecords.filter(function(e){return e[r.id]===c[r.id]}),h=e.deletedRecords[s][r.startTime];if(p.length>0){var d=p[0];d[r.recurrenceException]=i.excludeDateCheck(h,d[r.recurrenceException])}else c[r.recurrenceException]=i.excludeDateCheck(h,c[r.recurrenceException]);0===p.length&&a.changedRecords.push(i.parent.eventBase.processTimezone(c,!0)),l=e.deletedRecords[s][r.id]!==c[r.id]}l&&a.deletedRecords.push(e.deletedRecords[s])}(s);var l=i.parent.dataModule.dataManager.saveChanges(a,r.id,i.getTable(),i.getQuery()),c={requestType:"eventRemoved",cancel:!1,data:e.deletedRecords,promise:l,editParams:a};i.refreshData(c)}})},e.prototype.processSave=function(e){for(var i=this,n=e instanceof Array?e:[e],r=[],a=0,s=n;a<s.length;a++){var o=s[a];o[this.parent.eventFields.recurrenceRule]?r.push({occurrence:o,parent:this.getParentEvent(o)}):r.push(o)}var l={requestType:"eventChange",cancel:!1,addedRecords:[],changedRecords:n,deletedRecords:[]};l.data=r,this.parent.trigger(qe,l,function(e){if(!e.cancel){for(var n=i.parent.eventFields,r={addedRecords:[],changedRecords:[],deletedRecords:[]},a=0,s=e.changedRecords;a<s.length;a++){var o=s[a];if(!t.isNullOrUndefined(o[n.recurrenceRule])&&t.isNullOrUndefined(o[n.recurrenceException])){var l=Me(o[n.startTime]),c=i.getParentEvent(o);c[n.recurrenceException]=t.isNullOrUndefined(c[n.recurrenceException])?l:c[n.recurrenceException].concat(","+l),o[n.id]=i.parent.getEventMaxID(),o[n.recurrenceException]=l,r.addedRecords.push(i.parent.eventBase.processTimezone(o,!0)),r.changedRecords.push(i.parent.eventBase.processTimezone(c,!0))}else r.changedRecords.push(i.parent.eventBase.processTimezone(o,!0))}var p=i.parent.dataModule.dataManager.saveChanges(r,n.id,i.getTable(),i.getQuery()),h={requestType:"eventChanged",cancel:!1,data:e.changedRecords,promise:p,editParams:r};i.refreshData(h)}})},e.prototype.getParentEvent=function(e,t){void 0===t&&(t=!1);var i=this.parent.eventBase.getParentEvent(e,t)||e;return(i[this.parent.eventFields.startTimezone]||i[this.parent.eventFields.endTimezone])&&this.parent.eventBase.timezoneConvert(i),i},e.prototype.excludeDateCheck=function(e,i){var n=Me(e);return t.isNullOrUndefined(i)?i=n:-1===i.indexOf(n)&&(i=t.isNullOrUndefined(i)?n:i+","+n),i},e.prototype.processRecurrenceRule=function(e,t){var i,n=this.parent.eventFields,r=e[n.recurrenceRule];if(t instanceof Date)i=new Date(+t);else{i=new Date(+t[n.startTime]);var a=t[n.recurrenceRule],s=e[n.startTime],o=U(s,a,"DeleteFollowingEvents"===this.parent.currentAction?t[n.recurrenceException]:null,this.parent.activeViewOptions.firstDayOfWeek),l=new Date(o.slice(-1)[0]);l.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),i.setHours(s.getHours(),s.getMinutes(),s.getSeconds()),t[n.recurrenceRule]=this.getUpdatedRecurrenceRule(a,new Date(+l),!1)}e[n.recurrenceRule]=this.getUpdatedRecurrenceRule(r,C(new Date(i.getTime()),-1),!0)},e.prototype.getUpdatedRecurrenceRule=function(e,t,i){for(var n="",r=0,a=e.split(";");r<a.length;r++){var s=a[r];if(""!==s){var o=s.split("=")[0],l=s.split("=")[1];"COUNT"!==o&&"UNTIL"!==o||(l=Me(t),s=s.replace(s,"UNTIL="+l)),n+=s+";"}}return i&&-1===n.indexOf("UNTIL")&&(n+="UNTIL="+Me(t)),n},e.prototype.isBlockEvent=function(e){for(var t=!1,i=0,n=e instanceof Array?e:[e];i<n.length;i++)t=n[i][this.parent.eventFields.isBlock]||!1;return t},e.prototype.destroy=function(){this.crudObj=null,this.parent=null},e}(),yi=function(){function e(e){this.parent=e,t.EventHandler.add(this.parent.element,"mouseover",this.onHover,this)}return e.prototype.cellMouseDown=function(e){this.isPreventAction(e)||this.parent.notify("cell-mouse-down",{event:e})},e.prototype.cellClick=function(e){var i=this;if(!this.isPreventAction(e)){var n=t.closest(e.target,".e-work-cells,.e-all-day-cells,.e-header-cells");if(!t.isNullOrUndefined(n)){if(!t.isNullOrUndefined(t.closest(e.target,".e-new-event")))return void this.parent.eventWindow.openEditor(this.parent.activeCellsData,"Add");var r=t.closest(e.target,".e-navigate"),a=this.parent.getNavigateView(),s=this.parent.currentView===a;if(t.isNullOrUndefined(r)||s||t.isNullOrUndefined(this.parent.viewOptions[a.charAt(0).toLowerCase()+a.slice(1)])){if(this.parent.activeViewOptions.readonly&&"MonthAgenda"!==this.parent.currentView)return void(this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide());if(this.parent.isAdaptive&&(e.target.classList.contains("e-more-indicator")||t.closest(e.target,".e-more-indicator")))return;var o=n.classList.contains("e-work-cells")||n.classList.contains("e-all-day-cells");if(o&&e.shiftKey&&1===e.which&&this.parent.keyboardInteractionModule)return void this.parent.keyboardInteractionModule.onMouseSelection(e);this.parent.activeCellsData=this.parent.getCellDetails(n);var l=t.extend(this.parent.activeCellsData,{cancel:!1,event:e,name:"cellClick"});this.parent.trigger("cellClick",l,function(e){if(e.cancel)i.parent.quickPopup&&i.parent.quickPopup.quickPopupHide();else if(o&&i.parent.selectCell(n),i.parent.allowInline){var t={element:e.element,groupIndex:e.groupIndex,type:"Cell"};i.parent.notify(Ne,t)}else i.parent.notify("cellClick",e)})}else{var c=this.parent.getDateFromElement(n);t.isNullOrUndefined(c)||this.parent.isAdaptive||!this.parent.isMinMaxDate(c)||(this.parent.setProperties({selectedDate:c},!0),this.parent.changeView(this.parent.getNavigateView(),e))}}}},e.prototype.cellDblClick=function(e){var i=this,n=t.closest(e.target,".e-work-cells,.e-all-day-cells,.e-header-cells");if(!(this.parent.activeViewOptions.readonly||this.isPreventAction(e)||t.isNullOrUndefined(n))){var r=t.extend(this.parent.activeCellsData,{cancel:!1,event:e,name:"cellDoubleClick"});this.parent.trigger("cellDoubleClick",r,function(e){var t=new Date(e.startTime.getTime());i.parent.isMinMaxDate(new Date(t.setHours(0,0,0,0)))&&(e.cancel||i.parent.eventWindow.openEditor(i.parent.activeCellsData,"Add"))})}},e.prototype.onHover=function(e){var i=t.closest(e.target,".e-work-cells,.e-time-slots,.e-all-day-cells,.e-header-cells,.e-resource-cells,.e-appointment,.e-week-number,.e-month-header");if(i){var n={element:i,event:e};this.parent.trigger("hover",n)}},e.prototype.isPreventAction=function(e){if(t.closest(e.target,".e-navigate"))return!1;if(t.closest(e.target,".e-appointment-wrapper")&&!t.closest(e.target,".e-more-indicator"))return!0;var i=t.closest(e.target,".e-appointment,.e-resource-group-cells");return!t.isNullOrUndefined(i)||(i=t.closest(e.target,".e-header-cells"),!(!this.parent.activeView.isTimelineView()||t.isNullOrUndefined(i)))},e.prototype.destroy=function(){t.EventHandler.remove(this.parent.element,"mouseover",this.onHover)},e}(),Ti=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),wi=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},Di=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ti(i,e),wi([t.Property()],i.prototype,"name",void 0),wi([t.Property()],i.prototype,"default",void 0),wi([t.Property()],i.prototype,"title",void 0),wi([t.Property({})],i.prototype,"validation",void 0),i}(t.ChildProperty),bi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ci=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},Oi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Property("Id")],i.prototype,"id",void 0),Ci([t.Property("IsBlock")],i.prototype,"isBlock",void 0),Ci([t.Complex({name:"Subject"},Di)],i.prototype,"subject",void 0),Ci([t.Complex({name:"StartTime"},Di)],i.prototype,"startTime",void 0),Ci([t.Complex({name:"EndTime"},Di)],i.prototype,"endTime",void 0),Ci([t.Complex({name:"StartTimezone"},Di)],i.prototype,"startTimezone",void 0),Ci([t.Complex({name:"EndTimezone"},Di)],i.prototype,"endTimezone",void 0),Ci([t.Complex({name:"Location"},Di)],i.prototype,"location",void 0),Ci([t.Complex({name:"Description"},Di)],i.prototype,"description",void 0),Ci([t.Complex({name:"IsAllDay"},Di)],i.prototype,"isAllDay",void 0),Ci([t.Complex({name:"RecurrenceID"},Di)],i.prototype,"recurrenceID",void 0),Ci([t.Complex({name:"RecurrenceRule"},Di)],i.prototype,"recurrenceRule",void 0),Ci([t.Complex({name:"RecurrenceException"},Di)],i.prototype,"recurrenceException",void 0),Ci([t.Property("IsReadonly")],i.prototype,"isReadonly",void 0),Ci([t.Property("FollowingID")],i.prototype,"followingID",void 0),i}(t.ChildProperty),Ei=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Si=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},xi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ei(i,e),Si([t.Property()],i.prototype,"template",void 0),Si([t.Property([])],i.prototype,"dataSource",void 0),Si([t.Property()],i.prototype,"query",void 0),Si([t.Complex({},Oi)],i.prototype,"fields",void 0),Si([t.Property(!1)],i.prototype,"enableTooltip",void 0),Si([t.Property("AllDayRow")],i.prototype,"spannedEventPlacement",void 0),Si([t.Property(1)],i.prototype,"minimumEventDuration",void 0),Si([t.Property()],i.prototype,"tooltipTemplate",void 0),Si([t.Property()],i.prototype,"resourceColorField",void 0),Si([t.Property(!1)],i.prototype,"editFollowingEvents",void 0),Si([t.Property(!0)],i.prototype,"allowAdding",void 0),Si([t.Property(!0)],i.prototype,"allowEditing",void 0),Si([t.Property(!0)],i.prototype,"allowDeleting",void 0),Si([t.Property(!1)],i.prototype,"enableMaxHeight",void 0),Si([t.Property(!1)],i.prototype,"enableIndicator",void 0),Si([t.Property(!1)],i.prototype,"ignoreWhitespace",void 0),Si([t.Property()],i.prototype,"sortComparer",void 0),i}(t.ChildProperty),Ai=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Vi=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},ki=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ai(i,e),Vi([t.Property(!1)],i.prototype,"byDate",void 0),Vi([t.Property(!0)],i.prototype,"byGroupID",void 0),Vi([t.Property(!1)],i.prototype,"allowGroupEdit",void 0),Vi([t.Property([])],i.prototype,"resources",void 0),Vi([t.Property(!0)],i.prototype,"enableCompactView",void 0),Vi([t.Property()],i.prototype,"headerTooltipTemplate",void 0),i}(t.ChildProperty),Mi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ri=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},Pi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Mi(i,e),Ri([t.Property()],i.prototype,"field",void 0),Ri([t.Property()],i.prototype,"title",void 0),Ri([t.Property()],i.prototype,"name",void 0),Ri([t.Property(!1)],i.prototype,"allowMultiple",void 0),Ri([t.Property([])],i.prototype,"dataSource",void 0),Ri([t.Property()],i.prototype,"query",void 0),Ri([t.Property("Id")],i.prototype,"idField",void 0),Ri([t.Property("Text")],i.prototype,"textField",void 0),Ri([t.Property("Expanded")],i.prototype,"expandedField",void 0),Ri([t.Property("GroupID")],i.prototype,"groupIDField",void 0),Ri([t.Property("Color")],i.prototype,"colorField",void 0),Ri([t.Property("StartHour")],i.prototype,"startHourField",void 0),Ri([t.Property("EndHour")],i.prototype,"endHourField",void 0),Ri([t.Property("WorkDays")],i.prototype,"workDaysField",void 0),Ri([t.Property("CssClass")],i.prototype,"cssClassField",void 0),i}(t.ChildProperty),Ii=function(){function e(e){this.resourceCollection=[],this.leftPixel=25,this.parent=e}return e.prototype.renderResourceHeaderIndent=function(e){var i=t.createElement("td",{className:"e-resource-left-td"}),n=t.createElement("div",{className:"e-resource-text"});if(this.parent.activeViewOptions.headerIndentTemplate){var r={className:[i.className],type:"emptyCells"};this.parent.renderHeaderIndentTemplate(r,i)}else i.appendChild(n);var a={elementType:"emptyCells",element:i};this.parent.trigger(Le,a),e.appendChild(i)},e.prototype.hideResourceRows=function(e){if(!(this.resourceCollection.length<=1||this.parent.virtualScrollModule))for(var i=this.lastResourceLevel.length,n=0;n<i;n++){var r=this.lastResourceLevel[n].resourceData,a=this.lastResourceLevel[n].resource;if("e-parent-node"===r.ClassName&&!r[a.expandedField]&&!t.isNullOrUndefined(r[a.expandedField])){var s=[].slice.call(e.children).slice(n+1,n+(parseInt(r.Count,10)+1));t.addClass(s,"e-hidden")}}},e.prototype.createResourceColumn=function(){var e=this.resourceCollection,i=t.createElement("div",{className:"e-resource-column-wrap"}),n=this.parent.activeView.createTableLayout("e-resource-column-table");!this.parent.uiStateValues.isGroupAdaptive&&this.parent.rowAutoHeight&&this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0&&t.addClass([n],"e-auto-height");var r=n.querySelector("tbody"),a=this.generateTreeData(!0);if(this.countCalculation(e.slice(0,-2),e.slice(0,-1)),this.renderedResources=this.lastResourceLevel,this.parent.virtualScrollModule){var s=this.parent.virtualScrollModule.getRenderedCount();this.setExpandedResources(),a=this.expandedResources.slice(0,s),this.renderedResources=a}return t.append(this.getContentRows(a),r),this.hideResourceRows(r),n.appendChild(r),i.appendChild(n),i},e.prototype.setRenderedResources=function(){var e=this.resourceCollection;this.generateTreeData(!0);this.countCalculation(e.slice(0,-2),e.slice(0,-1)),this.renderedResources=this.lastResourceLevel},e.prototype.setExpandedResources=function(){for(var e=[],i=0;i<this.lastResourceLevel.length;i++){var n=this.lastResourceLevel[i].resourceData,r=n.Count;e.push(this.lastResourceLevel[i]);var a=n[this.lastResourceLevel[i].resource.expandedField];!t.isNullOrUndefined(a)&&!a&&r>0&&(i+=r)}this.expandedResources=e},e.prototype.getContentRows=function(e,i){for(var n,r,a=[],s=this.resourceCollection,o=t.createElement("tr"),l=t.createElement("td",{attrs:{tabindex:i?"-1":"0"}}),c=0;c<e.length;c++){var p=l.cloneNode();if(r=M(s,"name",e[c].resource.name),r===s.length-1?(t.extend(e[c].resourceData,{ClassName:"e-child-node"}),this.renderedResources[c].className=["e-child-node"]):(t.extend(e[c].resourceData,{ClassName:"e-parent-node"}),this.renderedResources[c].className=["e-parent-node"]),n=r*this.leftPixel+"px","e-parent-node"===e[c].resourceData.ClassName&&!t.isNullOrUndefined(e[c].resourceData.Count)&&e[c].resourceData.Count>0){var h=void 0;h=e[c].resourceData[s[r].expandedField]||t.isNullOrUndefined(e[c].resourceData[s[r].expandedField])?"e-resource-collapse":"e-resource-expand";var d=t.createElement("div");t.addClass([d],["e-resource-tree-icon",h]),this.setMargin(d,n),p.appendChild(d),this.resourceCollection.length>1&&t.EventHandler.add(d,"click",this.onTreeIconClick,this)}this.parent.activeView.setResourceHeaderContent(p,e[c],"e-resource-text"),p.setAttribute("data-group-index",e[c].groupIndex.toString()),p.setAttribute("aria-label",e[c].resourceData[e[c].resource.textField]+" resource"),this.parent.activeViewOptions.resourceHeaderTemplate||this.setMargin(p.querySelector(".e-resource-text"),n);var u=["e-resource-cells",e[c].resourceData.ClassName];t.addClass([p],u);var v={elementType:"resourceHeader",element:p,groupIndex:e[c].groupIndex};this.parent.trigger(Le,v);var m=o.cloneNode();m.appendChild(p),a.push(m)}return a},e.prototype.setMargin=function(e,t){this.parent.enableRtl?e.style.marginRight=t:e.style.marginLeft=t},e.prototype.countCalculation=function(e,i){for(var n,r=0;r<e.length;r++){for(var s=e[e.length-(r+1)].dataSource,o=0;o<s.length;o++){var l=0;if(this.parent.activeViewOptions.group.byGroupID){var c=(new a.Query).where(i[i.length-1].groupIDField,"equal",s[o][e[e.length-(r+1)].idField]);n=new a.DataManager(i[i.length-1].dataSource).executeLocal(c)}else n=i[i.length-1].dataSource;for(var p=0;p<n.length;p++)l+=parseInt(n[p].Count,10);l+=parseInt(s[o].Count,10),t.extend(s[o],{Count:l})}i=i.slice(0,-1)}},e.prototype.onTreeIconClick=function(e){var i=this;this.parent.eventTooltip&&this.parent.eventTooltip.close();var n,r=e.target,a=t.closest(r,".e-parent-node").parentElement,s=parseInt(a.children[0].getAttribute("data-group-index"),10),o={cancel:!1,event:e,groupIndex:s,requestType:r.classList.contains("e-resource-collapse")?"resourceCollapse":"resourceExpand"};this.parent.trigger(qe,o,function(a){if(!a.cancel){r.classList.contains("e-resource-collapse")?(t.classList(r,["e-resource-expand"],["e-resource-collapse"]),n=!0):(t.classList(r,["e-resource-collapse"],["e-resource-expand"]),n=!1);for(var l=0,c=[].slice.call(i.parent.element.querySelectorAll(".e-appointment"));l<c.length;l++){var p=c[l];t.remove(p)}i.parent.virtualScrollModule?i.updateVirtualContent(s,n,e,r):i.updateContent(s,n);var h={cssProperties:i.parent.getCssProperties(),module:"scroll"};i.parent.notify(Be,h),o={cancel:!1,event:e,groupIndex:s,requestType:r.classList.contains("e-resource-collapse")?"resourceExpanded":"resourceCollapsed"},i.parent.refreshEvents(!1),i.parent.trigger("actionComplete",o)}})},e.prototype.updateContent=function(e,i){for(var n,r=[],a=[],s=[],o=this.lastResourceLevel[e].resourceData,l=[].slice.call(this.parent.element.querySelectorAll(".e-resource-column-wrap tr")),c=[].slice.call(this.parent.element.querySelectorAll(".e-content-wrap tbody tr")),p=[].slice.call(this.parent.element.querySelectorAll(".e-content-wrap ."+Ze)),h=0;h<o.Count;h++)r.push(l[e+h+1]),a.push(c[e+h+1]),s.push(p[e+h+1]);for(var d=this.lastResourceLevel,u=0;u<r.length;u++){var v=!0;if(n=r[u].children[0].classList.contains("e-parent-node"),d[e].resourceData[d[e].resource.expandedField]=!i,i)n&&(g=r[u].querySelector(".e-resource-tree-icon"))&&t.classList(g,["e-resource-expand"],["e-resource-collapse"]),r[u].classList.contains("e-hidden")||t.addClass([r[u],a[u],s[u]],"e-hidden");else{if(n){var m=r[u].rowIndex;if(d[m].resourceData[d[m].resource.expandedField]||t.isNullOrUndefined(d[m].resourceData[d[m].resource.expandedField])||(r.splice(u+1,parseInt(d[m].resourceData.Count,10)),a.splice(u+1,parseInt(d[m].resourceData.Count,10)),s.splice(u+1,parseInt(d[m].resourceData.Count,10)),v=!1),v){var g=r[u].querySelector(".e-resource-tree-icon");g&&t.classList(g,["e-resource-collapse"],["e-resource-expand"])}}r[u].classList.contains("e-hidden")&&t.removeClass([r[u],a[u],s[u]],"e-hidden")}}},e.prototype.updateVirtualContent=function(e,i,n,r){this.lastResourceLevel[e].resourceData[this.lastResourceLevel[e].resource.expandedField]=!i,this.setExpandedResources();var a=this.parent.virtualScrollModule.getRenderedCount(),s=this.expandedResources.indexOf(this.renderedResources[0]);if(this.renderedResources=this.expandedResources.slice(s,s+a),this.renderedResources.length<a){var o=this.expandedResources.length-a;o=o>0?o:0,this.renderedResources=this.expandedResources.slice(o,this.expandedResources.length)}var l=this.parent.element.querySelector(".e-virtual-track");this.parent.virtualScrollModule.updateVirtualTrackHeight(l);var c=this.parent.element.querySelector(".e-resource-column-wrap table"),p=this.parent.element.querySelector(".e-content-wrap table"),h=this.parent.element.querySelector(".e-event-table");this.parent.virtualScrollModule.updateContent(c,p,h,this.renderedResources);var d=this.parent.element.querySelector(".e-current-timeline");t.isNullOrUndefined(d)||(d.style.height=this.parent.element.querySelector("."+Qe).offsetHeight+"px")},e.prototype.renderResourceHeader=function(){var e=t.createElement("div",{className:"e-schedule-resource-toolbar-container"});if(e.innerHTML='<div class="e-schedule-resource-toolbar"><div class="e-resource-menu"><div class="e-icons e-icon-menu"></div></div><div class="e-resource-level-title"></div></div>',"MonthAgenda"===this.parent.currentView){var i=this.parent.activeView.getPanel().querySelector(".e-content-wrap");i.insertBefore(e,i.querySelector(".e-wrapper-container"))}else this.parent.element.insertBefore(e,this.parent.element.querySelector("."+Xe));this.renderResourceHeaderText(),t.EventHandler.add(e.querySelector(".e-icon-menu"),"click",this.menuClick,this)},e.prototype.renderResourceTree=function(){this.popupOverlay=t.createElement("div",{className:"e-resource-tree-popup-overlay"});var e=t.createElement("div",{className:"e-resource-tree-popup e-popup-close"});if("MonthAgenda"===this.parent.currentView){var r=this.parent.activeView.getPanel().querySelector(".e-wrapper-container");r.insertBefore(e,r.children[0]),r.appendChild(this.popupOverlay)}else this.parent.element.querySelector("."+Xe).appendChild(e),this.parent.element.querySelector("."+Xe).appendChild(this.popupOverlay);var a=t.createElement("div",{className:"e-resource-tree"});e.appendChild(a),this.treeViewObj=new n.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:[].slice.call(this.generateTreeData()),id:"resourceId",text:"resourceName",child:"resourceChild"},nodeTemplate:this.parent.resourceHeaderTemplate,nodeClicked:this.resourceClick.bind(this)}),this.treeViewObj.appendTo(a),this.treeViewObj.expandAll(),this.treePopup=new i.Popup(e,{targetType:"relative",actionOnScroll:"none",content:this.treeViewObj.element,relateTo:this.parent.element.querySelector("."+Xe),enableRtl:this.parent.enableRtl,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+("MonthAgenda"===this.parent.currentView?"e-wrapper-container":Xe))}),this.parent.on("document-click",this.documentClick,this)},e.prototype.generateTreeData=function(e){for(var i=this,n=[],r=[],a=0,s=this,o=0,l=this.resourceTreeLevel.length;o<l;o++)!function(o,l){var c=function(n,s,o){var l,p,h=i.resourceCollection[s];e?(p={type:"resourceHeader",resource:n.resource,resourceData:n.resourceData,groupIndex:a,groupOrder:n.groupOrder},r.push(p),a++):l={resourceId:o,resourceName:n.resourceData[h.textField],resource:n.resource,resourceData:n.resourceData},n.child.length>0&&!e&&(l.resourceChild=[]);for(var d=1,u=0,v=n.child;u<v.length;u++){var m=v[u];e?c(m,s+1,o+"-"+d):l.resourceChild.push(c(m,s+1,o+"-"+d)),d+=1}return e&&t.extend(p.resourceData,{Count:d-1}),l};e?c(s.resourceTreeLevel[o],0,(o+1).toString()):n.push(c(s.resourceTreeLevel[o],0,(o+1).toString()))}(o);return e?(this.lastResourceLevel=r,r):n},e.prototype.renderResourceHeaderText=function(){for(var e=this.lastResourceLevel[this.parent.uiStateValues.groupIndex],i=[],n=this,r=0,a=e.groupOrder.length;r<a;r++)!function(r,a){var s=n.resourceCollection[r],o=s.dataSource.filter(function(t){return t[s.idField]===e.groupOrder[r]}),l=t.createElement("div",{className:"e-resource-name",innerHTML:o[0][s.textField]});i.push(l);var c=t.createElement("div",{className:"e-icons e-icon-next"});i.push(c)}(r);i.pop();var s=("MonthAgenda"===this.parent.currentView?this.parent.activeView.getPanel():this.parent.element).querySelector(".e-resource-level-title");P(s);for(var o=0,l=i;o<l.length;o++){var c=l[o];s.appendChild(c)}1===this.lastResourceLevel.length&&t.addClass([this.parent.element.querySelector(".e-resource-menu")],"e-disable")},e.prototype.menuClick=function(e){if(this.parent.element.querySelector(".e-resource-tree-popup").classList.contains(Ke))this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable");else{var i=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item:not(.e-has-child)"));t.removeClass(i,"e-active"),t.addClass([i[this.parent.uiStateValues.groupIndex]],"e-active"),this.treePopup.show(),t.addClass([this.popupOverlay],"e-enable")}},e.prototype.selectResourceByIndex=function(e){this.lastResourceLevel&&e>-1&&e<this.lastResourceLevel.length&&this.triggerEvents(e)},e.prototype.resourceClick=function(e){if(!e.node.classList.contains("e-has-child")){this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable");var i=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item:not(.e-has-child)")).indexOf(e.node);this.triggerEvents(i,e),e.event.preventDefault()}},e.prototype.triggerEvents=function(e,t){var i=this,n={cancel:!1,event:t?t.event:null,groupIndex:e,requestType:"resourceChange"};this.parent.trigger(qe,n,function(e){e.cancel||(i.parent.uiStateValues.groupIndex=e.groupIndex,i.parent.renderModule.render(i.parent.currentView),n={cancel:!1,event:t?t.event:null,groupIndex:i.parent.uiStateValues.groupIndex,requestType:"resourceChanged"},i.parent.trigger("actionComplete",n))})},e.prototype.documentClick=function(e){if(!t.closest(e.event.target,".e-resource-tree-popup")){var i=this.parent.element.querySelector(".e-resource-tree-popup");i&&i.classList.contains(Ke)&&(this.treePopup.hide(),t.removeClass([this.popupOverlay],"e-enable"))}},e.prototype.bindResourcesData=function(e){var t=this;this.parent.showSpinner();for(var i=[],n=0,r=this.parent.resources;n<r.length;n++){var a=r[n],s=new at(a.dataSource,a.query);i.push(s.getData(s.generateQuery()))}Promise.all(i).then(function(i){return t.dataManagerSuccess(i,e)}).catch(function(e){return t.parent.crudModule.dataManagerFailure(e)})},e.prototype.dataManagerSuccess=function(e,t){if(!(!this.parent||this.parent&&this.parent.isDestroyed)){this.parent.resourceCollection=[];for(var i=0,n=e.length;i<n;i++){var r=this.parent.resources[i],a=this.getResourceModel(r,e[i].result);this.parent.resourceCollection.push(a)}this.refreshLayout(t)}},e.prototype.getResourceModel=function(e,t){return{field:e.field,title:e.title,name:e.name,allowMultiple:e.allowMultiple,dataSource:t||e.dataSource,idField:e.idField,textField:e.textField,groupIDField:e.groupIDField,colorField:e.colorField,startHourField:e.startHourField,endHourField:e.endHourField,workDaysField:e.workDaysField,expandedField:e.expandedField,cssClassField:e.cssClassField}},e.prototype.refreshLayout=function(e){!t.isNullOrUndefined(this.parent.uiStateValues.groupIndex)&&this.parent.enablePersistence||(this.parent.uiStateValues.groupIndex=0),this.parent.renderElements(e)},e.prototype.setResourceCollection=function(){var e=[];if(this.resourceCollection=[],this.colorIndex=null,this.parent.activeViewOptions.group.resources.length>0)for(var i=0,n=this.parent.activeViewOptions.group.resources;i<n.length;i++){var r=n[i],a=M(this.parent.resourceCollection,"name",r);a>=0&&e.push(this.parent.resourceCollection[a])}else this.parent.resourceCollection.length>0&&(e=this.parent.resourceCollection);for(var s=0,o=0,l=e;o<l.length;o++){var r=l[o],c=this.getResourceModel(r);r.name===this.parent.eventSettings.resourceColorField&&(this.colorIndex=s),s++,this.resourceCollection.push(c)}t.isNullOrUndefined(this.colorIndex)&&(this.colorIndex=this.resourceCollection.length-1)},e.prototype.generateResourceLevels=function(e,t){var i=this,n=this.resourceCollection,r=[],a=[],s=function(t,n,o,l,c){var p=[],h=t[0];if(h){var d=void 0;if(l&&i.parent.activeViewOptions.group.byGroupID){var u=l[o.idField];d=h.dataSource.filter(function(e){return e[h.groupIDField]===u})}else d=h.dataSource;for(var v=0;v<d.length;v++){var m=[];c&&c.length>0&&(m=m.concat(c)),m.push(d[v][h.idField]);var g=s(t.slice(1),n+1,h,d[v],m);if(!(0===n&&0===g.length&&i.resourceCollection.length>1)){var f=[],y=i.parent.activeView.renderDates,T=void 0;if(!i.parent.activeViewOptions.group.byDate&&n+1===i.resourceCollection.length){var w=d[v][h.workDaysField],D=d[v][h.startHourField],b=d[v][h.endHourField];w&&w.length>0?(y=i.parent.activeView.getRenderDates(w),T=w,f=i.parent.activeView.getDateSlots(y,w)):(T=i.parent.activeViewOptions.workDays,f=e);var C=i.generateCustomHours(f,D,b,m);a=a.concat(C)}var O=d[v][h.cssClassField],E={type:"resourceHeader",className:["e-resource-cells"],resourceLevelIndex:n,groupOrder:m,resource:h,resourceData:d[v],colSpan:i.parent.activeViewOptions.group.byDate?1:f.length,renderDates:y,workDays:T,cssClass:O,child:g};p.push(E)}}return r[n]||(r[n]=[]),p.length>0&&r[n].push(p),p}return[]};return this.resourceTreeLevel=s(n,0),t?[]:this.generateHeaderLevels(r,a,e)},e.prototype.generateCustomHours=function(e,i,n,r){for(var a=t.extend([],e,null,!0),s=0,o=a;s<o.length;s++){var l=o[s];i&&(l.startHour=this.parent.getStartEndTime(i)),n&&(l.endHour=this.parent.getStartEndTime(n)),r&&(l.groupOrder=r)}return a},e.prototype.generateHeaderLevels=function(e,i,n){for(var r=[],a=e.length-1;a>=0;a--)for(var s=0,o=0,l=e[a];o<l.length;o++)for(var c=0,p=l[o];c<p.length;c++){var h=p[c];if(e[a+1]&&e[a+1].length>0){var d=e[a+1][s];if(!d)continue;for(var u=0,v=0,m=d;v<m.length;v++){var g=m[v];(!this.parent.activeViewOptions.group.byGroupID||this.parent.activeViewOptions.group.byGroupID&&g.resourceData[g.resource.groupIDField]===h.resourceData[h.resource.idField])&&(u+=g.colSpan)}h.colSpan=u}h.groupIndex=s,s++,r[h.resourceLevelIndex]=r[h.resourceLevelIndex]||[],r[h.resourceLevelIndex].push(h)}if(this.lastResourceLevel=r.slice(-1)[0]||[],!this.parent.activeViewOptions.group.byDate){for(var f=0,y=0,T=this.lastResourceLevel;y<T.length;y++)for(var w=T[y],a=0;a<w.colSpan;a++)i[f].groupIndex=w.groupIndex,f++;return r.push(i),r}for(var D=[],b=t.extend([],r,null,!0),C=0,O=0,E=b[0];O<E.length;O++)C+=E[O].colSpan;for(var S=[],x=0,A=n;x<A.length;x++){var V=A[x];V.colSpan=C,S.push(V);for(var k=t.extend([],b,null,!0),M=0,R=k.length;M<R;M++){if(M===k.length-1)for(var P=0,I=k[M];P<I.length;P++){var H=I[P];H.date=V.date,H.workDays=V.workDays,H.startHour=this.parent.getStartEndTime(H.resourceData[H.resource.startHourField])||V.startHour,H.endHour=this.parent.getStartEndTime(H.resourceData[H.resource.endHourField])||V.endHour}D[M]||(D[M]=[]),D[M]=D[M].concat(k[M])}}return D.unshift(S),D},e.prototype.setResourceValues=function(e,i){var n=this,r=function(t,i,r){n.resourceCollection[t].allowMultiple&&n.parent.activeViewOptions.group.allowGroupEdit?e[i]=[r]:e[i]=r};if(void 0===i&&(i=this.parent.uiStateValues.isGroupAdaptive?this.parent.uiStateValues.groupIndex:this.parent.activeCellsData.groupIndex),this.parent.activeViewOptions.group.resources.length>0&&!t.isNullOrUndefined(i))for(var a=this.lastResourceLevel[i].groupOrder,s=0;s<this.resourceCollection.length;s++)r(s,this.resourceCollection[s].field,a[s]);else if(this.parent.resourceCollection.length>0)for(s=0;s<this.resourceCollection.length;s++){var o=this.resourceCollection[s].dataSource[0];o&&r(s,this.resourceCollection[s].field,o[this.resourceCollection[s].idField])}},e.prototype.getResourceColor=function(e,i){var n=!t.isNullOrUndefined(i)&&this.colorIndex>i.length-1?i.length-1:this.colorIndex,r=this.resourceCollection[n];if(!(t.isNullOrUndefined(i)&&this.parent.activeViewOptions.group.allowGroupEdit&&r.allowMultiple)){var a=t.isNullOrUndefined(i)?e[r.field]:i[n],s=this.filterData(r.dataSource,r.idField,a);return s.length>0?s[0][r.colorField]:void 0}},e.prototype.getCssClass=function(e){var t=this.resourceCollection.slice(-1)[0];if(!this.parent.activeViewOptions.group.allowGroupEdit||!t.allowMultiple){var i=this.filterData(t.dataSource,t.idField,e[t.field]);return i.length>0?i[0][t.cssClassField]:void 0}},e.prototype.getResourceRenderDates=function(){var e=function(e){return e.filter(function(e,t,i){return i.map(function(e){return e.getTime()}).indexOf(e.getTime())===t})}([].concat.apply([],this.lastResourceLevel.map(function(e){return e.renderDates})));return e.sort(function(e,t){return e.getTime()-t.getTime()}),e},e.prototype.filterData=function(e,t,i){return e.filter(function(e){return e[t]===i})},e.prototype.getResourceData=function(e,i,n){if(this.parent.activeViewOptions.group.allowGroupEdit){for(var r={},a=0,s=n;a<s.length;a++)for(var o=s[a],l=this.lastResourceLevel[o].groupOrder,c=0,p=l.length;c<p;c++){var h=this.resourceCollection[c].field;t.isNullOrUndefined(r[h])&&(r[h]=[]),r[h].push(l[c])}e=t.extend(e,r)}else for(var c=0,d=this.resourceCollection.length;c<d;c++)this.lastResourceLevel[i]&&(e[this.resourceCollection[c].field]=this.lastResourceLevel[i].groupOrder[c])},e.prototype.addResource=function(e,t,i){for(var n=e instanceof Array?e:[e],r=0,s=this.parent.resourceCollection;r<s.length&&"break"!==function(e){if(e.name===t)return n.forEach(function(t,n){return new a.DataManager({json:e.dataSource}).insert(t,null,null,i+n)}),"break"}(s[r]);r++);this.refreshLayout(!0)},e.prototype.removeResource=function(e,t){for(var i=e instanceof Array?e:[e],n=0,r=this.parent.resourceCollection;n<r.length&&"break"!==function(e){if(e.name===t)return i.forEach(function(t){return new a.DataManager({json:e.dataSource}).remove(e.idField,t)}),"break"}(r[n]);n++);this.refreshLayout(!0)},e.prototype.getIndexFromResourceId=function(e,i,n,r,a){if(i=i||this.parent.resourceCollection.slice(-1)[0].name,t.isNullOrUndefined(n)&&(n=this.resourceCollection.filter(function(e){return e.name===i})[0],t.isNullOrUndefined(n)))return null;var s=n.dataSource.filter(function(t){return r&&t[n.idField]===e?t[n.groupIDField]===r[a]?t[n.idField]===e:null:t[n.idField]===e})[0];return this.lastResourceLevel.map(function(e){return e.resourceData}).indexOf(s)},e.prototype.resourceExpand=function(e,t,i){var n=this.parent.resourceCollection.filter(function(e){return e.name===t?e:null})[0],r=0,a=n.dataSource.filter(function(t){return t[n.idField]===e})[0];r=this.parent.activeViewOptions.group.byGroupID?this.lastResourceLevel.map(function(e){return e.resourceData}).indexOf(a):this.getIndexFromResourceId(e,t,n);var s=this.parent.element.querySelector('.e-resource-column-wrap [data-group-index="'+r+'"] .e-resource-tree-icon');s&&(s.classList.contains("e-resource-expand")&&!i?s.click():s.classList.contains("e-resource-collapse")&&i&&s.click())},e.prototype.resourceScroll=function(e,t){if(!(this.parent.isAdaptive||["Agenda","MonthAgenda"].indexOf(this.parent.currentView)>-1)){var i=t||this.parent.resourceCollection.slice(-1)[0].name,n=this.parent.resourceCollection.length-1,r=this.parent.resourceCollection.filter(function(e,t){return e.name===i?(n=t,e):null})[0],a=this.parent.element.querySelector(".e-content-wrap"),s=0;if(this.parent.activeView.isTimelineView()){if(this.parent.activeViewOptions.group.byGroupID){var o=r.dataSource.filter(function(t){return t[r.idField]===e})[0];s=this.lastResourceLevel.map(function(e){return e.resourceData}).indexOf(o)}else s=this.getIndexFromResourceId(e,i,r);if(this.parent.virtualScrollModule){var l=this.parent.element.querySelector(".e-virtual-track"),c=Math.round(l.offsetHeight/this.expandedResources.length);this.parent.rowAutoHeight&&(a.scrollTop=0,this.parent.virtualScrollModule.virtualScrolling()),a.scrollTop=s*c-(this.parent.virtualScrollModule.bufferCount-1)*c,this.parent.virtualScrollModule.virtualScrolling(),this.parent.rowAutoHeight?(p=this.parent.element.querySelector('.e-work-cells[data-group-index="'+s+'"]'))&&!p.parentElement.classList.contains("e-hidden")&&(a.scrollTop=a.scrollTop<p.offsetTop?p.offsetTop:a.scrollTop+p.offsetTop):a.scrollTop=s*c}else{var p=this.parent.element.querySelector('.e-work-cells[data-group-index="'+s+'"]');p&&!p.parentElement.classList.contains("e-hidden")&&(a.scrollTop=p.offsetTop)}}else{s=this.parent.activeViewOptions.group.byGroupID?i===this.parent.resourceCollection.slice(-1)[0].name?this.lastResourceLevel.map(function(e){return e.resourceData[r.idField]}).indexOf(e):r.dataSource.map(function(e){return e[r.idField]}).indexOf(e):this.getIndexFromResourceId(e,i,r);var h=this.parent.element.querySelector(".e-header-row:nth-child("+(n+1)+")"),d=[].slice.call(h.children).map(function(e){return e.offsetLeft});a.scrollLeft=d[s]}}},e.prototype.destroy=function(){this.parent.off("document-click",this.documentClick),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null,t.remove(this.parent.element.querySelector(".e-resource-tree-popup")),t.remove(this.parent.element.querySelector(".e-resource-tree-popup-overlay")));var e=this.parent.element.querySelector(".e-schedule-resource-toolbar-container");e&&t.remove(e)},e}(),Hi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ji=function(e,t,i,n){var r,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;o>=0;o--)(r=e[o])&&(s=(a<3?r(s):a>3?r(t,i,s):r(t,i))||s);return a>3&&s&&Object.defineProperty(t,i,s),s},qi=function(e){function n(t,i){return e.call(this,t,i)||this}return Hi(n,e),n.prototype.render=function(){var e=[],n=[];if(e.push(_e),this.enableRtl?e.push("e-rtl"):n.push("e-rtl"),this.isAdaptive?e.push("e-device"):n.push("e-device"),this.allowMultiDrag?e.push("e-multi-drag"):n.push("e-multi-drag"),this.cssClass)for(var r=0,a=this.cssClass.split(" ");r<a.length;r++){var s=a[r];e.push(s)}t.classList(this.element,e,n),this.validateDate(),i.createSpinner({target:this.element}),this.scrollModule=new it(this),this.scrollModule.setWidth(),this.scrollModule.setHeight(),this.renderModule=new ri(this),this.eventBase=new xt(this),this.workCellAction=new yi(this),this.allowKeyboardInteraction&&(this.keyboardInteractionModule=new rt(this)),this.inlineModule=new It(this),this.initializeDataModule(),this.renderTableContainer(),this.activeViewOptions=this.getActiveViewOptions(),this.initializeResources(),this.wireEvents()},n.prototype.renderTableContainer=function(){this.element.querySelector("."+Xe)||this.element.appendChild(this.createElement("div",{className:Xe}))},n.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},n.prototype.resetTemplates=function(e){(this.isAngular||this.isReact)&&this.clearTemplate(e)},n.prototype.initializeResources=function(e){void 0===e&&(e=!1),this.resources.length>0?(this.resourceBase=new Ii(this),this.resourceBase.bindResourcesData(e)):(this.resourceBase=null,this.resourceCollection=[],this.renderElements(e))},n.prototype.renderElements=function(e){if(e)return this.initializeView(this.currentView),void this.eventWindow.refresh();this.destroyHeaderModule(),this.showHeaderBar&&(this.headerModule=new tt(this)),this.renderTableContainer(),(t.Browser.isDevice||t.Browser.isTouch)&&(this.scheduleTouchModule=new nt(this)),this.initializeView(this.currentView),this.destroyPopups(),this.isPrinting||this.initializePopups()},n.prototype.validateDate=function(e){void 0===e&&(e=this.selectedDate);var t=e instanceof Date?new Date(e.getTime()):new Date(e),i=this.minDate instanceof Date?new Date(this.minDate.getTime()):new Date(this.minDate),n=this.maxDate instanceof Date?new Date(this.maxDate.getTime()):new Date(this.maxDate);if(!(i<=n))throw Error("minDate should be equal or less than maxDate");t<i&&(t=i),t>n&&(t=n),this.setProperties({selectedDate:new Date(""+t),minDate:new Date(""+i),maxDate:new Date(""+n)},!0),this.eventWindow&&this.eventWindow.updateMinMaxDateToEditor()},n.prototype.getViewIndex=function(e){for(var t=0;t<this.viewCollections.length;t++)if(this.viewCollections[t].option===e)return t;return-1},n.prototype.setViewOptions=function(e){void 0===e&&(e=!1),this.viewOptions={},this.viewCollections=[];var i,n,r=this.viewIndex,a=0;this.viewIndex=-1;for(var s=0,o=this.views;s<o.length;s++){var l=o[s],c="string"!=typeof l;"string"==typeof l?(i=l,this.currentView===i&&(n=i,this.viewIndex=a)):(i=l.option,l.isSelected&&(n=i,this.viewIndex=a));var p=t.extend({option:i},c?l:{}),h=i.charAt(0).toLowerCase()+i.slice(1);p.cellHeaderTemplateName=p.cellHeaderTemplate?p.option:"",p.dateHeaderTemplateName=p.dateHeaderTemplate?p.option:"",p.cellTemplateName=p.cellTemplate?p.option:"",p.dayHeaderTemplateName=p.dayHeaderTemplate?p.option:"",p.monthHeaderTemplateName=p.monthHeaderTemplate?p.option:"",p.resourceHeaderTemplateName=p.resourceHeaderTemplate?p.option:"",p.headerIndentTemplateName=p.headerIndentTemplate?p.option:"",p.eventTemplateName=p.eventTemplate?p.option:"",t.isNullOrUndefined(p.firstDayOfWeek)||0!==p.firstDayOfWeek||delete p.firstDayOfWeek,t.isNullOrUndefined(p.interval)||1!==p.interval||delete p.interval,this.viewCollections.push(p),t.isNullOrUndefined(this.viewOptions[h])?this.viewOptions[h]=[p]:this.viewOptions[h].push(p),a++}if(!e&&n&&this.setProperties({currentView:n},!0),-1===this.viewIndex){var d=this.getViewIndex(this.currentView);this.viewIndex="string"==typeof this.views[0]||t.isNullOrUndefined(r)||-1===r?-1===d?0:d:r}},n.prototype.getActiveViewOptions=function(){var e={enable:this.timeScale.enable,interval:this.timeScale.interval,slotCount:this.timeScale.slotCount,majorSlotTemplate:this.timeScale.majorSlotTemplate,minorSlotTemplate:this.timeScale.minorSlotTemplate},i={byDate:!(this.viewCollections[this.viewIndex].option.indexOf("Year")>-1)&&this.group.byDate,byGroupID:this.group.byGroupID,allowGroupEdit:this.group.allowGroupEdit,resources:this.group.resources,headerTooltipTemplate:this.group.headerTooltipTemplate,enableCompactView:this.group.enableCompactView},n=this.viewCollections[this.viewIndex].workDays?[]:this.workDays,r={dateFormat:this.dateFormat,endHour:this.endHour,isSelected:!1,option:null,readonly:this.readonly,startHour:this.startHour,allowVirtualScrolling:!1,cellHeaderTemplate:this.cellHeaderTemplate,dayHeaderTemplate:this.dayHeaderTemplate,monthHeaderTemplate:this.monthHeaderTemplate,cellTemplate:this.cellTemplate,eventTemplate:this.eventSettings.template,dateHeaderTemplate:this.dateHeaderTemplate,resourceHeaderTemplate:this.resourceHeaderTemplate,headerIndentTemplate:this.headerIndentTemplate,firstMonthOfYear:this.firstMonthOfYear,firstDayOfWeek:this.firstDayOfWeek,workDays:n,monthsCount:this.monthsCount,showWeekend:this.showWeekend,showWeekNumber:this.showWeekNumber,displayName:null,interval:1,timeScale:e,timeFormat:this.internalTimeFormat,group:i,headerRows:this.headerRows,orientation:"Horizontal",numberOfWeeks:0,displayDate:null},a=this.viewCollections[this.viewIndex],s=t.extend(r,a,void 0,!0);return 0!==this.firstDayOfWeek&&a.firstDayOfWeek&&this.firstDayOfWeek!==a.firstDayOfWeek&&(s.firstDayOfWeek=this.firstDayOfWeek),s.displayDate&&(s.displayDate=s.displayDate instanceof Date?new Date(s.displayDate.getTime()):new Date(s.displayDate)),s},n.prototype.initializeDataModule=function(){this.eventFields={id:this.eventSettings.fields.id,isBlock:this.eventSettings.fields.isBlock,subject:this.eventSettings.fields.subject.name,startTime:this.eventSettings.fields.startTime.name,endTime:this.eventSettings.fields.endTime.name,startTimezone:this.eventSettings.fields.startTimezone.name,endTimezone:this.eventSettings.fields.endTimezone.name,location:this.eventSettings.fields.location.name,description:this.eventSettings.fields.description.name,isAllDay:this.eventSettings.fields.isAllDay.name,recurrenceID:this.eventSettings.fields.recurrenceID.name,recurrenceRule:this.eventSettings.fields.recurrenceRule.name,recurrenceException:this.eventSettings.fields.recurrenceException.name,isReadonly:this.eventSettings.fields.isReadonly,followingID:this.eventSettings.fields.followingID},this.setEditorTitles(),this.dataModule=new at(this.eventSettings.dataSource,this.eventSettings.query),this.crudModule=new fi(this)},n.prototype.setEditorTitles=function(){this.editorTitles={subject:this.eventSettings.fields.subject.title||this.localeObj.getConstant("title"),startTime:this.eventSettings.fields.startTime.title||this.localeObj.getConstant("start"),endTime:this.eventSettings.fields.endTime.title||this.localeObj.getConstant("end"),isAllDay:this.eventSettings.fields.isAllDay.title||this.localeObj.getConstant("allDay"),startTimezone:this.eventSettings.fields.startTimezone.title||this.localeObj.getConstant("startTimezone"),endTimezone:this.eventSettings.fields.endTimezone.title||this.localeObj.getConstant("endTimezone"),location:this.eventSettings.fields.location.title||this.localeObj.getConstant("location"),description:this.eventSettings.fields.description.title||this.localeObj.getConstant("description"),recurrenceRule:this.eventSettings.fields.recurrenceRule.title||this.localeObj.getConstant("repeat")}},n.prototype.initializeView=function(e){this.showSpinner(),this.activeViewOptions=this.getActiveViewOptions(),this.resourceBase&&this.resourceBase.setResourceCollection(),this.initializeTemplates(),this.renderModule.render(e)},n.prototype.initializeTemplates=function(){this.cellHeaderTemplateFn=this.templateParser(this.activeViewOptions.cellHeaderTemplate),this.dayHeaderTemplateFn=this.templateParser(this.activeViewOptions.dayHeaderTemplate),this.monthHeaderTemplateFn=this.templateParser(this.activeViewOptions.monthHeaderTemplate),this.cellTemplateFn=this.templateParser(this.activeViewOptions.cellTemplate),this.dateHeaderTemplateFn=this.templateParser(this.activeViewOptions.dateHeaderTemplate),this.majorSlotTemplateFn=this.templateParser(this.activeViewOptions.timeScale.majorSlotTemplate),this.minorSlotTemplateFn=this.templateParser(this.activeViewOptions.timeScale.minorSlotTemplate),this.appointmentTemplateFn=this.templateParser(this.activeViewOptions.eventTemplate),this.resourceHeaderTemplateFn=this.templateParser(this.activeViewOptions.resourceHeaderTemplate),this.headerIndentTemplateFn=this.templateParser(this.activeViewOptions.headerIndentTemplate),this.headerTooltipTemplateFn=this.templateParser(this.activeViewOptions.group.headerTooltipTemplate),this.eventTooltipTemplateFn=this.templateParser(this.eventSettings.tooltipTemplate),this.editorTemplateFn=this.templateParser(this.editorTemplate),this.quickInfoTemplatesHeaderFn=this.templateParser(this.quickInfoTemplates.header),this.quickInfoTemplatesContentFn=this.templateParser(this.quickInfoTemplates.content),this.quickInfoTemplatesFooterFn=this.templateParser(this.quickInfoTemplates.footer)},n.prototype.initializePopups=function(){this.eventWindow=new ii(this),this.quickPopup=new jt(this)},n.prototype.getDayNames=function(e){var i,n=[],r="";"en"===this.locale||"en-US"===this.locale?(r="days.stand-alone.",i=t.getValue(r+e,t.getDefaultDateObject(this.getCalendarMode()))):(r="main."+this.locale+".dates.calendars."+this.getCalendarMode()+".days.format."+e,i=t.getValue(r,t.cldrData));for(var a=0,s=Object.keys(i);a<s.length;a++){var o=s[a];n.push(t.getValue(o,i))}return n},n.prototype.setCldrTimeFormat=function(){if(!t.isNullOrUndefined(this.timeFormat))return void(this.internalTimeFormat=this.timeFormat);"en"===this.locale||"en-US"===this.locale?this.internalTimeFormat=t.getValue("timeFormats.short",t.getDefaultDateObject(this.getCalendarMode())):this.internalTimeFormat=t.getValue("main."+this.locale+".dates.calendars."+this.getCalendarMode()+".timeFormats.short",t.cldrData)},n.prototype.getCalendarMode=function(){return this.calendarMode.toLowerCase()},n.prototype.getTimeString=function(e){return this.globalize.formatDate(e,{format:this.activeViewOptions.timeFormat,type:"time",calendar:this.getCalendarMode()}).toLocaleUpperCase()},n.prototype.getDateTime=function(e){return e instanceof Date?new Date(e.getTime()):new Date(e)},n.prototype.setCalendarMode=function(){"Islamic"===this.calendarMode?this.calendarUtil=new ot:this.calendarUtil=new st},n.prototype.changeView=function(e,i,n,r){var a=this;if(t.isNullOrUndefined(r)&&(r=this.getViewIndex(e)),!(!n&&r===this.viewIndex&&this.currentView===e||r<0)){this.viewIndex=r;var s={requestType:"viewNavigate",cancel:!1,event:i};this.trigger(qe,s,function(t){if(!t.cancel){var n={action:"view",cancel:!1,currentDate:a.selectedDate,previousView:a.currentView,currentView:e,viewIndex:a.viewIndex};a.trigger("navigating",n,function(t){t.cancel||(a.viewIndex=t.viewIndex,a.setProperties({currentView:e},!0),a.headerModule&&(a.headerModule.updateActiveView(),a.headerModule.setCalendarDate(a.selectedDate),a.headerModule.setCalendarView()),a.initializeView(a.currentView),a.animateLayout(),s={requestType:"viewNavigate",cancel:!1,event:i},a.trigger("actionComplete",s))})}})}},n.prototype.changeDate=function(e,t){var i=this,n={requestType:"dateNavigate",cancel:!1,event:t};this.trigger(qe,n,function(r){if(!r.cancel){var a={action:"date",cancel:!1,previousDate:i.selectedDate,currentDate:e};i.trigger("navigating",a,function(e){e.cancel||(i.uiStateValues.isInitial=!!i.activeView.isTimelineView()||i.uiStateValues.isInitial,i.validateDate(e.currentDate),i.headerModule&&i.headerModule.setCalendarDate(e.currentDate),i.initializeView(i.currentView),i.animateLayout(),n={requestType:"dateNavigate",cancel:!1,event:t},i.trigger("actionComplete",n))})}})},n.prototype.isMinMaxDate=function(e){return void 0===e&&(e=this.selectedDate),e.getTime()>=this.minDate.getTime()&&e.getTime()<=this.maxDate.getTime()},n.prototype.isSelectedDate=function(e){return e.setHours(0,0,0,0)===new Date(""+this.selectedDate).setHours(0,0,0,0)},n.prototype.getCurrentTime=function(e){return void 0===e&&(e=new Date),this.timezone?this.tzModule.convert(e,this.tzModule.getLocalTimezoneName(),this.timezone):e},n.prototype.getNavigateView=function(){return this.activeView.isTimelineView()?"TimelineMonth"===this.currentView||"TimelineYear"===this.currentView?"TimelineDay":"Agenda":"Day"},n.prototype.animateLayout=function(){this.activeView.element&&new t.Animation({duration:600,name:"FadeIn",timingFunction:"easeIn"}).animate(this.activeView.element)},n.prototype.requiredModules=function(){var e=[];this.setViewOptions(!0);for(var t=0,i=Object.keys(this.viewOptions);t<i.length;t++){var n=i[t];n="timelineDay"===n||"timelineWeek"===n||"timelineWorkWeek"===n?"timelineViews":n,e.push({member:n,args:[this]})}return this.allowDragAndDrop&&e.push({member:"dragAndDrop",args:[this]}),this.allowResizing&&e.push({member:"resize",args:[this]}),e.push({member:"excelExport",args:[this]}),e.push({member:"iCalendarExport",args:[this]}),e.push({member:"iCalendarImport",args:[this]}),e.push({member:"print",args:[this]}),e},n.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice||q(),this.globalize=new t.Internationalization(this.locale),this.tzModule=new lt,(this&&t.isNullOrUndefined(this.uiStateValues)||!this.enablePersistence)&&(this.uiStateValues={expand:!1,isInitial:!0,left:0,top:0,isGroupAdaptive:!1,isIgnoreOccurrence:!1,groupIndex:0,action:!1,isBlock:!1,isCustomMonth:!0,isResize:!1}),this.activeCellsData={startTime:this.getCurrentTime(),endTime:this.getCurrentTime(),isAllDay:!1},this.activeEventData={event:void 0,element:void 0},this.getDefaultLocale(),this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.setCldrTimeFormat(),this.setCalendarMode(),this.eventsData=[],this.eventsProcessed=[],this.blockData=[],this.blockProcessed=[],this.resourceCollection=[],this.currentAction=null,this.selectedElements=[],this.setViewOptions()},n.prototype.getDefaultLocale=function(){this.defaultLocale={day:"Day",week:"Week",workWeek:"Work Week",month:"Month",year:"Year",agenda:"Agenda",weekAgenda:"Week Agenda",workWeekAgenda:"Work Week Agenda",monthAgenda:"Month Agenda",today:"Today",noEvents:"No events",emptyContainer:"There are no events scheduled on this day.",allDay:"All day",start:"Start",end:"End",more:"more",close:"Close",cancel:"Cancel",noTitle:"(No Title)",delete:"Delete",deleteEvent:"Delete Event",deleteMultipleEvent:"Delete Multiple Events",selectedItems:"Items selected",deleteSeries:"Entire Series",edit:"Edit",editSeries:"Entire Series",editEvent:"Edit Event",createEvent:"Create",subject:"Subject",addTitle:"Add title",moreDetails:"More Details",save:"Save",editContent:"How would you like to change the appointment in the series?",deleteContent:"Are you sure you want to delete this event?",deleteMultipleContent:"Are you sure you want to delete the selected events?",newEvent:"New Event",title:"Title",location:"Location",description:"Description",timezone:"Timezone",startTimezone:"Start Timezone",endTimezone:"End Timezone",repeat:"Repeat",saveButton:"Save",cancelButton:"Cancel",deleteButton:"Delete",recurrence:"Recurrence",wrongPattern:"The recurrence pattern is not valid.",seriesChangeAlert:"Do you want to cancel the changes made to specific instances of this series and match it to the whole series again?",createError:"The duration of the event must be shorter than how frequently it occurs. Shorten the duration, or change the recurrence pattern in the recurrence event editor.",sameDayAlert:"Two occurrences of the same event cannot occur on the same day.",occurenceAlert:"Cannot reschedule an occurrence of the recurring appointment if it skips over a later occurrence of the same appointment.",editRecurrence:"Edit Recurrence",repeats:"Repeats",alert:"Alert",startEndError:"The selected end date occurs before the start date.",invalidDateError:"The entered date value is invalid.",blockAlert:"Events cannot be scheduled within the blocked time range.",ok:"Ok",yes:"Yes",no:"No",occurrence:"Occurrence",series:"Series",previous:"Previous",next:"Next",timelineDay:"Timeline Day",timelineWeek:"Timeline Week",timelineWorkWeek:"Timeline Work Week",timelineMonth:"Timeline Month",timelineYear:"Timeline Year",editFollowingEvent:"Following Events",deleteTitle:"Delete Event",editTitle:"Edit Event",beginFrom:"Begin From",endAt:"Ends At",expandAllDaySection:"Expand-all-day-section",collapseAllDaySection:"Collapse-all-day-section",searchTimezone:"Search Timezone",noRecords:"No records found"}},n.prototype.wireEvents=function(){t.EventHandler.add(window,"resize",this.onScheduleResize,this),t.EventHandler.add(window,"orientationchange",this.onScheduleResize,this),t.EventHandler.add(document,t.Browser.touchStartEvent,this.onDocumentClick,this)},n.prototype.removeSelectedClass=function(){for(var e=this.getSelectedElements(),i=0,n=e;i<n.length;i++){var r=n[i];r.setAttribute("aria-selected","false"),r.removeAttribute("tabindex")}t.removeClass(e,"e-selected-cell")},n.prototype.addSelectedClass=function(e,i,n){for(var r=0,a=e;r<a.length;r++)a[r].setAttribute("aria-selected","true");t.addClass(e,"e-selected-cell"),i&&(i.setAttribute("tabindex","0"),i.focus({preventScroll:n||!1}))},n.prototype.selectCell=function(e){this.removeSelectedClass(),this.addSelectedClass([e],e)},n.prototype.getAllDayRow=function(){return this.element.querySelector(".e-all-day-row")},n.prototype.getContentTable=function(){return this.activeView.element.querySelector("."+Qe+" tbody")},n.prototype.getTableRows=function(){return[].slice.call(this.element.querySelectorAll("."+Qe+" tbody tr:not(.e-hidden)"))},n.prototype.getWorkCellElements=function(){return[].slice.call(this.element.querySelectorAll(".e-work-cells"))},n.prototype.getIndexOfDate=function(e,t){return e.map(Number).indexOf(+t)},n.prototype.isAllDayCell=function(e){return!(!(["Month","TimelineMonth","TimelineYear","MonthAgenda"].indexOf(this.currentView)>-1||e.classList.contains("e-all-day-cells")||e.classList.contains("e-header-cells"))&&this.activeViewOptions.timeScale.enable)||!!(this.activeView.isTimelineView()&&this.activeViewOptions.headerRows.length>0&&"Hour"!==this.activeViewOptions.headerRows.slice(-1)[0].option)},n.prototype.getDateFromElement=function(e){var i;if(t.isNullOrUndefined(e)||(i=e.getAttribute("data-date")),!t.isNullOrUndefined(i)){var n=parseInt(i,10);return new Date(n)}},n.prototype.getTargetElement=function(e,t,i){var n,r=document.elementFromPoint(t,i);return r&&(n=r.closest(e)),n?[n]:null},n.prototype.getCellHeaderTemplate=function(){return this.cellHeaderTemplateFn},n.prototype.getDayHeaderTemplate=function(){return this.dayHeaderTemplateFn},n.prototype.getMonthHeaderTemplate=function(){return this.monthHeaderTemplateFn},n.prototype.getCellTemplate=function(){return this.cellTemplateFn},n.prototype.getDateHeaderTemplate=function(){return this.dateHeaderTemplateFn},n.prototype.getMajorSlotTemplate=function(){return this.majorSlotTemplateFn},n.prototype.getMinorSlotTemplate=function(){return this.minorSlotTemplateFn},n.prototype.getAppointmentTemplate=function(){return this.appointmentTemplateFn},n.prototype.getEventTooltipTemplate=function(){return this.eventTooltipTemplateFn},n.prototype.getHeaderTooltipTemplate=function(){return this.headerTooltipTemplateFn},n.prototype.getEditorTemplate=function(){return this.editorTemplateFn},n.prototype.getQuickInfoTemplatesHeader=function(){return this.quickInfoTemplatesHeaderFn},n.prototype.getQuickInfoTemplatesContent=function(){return this.quickInfoTemplatesContentFn},n.prototype.getQuickInfoTemplatesFooter=function(){return this.quickInfoTemplatesFooterFn},n.prototype.getResourceHeaderTemplate=function(){return this.resourceHeaderTemplateFn},n.prototype.getHeaderIndentTemplate=function(){return this.headerIndentTemplateFn},n.prototype.getCssProperties=function(){return{border:this.enableRtl?"borderLeftWidth":"borderRightWidth",padding:this.enableRtl?"paddingLeft":"paddingRight",rtlBorder:this.enableRtl?"borderRightWidth":"borderLeftWidth",rtlPadding:this.enableRtl?"paddingRight":"paddingLeft"}},n.prototype.removeNewEventElement=function(){var e=this.element.querySelector(".e-new-event");t.isNullOrUndefined(e)||t.remove(e)},n.prototype.getStartEndTime=function(e){if(!t.isNullOrUndefined(e)&&""!==e){var i=w(this.getCurrentTime()),n=e.split(":");return 2===n.length&&i.setHours(parseInt(n[0],10),parseInt(n[1],10),0),i}return null},n.prototype.onDocumentClick=function(e){this.notify("document-click",{event:e})},n.prototype.onScheduleResize=function(){t.isNullOrUndefined(this.activeView)||(this.isAdaptive||j())&&document.activeElement&&document.activeElement.classList.contains("e-subject")||(this.activeViewOptions.timeScale.enable&&this.activeView&&this.activeView.highlightCurrentTime(),this.quickPopup&&this.quickPopup.onClosePopup(),"Month"===this.currentView||"Agenda"!==this.currentView&&"MonthAgenda"!==this.currentView&&!this.activeViewOptions.timeScale.enable||this.activeView.isTimelineView()?(this.uiStateValues.isResize=!0,this.activeView.resetColWidth(),this.notify(Be,{cssProperties:this.getCssProperties(),isPreventScrollUpdate:!0}),this.refreshEvents(!1),this.uiStateValues.isResize=!1):this.notify(Ue,{}))},n.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return t.compile(document.querySelector(e).innerHTML.trim())}catch(i){return t.compile(e)}},n.prototype.getAnnouncementString=function(e,t){var i;if(this.quickPopup&&this.activeViewOptions.group.resources.length>0){i=this.quickPopup.getResourceText({event:e},"event")+'"s event - '}var n=t||e[this.eventFields.subject]||this.eventSettings.fields.subject.default,r=this.globalize.formatDate(e[this.eventFields.startTime],{type:"dateTime",skeleton:"full",calendar:this.getCalendarMode()}),a=this.globalize.formatDate(e[this.eventFields.endTime],{type:"dateTime",skeleton:"full",calendar:this.getCalendarMode()}),s=n+" "+this.localeObj.getConstant("beginFrom")+" "+r+" "+this.localeObj.getConstant("endAt")+" "+a;return i&&(s=i+" "+s),s},n.prototype.boundaryValidation=function(e,t){var i={left:!1,right:!1,top:!1,bottom:!1},n=this.element.querySelector(".e-content-wrap").getBoundingClientRect();return e<n.top+30+window.pageYOffset&&e>n.top+window.pageYOffset&&(i.top=!0),e>n.bottom-30+window.pageYOffset&&e<n.bottom+window.pageYOffset&&(i.bottom=!0),t<n.left+30+window.pageXOffset&&t>n.left+window.pageXOffset&&(i.left=!0),t>n.right-30+window.pageXOffset&&t<n.right+window.pageXOffset&&(i.right=!0),i},n.prototype.getWeekNumberContent=function(e){var t;if("FirstDay"===this.weekRule){var i=v(e.slice(-1)[0],this.firstDayOfWeek);t=this.globalize.formatNumber(f(i))}else if("FirstFourDayWeek"===this.weekRule){var n=y(r=u(e.slice(-1)[0],this.firstDayOfWeek),v(e.slice(-1)[0],this.firstDayOfWeek));t=this.globalize.formatNumber(f(n))}else if("FirstFullWeek"===this.weekRule){var r=u(e.slice(-1)[0],this.firstDayOfWeek);t=this.globalize.formatNumber(f(r))}return t},n.prototype.renderHeaderIndentTemplate=function(e,i){if(this.activeViewOptions.headerIndentTemplate){var n=this.element.id+"_"+this.activeViewOptions.headerIndentTemplateName+"headerIndentTemplate",r=[].slice.call(this.getHeaderIndentTemplate()(e,this,"headerIndentTemplate",n,!1));t.append(r,i)}},n.prototype.unWireEvents=function(){t.EventHandler.remove(window,"resize",this.onScheduleResize),t.EventHandler.remove(window,"orientationchange",this.onScheduleResize),t.EventHandler.remove(document,t.Browser.touchStartEvent,this.onDocumentClick)},n.prototype.getModuleName=function(){return"schedule"},n.prototype.getPersistData=function(){return this.addOnPersist(["currentView","selectedDate","scrollTop","scrollLeft"])},n.prototype.onPropertyChanged=function(e,i){if(!this.isReact||!t.isNullOrUndefined(this.activeView)){for(var n={isRefresh:!1,isResource:!1,isDate:!1,isView:!1,isLayout:!1,isDataManager:!1},r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];switch(s){case"views":this.setViewOptions(),this.headerModule&&this.headerModule.updateItems(),n.isView=!0;break;case"currentView":n.isView=!0;break;case"minDate":case"maxDate":case"selectedDate":n.isDate=!0;break;case"dateFormat":this.activeViewOptions=this.getActiveViewOptions(),this.headerModule&&this.headerModule.updateDateRange(this.activeView.getDateRangeText());break;case"showHeaderBar":this.destroyHeaderModule(),e.showHeaderBar&&(this.headerModule=new tt(this),this.headerModule.updateDateRange(this.activeView.getDateRangeText())),this.notify(Be,{cssProperties:this.getCssProperties()}),this.activeView.isTimelineView()&&this.refreshEvents(!1);break;case"showWeekend":case"workDays":case"startHour":case"endHour":case"workHours":case"readonly":case"headerRows":case"showWeekNumber":case"rowAutoHeight":n.isLayout=!0;break;case"locale":case"calendarMode":this.globalize=new t.Internationalization(this.locale),this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.setCldrTimeFormat(),this.setCalendarMode(),n.isRefresh=!0;break;case"firstDayOfWeek":this.activeViewOptions.firstDayOfWeek=e.firstDayOfWeek,this.eventWindow&&this.eventWindow.refreshRecurrenceEditor(),n.isLayout=!0;break;case"showTimeIndicator":this.activeViewOptions.timeScale.enable&&this.activeView&&this.activeView.highlightCurrentTime();break;case"cellHeaderTemplate":this.activeViewOptions.cellHeaderTemplate=e.cellHeaderTemplate,this.cellHeaderTemplateFn=this.templateParser(this.activeViewOptions.cellHeaderTemplate),n.isLayout=!0;break;case"cellTemplate":this.activeViewOptions.cellTemplate=e.cellTemplate,this.cellTemplateFn=this.templateParser(this.activeViewOptions.cellTemplate),n.isLayout=!0;break;case"dateHeaderTemplate":this.activeViewOptions.dateHeaderTemplate=e.dateHeaderTemplate,this.dateHeaderTemplateFn=this.templateParser(this.activeViewOptions.dateHeaderTemplate),n.isLayout=!0;break;case"dayHeaderTemplate":this.activeViewOptions.dayHeaderTemplate=e.dayHeaderTemplate,this.dayHeaderTemplateFn=this.templateParser(this.activeViewOptions.dayHeaderTemplate),n.isLayout=!0;break;case"monthHeaderTemplate":this.activeViewOptions.monthHeaderTemplate=e.monthHeaderTemplate,this.monthHeaderTemplateFn=this.templateParser(this.activeViewOptions.monthHeaderTemplate),n.isLayout=!0;break;case"resourceHeaderTemplate":this.activeViewOptions.resourceHeaderTemplate=e.resourceHeaderTemplate,this.resourceHeaderTemplateFn=this.templateParser(this.activeViewOptions.resourceHeaderTemplate),n.isLayout=!0;break;case"timezone":this.eventBase.timezonePropertyChange(i.timezone),this.headerModule.setCalendarTimezone();break;case"enableRtl":this.setRtlClass(),n.isRefresh=!0;break;default:this.extendedPropertyChange(s,e,i,n)}}this.propertyChangeAction(n)}},n.prototype.propertyChangeAction=function(e){e.isRefresh?this.refresh():e.isResource?this.initializeResources(!0):e.isView?this.changeView(this.currentView,null,!0):e.isDate?this.changeDate(this.selectedDate):e.isLayout?this.initializeView(this.currentView):e.isDataManager&&this.crudModule&&(this.dragAndDropModule&&(this.dragAndDropModule.actionObj.action="",t.removeClass([this.element],"e-event-action")),this.crudModule.refreshDataManager())},n.prototype.allDayRowScrollUpdate=function(){var e=this.element.querySelector(".e-date-header-wrap"),i=this.element.querySelector(".e-all-day-row");if("auto"!==this.height&&this.enableAllDayScroll)e.classList.contains("e-all-day-auto")&&t.removeClass([e],"e-all-day-auto"),this.eventBase.allDayExpandScroll(e);else if(t.addClass([e],"e-all-day-auto"),e.classList.contains("e-all-day-scroll")&&t.removeClass([e],"e-all-day-scroll"),this.uiStateValues.expand){var n=[].slice.call(this.element.querySelectorAll(".e-all-day-cells"));n[0].style.height=i.style.height?i.style.height:n[1].style.height}this.uiStateValues.expand||(i.style.height="")},n.prototype.extendedPropertyChange=function(e,i,n,r){switch(e){case"width":case"height":case"enableAllDayScroll":["Day","Week","WorkWeek"].indexOf(this.currentView)>-1&&this.allDayRowScrollUpdate(),this.notify("ui-update",{module:"scroll",properties:{width:i.width,height:i.height}});break;case"cssClass":n.cssClass&&t.removeClass([this.element],n.cssClass.split(" ")),i.cssClass&&t.addClass([this.element],i.cssClass.split(" "));break;case"hideEmptyAgendaDays":case"agendaDaysCount":this.activeViewOptions=this.getActiveViewOptions(),r.isView=!0;break;case"eventSettings":this.onEventSettingsPropertyChanged(i.eventSettings,n.eventSettings,r);break;case"allowKeyboardInteraction":this.keyboardInteractionModule&&(this.keyboardInteractionModule.destroy(),this.keyboardInteractionModule=null),i.allowKeyboardInteraction&&(this.keyboardInteractionModule=new rt(this));break;case"timezoneDataSource":this.eventWindow&&this.eventWindow.refresh();break;case"editorTemplate":t.isNullOrUndefined(this.editorTemplate)||(this.editorTemplateFn=this.templateParser(this.editorTemplate)),this.eventWindow&&this.eventWindow.setDialogContent();break;case"quickInfoTemplates":this.quickInfoTemplates.header&&(this.quickInfoTemplatesHeaderFn=this.templateParser(this.quickInfoTemplates.header)),this.quickInfoTemplates.content&&(this.quickInfoTemplatesContentFn=this.templateParser(this.quickInfoTemplates.content)),this.quickInfoTemplates.footer&&(this.quickInfoTemplatesFooterFn=this.templateParser(this.quickInfoTemplates.footer));break;case"group":this.onGroupSettingsPropertyChanged(i.group,n.group,r);break;case"resources":r.isResource=!0;break;case"timeScale":this.activeViewOptions.timeScale.interval=i.timeScale.interval||this.activeViewOptions.timeScale.interval,this.activeViewOptions.timeScale.slotCount=i.timeScale.slotCount||this.activeViewOptions.timeScale.slotCount,this.eventWindow&&this.eventWindow.refreshDateTimePicker(),r.isLayout=!0;break;case"allowDragAndDrop":case"allowResizing":case"eventDragArea":this.refreshEvents(!1);break;case"weekRule":r.isLayout=!0;break;case"firstMonthOfYear":this.activeViewOptions.firstMonthOfYear=i.firstMonthOfYear,this.viewIndex=this.activeView.viewIndex,r.isLayout=!0;break;case"monthsCount":this.activeViewOptions.monthsCount=i.monthsCount,this.viewIndex=this.activeView.viewIndex,r.isLayout=!0;break;case"timeFormat":this.internalTimeFormat=i.timeFormat||this.activeViewOptions.timeFormat,this.eventWindow&&this.eventWindow.refreshDateTimePicker(),r.isLayout=!0;break;case"enableAdaptiveUI":this.showHeaderBar&&this.headerModule&&(this.destroyHeaderModule(),this.headerModule=new tt(this),this.headerModule.updateDateRange(this.activeView.getDateRangeText())),r.isLayout=!0;break;case"headerIndentTemplate":this.activeViewOptions.headerIndentTemplate=i.headerIndentTemplate,this.headerIndentTemplateFn=this.templateParser(this.activeViewOptions.headerIndentTemplate),r.isLayout=!0}},n.prototype.setRtlClass=function(){this.enableRtl?t.addClass([this.element],"e-rtl"):t.removeClass([this.element],"e-rtl")},n.prototype.onGroupSettingsPropertyChanged=function(e,t,i){for(var n=0,r=Object.keys(e);n<r.length;n++){var a=r[n];"headerTooltipTemplate"===a?this.headerTooltipTemplateFn=this.templateParser(e[a]):(i.isLayout=!0,this.eventWindow&&this.eventWindow.refresh())}},n.prototype.onEventSettingsPropertyChanged=function(e,t,i){for(var n=0,r=Object.keys(e);n<r.length;n++)switch(r[n]){case"dataSource":case"query":case"fields":this.initializeDataModule(),i.isDataManager=!0;break;case"template":this.activeViewOptions.eventTemplate=e.template,this.appointmentTemplateFn=this.templateParser(this.activeViewOptions.eventTemplate),i.isDataManager=!0;break;case"enableTooltip":this.eventTooltip&&(this.eventTooltip.destroy(),this.eventTooltip=null),e.enableTooltip&&(this.eventTooltip=new qt(this));break;case"tooltipTemplate":this.eventTooltipTemplateFn=this.templateParser(this.eventSettings.tooltipTemplate);break;case"resourceColorField":this.resourceBase&&this.resourceBase.setResourceCollection(),i.isDataManager=!0;break;case"editFollowingEvents":this.quickPopup&&this.quickPopup.refreshQuickDialog();break;case"allowAdding":case"allowEditing":case"allowDeleting":this.showHeaderBar&&this.headerModule&&this.headerModule.updateAddIcon(),this.eventWindow&&this.eventWindow.refresh();break;case"spannedEventPlacement":case"minimumEventDuration":case"enableMaxHeight":case"enableIndicator":this.refreshEvents(!1);break;case"ignoreWhitespace":i.isLayout=!0}},n.prototype.destroyHeaderModule=function(){this.headerModule&&(this.headerModule.destroy(),this.headerModule=null)},n.prototype.destroyPopups=function(){this.quickPopup&&(this.quickPopup.destroy(),this.quickPopup=null),this.eventWindow&&(this.eventWindow.destroy(),this.eventWindow=null)},n.prototype.showSpinner=function(){i.showSpinner(this.element)},n.prototype.hideSpinner=function(){i.hideSpinner(this.element)},n.prototype.setWorkHours=function(e,i,n,r){var a=[];a=this.getWorkHourCells(e,i,n,r),t.addClass(a,"e-work-hours")},n.prototype.resetWorkHours=function(e,i,n,r){if(void 0===e&&(e=this.activeView.renderDates),e&&i&&n){var a=this.getWorkHourCells(e,i,n,r);t.removeClass(a,"e-work-hours")}else{var s=[].slice.call(this.element.querySelectorAll(".e-work-hours"));t.removeClass(s,"e-work-hours")}},n.prototype.getWorkHourCells=function(e,i,n,r){if(["Agenda","MonthAgenda","Month","TimelineMonth"].indexOf(this.currentView)>-1)return[];var a=this.getStartEndTime(i),s=this.getStartEndTime(n),o=this.getContentTable();if(t.isNullOrUndefined(a)||t.isNullOrUndefined(s)||!o)return[];a.setMilliseconds(0),s.setMilliseconds(0);var l=this.activeView.getStartHour();a<l&&(a=l);var c=this.activeView.getEndHour();s>c&&(s=c);for(var p=this.activeViewOptions.timeScale.interval*ze/this.activeViewOptions.timeScale.slotCount,h=Math.round((a.getTime()-l.getTime())/p),d=Math.ceil((s.getTime()-l.getTime())/p),u=h,v=d,m=[],g=0,f=e;g<f.length;g++){var y=f[g];w(y=this.getDateTime(y));var T=this.activeView.renderDates;t.isNullOrUndefined(r)||!this.resourceBase||this.activeView.isTimelineView()||(T=this.resourceBase.lastResourceLevel[r].renderDates);var D=this.getIndexOfDate(T,y);if(D>=0){if(this.activeView.isTimelineView()){var b=Math.round((c.getTime()-l.getTime())/p);h=u+D*b,d=v+D*b}for(var C=h;C<d;C++)if(this.activeView.isTimelineView()){var O=t.isNullOrUndefined(r)?0:r;m.push(o.rows[O].cells[C])}else if(t.isNullOrUndefined(r))m.push(o.rows[C].cells[D]);else{var E='.e-work-cells[data-group-index="'+r+'"]',S=[].slice.call(o.rows[C].querySelectorAll(E));m.push(S[D])}}}return m},n.prototype.getCellDetails=function(e){var i=e instanceof Array?e:[e],n=t.getElement(i[0]),r=t.getElement(i.slice(-1)[0]),a=this.getDateFromElement(n),s=this.getDateFromElement(r);if(!t.isNullOrUndefined(a)&&!t.isNullOrUndefined(s)){var o=this.activeView.isTimelineView()&&!t.isNullOrUndefined(r.getAttribute("colSpan"))&&this.headerRows.length>0,l=o?parseInt(r.getAttribute("colSpan"),10):1,c={startTime:a,endTime:s=!this.activeViewOptions.timeScale.enable||o||r.classList.contains("e-all-day-cells")||r.classList.contains("e-header-cells")?C(new Date(s.getTime()),l):this.activeView.getEndDateFromStartDate(s),isAllDay:this.isAllDayCell(n),element:e},p=n.getAttribute("data-group-index");return t.isNullOrUndefined(p)||(c.groupIndex=parseInt(p,10)),c}},n.prototype.getSelectedElements=function(){return[].slice.call(this.element.querySelectorAll(".e-selected-cell"))},n.prototype.getResourceCollections=function(){return this.resourceCollection},n.prototype.setResourceCollections=function(e){this.setProperties({resources:e},!1)},n.prototype.changeCurrentView=function(e,t){var i=this.getViewIndex(e),n=e.charAt(0).toLowerCase()+e.slice(1),r=this.viewOptions[n];r&&(i=this.viewCollections.indexOf(r[t||0])),-1!==i&&i!==this.viewIndex&&this.changeView(e,null,null,i)},n.prototype.getCurrentViewIndex=function(){return this.viewIndex},n.prototype.getResourcesByIndex=function(e){if(this.resourceBase&&this.resourceBase.lastResourceLevel){if(e<0||e>=this.resourceBase.lastResourceLevel.length)return;var t=this.resourceBase.lastResourceLevel[e],i={};return this.resourceBase.setResourceValues(i,e),{resource:t.resource,resourceData:t.resourceData,groupData:i}}},n.prototype.expandResource=function(e,t){this.activeView.isTimelineView()&&this.resourceBase&&this.resourceCollection.length>1&&this.resourceBase.resourceExpand(e,t,!1)},n.prototype.collapseResource=function(e,t){this.activeView.isTimelineView()&&this.resourceBase&&this.resourceCollection.length>1&&this.resourceBase.resourceExpand(e,t,!0)},n.prototype.scrollTo=function(e,i){this.activeView.scrollToDate&&t.isNullOrUndefined(e)&&i?this.activeView.scrollToDate(i):this.activeView.scrollToHour&&this.activeView.scrollToHour(e,i)},n.prototype.scrollToResource=function(e,t){this.resourceBase&&this.resourceBase.lastResourceLevel&&this.resourceBase.resourceScroll(e,t)},n.prototype.exportToICalendar=function(e,t){if(!this.iCalendarExportModule)throw Error("Inject ICalendarExport module");this.iCalendarExportModule.initializeCalendarExport(e,t)},n.prototype.importICalendar=function(e){if(!this.iCalendarImportModule)throw Error("Inject ICalendarImport module");this.iCalendarImportModule.initializeCalendarImport(e)},n.prototype.addEvent=function(e){this.crudModule.addEvent(e)},n.prototype.exportToExcel=function(e){if(!this.excelExportModule)throw Error("Inject ExcelExport module");this.excelExportModule.initializeExcelExport(e)},n.prototype.print=function(e){if(!this.printModule)throw Error("Inject Print module");this.printModule.print(e)},n.prototype.saveEvent=function(e,t){this.crudModule.saveEvent(e,t)},n.prototype.deleteEvent=function(e,t){this.crudModule.deleteEvent(e,t)},n.prototype.getEvents=function(e,t,i){var n=[];return n=i?this.eventBase.getProcessedEvents():this.eventsData,e&&(e=this.getDateTime(e)),t&&(t=this.getDateTime(t)),n=this.eventBase.filterEventsByRange(n,e,t)},n.prototype.getBlockEvents=function(e,t,i){var n=[];return n=i?this.eventBase.getProcessedEvents(this.blockData):this.blockData,e&&(e=this.getDateTime(e)),t&&(t=this.getDateTime(t)),n=this.eventBase.filterEventsByRange(n,e,t)},n.prototype.getOccurrencesByID=function(e){return this.eventBase.getOccurrencesByID(e)},n.prototype.getOccurrencesByRange=function(e,t){return e=this.getDateTime(e),t=this.getDateTime(t),this.eventBase.getOccurrencesByRange(e,t)},n.prototype.getCurrentViewDates=function(){return this.activeView?this.activeView.renderDates:[]},n.prototype.setRecurrenceEditor=function(e){this.eventWindow.setRecurrenceEditor(e)},n.prototype.getEventMaxID=function(){return this.eventBase.getEventMaxID()},n.prototype.getDeletedOccurrences=function(e){return this.eventBase.getDeletedOccurrences(e)},n.prototype.getCurrentViewEvents=function(){return this.eventsProcessed},n.prototype.refreshEvents=function(e){if(void 0===e&&(e=!0),this.dragAndDropModule&&(this.dragAndDropModule.actionObj.action="",t.removeClass([this.element],"e-event-action")),e)this.crudModule.refreshDataManager();else{if(this.activeViewOptions&&this.activeViewOptions.eventTemplate){var i=["eventTemplate"];if(this.crudModule&&this.crudModule.crudObj.isCrudAction&&-1===["Agenda","MonthAgenda","Year","TimelineYear"].indexOf(this.currentView)){i=[];for(var n=0,r=this.crudModule.crudObj.sourceEvent.length;n<r;n++)i.push("eventTemplate_"+this.crudModule.crudObj.sourceEvent[n].groupIndex),this.crudModule.crudObj.targetEvent[n]&&this.crudModule.crudObj.sourceEvent[n].groupIndex!==this.crudModule.crudObj.targetEvent[n].groupIndex&&i.push("eventTemplate_"+this.crudModule.crudObj.targetEvent[n].groupIndex)}this.resetTemplates(i)}var a=this.eventsData||[],s=this.blockData||[],o=a.concat(s);this.notify(Fe,{processedData:this.eventBase?this.eventBase.processData(o):[]})}},n.prototype.refreshTemplates=function(e){switch(e?this.resetTemplates([e]):this.resetTemplates(),e){case"eventTemplate":this.appointmentTemplateFn=this.templateParser(this.activeViewOptions.eventTemplate),this.refreshEvents(!1);break;case"dateHeaderTemplate":this.dateHeaderTemplateFn=this.templateParser(this.activeViewOptions.dateHeaderTemplate),this.activeView.refreshHeader();break;case"resourceHeaderTemplate":this.resourceHeaderTemplateFn=this.templateParser(this.activeViewOptions.resourceHeaderTemplate),this.activeView.isTimelineView()?this.activeView.refreshResourceHeader():this.activeView.refreshHeader();break;case"quickInfoTemplates":this.quickPopup&&(this.quickPopup.destroy(),this.quickPopup=null),this.quickPopup=new jt(this),this.quickInfoTemplatesHeaderFn=this.templateParser(this.quickInfoTemplates.header),this.quickInfoTemplatesContentFn=this.templateParser(this.quickInfoTemplates.content),this.quickInfoTemplatesFooterFn=this.templateParser(this.quickInfoTemplates.footer);break;case"editorTemplate":this.eventWindow&&(this.eventWindow.destroy(),this.eventWindow=null),this.eventWindow=new ii(this),this.editorTemplateFn=this.templateParser(this.editorTemplate);break;case"tooltipTemplate":case"headerTooltipTemplate":this.eventTooltip&&(this.eventTooltip.destroy(),this.eventTooltip=null),this.eventTooltip=new qt(this),this.eventTooltipTemplateFn=this.templateParser(this.eventSettings.tooltipTemplate),this.headerTooltipTemplateFn=this.templateParser(this.activeViewOptions.group.headerTooltipTemplate);break;default:this.initializeView(this.currentView)}},n.prototype.refreshLayout=function(){this.onScheduleResize(),this.headerModule&&this.headerModule.refresh(),this.eventWindow&&this.eventWindow.refresh()},n.prototype.getEventDetails=function(e){var i=(e=t.getElement(e)).getAttribute("data-guid");return i?this.eventBase.getEventByGuid(i):{}},n.prototype.isSlotAvailable=function(e,i,n){var r,a,s=this,o=this.activeEventData.event;if(e instanceof Date||"string"==typeof e?(r=e,a=i):(o=e,r=e[this.eventFields.startTime],a=e[this.eventFields.endTime],this.resourceBase&&(n=this.eventBase.getGroupIndexFromEvent(e))),t.isNullOrUndefined(r)||t.isNullOrUndefined(a))return!0;r=this.getDateTime(r),a=this.getDateTime(a);var l=this.eventBase.filterEvents(r,a);return!t.isNullOrUndefined(n)&&this.resourceBase&&this.resourceBase.lastResourceLevel.length>0&&(l=this.eventBase.filterEventsByResource(this.resourceBase.lastResourceLevel[n],l)),o&&(l=o.Guid?l.filter(function(e){return e.Guid!==o.Guid}):l.filter(function(e){return e[s.eventFields.id]!==o[s.eventFields.id]})),!(l.length>0)},n.prototype.openEditor=function(e,i,n,r){"Add"!==i||n?(e[this.eventFields.startTime]=this.getDateTime(e[this.eventFields.startTime]),e[this.eventFields.endTime]=this.getDateTime(e[this.eventFields.endTime])):(e.startTime=this.getDateTime(e.startTime),e.endTime=this.getDateTime(e.endTime),t.isNullOrUndefined(e.element)||(e.element=t.getElement(e.element))),this.currentAction=i,"Add"!==i&&(this.activeEventData.event=e),this.eventWindow.openEditor(e,i,n,r)},n.prototype.closeEditor=function(){this.eventWindow&&this.eventWindow.dialogClose()},n.prototype.closeQuickInfoPopup=function(){this.quickPopup&&this.quickPopup.quickPopupHide(!0)},n.prototype.selectResourceByIndex=function(e){this.resourceBase&&this.uiStateValues.isGroupAdaptive&&this.resourceBase.selectResourceByIndex(e)},n.prototype.getIndexFromResourceId=function(e,t){return this.resourceBase?this.resourceBase.getIndexFromResourceId(e,t):null},n.prototype.addResource=function(e,t,i){this.resourceBase.addResource(e,t,i)},n.prototype.removeResource=function(e,t){this.resourceBase.removeResource(e,t)},n.prototype.destroy=function(){this.eventTooltip&&(this.eventTooltip.destroy(),this.eventTooltip=null),this.destroyPopups(),this.hideSpinner(),this.unWireEvents(),this.destroyHeaderModule(),this.eventTooltip&&(this.eventTooltip.destroy(),this.eventTooltip=null),this.eventBase&&(this.eventBase.destroy(),this.eventBase=null),this.workCellAction&&(this.workCellAction.destroy(),this.workCellAction=null),this.inlineModule&&(this.inlineModule.destroy(),this.inlineModule=null),this.keyboardInteractionModule&&(this.keyboardInteractionModule.destroy(),this.keyboardInteractionModule=null),this.scrollModule&&(this.scrollModule.destroy(),this.scrollModule=null),this.printModule&&this.printModule.destroy(),this.activeView&&(this.resetTemplates(),this.activeView.removeEventListener(),this.activeView.destroy(),this.activeView=null),this.scheduleTouchModule&&(this.scheduleTouchModule.destroy(),this.scheduleTouchModule=null),this.crudModule&&(this.crudModule.destroy(),this.crudModule=null),this.dataModule&&(this.dataModule.destroy(),this.dataModule=null),e.prototype.destroy.call(this);for(var i=0,n=["dayModule","weekModule","workWeekModule","monthModule","monthAgendaModule","yearModule","agendaModule","timelineViewsModule","timelineMonthModule","timelineYearModule","resizeModule","dragAndDropModule","excelExportModule","printModule","iCalendarExportModule","iCalendarImportModule","tzModule","eventsData","eventsProcessed","blockData","blockProcessed","uiStateValues","viewCollections","viewOptions","defaultLocale","localeObj","selectedElements","resourceCollection","editorTitles","eventFields","activeViewOptions","activeEventData","activeCellsData","renderModule"];i<n.length;i++)this[n[i]]=null;P(this.element);var r=[_e,"e-rtl","e-device","e-multi-drag"];this.cssClass&&(r=r.concat(this.cssClass.split(" "))),t.removeClass([this.element],r)},ji([t.Property("auto")],n.prototype,"width",void 0),ji([t.Property("auto")],n.prototype,"height",void 0),ji([t.Property(!0)],n.prototype,"showHeaderBar",void 0),ji([t.Property(!0)],n.prototype,"showTimeIndicator",void 0),ji([t.Property("Week")],n.prototype,"currentView",void 0),ji([t.Property(["Day","Week","WorkWeek","Month","Agenda"])],n.prototype,"views",void 0),ji([t.Property(new Date)],n.prototype,"selectedDate",void 0),ji([t.Property(new Date(1900,0,1))],n.prototype,"minDate",void 0),ji([t.Property(new Date(2099,11,31))],n.prototype,"maxDate",void 0),ji([t.Property()],n.prototype,"dateFormat",void 0),ji([t.Property("Gregorian")],n.prototype,"calendarMode",void 0),ji([t.Property(!0)],n.prototype,"showWeekend",void 0),ji([t.Property(0)],n.prototype,"firstDayOfWeek",void 0),ji([t.Property("FirstDay")],n.prototype,"weekRule",void 0),ji([t.Property([1,2,3,4,5])],n.prototype,"workDays",void 0),ji([t.Property(12)],n.prototype,"monthsCount",void 0),ji([t.Property("00:00")],n.prototype,"startHour",void 0),ji([t.Property("24:00")],n.prototype,"endHour",void 0),ji([t.Property(null)],n.prototype,"timeFormat",void 0),ji([t.Property(!1)],n.prototype,"enableAllDayScroll",void 0),ji([t.Property(!1)],n.prototype,"enableAdaptiveUI",void 0),ji([t.Property(!0)],n.prototype,"allowResizing",void 0),ji([t.Complex({},oi)],n.prototype,"workHours",void 0),ji([t.Complex({},pi)],n.prototype,"timeScale",void 0),ji([t.Property(!0)],n.prototype,"allowKeyboardInteraction",void 0),ji([t.Property(!0)],n.prototype,"allowDragAndDrop",void 0),ji([t.Property()],n.prototype,"dateHeaderTemplate",void 0),ji([t.Property()],n.prototype,"cellHeaderTemplate",void 0),ji([t.Property()],n.prototype,"dayHeaderTemplate",void 0),ji([t.Property()],n.prototype,"monthHeaderTemplate",void 0),ji([t.Property()],n.prototype,"cellTemplate",void 0),ji([t.Property(!1)],n.prototype,"readonly",void 0),ji([t.Property(!0)],n.prototype,"showQuickInfo",void 0),ji([t.Property(!1)],n.prototype,"allowInline",void 0),ji([t.Property(!0)],n.prototype,"allowMultiCellSelection",void 0),ji([t.Property(!0)],n.prototype,"allowMultiRowSelection",void 0),ji([t.Property(!1)],n.prototype,"quickInfoOnSelectionEnd",void 0),ji([t.Property(!1)],n.prototype,"showWeekNumber",void 0),ji([t.Property(!1)],n.prototype,"rowAutoHeight",void 0),ji([t.Property(!1)],n.prototype,"allowMultiDrag",void 0),ji([t.Property(0)],n.prototype,"firstMonthOfYear",void 0),ji([t.Property()],n.prototype,"editorTemplate",void 0),ji([t.Complex({},ui)],n.prototype,"quickInfoTemplates",void 0),ji([t.Property(7)],n.prototype,"agendaDaysCount",void 0),ji([t.Property(!0)],n.prototype,"hideEmptyAgendaDays",void 0),ji([t.Property(!0)],n.prototype,"enableRecurrenceValidation",void 0),ji([t.Property()],n.prototype,"timezone",void 0),ji([t.Complex({},xi)],n.prototype,"eventSettings",void 0),ji([t.Property(ct)],n.prototype,"timezoneDataSource",void 0),ji([t.Property()],n.prototype,"resourceHeaderTemplate",void 0),ji([t.Property()],n.prototype,"headerIndentTemplate",void 0),ji([t.Complex({},ki)],n.prototype,"group",void 0),ji([t.Collection([],Pi)],n.prototype,"resources",void 0),ji([t.Collection([],gi)],n.prototype,"headerRows",void 0),ji([t.Property()],n.prototype,"cssClass",void 0),ji([t.Property()],n.prototype,"eventDragArea",void 0),ji([t.Event()],n.prototype,"created",void 0),ji([t.Event()],n.prototype,"destroyed",void 0),ji([t.Event()],n.prototype,"cellClick",void 0),ji([t.Event()],n.prototype,"cellDoubleClick",void 0),ji([t.Event()],n.prototype,"moreEventsClick",void 0),ji([t.Event()],n.prototype,"hover",void 0),ji([t.Event()],n.prototype,"select",void 0),ji([t.Event()],n.prototype,"actionBegin",void 0),ji([t.Event()],n.prototype,"actionComplete",void 0),ji([t.Event()],n.prototype,"actionFailure",void 0),ji([t.Event()],n.prototype,"navigating",void 0),ji([t.Event()],n.prototype,"renderCell",void 0),ji([t.Event()],n.prototype,"eventClick",void 0),ji([t.Event()],n.prototype,"eventRendered",void 0),ji([t.Event()],n.prototype,"dataBinding",void 0),ji([t.Event()],n.prototype,"popupOpen",void 0),ji([t.Event()],n.prototype,"popupClose",void 0),ji([t.Event()],n.prototype,"dragStart",void 0),ji([t.Event()],n.prototype,"drag",void 0),ji([t.Event()],n.prototype,"dragStop",void 0),ji([t.Event()],n.prototype,"resizeStart",void 0),ji([t.Event()],n.prototype,"resizing",void 0),ji([t.Event()],n.prototype,"resizeStop",void 0),ji([t.Event()],n.prototype,"dataBound",void 0),n=ji([t.NotifyPropertyChanges],n)}(t.Component),Li=function(){function e(e){this.daysVariation=0,this.parent=e,this.actionObj={X:0,Y:0,groupIndex:0,cellWidth:0,cellHeight:0,slotInterval:0,interval:0,actionIndex:0,cloneElement:[],originalElement:[],action:null,isAllDay:null,excludeSelectors:null,index:0,navigationInterval:null,scrollInterval:null},this.scrollArgs={element:null,width:0,height:0},this.resizeEdges={left:!1,right:!1,top:!1,bottom:!1},this.scrollEdges={left:!1,right:!1,top:!1,bottom:!1}}return e.prototype.getChangedData=function(e){var i=this,n=t.extend({},this.actionObj.event,null,!0);if(n[this.parent.eventFields.startTime]=this.actionObj.start,n[this.parent.eventFields.endTime]=this.actionObj.end,t.isNullOrUndefined(this.actionObj.isAllDay)||(n[this.parent.eventFields.isAllDay]=this.actionObj.isAllDay),this.parent.activeViewOptions.group.resources.length>0){var r=this.getOriginalElement(this.actionObj.element);if(r){var a=r.map(function(e){return parseInt(e.getAttribute("data-group-index"),10)});if(-1===a.indexOf(this.actionObj.groupIndex)||!t.isNullOrUndefined(e)&&e.length>0){var s=parseInt(this.actionObj.clone.getAttribute("data-group-index"),10);(a=a.filter(function(e){return e!==s})).push(this.actionObj.groupIndex),e&&e.length>0?e.forEach(function(e){i.parent.resourceBase.getResourceData(e,i.actionObj.groupIndex,a)}):this.parent.resourceBase.getResourceData(n,this.actionObj.groupIndex,a)}}}return n},e.prototype.saveChangedData=function(e,t){void 0===t&&(t=!1),this.parent.activeEventData.event=this.actionObj.event,this.parent.currentAction="Save";var i,n=[e.data];t&&(n=e.selectedData);for(var r=0,a=n;r<a.length;r++){var s=a[r],o=!(this.parent.activeViewOptions.group.resources.length>0)||parseInt(this.actionObj.element.getAttribute("data-group-index"),10)===this.actionObj.groupIndex;if(+s[this.parent.eventFields.startTime]==+this.actionObj.event[this.parent.eventFields.startTime]&&+s[this.parent.eventFields.endTime]==+this.actionObj.event[this.parent.eventFields.endTime]&&o)return;if(s[this.parent.eventFields.recurrenceRule]){var l=s[this.parent.eventFields.recurrenceID]||s[this.parent.eventFields.id];if(s[this.parent.eventFields.id]===s[this.parent.eventFields.recurrenceID]&&(s[this.parent.eventFields.id]=this.parent.eventBase.getEventMaxID(),i="EditOccurrence"),this.parent.enableRecurrenceValidation&&this.parent.eventWindow.editOccurrenceValidation(l,s,this.actionObj.event))return}else i=null;(s[this.parent.eventFields.startTimezone]||s[this.parent.eventFields.endTimezone])&&this.parent.eventBase.timezoneConvert(s),this.parent.crudModule.saveEvent(s,i)}},e.prototype.calculateIntervalTime=function(e){var t=new Date(+e);return t.setMinutes(Math.floor(t.getMinutes()/this.actionObj.interval)*this.actionObj.interval),t},e.prototype.getContentAreaDimension=function(){var e=this.parent.element.querySelector(".e-content-wrap"),t=[].slice.call(e.querySelector("tr").children);!this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.isAdaptive&&!this.parent.enableAdaptiveUI&&(t=this.getResourceElements(t));var i=t[0].getBoundingClientRect(),n=t.slice(-1)[0].getBoundingClientRect();return{bottom:e.scrollHeight-5,left:this.parent.enableRtl?n.left:i.left,right:this.parent.enableRtl?i.right:n.right,top:0,leftOffset:this.parent.enableRtl?n.right:i.right,rightOffset:this.parent.enableRtl?i.left:n.left}},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getIndex=function(e){var t=[].slice.call(this.parent.getContentTable().querySelector("tr").children),i={minIndex:0,maxIndex:t.length-1};if("resize"===this.actionObj.action&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&!this.parent.activeView.isTimelineView()){var n=this.getResourceElements(t);i.minIndex=n[0].cellIndex,i.maxIndex=n.slice(-1)[0].cellIndex}return e<i.minIndex&&(e=i.minIndex),e>i.maxIndex&&(e=i.maxIndex),e},e.prototype.updateTimePosition=function(e,i){for(var n=0,r=0,a=this.actionObj.cloneElement;r<a.length;r++){var s=a[r].querySelector(".e-time");if(s){var o=this.actionObj.start,l=this.actionObj.end;i&&i.length>0&&(o=i[n][this.parent.eventFields.startTime],l=i[n][this.parent.eventFields.endTime]),s.innerHTML=this.parent.getTimeString(o)+" - "+this.parent.getTimeString(l)}n++}if(this.parent.activeViewOptions.timeScale.enable&&this.parent.isAdaptive&&"Month"!==this.parent.currentView&&"TimelineMonth"!==this.parent.currentView){var c=this.parent.element.querySelector(".e-clone-time-indicator");if(!c){c=t.createElement("div",{className:"e-clone-time-indicator"});var p=this.parent.activeView.isTimelineView()?"e-date-header-wrap":"e-time-cells-wrap";this.parent.element.querySelector("."+p).appendChild(c)}c.innerHTML=this.parent.getTimeString(e);var h=0;if(this.parent.activeView.isTimelineView())if(this.parent.enableRtl){var d=parseInt(this.actionObj.clone.style.right,10);h="drag"===this.actionObj.action||this.resizeEdges.left?d+this.actionObj.clone.offsetWidth:d,c.style.right=t.formatUnit(h)}else{var u=parseInt(this.actionObj.clone.style.left,10);h="drag"===this.actionObj.action||this.resizeEdges.left?u:u+this.actionObj.clone.offsetWidth,c.style.left=t.formatUnit(h)}else h="drag"===this.actionObj.action||this.resizeEdges.top?this.actionObj.clone.offsetTop:this.actionObj.clone.offsetTop+this.actionObj.clone.offsetHeight,c.style.top=t.formatUnit(h)}},e.prototype.getResourceElements=function(e){var t=this;return e.filter(function(e){return parseInt(e.getAttribute("data-group-index"),10)===t.actionObj.groupIndex})},e.prototype.getOriginalElement=function(e){var i,n=e.getAttribute("data-guid");if(e.offsetParent&&e.offsetParent.classList.contains("e-more-event-popup")||this.parent.activeView.isTimelineView())i=[].slice.call(this.parent.element.querySelectorAll('[data-guid="'+n+'"]'));else{var r=t.closest(e,"tr");r&&(i=[].slice.call(r.querySelectorAll('[data-guid="'+n+'"]')))}return i},e.prototype.createCloneElement=function(e){var i=t.createElement("div",{innerHTML:e.outerHTML}).children[0],n=["e-schedule-event-clone"];n.push("drag"===this.actionObj.action?"e-drag-clone":"e-resize-clone"),"Month"!==this.parent.currentView&&"TimelineMonth"!==this.parent.currentView||n.push("e-month-event"),t.addClass([i],n),t.addClass([e],"e-event-action"),t.isNullOrUndefined(e.parentElement)||e.parentElement.appendChild(i),i.style.width=t.formatUnit(i.offsetWidth-2);var r=document.querySelector(this.parent.eventDragArea);return this.parent.eventDragArea&&"drag"===this.actionObj.action&&r&&r.appendChild(i),t.setStyleAttribute(i,{border:"0px"}),i},e.prototype.removeCloneElementClasses=function(){var e=this.actionObj.originalElement;"Month"!==this.parent.currentView&&"TimelineYear"!==this.parent.currentView&&"Day"!==this.parent.currentView&&"Week"!==this.parent.currentView&&"WorkWeek"!==this.parent.currentView||(e=[].slice.call(this.parent.element.querySelectorAll(".e-event-action"))),t.removeClass(e,"e-event-action")},e.prototype.removeCloneElement=function(){this.actionObj.originalElement=[];for(var e=0,i=[].slice.call(this.parent.element.querySelectorAll(".e-dynamic-clone"));e<i.length;e++){var n=i[e];t.remove(n)}for(var r=0,a=this.actionObj.cloneElement;r<a.length;r++){var s=a[r];t.isNullOrUndefined(s.parentNode)||t.remove(s)}this.actionObj.cloneElement=[];var o=this.parent.element.querySelector(".e-clone-time-indicator");o&&t.remove(o)},e.prototype.getCursorElement=function(e){var t=this.getPageCoordinates(e);return document.elementFromPoint(t.clientX,t.clientY)},e.prototype.autoScroll=function(){var e=this.parent.element.querySelector(".e-content-wrap"),t=e.offsetHeight<=e.scrollHeight,i=e.offsetWidth<=e.scrollWidth,n=t&&e.scrollTop>=0&&e.scrollTop+e.offsetHeight<=e.scrollHeight,r=i&&e.scrollLeft>=0&&e.scrollLeft+e.offsetWidth<=e.scrollWidth;if("resize"===this.actionObj.action&&this.scrollEdges.right&&e.scrollLeft+e.offsetWidth>e.scrollWidth){var a=[].slice.call(this.parent.getContentTable().querySelector("tr").children).length-1;r=Math.ceil((this.actionObj.clone.offsetLeft+this.actionObj.clone.offsetWidth)/this.actionObj.cellWidth)===a}n&&(this.scrollEdges.top||this.scrollEdges.bottom)&&(e.scrollTop+=this.scrollEdges.top?-this.actionObj.scroll.scrollBy:this.actionObj.scroll.scrollBy,"resize"===this.actionObj.action&&e.scrollHeight!==e.offsetHeight+e.scrollTop&&e.scrollTop>0&&(this.actionObj.Y+=this.scrollEdges.top?this.actionObj.scroll.scrollBy:-this.actionObj.scroll.scrollBy)),r&&(this.scrollEdges.left||this.scrollEdges.right)&&(e.scrollLeft+=this.scrollEdges.left?-this.actionObj.scroll.scrollBy:this.actionObj.scroll.scrollBy,"resize"===this.actionObj.action&&e.scrollWidth!==e.offsetWidth+e.scrollLeft&&e.scrollLeft>0&&(this.actionObj.X+=this.scrollEdges.left?this.actionObj.scroll.scrollBy:-this.actionObj.scroll.scrollBy))},e.prototype.autoScrollValidation=function(){if(!this.actionObj.scroll.enable)return!1;var e=this.parent.boundaryValidation(this.actionObj.pageY,this.actionObj.pageX);return this.scrollEdges=e,e.bottom||e.top||e.left||e.right},e.prototype.actionClass=function(e){"addClass"===e?t.addClass([this.parent.element],"e-event-action"):t.removeClass([this.parent.element],"e-event-action")},e.prototype.updateScrollPosition=function(e){var i=this;this.actionObj.scroll.enable&&t.isNullOrUndefined(this.actionObj.scrollInterval)&&(this.actionObj.scrollInterval=window.setInterval(function(){if(i.autoScrollValidation()&&!i.actionObj.clone.classList.contains("e-all-day-appointment")){if(i.parent.activeView.isTimelineView()&&i.parent.activeViewOptions.group.resources.length>0&&i.actionObj.groupIndex<0)return;i.autoScroll(),"drag"===i.actionObj.action?i.parent.dragAndDropModule.updateDraggingDateTime(e):i.parent.resizeModule.updateResizingDirection(e)}},this.actionObj.scroll.timeDelay))},e.prototype.updateOriginalElement=function(e){var i='[data-id="'+e.getAttribute("data-id")+'"]';this.parent.activeViewOptions.group.resources.length>0&&(i=i.concat('[data-group-index = "'+e.getAttribute("data-group-index")+'"]'));var n=[].slice.call(this.parent.element.querySelectorAll(i));t.addClass(n,"e-event-action");var r=[].slice.call(this.parent.element.querySelectorAll(".e-schedule-event-clone"));t.removeClass(r,"e-event-action")},e.prototype.getUpdatedEvent=function(e,t,i){var n=JSON.parse(JSON.stringify(i));return n[this.parent.eventFields.startTime]=e,n[this.parent.eventFields.endTime]=t,n},e.prototype.dynamicYearlyEventsRendering=function(e,i){void 0===i&&(i=!1);var n=this.actionObj.cellWidth-7;if(i&&(this.resizeEdges.left||this.resizeEdges.right)&&(n=this.actionObj.cellWidth*e.count),!i&&"Horizontal"===this.parent.activeViewOptions.orientation&&0===this.parent.activeViewOptions.group.resources.length){var r=this.yearEvent.isSpannedEvent(e,e[this.parent.eventFields.startTime]);r[this.parent.eventFields.startTime].getTime()===r[this.parent.eventFields.endTime].getTime()&&(r.isSpanned.count=1),n=r.isSpanned.count*this.actionObj.cellWidth}var a=this.createAppointmentElement(this.actionObj.groupIndex,e[this.parent.eventFields.subject]);a.setAttribute("drag","true"),t.addClass([a],"e-schedule-event-clone"),t.setStyleAttribute(a,{width:n+"px",border:"0px","pointer-events":"none",position:"absolute",overflow:"hidden",padding:"3px"}),""!==this.actionObj.clone.style.backgroundColor&&t.setStyleAttribute(a,{backgroundColor:this.actionObj.clone.style.backgroundColor});var s=w(e[this.parent.eventFields.startTime]).getTime(),o='.e-work-cells[data-date="'+s+'"]';this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(o='.e-work-cells[data-date="'+s+'"][data-group-index="'+this.actionObj.groupIndex+'"]');var l=this.parent.element.querySelector(o);if(!t.isNullOrUndefined(l)){if(i){var c=l.querySelector(".e-date-header"),p=this.actionObj.cellHeight*e.count-(c?c.offsetHeight:0)-7;(this.resizeEdges.right||this.resizeEdges.left)&&(p=parseInt(this.actionObj.clone.style.height,10)),t.setStyleAttribute(a,{height:p+"px"})}this.renderDynamicElement(l,a,!0),this.actionObj.cloneElement.push(a)}},e.prototype.renderDynamicElement=function(e,i,n){if(void 0===n&&(n=!1),e.querySelector(".e-appointment-wrapper"))e.querySelector(".e-appointment-wrapper").appendChild(i);else{var r=t.createElement("div",{className:"e-appointment-wrapper"});r.appendChild(i),e.appendChild(r)}},e.prototype.createAppointmentElement=function(e,i){var n=t.createElement("div",{className:"e-appointment",innerHTML:i});return this.parent.activeViewOptions.group.resources.length>0&&n.setAttribute("data-group-index",e.toString()),n},e.prototype.dynamicEventsRendering=function(e){var i,n=this,r=this.parent.activeView.renderDates,a=[].slice.call(this.parent.element.querySelectorAll(".e-work-cells")),s=this.parent.activeViewOptions.workDays;if(this.parent.activeViewOptions.group.resources.length>0){var o=this.parent.resourceBase.lastResourceLevel.filter(function(e){return e.groupIndex===n.actionObj.groupIndex});r=o[0].renderDates;var l='.e-work-cells[data-group-index="'+this.actionObj.groupIndex+'"]';a=[].slice.call(this.parent.element.querySelectorAll(l)),s=o[0].workDays,i=o[0].groupOrder}if(this.monthEvent.dateRender=r,this.monthEvent.getSlotDates(s),this.resizeEdges.left||this.resizeEdges.right)for(var c=0,p=[].slice.call(this.parent.element.querySelectorAll(".e-schedule-event-clone"));c<p.length;c++){var h=p[c];t.remove(h)}for(var d=0,u=this.monthEvent.splitEvent(e,r);d<u.length;d++){var v=u[d],m=this.parent.getIndexOfDate(r,w(v[this.monthEvent.fields.startTime])),g=v.data.count*this.actionObj.cellWidth-7,f=this.monthEvent.createAppointmentElement(v,this.actionObj.groupIndex,!0);f.setAttribute("drag","true"),t.addClass([f],"e-schedule-event-clone"),this.monthEvent.applyResourceColor(f,v,"backgroundColor",i),t.setStyleAttribute(f,{width:g+"px",border:"0px","pointer-events":"none"});var y=a[m];y&&t.isNullOrUndefined(this.parent.eventDragArea)&&(this.monthEvent.renderElement(y,f,!0),this.actionObj.cloneElement.push(f))}},e.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||(this.actionObj={},this.scrollArgs={},this.resizeEdges={left:!1,right:!1,top:!1,bottom:!1},this.scrollEdges={left:!1,right:!1,top:!1,bottom:!1})},e}(),Ni=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Fi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ni(i,e),i.prototype.wireResizeEvent=function(e){for(var i=0,n=[].slice.call(e.querySelectorAll(".e-event-resize"));i<n.length;i++){var r=n[i];t.EventHandler.add(r,t.Browser.touchStartEvent,this.resizeStart,this)}},i.prototype.resizeHelper=function(){if(this.parent.activeViewOptions.group.resources.length>0&&this.parent.activeViewOptions.group.allowGroupEdit)for(var e=0,t=this.actionObj.originalElement.length;e<t;e++){var i=this.createCloneElement(this.actionObj.originalElement[e]);this.actionObj.cloneElement[e]=i,this.actionObj.element===this.actionObj.originalElement[e]&&(this.actionObj.clone=i)}else this.actionObj.element&&(this.actionObj.clone=this.createCloneElement(this.actionObj.element)),this.actionObj.cloneElement=[this.actionObj.clone],this.actionObj.originalElement=[this.actionObj.element]},i.prototype.resizeStart=function(e){var i=this;this.actionObj.action="resize",this.actionObj.slotInterval=this.parent.activeViewOptions.timeScale.interval/this.parent.activeViewOptions.timeScale.slotCount,this.actionObj.interval=this.actionObj.slotInterval;var n=t.closest(e.target,".e-event-resize");this.actionObj.element=t.closest(n,".e-appointment"),this.actionObj.event=this.parent.eventBase.getEventByGuid(this.actionObj.element.getAttribute("data-guid"));var r=t.extend({},this.actionObj.event,null,!0),a={cancel:!1,data:r,element:this.actionObj.element,event:e,interval:this.actionObj.interval,scroll:{enable:!0,scrollBy:30,timeDelay:100}};this.parent.trigger("resizeStart",a,function(a){if(!a.cancel){i.actionClass("addClass"),i.parent.uiStateValues.action=!0,i.resizeEdges={left:n.classList.contains("e-left-handler"),right:n.classList.contains("e-right-handler"),top:n.classList.contains("e-top-handler"),bottom:n.classList.contains("e-bottom-handler")},i.actionObj.groupIndex=i.parent.uiStateValues.isGroupAdaptive?i.parent.uiStateValues.groupIndex:0;var s=i.parent.element.querySelector(".e-work-cells").getBoundingClientRect();i.actionObj.cellWidth=s.width,i.actionObj.cellHeight=s.height;var o=i.parent.activeViewOptions.headerRows.map(function(e){return e.option});if(i.parent.activeView.isTimelineView()&&o.length>0&&["Date","Hour"].indexOf(o.slice(-1)[0])<0){for(var l=i.parent.getContentTable().querySelector("tr"),c=0,p=0,h=[].slice.call(l.children);p<h.length;p++){var d=h[p];c+=parseInt(d.getAttribute("colspan"),10)}var u=l.getBoundingClientRect();i.actionObj.cellWidth=u.width/c,i.actionObj.cellHeight=u.height}var v=i.getPageCoordinates(e);i.actionObj.X=v.pageX,i.actionObj.Y=v.pageY,i.actionObj.groupIndex=parseInt(i.actionObj.element.getAttribute("data-group-index")||"0",10),i.actionObj.interval=a.interval,i.actionObj.scroll=a.scroll,i.actionObj.start=new Date(r[i.parent.eventFields.startTime].getTime()),i.actionObj.end=new Date(r[i.parent.eventFields.endTime].getTime()),i.actionObj.originalElement=i.getOriginalElement(i.actionObj.element),"Month"===i.parent.currentView&&(i.daysVariation=-1,i.monthEvent=new Mt(i.parent));var m=i.parent.element.querySelector(".e-content-wrap");i.scrollArgs={element:m,width:m.scrollWidth,height:m.scrollHeight},t.EventHandler.add(document,t.Browser.touchMoveEvent,i.resizing,i),t.EventHandler.add(document,t.Browser.touchEndEvent,i.resizeStop,i)}})},i.prototype.resizing=function(e){if(this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(),0===this.parent.element.querySelectorAll(".e-resize-clone").length&&this.resizeHelper(),t.isNullOrUndefined(e.target)||!e.target.classList.contains("e-disable-dates")){var i=this.getPageCoordinates(e);this.actionObj.pageX=i.pageX,this.actionObj.pageY=i.pageY,this.updateScrollPosition(e),this.updateResizingDirection(e);var n={cancel:!1,data:t.extend({},this.actionObj.event,null,!0),element:this.actionObj.element,event:e,startTime:this.actionObj.start,endTime:this.actionObj.end};this.parent.group.resources.length>0&&(n.groupIndex=this.actionObj.groupIndex),this.parent.trigger("resizing",n)}},i.prototype.updateResizingDirection=function(e){if("Month"===this.parent.currentView||"TimelineYear"===this.parent.currentView)return void this.monthResizing();var i=this.resizeValidation(e);if(this.resizeEdges.left){if(i){var n=this.getLeftRightStyles(e,!0);if(parseInt(n.width,10)<1)return;for(var r=0,a=this.actionObj.cloneElement;r<a.length;r++){m=a[r];t.setStyleAttribute(m,n),t.addClass([m],"e-left-handler")}}this.horizontalResizing(!this.parent.enableRtl)}if(this.resizeEdges.right){if(i){var s=this.getLeftRightStyles(e,!1);if(parseInt(s.width,10)<1)return;for(var o=0,l=this.actionObj.cloneElement;o<l.length;o++){m=l[o];t.setStyleAttribute(m,s),t.addClass([m],"e-right-handler")}}this.horizontalResizing(this.parent.enableRtl)}if(this.resizeEdges.top){if(i){var c=this.getTopBottomStyles(e,!0);if(parseInt(c.height,10)<1)return;for(var p=0,h=this.actionObj.cloneElement;p<h.length;p++){m=h[p];t.setStyleAttribute(m,c),t.addClass([m],"e-top-handler")}}this.verticalResizing(!0)}if(this.resizeEdges.bottom){if(i){var d=this.getTopBottomStyles(e,!1);if(parseInt(d.height,10)<1)return;for(var u=0,v=this.actionObj.cloneElement;u<v.length;u++){var m=v[u];t.setStyleAttribute(m,d),t.addClass([m],"e-bottom-handler")}}this.verticalResizing(!1)}},i.prototype.monthResizing=function(){if(this.removeCloneElement(),!t.isNullOrUndefined(this.actionObj.pageX)&&!t.isNullOrUndefined(this.actionObj.pageY)){var e=document.elementFromPoint(this.actionObj.pageX,this.actionObj.pageY);if(!t.isNullOrUndefined(e)){var i=this.parent.getDateFromElement(e),n=!(this.parent.activeViewOptions.group.resources.length>0)||parseInt(e.getAttribute("data-group-index"),10)===this.actionObj.groupIndex,r=new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime()),a=new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime());if(!this.parent.enableRtl&&this.resizeEdges.left||this.parent.enableRtl&&this.resizeEdges.right||this.resizeEdges.top?r=i:(!this.parent.enableRtl&&this.resizeEdges.right||this.parent.enableRtl&&this.resizeEdges.left||this.resizeEdges.bottom)&&(a=C(i,1)),n&&r<a){this.actionObj.start=r,this.actionObj.end=a;var s=this.getUpdatedEvent(this.actionObj.start,this.actionObj.end,this.actionObj.event);"TimelineYear"===this.parent.currentView?this.yearEventsRendering(s):this.dynamicEventsRendering(s),this.updateOriginalElement(this.actionObj.clone)}}}},i.prototype.yearEventsRendering=function(e){for(var i=0,n=[].slice.call(this.parent.element.querySelectorAll(".e-schedule-event-clone"));i<n.length;i++){var r=n[i];t.remove(r)}var a=new Date(e[this.parent.eventFields.endTime]),s=0;0===this.parent.activeViewOptions.group.resources.length&&(s=this.getMonthDiff(e[this.parent.eventFields.startTime],C(a,-1)));for(var o=0;o<=s;o++){var l=void 0;0===this.parent.activeViewOptions.group.resources.length?l=this.getEventCount(e,this.actionObj.start.getMonth()+o):(l=t.extend({},e,null,!0),a=this.resizeEdges.left||this.resizeEdges.right?C(a,-1):a,l.count=this.getMonthDiff(e[this.parent.eventFields.startTime],a)+1),this.dynamicYearlyEventsRendering(l,!0)}},i.prototype.getMonthDiff=function(e,t){var i;return i=12*(t.getFullYear()-e.getFullYear()),i-=e.getMonth(),i+=t.getMonth(),i<=0?0:i},i.prototype.getEventCount=function(e,i){var n=t.extend({},e,null,!0),r=n[this.parent.eventFields.startTime],a=n[this.parent.eventFields.endTime],s=new Date(this.parent.selectedDate.getFullYear(),i,1),o=C(new Date(this.parent.selectedDate.getFullYear(),i+1,0),1),l=1;return r.getTime()<s.getTime()&&(n[this.parent.eventFields.startTime]=s),a.getTime()>o.getTime()&&(n[this.parent.eventFields.endTime]=o),0===this.parent.activeViewOptions.group.resources.length&&(l=Math.ceil((n[this.parent.eventFields.endTime].getTime()-n[this.parent.eventFields.startTime].getTime())/We)),n.count=l,n},i.prototype.resizeStop=function(e){var i=this;t.EventHandler.remove(document,t.Browser.touchMoveEvent,this.resizing),t.EventHandler.remove(document,t.Browser.touchEndEvent,this.resizeStop),clearInterval(this.actionObj.scrollInterval),this.actionObj.scrollInterval=null,this.removeCloneElementClasses(),this.removeCloneElement(),this.actionClass("removeClass"),this.parent.uiStateValues.action=!1;var n={cancel:!1,data:this.getChangedData(),element:this.actionObj.element,event:e};this.parent.trigger("resizeStop",n,function(e){e.cancel||(i.parent.activeViewOptions.group.resources.length>0&&!i.parent.rowAutoHeight&&!i.parent.activeViewOptions.group.allowGroupEdit&&!i.parent.virtualScrollModule&&i.parent.activeViewOptions.group.byGroupID&&(i.parent.crudModule.crudObj.sourceEvent=[i.parent.resourceBase.lastResourceLevel[parseInt(e.element.getAttribute("data-group-index"),10)]],i.parent.crudModule.crudObj.targetEvent=i.parent.crudModule.crudObj.sourceEvent,i.parent.crudModule.crudObj.isCrudAction=!0),i.saveChangedData(e))})},i.prototype.verticalResizing=function(e){var i=this.actionObj.clone.offsetTop;e||(i+=this.actionObj.clone.offsetHeight);var n=i/this.actionObj.cellHeight*this.actionObj.slotInterval,r=this.actionObj.clone.offsetParent;if(!t.isNullOrUndefined(r)){var a=w(this.parent.getDateFromElement(r));a.setHours(this.parent.activeView.getStartHour().getHours()),a.setMinutes(n+this.parent.activeView.getStartHour().getMinutes()),e?this.actionObj.start=this.calculateIntervalTime(a):this.actionObj.end=this.calculateIntervalTime(a),this.updateTimePosition(a)}},i.prototype.horizontalResizing=function(e){var i,n=new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime()),r=new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime()),a=!1,s=this.parent.currentView,o=["TimelineDay","TimelineWeek","TimelineWorkWeek"].indexOf(this.parent.currentView)>-1,l="TimelineMonth"===this.parent.currentView,c=l||o&&!this.parent.activeViewOptions.timeScale.enable;if(this.parent.activeView.isTimelineView()){k=this.parent.getContentTable().querySelector("tr");if(this.parent.activeViewOptions.headerRows.length>0){var p=this.parent.activeViewOptions.headerRows.map(function(e){return e.option});s=p.slice(-1)[0],l&&"Hour"===s&&(s=p.slice(-2)[0]||"Month")}i=e?n:r;var h=0,d=[].slice.call(k.children),u=!1,v=this.actionObj.cellWidth/(this.parent.activeViewOptions.timeScale.interval/this.parent.activeViewOptions.timeScale.slotCount),m=parseFloat(this.parent.enableRtl?this.actionObj.clone.style.right:this.actionObj.clone.style.left);if(m=Math.round(m/v)*v,-1!==["Year","Month","Week","Date"].indexOf(s)){for(var g=0,f=0,y=d;f<y.length;f++){var T=y[f];g+=parseInt(T.getAttribute("colspan"),10)}var D=this.parent.enableRtl?parseInt(this.actionObj.clone.style.right,10):parseInt(this.actionObj.clone.style.left,10);D=Math.round(D/this.actionObj.cellWidth)*this.actionObj.cellWidth,e||(D+=this.actionObj.clone.getBoundingClientRect().width-this.actionObj.cellWidth),h=Math.floor(D/Math.floor(k.getBoundingClientRect().width/g)),a=o&&"Date"===s,u=(h=e?h:l?h+1:h)===d.length,h=h<0?0:h>=g?g-1:h}else{var b=this.actionObj.cellWidth;if(h=e?Math.floor(m/this.actionObj.cellWidth):Math.ceil((m+(this.actionObj.clone.getBoundingClientRect().width-b))/this.actionObj.cellWidth),this.parent.enableRtl){var O=0;"TimelineMonth"!==s&&(this.parent.activeViewOptions.timeScale.enable||l)||(O=this.actionObj.cellWidth);var E=Math.floor(m/this.actionObj.cellWidth)*this.actionObj.cellWidth+(e?0:this.actionObj.clone.getBoundingClientRect().width-O);h=Math.floor(E/this.actionObj.cellWidth)}u=h===d.length,h=this.getIndex(h)}var S=void 0;if(S=-1!==["Year","Month","Week","Date"].indexOf(s)?new Date(this.parent.activeView.renderDates[h].getTime()):this.parent.getDateFromElement(k.children[h]),-1===["TimelineMonth","Year","Month","Week","Date"].indexOf(s)&&this.parent.activeViewOptions.timeScale.enable){e||(m+=this.actionObj.clone.getBoundingClientRect().width);var x=Math.ceil(this.actionObj.slotInterval/this.actionObj.cellWidth*(m-Math.floor(m/this.actionObj.cellWidth)*this.actionObj.cellWidth));x=u||!e&&0===x?this.actionObj.slotInterval:x,(i=new Date(S.getTime())).setMinutes(i.getMinutes()+x),this.updateTimePosition(i)}else i=new Date(S.setHours(i.getHours(),i.getMinutes(),i.getSeconds()))}else{var A=t.closest(this.actionObj.clone,"td").cellIndex,V=Math.ceil((e?this.actionObj.element.getBoundingClientRect().width:0)/this.actionObj.cellWidth)*this.actionObj.cellWidth,g=Math.ceil((this.actionObj.clone.getBoundingClientRect().width-V)/this.actionObj.cellWidth),k=t.closest(this.actionObj.clone,"tr"),M=e?A-g:A+g-1;M=this.getIndex(M),i=this.parent.getDateFromElement(k.children[M]),e?i.setHours(n.getHours(),n.getMinutes(),n.getSeconds()):i.setHours(r.getHours(),r.getMinutes(),r.getSeconds())}if(e)r.getTime()-i.getTime()<=0&&(i=c?w(r):n),this.actionObj.start=this.parent.activeViewOptions.timeScale.enable?this.calculateIntervalTime(i):i;else{var R=(!(o&&this.parent.activeViewOptions.timeScale.enable)||a||o&&["Week","Month","Year"].indexOf(s)>-1)&&0===i.getHours()&&0===i.getMinutes()?C(i,1):i;c&&R.getTime()-n.getTime()<=0&&(R=C(w(n),1)),this.actionObj.end=this.parent.activeViewOptions.timeScale.enable&&"Month"!==this.parent.currentView?this.calculateIntervalTime(R):R}},i.prototype.getTopBottomStyles=function(e,i){var n=this.parent.element.querySelector(".e-content-wrap"),r=this.actionObj.cellHeight/this.actionObj.slotInterval*this.actionObj.interval,a=i?this.actionObj.element.offsetHeight+(this.actionObj.Y-this.actionObj.pageY):this.actionObj.element.offsetHeight+(this.actionObj.pageY-this.actionObj.Y),s=i?this.actionObj.element.offsetTop-(this.actionObj.Y-this.actionObj.pageY):this.actionObj.clone.offsetTop;return a=s<0?this.actionObj.clone.offsetHeight:this.actionObj.clone.offsetTop+this.actionObj.clone.offsetHeight>this.scrollArgs.height?this.actionObj.clone.offsetHeight:a,s=s<0?0:s,a=(s=i?Math.floor(s/r)*r:s)+a>=n.scrollHeight?n.scrollHeight-s:Math.ceil(a/r)*r,{height:t.formatUnit(a<this.actionObj.cellHeight?Math.floor(a/r)*r:a),top:t.formatUnit(a<this.actionObj.cellHeight&&i?Math.ceil(s/r)*r:s),left:"0px",right:"0px",width:"100%"}},i.prototype.getLeftRightStyles=function(e,i){var n={},r=this.parent.activeView.isTimelineView(),a=["TimelineDay","TimelineWeek","TimelineWorkWeek"].indexOf(this.parent.currentView)>-1&&this.parent.activeViewOptions.timeScale.enable,s=this.actionObj.cellWidth/this.actionObj.slotInterval*this.actionObj.interval,o=i?this.actionObj.X-this.actionObj.pageX:this.actionObj.pageX-this.actionObj.X,l=r?this.actionObj.element.getBoundingClientRect().width/this.actionObj.cellWidth*this.actionObj.cellWidth:"Month"===this.parent.currentView?this.actionObj.element.getBoundingClientRect().width:Math.ceil(this.actionObj.element.getBoundingClientRect().width/this.actionObj.cellWidth)*this.actionObj.cellWidth,c=l+Math.ceil(o/this.actionObj.cellWidth)*this.actionObj.cellWidth,p=this.parent.enableRtl?parseInt(this.actionObj.element.style.right,10):this.actionObj.clone.offsetLeft;a&&(c=l+Math.ceil(o/s)*s,c=Math.round((p+c)/s)*s-p,this.actionObj.event[this.parent.eventFields.isAllDay]=!1);var h=!i&&c+this.actionObj.clone.offsetLeft>this.scrollArgs.width?this.actionObj.clone.getBoundingClientRect().width:(this.actionObj.cellWidth,c);if(this.parent.enableRtl){var d=r?parseInt(this.actionObj.element.style.right,10):-(c-this.actionObj.cellWidth);d=r?d:i?0:d>0?0:d,r&&!i&&(d=(d=Math.ceil((this.actionObj.element.offsetLeft+(this.actionObj.element.getBoundingClientRect().width+(this.actionObj.pageX-this.actionObj.X)))/s)*s)<0?Math.abs(d):-d),d=d>=this.scrollArgs.width?this.scrollArgs.width-this.actionObj.cellWidth:d,n.right=t.formatUnit(d),h=h+d>this.scrollArgs.width?this.actionObj.clone.getBoundingClientRect().width:h}else{var u=i?this.actionObj.element.offsetLeft-(this.actionObj.X-this.actionObj.pageX):this.parent.enableRtl?this.actionObj.element.offsetLeft:0;r&&(u=i?u:parseInt(this.actionObj.clone.style.left,10),u=this.parent.enableRtl?i?u:this.actionObj.pageX<this.actionObj.X-this.actionObj.clone.getBoundingClientRect().width?parseInt(this.actionObj.clone.style.right,10):u:i&&this.actionObj.pageX>this.actionObj.X+this.actionObj.clone.getBoundingClientRect().width&&this.actionObj.clone.getBoundingClientRect().width===this.actionObj.cellWidth?parseInt(this.actionObj.clone.style.left,10):u);var v=u;(u=r?a?i?Math.floor(u/s)*s:u:Math.floor(u/this.actionObj.cellWidth)*this.actionObj.cellWidth:Math.ceil(Math.abs(u)/this.actionObj.cellWidth)*this.actionObj.cellWidth)<0&&(u=0,h=this.actionObj.clone.getBoundingClientRect().width);var m=Math.ceil(this.actionObj.clone.getBoundingClientRect().width/this.actionObj.cellWidth)*this.actionObj.cellWidth;i&&(n.left=t.formatUnit(r?u:i?v<0?-u:Math.ceil((l-m)/this.actionObj.cellWidth)*this.actionObj.cellWidth:u))}return n.width=t.formatUnit(h),n},i.prototype.resizeValidation=function(e){var t=this.getPageCoordinates(e),i=this.getContentAreaDimension(),n=this.parent.activeView.isTimelineView()&&this.parent.activeViewOptions.timeScale.enable,r=this.actionObj.cellWidth,a=!1;return this.resizeEdges.left&&(t.pageX<i.leftOffset&&t.pageX>=i.left&&n&&(r=0),a=t.pageX-r>=i.left),this.resizeEdges.right&&(t.pageX>i.rightOffset&&t.pageX<=i.right&&n&&(r=0),a=t.pageX+r<=i.right),this.resizeEdges.top&&(a=this.actionObj.clone.offsetTop>=i.top),this.resizeEdges.bottom&&(a=this.actionObj.clone.offsetTop+this.actionObj.clone.offsetHeight<=this.scrollArgs.height),a},i.prototype.getModuleName=function(){return"resize"},i}(Li),Ui=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Bi=function(e){function i(t){var i=e.call(this,t,"day")||this;return i.isResource=!1,i}return Ui(i,e),i.prototype.renderAppointments=function(){this.parent.dragAndDropModule&&this.parent.dragAndDropModule.setDragArea(),this.fields=this.parent.eventFields;for(var e="Year"===this.parent.currentView?".e-appointment":".e-appointment-wrapper,.e-more-indicator",i=0,n=[].slice.call(this.parent.element.querySelectorAll(e));i<n.length;i++){var r=n[i];t.remove(r)}this.renderedEvents=[],"Year"===this.parent.currentView?this.yearViewEvents():(this.removeCellHeight(),this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive?(this.isResource=!0,this.timelineResourceEvents()):this.timelineYearViewEvents()),this.parent.renderTemplates(),this.parent.notify(Ue,{})},i.prototype.yearViewEvents=function(){for(var e=this.getMonths(),i=0,n=e;i<n.length;i++)for(var r=n[i],a=".e-month-calendar:nth-child("+(e.indexOf(r)+1)+") td.e-work-cells",s=[].slice.call(this.parent.element.querySelectorAll(a)),o=new Date(this.parent.selectedDate.getFullYear(),r,1),l=this.parent.calendarUtil.getMonthStartDate(new Date(o.getTime())),c=this.parent.calendarUtil.getMonthEndDate(new Date(o.getTime())),p=u(l,this.parent.firstDayOfWeek),h=C(v(c,this.parent.firstDayOfWeek),1),d=0;p.getTime()<h.getTime();d++){var m=w(new Date(p.getTime())),g=C(new Date(m.getTime()),1);if(this.parent.eventBase.filterEvents(m,g).length>0){var f=s[d];f&&f.appendChild(t.createElement("div",{className:"e-appointment"}))}p=C(new Date(p.getTime()),1)}},i.prototype.timelineYearViewEvents=function(){var e=this.parent.element.querySelector(".e-work-cells");this.cellWidth=e.offsetWidth,this.cellHeader=R(e.querySelector(".e-date-header"));var i=this.parent.element.querySelector(".e-event-table");this.eventHeight=h(i,"e-appointment");for(var n=[].slice.call(this.parent.element.querySelectorAll("."+Ze)),r=this.getMonths(),a=0;a<r.length;a++){var s=n[a],o=a+1,l=t.createElement("div",{className:"e-appointment-wrapper"});s.appendChild(l);var c=new Date(this.parent.selectedDate.getFullYear(),r[a],1),p=new Date(c.getFullYear(),c.getMonth()+1,0),d=c.getDay(),u=[];for("Horizontal"===this.parent.activeViewOptions.orientation&&(this.renderedEvents=[]);c.getTime()<=p.getTime();){var v=void 0,m=void 0;if("Vertical"===this.parent.activeViewOptions.orientation){var g=n[d];o=d+1;var f=g.querySelector(".e-appointment-wrapper");f||(f=t.createElement("div",{className:"e-appointment-wrapper"}),g.appendChild(f)),this.parent.enableRtl?m=a*this.cellWidth:v=a*this.cellWidth}else this.parent.enableRtl?m=(d+c.getDate()-1)*this.cellWidth:v=(d+c.getDate()-1)*this.cellWidth;var y=this.parent.element.querySelector(".e-content-wrap tr:nth-child("+o+") td");this.cellHeight=y.offsetHeight;var T=w(new Date(c.getTime())),D=C(new Date(T.getTime()),1),b=void 0;this.parent.uiStateValues.isGroupAdaptive&&(b=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]);for(var O=this.parent.eventBase.filterEvents(T,D,void 0,b),E=this,S=0,x=(O=this.parent.eventBase.sortByDateTime(O)).length;S<x;S++)!function(e,i){var n=t.extend({},O[e],null,!0);E.updateSpannedEvents(n,T,D);var r=E.getIndex(T);n.Index=r;var s=E.cellHeader+E.eventHeight*(r+1)+2+E.moreIndicatorHeight,o=E.cellHeight-E.cellHeader-E.moreIndicatorHeight,p=Math.floor(o/(E.eventHeight+2)),h=i-p<=0?1:i-p;if("Horizontal"===E.parent.activeViewOptions.orientation){var g=E.renderedEvents.filter(function(e){return e.Guid===n.Guid}),f=u.filter(function(e){return e.Guid===n.Guid});if(g.length>0&&g[0].MoreIndicator||f.length>0&&f[0].MoreIndicator){w="Horizontal"===E.parent.activeViewOptions.orientation?a:d;return E.renderMoreIndicator(l,h,T,w,v,m),"continue"}if(g.length>0||f.length>0)return"continue"}if(E.parent.rowAutoHeight&&"Horizontal"===E.parent.activeViewOptions.orientation||E.cellHeight>s)E.renderEvent(l,n,a,v,m,c,d),E.updateCellHeight(y,s),u.push(n);else{var w="Horizontal"===E.parent.activeViewOptions.orientation?a:d;E.renderMoreIndicator(l,h,T,w,v,m),"Horizontal"===E.parent.activeViewOptions.orientation&&(n.MoreIndicator=!0,E.renderedEvents.push(n),u.push(n))}}(S,x);c=C(new Date(c.getTime()),1),"Vertical"===this.parent.activeViewOptions.orientation&&(d++,this.renderedEvents=[])}}},i.prototype.updateSpannedEvents=function(e,t,i){var n=this.isResource&&"Vertical"===this.parent.activeViewOptions.orientation||!this.isResource&&"Horizontal"===this.parent.activeViewOptions.orientation,r={isLeft:!0,isRight:!0,isBottom:!0,isTop:!0};t.getTime()<=e[this.fields.startTime].getTime()&&(n?r.isLeft=!1:r.isTop=!1),(i.getTime()>=e[this.fields.endTime].getTime()||n&&!this.isResource&&C(i,-1).getMonth()===e[this.fields.endTime].getMonth())&&(n?r.isRight=!1:r.isBottom=!1),e.data=r},i.prototype.timelineResourceEvents=function(){var e=this.parent.element.querySelector(".e-work-cells");this.cellWidth=e.offsetWidth,this.cellHeader=0;var t=this.parent.element.querySelector(".e-event-table");this.eventHeight=h(t,"e-appointment");var i=[].slice.call(this.parent.element.querySelectorAll("."+Ze)),n=this.parent.uiStateValues.isGroupAdaptive?[this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]]:this.parent.resourceBase.lastResourceLevel,r=this.getMonths();if("Horizontal"===this.parent.activeViewOptions.orientation)for(l=0;l<r.length;l++)for(var a=new Date(this.parent.selectedDate.getFullYear(),r[l],1),s=0,o=n.length;s<o;s++)this.renderedEvents=[],this.renderResourceEvent(i[l],n[s],l,s,a);else for(var s=0,o=n.length;s<o;s++){this.renderedEvents=[];for(var l=0;l<r.length;l++){a=new Date(this.parent.selectedDate.getFullYear(),r[l],1);this.renderResourceEvent(i[s],n[s],l,s,a)}}},i.prototype.renderResourceEvent=function(e,i,n,r,a){var s=t.createElement("div",{className:"e-appointment-wrapper"});e.appendChild(s);var o=C(g(new Date(a.getTime())),1),l=this.parent.eventBase.filterEvents(a,o,void 0,i),c="Vertical"===this.parent.activeViewOptions.orientation?r:n,p=this.parent.element.querySelector(".e-content-wrap tr:nth-child("+(c+1)+") td");this.cellHeight=p.offsetHeight,this.groupOrder=i.groupOrder;for(var h=0;h<l.length;h++){var d=l[h],u=void 0,v=t.extend({},d,null,!0);if(this.parent.activeViewOptions.group.resources.length>0){var m=this.isSpannedEvent(v,a);u=this.getIndex(m[this.fields.startTime]),v.Index=u}else u=this.getIndex(v[this.fields.startTime]),v.Index=u;var f=this.cellHeader+this.eventHeight*(h+1)+2+this.moreIndicatorHeight,y="Vertical"===this.parent.activeViewOptions.orientation?n*this.cellWidth:r*this.cellWidth;if(!(this.parent.rowAutoHeight||this.cellHeight>f)){var T="Horizontal"===this.parent.activeViewOptions.orientation?n:r;if(this.renderMoreIndicator(s,l.length-h,a,T,y,y,r),"Horizontal"===this.parent.activeViewOptions.orientation)for(var w=r;w<l.length;w++)this.renderedEvents.push(t.extend({},l[w],{Index:u+w},!0));break}this.renderEvent(s,v,n,y,y,a,r),this.updateCellHeight(p,f)}},i.prototype.renderEvent=function(e,i,n,r,a,s,o){var l,c,p=this,h=this.isSpannedEvent(i,s),d=this.createEventElement(h);if(1===h.isSpanned.count){var u=C(h[this.fields.endTime],-1);h[this.fields.endTime]=u>h[this.fields.startTime]?u:h[this.fields.endTime]}if(!(h[this.fields.startTime]>h[this.fields.endTime])){"Horizontal"===this.parent.activeViewOptions.orientation?(c=n+1,h[this.fields.startTime].getTime()===h[this.fields.endTime].getTime()&&(h.isSpanned.count=1),l=h.isSpanned.count*this.cellWidth):(c=o+1,l=this.cellWidth);var v=this.parent.element.querySelector(".e-content-wrap tr:nth-child("+c+") td").offsetTop+this.cellHeader+this.eventHeight*h.Index+2;t.setStyleAttribute(d,{width:l+"px",height:this.eventHeight+"px",left:r+"px",right:a+"px",top:v+"px"});var m={data:h,element:d,cancel:!1,type:"event"};this.parent.trigger("eventRendered",m,function(i){i.cancel||(e.appendChild(d),p.wireAppointmentEvents(d,h),p.parent.activeViewOptions.group.resources.length>0?p.renderedEvents.push(t.extend({},h,null,!0)):"Vertical"===p.parent.activeViewOptions.orientation?p.renderedEvents.push(t.extend({},h,null,!0)):((h.isSpanned.isRight||h.isSpanned.isLeft)&&"Horizontal"===p.parent.activeViewOptions.orientation||!h.isSpanned.isRight)&&p.renderedEvents.push(t.extend({},h,null,!0)))})}},i.prototype.renderMoreIndicator=function(e,i,n,r,a,s,o){if(0!==this.parent.activeViewOptions.group.resources.length||!e.querySelector('[data-start-date="'+n.getTime()+'"]')){var l;l=this.parent.activeViewOptions.group.resources.length>0?C(g(new Date(n.getTime())),1):C(new Date(n.getTime()),1);var c=this.getMoreIndicatorElement(i,n,l),p=this.parent.element.querySelector(".e-content-wrap tr:nth-child("+(r+1)+")").offsetTop+(this.cellHeight-this.moreIndicatorHeight);a=Math.floor(a/this.cellWidth)*this.cellWidth,s=Math.floor(s/this.cellWidth)*this.cellWidth,t.setStyleAttribute(c,{width:this.cellWidth+"px",left:a+"px",right:s+"px",top:p+"px"}),t.isNullOrUndefined(o)||c.setAttribute("data-group-index",o.toString()),e.appendChild(c),t.EventHandler.add(c,"click",this.moreIndicatorClick,this)}},i.prototype.createEventElement=function(e){var i=e[this.fields.subject]||this.parent.eventSettings.fields.subject.default||this.parent.localeObj.getConstant("addTitle"),n=t.createElement("div",{className:"e-appointment",attrs:{"data-id":"Appointment_"+e[this.fields.id],"data-guid":e.Guid,role:"button",tabindex:"0","aria-readonly":this.parent.eventBase.getReadonlyAttribute(e),"aria-selected":"false","aria-grabbed":"true","aria-label":this.parent.getAnnouncementString(e)}});if(this.cssClass&&t.addClass([n],this.cssClass),e[this.fields.isReadonly]&&t.addClass([n],"e-read-only"),this.parent.activeViewOptions.group.resources.length>0){var r=this.getGroupIndexFromEvent(e);n.setAttribute("data-group-index",r.toString())}var a=[],s=t.extend({},e,null,!0);if(this.parent.activeViewOptions.eventTemplate){var o=this.parent.element.id+"_"+this.parent.activeViewOptions.eventTemplateName+"eventTemplate";a=this.parent.getAppointmentTemplate()(s,this.parent,"eventTemplate",o,!1)}else{var l=e[this.fields.location]||this.parent.eventSettings.fields.location.default||"",c=t.createElement("div",{className:"e-subject",innerHTML:i+(l?";&nbsp"+l:"")}),p=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(s[this.fields.startTime])}),h=t.createElement("div",{className:"e-time"+(this.parent.isAdaptive?" e-disable":""),innerHTML:this.parent.getTimeString(s[this.fields.endTime])});t.addClass([c],"e-text-center"),e[this.fields.isAllDay]?a=[c]:s.isLeft||s.isRight?(s.isLeft||a.push(p),a.push(c),s.isRight||a.push(h)):a=[p,c,h]}var d=t.createElement("div",{className:"e-appointment-details"});return t.append(a,d),n.appendChild(d),this.renderResizeHandler(n,e.data,e[this.fields.isReadonly]),this.applyResourceColor(n,s,"backgroundColor",this.groupOrder),n},i.prototype.isSpannedEvent=function(e,i){var n=new Date(i.getFullYear(),i.getMonth(),1),r=C(new Date(i.getFullYear(),i.getMonth()+1,0),1),a=t.extend({},e,null,!0),s=a[this.fields.startTime],o=a[this.fields.endTime],l={isLeft:!1,isRight:!1,count:1};if(this.isResource&&this.updateSpannedEvents(e,n,r),s.getTime()<n.getTime()&&(a[this.fields.startTime]=n,l.isLeft=!0),o.getTime()>r.getTime()&&(a[this.fields.endTime]=r,l.isRight=!0),0===this.parent.activeViewOptions.group.resources.length){var c=w(a[this.fields.endTime]).getTime(),p=w(a[this.fields.startTime]).getTime();(e[this.fields.isAllDay]&&c===e[this.fields.endTime].getTime()||l.isRight)&&(c=C(new Date(c),-1).getTime()),l.count=Math.ceil((c-p)/We)+1}return a.isSpanned=l,w(s).getTime()<w(this.parent.minDate).getTime()&&(a[this.fields.startTime]=this.parent.minDate),w(o).getTime()>w(this.parent.maxDate).getTime()&&(a[this.fields.endTime]=this.parent.maxDate),a},i.prototype.getOverlapEvents=function(e,t){var i,n,r=[];if(this.parent.activeViewOptions.group.resources.length>0){var a=this.parent.calendarUtil.getMonthStartDate(new Date(e.getTime())),s=C(this.parent.calendarUtil.getMonthEndDate(new Date(e.getTime())),-1);i=w(new Date(a.getTime())).getTime(),n=w(new Date(s.getTime())).getTime()}else this.parent.rowAutoHeight?(i=w(new Date(e.getTime())).getTime(),n=C(w(new Date(e.getTime())),1).getTime()):i=n=w(new Date(e.getTime())).getTime();for(var o=0,l=t;o<l.length;o++){var c=l[o],p=new Date(c[this.fields.startTime].getTime()),h=new Date(c[this.fields.endTime].getTime());if("Vertical"===this.parent.activeViewOptions.orientation&&this.parent.activeViewOptions.group.resources.length>0)w(p).getTime()>=i&&w(h).getTime()<=n&&r.push(c);else{var d=c[this.fields.isAllDay]?w(h).getTime()>i:w(h).getTime()>=i;(w(p).getTime()<=i&&d||w(p).getTime()>=i&&w(h).getTime()<=n)&&r.push(c)}}return r},i.prototype.getMonths=function(){var e=this;return Array.apply(null,{length:this.parent.monthsCount}).map(function(t,i){return e.parent.firstMonthOfYear+i})},i.prototype.removeCellHeight=function(){for(var e=".e-month-header-wrapper tbody tr,.e-resource-column-table tbody tr,."+Qe+" tbody tr",t=0,i=[].slice.call(this.element.querySelectorAll(e));t<i.length;t++)i[t].firstElementChild.style.height=""},i.prototype.destroy=function(){e.prototype.destroy.call(this),this.parent=null},i}(Pt),Wi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),zi=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.widthUptoCursorPoint=0,t.heightUptoCursorPoint=0,t.cursorPointIndex=0,t.isHeaderRows=!1,t.isTimelineDayProcess=!1,t.widthPerMinute=0,t.heightPerMinute=0,t.minDiff=0,t.isStepDragging=!1,t.isMorePopupOpened=!1,t.isAllDayDrag=!1,t.isMultiSelect=!1,t.multiData=[],t.updatedData=[],t.swagData=[],t.startTime=0,t.isAllDayTarget=!1,t.targetTd=null,t.isCursorAhead=!1,t}return Wi(i,e),i.prototype.wireDragEvent=function(e){new t.Draggable(e,{abort:".e-event-resize",clone:!0,isDragScroll:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!!this.parent.eventDragArea,cursorAt:this.parent.eventDragArea?{left:-20,top:-20}:{left:0,top:0},dragArea:this.dragArea,dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this),queryPositionInfo:this.dragPosition.bind(this)})},i.prototype.setDragArea=function(){var e=document.querySelector(this.parent.eventDragArea);this.dragArea=this.parent.eventDragArea&&e?e:this.parent.element.querySelector("."+Qe)},i.prototype.dragHelper=function(e){var i=this;this.setDragActionDefaultValues(),this.actionObj.element=e.element,this.actionObj.action="drag";var n=[];return!this.parent.allowMultiDrag||t.isNullOrUndefined(this.parent.selectedElements)||0===this.parent.selectedElements.length||this.parent.selectedElements.length>0&&-1===this.parent.selectedElements.indexOf(this.actionObj.element)?n=[e.element]:(n=this.parent.selectedElements,this.isMultiSelect=!0),n.forEach(function(e){var n=i.createCloneElement(e);e.getAttribute("data-guid")===i.actionObj.element.getAttribute("data-guid")&&(i.actionObj.clone=n,i.parent.eventDragArea||"Month"===i.parent.currentView||!i.parent.activeViewOptions.timeScale.enable||i.parent.activeView.isTimelineView()||i.actionObj.element.classList.contains("e-all-day-appointment")||t.setStyleAttribute(i.actionObj.clone,{cursor:"move",left:"0%",right:"0%",width:"100%"}),i.actionObj.clone.style.top=t.formatUnit(i.actionObj.element.offsetTop)),i.actionObj.cloneElement.push(n),i.actionObj.originalElement.push(e)}),this.actionObj.clone},i.prototype.dragPosition=function(e){if(this.parent.eventDragArea)return{left:e.left,top:e.top};var i=this.actionObj.cellHeight/this.actionObj.slotInterval*this.actionObj.interval,n=t.formatUnit(0);"Month"===this.parent.currentView&&(n=e.left);var r;r=this.isStepDragging?Math.ceil(this.actionObj.clone.getBoundingClientRect().right)+this.actionObj.interval:this.actionObj.clone.getBoundingClientRect().right;var a=this.parent.element.querySelector(".e-content-wrap").getBoundingClientRect().right;!(this.parent.activeView.isTimelineView()&&"TimelineYear"!==this.parent.currentView&&!this.parent.enableRtl&&this.actionObj.pageX>r)||this.isMorePopupOpened||this.actionObj.pageX>a||(this.isCursorAhead=!0),this.parent.activeView.isTimelineView()&&(n=t.formatUnit(this.actionObj.clone.offsetLeft));var s;if(this.parent.activeView.isTimelineView()||!this.parent.timeScale.enable||!t.isNullOrUndefined(this.actionObj.clone.offsetParent)&&this.actionObj.clone.offsetParent.classList.contains("e-more-event-popup"))s=t.formatUnit(this.actionObj.clone.offsetTop);else if("Month"===this.parent.currentView)s=t.formatUnit(0);else if(this.actionObj.clone.classList.contains("e-all-day-appointment"))s=t.formatUnit(this.parent.element.querySelector(".e-all-day-row").offsetTop),t.setStyleAttribute(this.actionObj.clone,{width:t.formatUnit(Math.ceil(this.actionObj.clone.offsetWidth/this.actionObj.cellWidth)*this.actionObj.cellWidth),right:this.parent.enableRtl&&t.formatUnit(0)});else{this.actionObj.element.classList.contains("e-all-day-appointment")&&!this.actionObj.clone.classList.contains("e-all-day-appointment")&&t.setStyleAttribute(this.actionObj.clone,{height:t.formatUnit(this.actionObj.cellHeight),width:t.formatUnit(this.actionObj.cellWidth-1),pointerEvents:"none"});var o=parseInt(e.top,10);o=o<0?0:o,s=t.formatUnit(Math.ceil(o/i)*i);var l=this.parent.element.querySelector(".e-content-wrap").scrollHeight,c=parseInt(s,10)+this.actionObj.clone.offsetHeight;c>l&&(s=parseInt(s,10)-(c-l)+"px")}return{left:n,top:s}},i.prototype.setDragActionDefaultValues=function(){this.actionObj.action="drag",this.actionObj.isAllDay=null,this.actionObj.slotInterval=this.parent.activeViewOptions.timeScale.interval/this.parent.activeViewOptions.timeScale.slotCount,this.actionObj.interval=this.actionObj.slotInterval;var e=this.parent.element.querySelector(".e-work-cells");this.actionObj.cellWidth=e.offsetWidth,this.actionObj.cellHeight=e.offsetHeight},i.prototype.dragStart=function(e){var i=this,n=this.actionObj.element.getAttribute("data-guid");this.actionObj.event=this.parent.eventBase.getEventByGuid(n);var r=t.extend({},this.actionObj.event,null,!0);t.isNullOrUndefined(r)||(this.startTime=r[this.parent.eventFields.startTime].getTime());var a={cancel:!1,data:r,selectedData:this.getSelectedData(),event:e,excludeSelectors:null,element:this.actionObj.element,interval:this.actionObj.interval,navigation:{enable:!1,timeDelay:2e3},scroll:{enable:!0,scrollBy:30,timeDelay:100}};this.parent.trigger("dragStart",a,function(n){if(n.cancel||!t.isNullOrUndefined(i.actionObj.element)&&t.isNullOrUndefined(i.actionObj.element.parentElement)){var a=i.actionObj.element.ej2_instances[0];return t.isNullOrUndefined(a)||a.intDestroy(e.event),i.actionObj.action="",i.removeCloneElementClasses(),void i.removeCloneElement()}i.actionClass("addClass"),i.parent.uiStateValues.action=!0,i.actionObj.start=r[i.parent.eventFields.startTime],i.actionObj.end=r[i.parent.eventFields.endTime],i.actionObj.groupIndex=parseInt(i.actionObj.element.getAttribute("data-group-index")||"0",10),i.actionObj.interval=n.interval,i.actionObj.navigation=n.navigation,i.actionObj.scroll=n.scroll,i.actionObj.excludeSelectors=n.excludeSelectors;var s=i.parent.element.querySelector(".e-content-wrap");if(i.scrollArgs={element:s,width:s.scrollWidth,height:s.scrollHeight},i.widthPerMinute=i.actionObj.cellWidth/i.actionObj.slotInterval*i.actionObj.interval,i.heightPerMinute=i.actionObj.cellHeight/i.actionObj.slotInterval*i.actionObj.interval,i.widthUptoCursorPoint=0,i.heightUptoCursorPoint=0,i.cursorPointIndex=-1,i.isHeaderRows=!1,i.isTimelineDayProcess=!1,i.minDiff=0,i.isMorePopupOpened=!1,i.daysVariation=-1,i.isAllDayTarget=i.actionObj.clone.classList.contains("e-all-day-appointment"),(i.parent.activeView.isTimelineView()||!i.parent.timeScale.enable)&&"TimelineYear"!==i.parent.currentView){!t.isNullOrUndefined(i.actionObj.clone.offsetParent)&&i.actionObj.clone.offsetParent.classList.contains("e-more-event-popup")&&(i.isMorePopupOpened=!0),i.actionObj.pageX=e.event.pageX;var o=i.parent.activeViewOptions.headerRows;i.isHeaderRows=o.length>0&&"Hour"!==o[o.length-1].option&&"Date"!==o[o.length-1].option,i.isTimelineDayProcess=!i.parent.activeViewOptions.timeScale.enable||i.isHeaderRows||"TimelineMonth"===i.parent.currentView||o.length>0&&"Date"===o[o.length-1].option,i.isStepDragging=!i.isTimelineDayProcess&&i.actionObj.slotInterval!==i.actionObj.interval,i.isTimelineDayProcess?i.timelineEventModule=new Pt(i.parent,"day"):i.timelineEventModule=new Pt(i.parent,"hour")}"TimelineYear"===i.parent.currentView&&(i.yearEvent=new Bi(i.parent)),"Month"===i.parent.currentView&&(i.startTime=w(new Date(i.startTime)).getTime(),i.updateOriginalElement(i.actionObj.clone),i.monthEvent=new Mt(i.parent)),"Day"!==i.parent.currentView&&"Week"!==i.parent.currentView&&"WorkWeek"!==i.parent.currentView||(i.verticalEvent=new Vt(i.parent),i.verticalEvent.initializeValues(),i.splitEvent(i.actionObj.event).forEach(function(e){var n='.e-day-wrapper[data-date="'+w(e[i.parent.eventFields.startTime]).getTime()+'"]';i.parent.activeViewOptions.group.resources.length>0&&(n=n.concat('[data-group-index = "'+i.actionObj.groupIndex+'"]'));var r=i.parent.element.querySelector(n);if(r){var a=r.querySelector('[data-id="'+i.actionObj.clone.getAttribute("data-id")+'"]');a&&t.addClass([a],"e-event-action")}}))})},i.prototype.getSelectedData=function(){if(this.isMultiSelect&&0===this.multiData.length&&this.parent.selectedElements.length>0)for(var e=0,i=this.parent.selectedElements;e<i.length;e++){var n=i[e].getAttribute("data-guid"),r=this.parent.eventBase.getEventByGuid(n);this.multiData.push(t.extend({},r,null,!0))}return this.multiData},i.prototype.drag=function(e){if(this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(!0),t.isNullOrUndefined(e.target)||!e.target.classList.contains("e-disable-dates")){var i=t.extend({},this.actionObj.event,null,!0),n=this.getPageCoordinates(e);if(this.actionObj.Y=this.actionObj.pageY=n.pageY,this.actionObj.X=this.actionObj.pageX=n.pageX,this.actionObj.target=e.target,this.widthUptoCursorPoint=0===this.widthUptoCursorPoint?Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left-this.actionObj.X)/this.widthPerMinute)*this.widthPerMinute:this.widthUptoCursorPoint,this.widthUptoCursorPoint=this.isMorePopupOpened?this.actionObj.cellWidth:this.widthUptoCursorPoint,this.heightUptoCursorPoint=0===this.heightUptoCursorPoint?Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top-this.actionObj.Y)/this.heightPerMinute)*this.heightPerMinute:this.heightUptoCursorPoint,this.isAllDayDrag=this.parent.activeViewOptions.timeScale.enable?this.actionObj.clone.classList.contains("e-all-day-appointment"):this.actionObj.event[this.parent.eventFields.isAllDay],this.isStepDragging&&0===this.minDiff&&this.calculateMinutesDiff(i),("Month"===this.parent.currentView||this.isAllDayDrag)&&this.daysVariation<0){var r=this.parent.getDateFromElement(this.actionObj.target);if(t.isNullOrUndefined(r))this.daysVariation=0;else{var a=w(r),s=w(new Date(i[this.parent.eventFields.startTime].getTime()));this.daysVariation=(a.getTime()-s.getTime())/We}}else this.daysVariation=0;if(this.parent.eventDragArea){var o=n.target;this.actionObj.clone.style.top=t.formatUnit(o.offsetTop),this.actionObj.clone.style.left=t.formatUnit(o.offsetLeft),t.closest(o,"."+_e)?"Week"!==this.parent.currentView&&"WorkWeek"!==this.parent.currentView&&"Day"!==this.parent.currentView&&(this.actionObj.clone.style.width=t.formatUnit(this.actionObj.element.offsetWidth)):(this.actionObj.clone.style.height="",this.actionObj.clone.style.width="")}this.updateScrollPosition(e),this.updateNavigatingPosition(e),this.updateDraggingDateTime(e);var l={data:i,event:e,element:this.actionObj.element,startTime:this.actionObj.start,endTime:this.actionObj.end,selectedData:this.updatedData};this.parent.group.resources.length>0&&(l.groupIndex=this.actionObj.groupIndex),this.parent.trigger("drag",l)}},i.prototype.calculateMinutesDiff=function(e){this.parent.enableRtl?this.minDiff=(this.actionObj.clone.offsetWidth-this.widthUptoCursorPoint)/this.widthPerMinute*this.actionObj.interval:this.minDiff=this.widthUptoCursorPoint/this.widthPerMinute*this.actionObj.interval;var t=e[this.parent.eventFields.startTime],i=S(this.parent.activeView.renderDates[0],this.parent.activeView.getStartHour(),this.parent.activeView.getEndHour());i.startHour.getTime()>t.getTime()&&(this.minDiff=this.minDiff+(i.startHour.getTime()-t.getTime())/ze)},i.prototype.dragStop=function(e){var i=this;if(this.isCursorAhead=!1,this.removeCloneElementClasses(),this.removeCloneElement(),clearInterval(this.actionObj.navigationInterval),this.actionObj.navigationInterval=null,clearInterval(this.actionObj.scrollInterval),this.actionObj.scrollInterval=null,this.actionClass("removeClass"),this.parent.uiStateValues.action=!1,this.actionObj.action=null,!this.isAllowDrop(e)){var n=!e.target.classList.contains("e-work-cells")&&this.parent.cellTemplate?t.closest(e.target,".e-work-cells"):e.target,r={cancel:!1,data:this.getChangedData(this.updatedData),selectedData:this.updatedData,event:e,element:this.actionObj.element,target:n};this.parent.trigger("dragStop",r,function(e){if(!e.cancel){if(i.parent.activeViewOptions.group.resources.length>0&&!i.parent.activeViewOptions.group.allowGroupEdit&&!i.parent.rowAutoHeight&&!i.parent.virtualScrollModule&&i.parent.activeViewOptions.group.byGroupID){i.parent.crudModule.crudObj.isCrudAction=!0,i.parent.crudModule.crudObj.sourceEvent=[i.parent.resourceBase.lastResourceLevel[parseInt(r.element.getAttribute("data-group-index"),10)]];var t=parseInt(r.target.getAttribute("data-group-index"),10)||i.actionObj.groupIndex;i.parent.crudModule.crudObj.targetEvent=[i.parent.resourceBase.lastResourceLevel[t]]}i.saveChangedData(e,i.isMultiSelect)}}),this.updatedData=[],this.multiData=[],this.isMultiSelect=!1,this.parent.selectedElements=[]}},i.prototype.updateNavigatingPosition=function(e){var i=this;if(this.actionObj.navigation.enable){var n=this.parent.getCurrentTime();t.isNullOrUndefined(this.actionObj.navigationInterval)&&(this.actionObj.navigationInterval=window.setInterval(function(){if(n){var t=i.parent.getCurrentTime().getSeconds(),r=n.getSeconds()+i.actionObj.navigation.timeDelay/1e3;(r=r>=60?r-60:r)===t&&(n=i.parent.getCurrentTime(),i.viewNavigation(e),i.updateDraggingDateTime(e))}},this.actionObj.navigation.timeDelay))}},i.prototype.updateDraggingDateTime=function(e){!t.isNullOrUndefined(this.actionObj.clone.offsetParent)&&this.actionObj.clone.offsetParent.classList.contains("e-more-event-popup")?this.morePopupEventDragging(e):this.parent.activeView.isTimelineView()&&"TimelineYear"!==this.parent.currentView?(this.timelineEventModule.dateRender=this.parent.activeView.renderDates,this.timelineEventModule.cellWidth=this.actionObj.cellWidth,this.timelineEventModule.getSlotDates(),this.actionObj.cellWidth=this.isHeaderRows?this.timelineEventModule.cellWidth:this.actionObj.cellWidth,this.calculateTimelineTime(e)):"Month"===this.parent.currentView||"TimelineYear"===this.parent.currentView?this.calculateVerticalDate(e):this.calculateVerticalTime(e)},i.prototype.navigationWrapper=function(){if(this.parent.activeView.isTimelineView()){var e=void 0;if(e=this.parent.activeViewOptions.group.resources.length>0?this.parent.element.querySelectorAll(".e-appointment-container:not(.e-hidden)").item(this.actionObj.index):this.parent.element.querySelector("."+Ze),!t.isNullOrUndefined(e)){var i=e.querySelector(".e-appointment-wrapper");i||(i=t.createElement("div",{className:"e-appointment-wrapper"}),e.appendChild(i)),this.actionObj.cloneElement.forEach(function(e){i.appendChild(e)})}}else if("Month"!==this.parent.currentView&&this.parent.timeScale.enable){var n=this.actionObj.clone.classList.contains("e-all-day-appointment")?".e-all-day-appointment-wrapper":".e-appointment-wrapper";if(this.parent.element.querySelectorAll(n).item(this.actionObj.index).appendChild(this.actionObj.clone),".e-all-day-appointment-wrapper"===n){var r=this.getAllDayEventHeight(),a=[].slice.call(this.parent.element.querySelectorAll(".e-all-day-cells:first-child"));if(a[0].offsetHeight<r)for(var s=0,o=a;s<o.length;s++)o[s].style.height=(r+2)/12+"em";this.actionObj.clone.style.height=t.formatUnit(r)}this.actionObj.height=parseInt(this.actionObj.clone.style.height,10)}else{var l=[].slice.call(this.parent.element.querySelectorAll(".e-work-cells"));this.actionObj.index=this.parent.activeView.renderDates.length<this.actionObj.index?this.parent.activeView.renderDates.length-1:this.actionObj.index;var c=l[this.actionObj.index].querySelector(".e-appointment-wrapper");c||(c=t.createElement("div",{className:"e-appointment-wrapper"}),l[this.actionObj.index].appendChild(c)),c.appendChild(this.actionObj.clone)}},i.prototype.viewNavigation=function(e){var i,n=this.parent.element.querySelector(".e-content-wrap");n&&(!this.scrollEdges.top&&!this.scrollEdges.bottom||t.closest(this.actionObj.clone,".e-all-day-appointment-wrapper"))&&(0===n.scrollLeft&&Math.round(this.actionObj.X)<=Math.round(n.getBoundingClientRect().left+this.actionObj.cellWidth+window.pageXOffset)?i=this.parent.enableRtl?"next":"previous":Math.round(n.scrollLeft)+n.clientWidth===n.scrollWidth&&Math.round(this.actionObj.X)>=Math.round(n.getBoundingClientRect().right-this.actionObj.cellWidth+window.pageXOffset)&&(i=this.parent.enableRtl?"previous":"next"),i&&this.parent.changeDate(this.parent.activeView.getNextPreviousDate(i)))},i.prototype.morePopupEventDragging=function(e){if(!(t.isNullOrUndefined(e.target)||e.target&&t.isNullOrUndefined(t.closest(e.target,"td")))){var i=t.extend({},this.actionObj.event,null,!0),n=i[this.parent.eventFields.endTime].getTime()-i[this.parent.eventFields.startTime].getTime(),r=t.closest(e.target,"td");if("TimelineYear"!==this.parent.currentView||r.classList.contains("e-work-cells")){var a=this.parent.getDateFromElement(r),s=new Date(a.getTime());s.setMilliseconds(n),this.parent.activeViewOptions.group.resources.length>0&&(this.actionObj.groupIndex=parseInt(r.getAttribute("data-group-index"),10)),this.actionObj.start=new Date(a.getTime()),this.actionObj.end=new Date(s.getTime()),this.actionObj.clone.style.top=t.formatUnit(r.offsetParent.offsetTop),this.actionObj.clone.style.left=t.formatUnit(r.offsetLeft),this.actionObj.clone.style.width=t.formatUnit(r.offsetWidth);var o,l=r;if(this.parent.activeView.isTimelineView()){var c=t.closest(r,"tr").rowIndex;l=this.parent.element.querySelectorAll(".e-appointment-container").item(c)}(o=l.querySelector(".e-appointment-wrapper"))||(o=t.createElement("div",{className:"e-appointment-wrapper"}),l.appendChild(o)),this.appendCloneElement(o)}}},i.prototype.calculateVerticalTime=function(e){var i=this;if(!(t.isNullOrUndefined(this.actionObj.target)||this.actionObj.target&&t.isNullOrUndefined(t.closest(this.actionObj.target,"tr"))||!t.closest(this.actionObj.target,"td").classList.contains("e-work-cells")&&!t.closest(this.actionObj.target,"td").classList.contains("e-all-day-cells"))){this.parent.activeViewOptions.timeScale.enable&&this.swapDragging(e);var n=this.parent.element.querySelector(".e-content-wrap"),r=t.extend({},this.actionObj.event,null,!0),a=r[this.parent.eventFields.startTime],s=r[this.parent.eventFields.endTime].getTime()-a.getTime(),o=Math.floor(parseInt(this.actionObj.clone.style.top,10)/this.actionObj.cellHeight)*this.actionObj.cellHeight;o=o<0?0:o,(this.scrollEdges.top||this.scrollEdges.bottom)&&(o=this.scrollEdges.top?n.scrollTop-this.heightUptoCursorPoint+this.actionObj.cellHeight+window.pageYOffset:n.scrollTop+n.offsetHeight-this.actionObj.clone.offsetHeight+window.pageYOffset+(this.actionObj.clone.offsetHeight-this.heightUptoCursorPoint),o=Math.round(o/this.actionObj.cellHeight)*this.actionObj.cellHeight,this.actionObj.clone.style.top=t.formatUnit(o));var l,c=this.parent.activeViewOptions.timeScale.enable?o/this.actionObj.cellHeight:0,p=this.actionObj.cellHeight/this.actionObj.slotInterval,h=parseInt(this.actionObj.clone.style.top,10)-o;l=this.isAllDayDrag?this.parent.element.querySelector(".e-all-day-row"):[].slice.call(this.parent.getContentTable().querySelectorAll("tr"))[c];var d;(t.closest(this.actionObj.target,"td").classList.contains("e-work-cells")||t.closest(this.actionObj.target,"td").classList.contains("e-all-day-cells"))&&(d=t.closest(this.actionObj.target,"td").cellIndex);var u=t.isNullOrUndefined(d)?t.closest(this.actionObj.clone,"td").cellIndex:d;if(this.actionObj.index=u,!t.isNullOrUndefined(l)){var v=l.children[u];this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(this.actionObj.groupIndex=parseInt(v.getAttribute("data-group-index"),10));var m,g;this.parent.activeViewOptions.timeScale.enable&&!this.isAllDayDrag?(this.appendCloneElement(this.getEventWrapper(u)),(m=this.parent.getDateFromElement(v)).setMinutes(m.getMinutes()+h/p),g=new Date(m.getTime()),this.actionObj.element.classList.contains("e-all-day-appointment")?g.setMinutes(g.getMinutes()+this.actionObj.slotInterval):g.setMilliseconds(s)):((m=this.parent.getDateFromElement(v)).setDate(m.getDate()-this.daysVariation),m.setHours(a.getHours(),a.getMinutes(),a.getSeconds()),(g=new Date(m.getTime())).setMilliseconds(s),!this.actionObj.element.classList.contains("e-all-day-appointment")&&this.actionObj.clone.classList.contains("e-all-day-appointment")&&(g=C(w(g),1)),this.updateAllDayEvents(m,g,this.parent.activeViewOptions.group.byDate?u:void 0)),this.actionObj.start=new Date(+m),this.actionObj.end=new Date(+g);for(var f=this.getUpdatedEvent(this.actionObj.start,this.actionObj.end,this.actionObj.event),y=0,T=[].slice.call(this.parent.element.querySelectorAll(".e-dynamic-clone"));y<T.length;y++){x=T[y];t.remove(x)}if(this.multiData.length>0){if(this.isAllDayTarget&&this.isAllDayDrag&&!t.isNullOrUndefined(this.actionObj.isAllDay)&&!this.actionObj.isAllDay){var D=parseInt(t.closest(this.actionObj.target,"td").getAttribute("data-date"),10);this.multiData.forEach(function(e){if(i.swagData.push(t.extend({},e,null,!0)),e[i.parent.eventFields.isAllDay]){e[i.parent.eventFields.startTime]=new Date(e[i.parent.eventFields.startTime].getTime()+(D-i.startTime));var n=new Date(e[i.parent.eventFields.startTime]),r=new Date(n.setMinutes(n.getMinutes()+i.actionObj.slotInterval));e[i.parent.eventFields.endTime]=r,e[i.parent.eventFields.isAllDay]=!1}}),this.startTime=D}if(this.isAllDayTarget&&this.isAllDayDrag&&!t.isNullOrUndefined(this.actionObj.isAllDay)&&this.actionObj.isAllDay&&this.swagData.length>0){this.multiData=this.swagData,this.swagData=[];var b=t.extend({},this.actionObj.event,null,!0);this.startTime=b[this.parent.eventFields.startTime].getTime()}for(var O=f[this.parent.eventFields.startTime].getTime()-this.startTime,E=0;E<this.multiData.length;E++){this.updatedData[E]=this.updateMultipleData(this.multiData[E],O);var S=this.getDayIndex(this.updatedData[E]);if(S>=0){var x=this.getEventWrapper(S,this.updatedData[E][this.parent.eventFields.isAllDay]);this.appendCloneElement(x,this.actionObj.cloneElement[E]),this.updateEventHeight(this.updatedData[E],E,S)}else t.isNullOrUndefined(this.actionObj.cloneElement[E].parentNode)||t.remove(this.actionObj.cloneElement[E])}}else this.updateEventHeight(f);this.updateTimePosition(this.actionObj.start,this.updatedData)}}},i.prototype.splitEvent=function(e){var i=this.parent.eventFields,n=[],r=e[i.startTime],a=e[i.endTime];if(w(new Date(r.getTime()))<w(new Date(a.getTime()))){for(var s=w(new Date(r.getTime())),o=new Date(s.getTime()),l=0;s<new Date(a.getTime());l++){o=new Date(o.setDate(s.getDate()+1));var c=t.extend({},e,null,!0);c[i.startTime]=new Date(s),c[i.endTime]=new Date(o),s=new Date(s.setDate(s.getDate()+1)),n.push(c)}var p=n.length-1;n[0][i.startTime]=r,n[p][i.endTime]=a}else n.push(e);return n},i.prototype.updateMultipleData=function(e,i){var n=t.extend({},e,null,!0);!t.isNullOrUndefined(this.actionObj.isAllDay)&&this.parent.activeViewOptions.timeScale.enable&&(this.isAllDayTarget&&n[this.parent.eventFields.isAllDay]||!this.isAllDayTarget&&!n[this.parent.eventFields.isAllDay])&&(n[this.parent.eventFields.isAllDay]=this.actionObj.isAllDay);var r=n[this.parent.eventFields.endTime].getTime()-n[this.parent.eventFields.startTime].getTime();if(n[this.parent.eventFields.isAllDay]){var a=Math.ceil(i/864e5),s=Math.ceil(r/864e5),o=new Date(n[this.parent.eventFields.startTime]);n[this.parent.eventFields.startTime]=w(new Date(o.setDate(o.getDate()+a))),n[this.parent.eventFields.endTime]=C(n[this.parent.eventFields.startTime],s)}else n[this.parent.eventFields.startTime]=new Date(n[this.parent.eventFields.startTime].getTime()+i),n[this.parent.eventFields.endTime]=new Date(n[this.parent.eventFields.startTime].getTime()+r);return n},i.prototype.getDayIndex=function(e){var i=t.extend({},e,null,!0),n=w(i[this.parent.eventFields.startTime]).getTime(),r="",a="e-day-wrapper";return a=this.parent.activeViewOptions.timeScale.enable&&i[this.parent.eventFields.isAllDay]?"e-all-day-appointment-wrapper":"e-work-cells",r="."+a+'[data-date="'+n+'"]',this.parent.activeViewOptions.group.resources.length>0&&(r=r+'[data-group-index="'+this.actionObj.groupIndex+'"]'),this.targetTd=this.parent.element.querySelector(r),t.isNullOrUndefined(this.targetTd)?-1:this.targetTd.cellIndex},i.prototype.updateEventHeight=function(e,i,n){this.verticalEvent.initializeValues();var r=0;if(!this.parent.uiStateValues.isGroupAdaptive)for(p=0;p<this.actionObj.groupIndex;p++)r+=this.verticalEvent.dateRender[p].length;var a=this.parent.uiStateValues.isGroupAdaptive?r:this.actionObj.groupIndex;if(!(!this.parent.activeViewOptions.group.byDate||t.isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)))||!this.parent.activeViewOptions.group.byDate)for(var s=-1,o=this.parent.activeViewOptions.group.byDate?this.parent.getIndexOfDate(this.verticalEvent.dateRender[a],w(this.parent.getDateFromElement(t.isNullOrUndefined(i)?this.actionObj.target:this.targetTd))):t.isNullOrUndefined(i)?this.actionObj.index-r:n-r,l=this.splitEvent(e),c=this.parent.eventBase.isAllDayAppointment(e)||l.length>2||"TimeSlot"!==this.parent.eventSettings.spannedEventPlacement?[e]:l,p=0;p<c.length;p++){if(p>0){var h='.e-day-wrapper[data-date="'+w(c[p][this.parent.eventFields.startTime]).getTime()+'"]';this.parent.activeViewOptions.group.resources.length>0&&(h=h.concat('[data-group-index = "'+this.actionObj.groupIndex+'"]'));var d=this.parent.element.querySelector(h);d?(o+=1,s=d.cellIndex):o=-1}if(o>=0){var u=this.verticalEvent.isSpannedEvent(c[p],o,a),v=u[this.verticalEvent.fields.startTime],m=u[this.verticalEvent.fields.endTime],g=this.parent.activeViewOptions.timeScale.enable?this.verticalEvent.getHeight(v,m):this.actionObj.element.offsetHeight,f=this.parent.activeViewOptions.timeScale.enable?this.verticalEvent.getTopValue(v,o,a):this.actionObj.element.offsetTop;if(t.isNullOrUndefined(i))0===p?(this.actionObj.clone.style.top=t.formatUnit(f),this.actionObj.clone.style.height=t.formatUnit(g)):this.renderSpannedEvents(u,s,f,g);else{var y=this.actionObj.cellWidth;if(e[this.parent.eventFields.isAllDay]){f=this.parent.element.querySelector(".e-all-day-row").offsetTop,g=this.getAllDayEventHeight();var T=e[this.parent.eventFields.endTime].getTime()-e[this.parent.eventFields.startTime].getTime(),D=Math.ceil(T/864e5);D>=0&&(y=D*this.actionObj.cellWidth)}this.actionObj.cloneElement[i]&&(0===p?(this.actionObj.cloneElement[i].style.top=t.formatUnit(f),this.actionObj.cloneElement[i].style.height=t.formatUnit(g),this.actionObj.cloneElement[i].style.width=t.formatUnit(y),this.actionObj.cloneElement[i].style.left=t.formatUnit(0)):this.renderSpannedEvents(u,s,f,g))}}}},i.prototype.renderSpannedEvents=function(e,i,n,r){if(e[this.parent.eventFields.startTime].getTime()!==e[this.parent.eventFields.endTime].getTime()){var a=this.verticalEvent.createAppointmentElement(e,!1,e.isSpanned,this.actionObj.groupIndex);t.addClass([a],["e-schedule-event-clone","e-dynamic-clone"]),t.setStyleAttribute(a,{width:"100%",height:r+"px",top:n+"px",border:"0px"}),[].slice.call(this.parent.element.querySelectorAll(".e-appointment-wrapper"))[i].appendChild(a)}},i.prototype.getRenderedDates=function(){var e,t,i=this,n=this.parent.activeView.renderDates;return(e=this.parent.eventBase.slots).push.apply(e,this.parent.activeView.renderDates.map(function(e){return+e})),this.parent.activeViewOptions.group.resources.length>0&&(this.parent.eventBase.slots=[],n=this.parent.resourceBase.lastResourceLevel.filter(function(e){return e.groupIndex===i.actionObj.groupIndex})[0].renderDates,(t=this.parent.eventBase.slots).push.apply(t,n.map(function(e){return+e}))),n},i.prototype.updateAllDayEvents=function(e,i,n){this.parent.eventBase.slots=[];var r=this.getUpdatedEvent(e,i,this.actionObj.event),a=this.getRenderedDates(),s=this.parent.eventBase.splitEvent(r,a),o='.e-all-day-cells[data-date="'+s[0][this.parent.eventFields.startTime].getTime()+'"]';this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(o=o.concat('[data-group-index = "'+this.actionObj.groupIndex+'"]'));var l=[].slice.call(this.parent.element.querySelectorAll(o));if(l.length>0||!t.isNullOrUndefined(n)){var c=t.isNullOrUndefined(n)?l[0].cellIndex:n;this.appendCloneElement(this.getEventWrapper(c)),this.actionObj.clone.style.width=t.formatUnit(s[0].data.count*this.actionObj.cellWidth)}},i.prototype.swapDragging=function(e){var i=t.closest(this.actionObj.target,"td").cellIndex;if(t.closest(this.actionObj.target,".e-date-header-wrap")&&!t.closest(this.actionObj.clone,".e-all-day-appointment-wrapper")){t.addClass([this.actionObj.clone],"e-all-day-appointment"),this.appendCloneElement(this.getEventWrapper(i)),this.actionObj.isAllDay=!0;var n=this.getAllDayEventHeight(),r=[].slice.call(this.parent.element.querySelectorAll(".e-all-day-cells:first-child"));if(r[0].offsetHeight<n)for(var a=0,s=r;a<s.length;a++)s[a].style.height=(n+2)/12+"em";t.setStyleAttribute(this.actionObj.clone,{width:t.formatUnit(this.actionObj.cellWidth),height:t.formatUnit(n),top:t.formatUnit(this.parent.element.querySelector(".e-all-day-row").offsetTop)})}if(t.closest(this.actionObj.target,".e-work-cells")&&!t.closest(this.actionObj.clone,".e-day-wrapper")){t.removeClass([this.actionObj.clone],"e-all-day-appointment"),this.appendCloneElement(this.getEventWrapper(i)),this.actionObj.isAllDay=!1;var o=0===this.actionObj.element.offsetHeight?this.actionObj.height:this.actionObj.element.offsetHeight;t.setStyleAttribute(this.actionObj.clone,{left:t.formatUnit(0),height:t.formatUnit(o),width:t.formatUnit(this.actionObj.cellWidth)})}},i.prototype.calculateVerticalDate=function(e){if(!(t.isNullOrUndefined(e.target)||e.target&&t.isNullOrUndefined(t.closest(e.target,"tr"))||e.target&&"DIV"===e.target.tagName)){var i=t.extend({},this.actionObj.event,null,!0);t.isNullOrUndefined(this.parent.eventDragArea)&&this.removeCloneElement();var n=i[this.parent.eventFields.endTime].getTime()-i[this.parent.eventFields.startTime].getTime(),r=t.closest(this.actionObj.target,"td");if(!t.isNullOrUndefined(r)){var a=r.parentElement;this.actionObj.index=a.rowIndex*a.children.length+r.cellIndex,r=[].slice.call(this.parent.element.querySelectorAll(".e-work-cells"))[this.actionObj.index];var s=this.parent.getDateFromElement(r);if(!t.isNullOrUndefined(s)){this.parent.activeViewOptions.group.resources.length>0&&(this.actionObj.groupIndex=parseInt(r.getAttribute("data-group-index"),10));var o=new Date(s.setDate(s.getDate()-this.daysVariation)),l=new Date(o.getTime()),c=new Date(l.getTime()),p=i[this.parent.eventFields.startTime].getTime()-w(new Date(+i[this.parent.eventFields.startTime])).getTime();l=new Date(l.getTime()+p),c=new Date(l.getTime()+n),this.actionObj.start=new Date(l.getTime()),this.actionObj.end=new Date(c.getTime())}}for(var h=this.getUpdatedEvent(this.actionObj.start,this.actionObj.end,this.actionObj.event),d=0,u=[].slice.call(this.parent.element.querySelectorAll(".e-schedule-event-clone"));d<u.length;d++){var v=u[d];t.remove(v)}if(this.multiData&&this.multiData.length>0){var m=w(new Date(h[this.parent.eventFields.startTime])),p=m.getTime()-this.startTime;"TimelineYear"===this.parent.currentView&&this.parent.group.resources.length>0&&(p=12*(m.getFullYear()-new Date(this.startTime).getFullYear()),p-=new Date(this.startTime).getMonth(),p+=m.getMonth());for(var g=0;g<this.multiData.length;g++)this.updatedData[g]=this.updateMultipleVerticalDate(this.multiData[g],p),"TimelineYear"===this.parent.currentView?this.dynamicYearlyEventsRendering(this.updatedData[g]):this.dynamicEventsRendering(this.updatedData[g])}else"TimelineYear"===this.parent.currentView?this.dynamicYearlyEventsRendering(h):this.dynamicEventsRendering(h)}},i.prototype.updateMultipleVerticalDate=function(e,i){var n=t.extend({},e,null,!0),r=n[this.parent.eventFields.endTime].getTime()-n[this.parent.eventFields.startTime].getTime(),a=new Date(n[this.parent.eventFields.startTime]);if("TimelineYear"===this.parent.currentView&&this.parent.group.resources.length>0)n[this.parent.eventFields.startTime]=new Date(a.setMonth(a.getMonth()+i));else{var s=Math.ceil(i/We);n[this.parent.eventFields.startTime]=new Date(a.setDate(a.getDate()+s))}return n[this.parent.eventFields.endTime]=new Date(n[this.parent.eventFields.startTime].getTime()+r),n},i.prototype.calculateTimelineTime=function(e){var i=t.extend({},this.actionObj.event,null,!0),n=i[this.parent.eventFields.endTime].getTime()-i[this.parent.eventFields.startTime].getTime(),r=this.parent.enableRtl?Math.abs(this.actionObj.clone.offsetLeft)-this.actionObj.clone.offsetWidth:parseInt(this.actionObj.clone.style.left,10);r=Math.floor(r/this.actionObj.cellWidth)*this.actionObj.cellWidth;var a;this.parent.enableRtl&&(a=Math.abs(parseInt(this.actionObj.clone.style.right,10)),this.actionObj.clone.style.right=t.formatUnit(a)),r=this.getOffsetValue(r,a);var s=this.getColumnIndex(r),o=this.parent.element.querySelector(".e-content-wrap"),l=o.getBoundingClientRect().right,c=this.parent.activeView.isTimelineView()&&!this.parent.enableRtl&&this.actionObj.pageX>this.actionObj.clone.getBoundingClientRect().right&&!this.isMorePopupOpened&&!(this.actionObj.pageX>l),p=this.parent.eventDragArea?o.scrollLeft-o.offsetLeft:0;!this.isCursorAhead&&!c||this.isStepDragging||(this.isCursorAhead=!0);var h=Math.floor((this.actionObj.pageX-this.actionObj.clone.getBoundingClientRect().left+p)/this.actionObj.cellWidth);this.parent.enableRtl&&(h=Math.abs(Math.floor((this.actionObj.pageX-this.actionObj.clone.getBoundingClientRect().right)/this.actionObj.cellWidth))-1),this.cursorPointIndex<0&&this.cursorIndex(e,i,r,h);var d=this.parent.getContentTable().querySelector("tr"),u=this.getCursorCurrentIndex(s,h,d);u=u<0?0:u;var v=this.isHeaderRows?new Date(this.timelineEventModule.dateRender[u].getTime()):this.parent.getDateFromElement(d.children[u]);if(this.isStepDragging){var m=this.getWidthDiff(d,u);if(0!==m){var g=Math.round(m/this.widthPerMinute);v.setMinutes(v.getMinutes()+g*this.actionObj.interval),this.isCursorAhead||c?v.setMilliseconds(-n):v.setMinutes(v.getMinutes()-this.minDiff)}else v=this.actionObj.start}else this.isCursorAhead||c?(v.setMinutes(v.getMinutes()+(this.isTimelineDayProcess?1440:this.actionObj.slotInterval)),v.setMilliseconds(-n)):v.setMinutes(v.getMinutes()-this.cursorPointIndex*(this.isTimelineDayProcess?1440:this.actionObj.slotInterval));if(v=this.calculateIntervalTime(v),this.isTimelineDayProcess){y=i[this.parent.eventFields.startTime];v.setHours(y.getHours(),y.getMinutes(),y.getSeconds())}if(this.parent.eventDragArea){var f=this.parent.getDateFromElement(e.target);if(!t.isNullOrUndefined(f))if(this.parent.activeViewOptions.timeScale.enable&&"TimelineMonth"!==this.parent.currentView)v=f;else{var y=i[this.parent.eventFields.startTime];v=new Date(f.setHours(y.getHours(),y.getMinutes(),y.getSeconds()))}}var T=new Date(v.getTime());T.setMilliseconds(n);var D=[this.getUpdatedEvent(v,T,this.actionObj.event)];if(this.multiData.length>0){for(var b=D[0][this.parent.eventFields.startTime].getTime()-this.startTime,C=0;C<this.multiData.length;C++)this.updatedData[C]=this.updateMultipleData(this.multiData[C],b);D=this.updatedData}for(var O=0;O<D.length;O++){var E=this.timelineEventModule.splitEvent(D[O],this.timelineEventModule.dateRender),S=E[0].data,x=this.timelineEventModule.getStartTime(E[0],S),A=this.timelineEventModule.getEndTime(E[0],S),V=this.timelineEventModule.getEventWidth(x,A,i[this.parent.eventFields.isAllDay],S.count),k=this.parent.getIndexOfDate(this.timelineEventModule.dateRender,w(new Date(x.getTime())));k=k<0?0:k;var M=this.timelineEventModule.getPosition(x,A,i[this.parent.eventFields.isAllDay],k),R=this.multiData.length>0?this.actionObj.cloneElement[O]:this.actionObj.clone;this.parent.enableRtl?R.style.right=t.formatUnit(M):R.style.left=t.formatUnit(M),this.isMorePopupOpened||(R.style.width=t.formatUnit(V)),this.parent.activeViewOptions.group.resources.length>0&&this.calculateResourceGroupingPosition(e,R),this.actionObj.start=new Date(v.getTime()),this.actionObj.end=new Date(T.getTime()),this.updateTimePosition(this.actionObj.start,this.updatedData)}},i.prototype.getOffsetValue=function(e,i){if(this.scrollEdges.left||this.scrollEdges.right){var n=this.parent.element.querySelector(".e-content-wrap");this.parent.enableRtl?(i=n.offsetWidth-n.scrollLeft,this.scrollEdges.right?i=i-n.offsetWidth+this.actionObj.clone.offsetWidth-(this.actionObj.clone.offsetWidth-this.widthUptoCursorPoint):(i+=this.widthUptoCursorPoint)-this.widthUptoCursorPoint>=n.scrollWidth&&(this.actionObj.clone.style.width=t.formatUnit(this.actionObj.clone.offsetWidth-this.widthUptoCursorPoint+this.actionObj.cellWidth),i=n.scrollLeft-n.scrollWidth),this.actionObj.clone.style.left=t.formatUnit(i)):(this.scrollEdges.left?(e=n.scrollLeft-this.widthUptoCursorPoint+this.actionObj.cellWidth,n.scrollLeft+n.offsetWidth>=n.offsetWidth?n.scrollLeft=n.scrollLeft-1:0===this.actionObj.clone.offsetLeft&&(e=n.scrollLeft)):e=n.scrollLeft+n.offsetWidth-this.actionObj.clone.offsetWidth+(this.actionObj.clone.offsetWidth-this.widthUptoCursorPoint),e=e<0?0:e,this.actionObj.clone.style.left=t.formatUnit(e))}return e},i.prototype.getWidthDiff=function(e,t){var i=this.scrollArgs.element.getBoundingClientRect();if(i.left<=this.actionObj.pageX&&i.right>=this.actionObj.pageX){var n=e.children[t].offsetLeft,r=this.actionObj.pageX-i.left;return this.parent.enableRtl?n+this.actionObj.cellWidth-(this.scrollArgs.element.scrollLeft+r):this.scrollArgs.element.scrollLeft+r-n}return 0},i.prototype.getColumnIndex=function(e){var t=Math.floor(e/this.actionObj.cellWidth);return this.isHeaderRows?t:this.getIndex(t)},i.prototype.getCursorCurrentIndex=function(e,t,i){var n=e+t;if(this.isHeaderRows){var r=Math.floor(i.offsetWidth/this.actionObj.cellWidth);return n>r-1?r-1:n}return n>i.children.length-1?i.children.length-1:n},i.prototype.cursorIndex=function(e,i,n,r){var a=t.closest(e.target,".e-work-cells");if(t.isNullOrUndefined(a)||this.isMorePopupOpened)this.cursorPointIndex=0;else{var s=this.parent.getDateFromElement(a);if(this.isHeaderRows){var o=Math.floor(n/this.actionObj.cellWidth);s=new Date(this.timelineEventModule.dateRender[o+r].getTime())}var l=s.getTime()-i[this.parent.eventFields.startTime].getTime();if(this.isTimelineDayProcess)this.cursorPointIndex=Math.abs(Math.ceil(l/We));else{var c=Math.floor(l/ze/(this.actionObj.slotInterval/this.actionObj.cellWidth));this.cursorPointIndex=Math.floor(c/this.actionObj.cellWidth),this.cursorPointIndex=this.cursorPointIndex<0?0:this.cursorPointIndex}}},i.prototype.calculateResourceGroupingPosition=function(e,i){var n=this.parent.element.querySelector(".e-content-wrap"),r=[].slice.call(this.parent.element.querySelectorAll(".e-content-wrap .e-content-table tr:not(.e-hidden)")),a=d(n.querySelector("table"));a=t.isNullOrUndefined(a)?0:a;var s=this.parent.rowAutoHeight?~~(n.querySelector("table").offsetHeight/r.length):this.actionObj.cellHeight,o=Math.floor(Math.floor(this.actionObj.Y+(n.scrollTop-a-(window.scrollY||window.pageYOffset))-n.getBoundingClientRect().top)/s);o=o<0?0:o>r.length-1?r.length-1:o,this.actionObj.index=o;var l=this.parent.element.querySelectorAll(".e-appointment-container:not(.e-hidden)").item(o),c=l.querySelector(".e-appointment-wrapper");c||(c=t.createElement("div",{className:"e-appointment-wrapper"}),l.appendChild(c)),this.appendCloneElement(c,i);var p=t.closest(this.actionObj.target,"td");this.actionObj.groupIndex=p&&!isNaN(parseInt(p.getAttribute("data-group-index"),10))?parseInt(p.getAttribute("data-group-index"),10):this.actionObj.groupIndex;var h=r[o].getBoundingClientRect().height*o;if(this.parent.rowAutoHeight){var u=this.getCursorElement(e);u&&(h=u.classList.contains("e-work-cells")?u.offsetTop:u.offsetParent.classList.contains("e-appointment")?u.offsetParent.offsetTop:h)}i.style.top=t.formatUnit(h)},i.prototype.appendCloneElement=function(e,i){void 0===i&&(i=null),i=t.isNullOrUndefined(i)?this.actionObj.clone:i;var n=document.querySelector(this.parent.eventDragArea);this.parent.eventDragArea&&n?n.appendChild(i):e.appendChild(i)},i.prototype.getEventWrapper=function(e,i){var n;if(t.isNullOrUndefined(i)&&(i=this.actionObj.clone.classList.contains("e-all-day-appointment")),this.parent.activeViewOptions.timeScale.enable){var r=i?".e-all-day-appointment-wrapper":".e-appointment-wrapper";n=this.parent.element.querySelectorAll(r).item(e)}else{var a=this.parent.element.querySelectorAll(".e-work-cells").item(e);(n=a.querySelector(".e-appointment-wrapper"))||(n=t.createElement("div",{className:"e-appointment-wrapper"}),a.appendChild(n))}return n},i.prototype.getAllDayEventHeight=function(){var e=t.createElement("div",{className:"e-appointment"});this.parent.element.querySelector(".e-all-day-appointment-wrapper").appendChild(e);var i=e.offsetHeight;return t.remove(e),i},i.prototype.isAllowDrop=function(e){if(!this.actionObj.excludeSelectors)return!1;for(var t=!1,i=0,n=this.actionObj.excludeSelectors.split(",");i<n.length;i++){var r=n[i];if(e.target.classList.contains(r)){t=!0;break}}return t},i.prototype.getModuleName=function(){return"dragAndDrop"},i}(Li),Yi=function(){function e(e){this.parent=e}return e.prototype.isTimelineView=function(){return-1!==this.parent.currentView.indexOf("Timeline")},e.prototype.getContentRows=function(){return[]},e.prototype.refreshHeader=function(){},e.prototype.refreshResourceHeader=function(){t.remove(this.element.querySelector("tbody").lastElementChild.firstElementChild);var e=t.createElement("td");e.appendChild(this.parent.resourceBase.createResourceColumn()),t.prepend([e],this.element.querySelector("tbody").lastElementChild),this.parent.notify(Ue,{})},e.prototype.getDayName=function(e){return this.parent.getDayNames("abbreviated")[e.getDay()]},e.prototype.getDate=function(e){return this.parent.globalize.formatDate(e,{format:"d",calendar:this.parent.getCalendarMode()})},e.prototype.getTime=function(e){return this.parent.isAdaptive?"HH:mm"===this.parent.activeViewOptions.timeFormat||"HH.mm"===this.parent.activeViewOptions.timeFormat?this.parent.globalize.formatDate(e,{format:"H",calendar:this.parent.getCalendarMode()}):this.parent.globalize.formatDate(e,{skeleton:"h",calendar:this.parent.getCalendarMode()}):this.parent.getTimeString(e)},e.prototype.getTimelineDate=function(e){return L(this.parent.globalize.formatDate(e,{skeleton:"MMMd",calendar:this.parent.getCalendarMode()})+", "+this.parent.getDayNames("wide")[e.getDay()],"multiple")},e.prototype.createEventTable=function(e){var i=t.createElement("div",{className:"e-event-table"});return t.append(this.getEventRows(e),i),i},e.prototype.getEventRows=function(e){for(var i,n=[],r=0;r<e;r++)i=t.createElement("div",{className:Ze}),this.parent.resourceBase&&!this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.renderedResources&&i.setAttribute("data-group-index",this.parent.resourceBase.renderedResources[r].groupIndex.toString()),n.push(i);return n},e.prototype.collapseRows=function(e){this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(this.parent.resourceBase.hideResourceRows(e.querySelector("tbody")),this.parent.resourceBase.hideResourceRows(e.querySelector(".e-event-table")))},e.prototype.createTableLayout=function(e){var i=e||"",n=t.createElement("table",{className:"e-schedule-table "+i,attrs:{role:"table"}}),r=t.createElement("tbody");return n.appendChild(r),n},e.prototype.createColGroup=function(e,i){var n=i.length;i[0]&&i[0].colSpan&&(n=i.map(function(e){return e.colSpan}).reduce(function(e,t){return e+t}));for(var r=t.createElement("colgroup"),a=0;a<n;a++)r.appendChild(t.createElement("col"));t.prepend([r],e)},e.prototype.getScrollXIndent=function(e){return e.offsetHeight-e.clientHeight>0?k():0},e.prototype.scrollTopPanel=function(e){this.getDatesHeaderElement().firstElementChild.scrollLeft=e.scrollLeft},e.prototype.scrollHeaderLabels=function(e){for(var i=this.element.querySelector(".e-date-header-wrap table"),n=i.offsetWidth/i.querySelectorAll("colgroup col").length,r=0,a=[".e-header-year-cell",".e-header-month-cell",".e-header-week-cell",".e-header-cells"];r<a.length;r++){var s=a[r],o=[].slice.call(this.element.querySelectorAll(s));if(o.length>0){for(var l=0,c=o;l<c.length;l++)c[l].children[0].style[this.parent.enableRtl?"right":"left"]="";!function(i,r){for(var a,s=0,o=0,l=r?-e.scrollLeft:e.scrollLeft,c=0,p=i;c<p.length;c++){var h=p[c];if((o+=parseInt(h.getAttribute("colSpan"),10))>Math.floor(l/n)){a=h;break}s+=h.offsetWidth}t.isNullOrUndefined(a)||(a.children[0].style[r?"right":"left"]=l-s+"px")}(o,this.parent.enableRtl)}}},e.prototype.addAttributes=function(e,i){e.template&&t.append(e.template,i),e.colSpan&&i.setAttribute("colspan",e.colSpan.toString()),e.className&&t.addClass([i],e.className)},e.prototype.getHeaderBarHeight=function(){var e=2;if(this.parent.headerModule&&(e+=R(this.parent.headerModule.getHeaderElement())),this.parent.uiStateValues.isGroupAdaptive){var t=this.parent.element.querySelector(".e-schedule-resource-toolbar");t&&(e+=t.offsetHeight)}return e},e.prototype.renderPanel=function(e){"e-previous-panel"===e?t.prepend([this.element],this.parent.element.querySelector("."+Xe)):this.parent.element.querySelector("."+Xe).appendChild(this.element)},e.prototype.setPanel=function(e){this.element=e},e.prototype.getPanel=function(){return this.element},e.prototype.getDatesHeaderElement=function(){return this.element.querySelector(".e-date-header-container")},e.prototype.getDateSlots=function(e,t){return[]},e.prototype.generateColumnLevels=function(){return[]},e.prototype.getColumnLevels=function(){return this.colLevels},e.prototype.highlightCurrentTime=function(){},e.prototype.startDate=function(){return this.renderDates[0]},e.prototype.endDate=function(){return C(this.renderDates[this.renderDates.length-1],1)},e.prototype.getStartHour=function(){var e=this.parent.getStartEndTime(this.parent.activeViewOptions.startHour);return t.isNullOrUndefined(e)&&(e=new Date(2e3,0,0,0)),e},e.prototype.getEndHour=function(){var e=this.parent.getStartEndTime(this.parent.activeViewOptions.endHour);return t.isNullOrUndefined(e)&&(e=new Date(2e3,0,0,0)),e},e.prototype.isCurrentDate=function(e){return e.setHours(0,0,0,0)===this.parent.getCurrentTime().setHours(0,0,0,0)},e.prototype.isCurrentMonth=function(e){return this.parent.activeViewOptions.displayDate||this.parent.activeViewOptions.numberOfWeeks>0?this.parent.activeView.getStartDate().getTime()<=this.parent.getCurrentTime().getTime()&&this.parent.activeView.getEndDate().getTime()>=this.parent.getCurrentTime().getTime():e.getFullYear()===this.parent.getCurrentTime().getFullYear()&&e.getMonth()===this.parent.getCurrentTime().getMonth()},e.prototype.isWorkDay=function(e,t){return void 0===t&&(t=this.parent.activeViewOptions.workDays),t.indexOf(e.getDay())>=0},e.prototype.isWorkHour=function(e,i,n,r){return!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(n)&&(i.setMilliseconds(0),n.setMilliseconds(0),!(D(e)<D(i)||D(e)>=D(n)||!this.isWorkDay(e,r)))},e.prototype.getRenderDates=function(e){var t=[];if("Week"===this.parent.currentView||"TimelineWeek"===this.parent.currentView)for(var i=u(w(this.parent.selectedDate),this.parent.activeViewOptions.firstDayOfWeek),n=0,r=7*this.parent.activeViewOptions.interval;n<r;n++)this.parent.activeViewOptions.showWeekend?t.push(i):this.isWorkDay(i,e)&&t.push(i),i=C(i,1);else if("WorkWeek"===this.parent.currentView||"TimelineWorkWeek"===this.parent.currentView)for(var i=u(w(this.parent.selectedDate),this.parent.activeViewOptions.firstDayOfWeek),n=0,a=7*this.parent.activeViewOptions.interval;n<a;n++)this.isWorkDay(i,e)&&t.push(i),i=C(i,1);else{var s="Agenda"===this.parent.currentView?this.parent.agendaDaysCount:this.parent.activeViewOptions.interval,i=w(this.parent.selectedDate);do{this.parent.activeViewOptions.showWeekend?t.push(i):this.isWorkDay(i,e)&&t.push(i),i=C(i,1)}while(s!==t.length)}return e||(this.renderDates=t),this.parent.headerModule&&this.parent.headerModule.previousNextIconHandler(),t},e.prototype.getNextPreviousDate=function(e){if("Day"===this.parent.currentView||"TimelineDay"===this.parent.currentView){if(this.parent.activeViewOptions.showWeekend){var t=this.parent.activeViewOptions.interval;return C(this.parent.selectedDate,"next"===e?t:-t)}var i=void 0;if("next"===e)for(i=C(this.renderDates.slice(-1)[0],1);!this.isWorkDay(i);)i=C(i,1);else{i=C(this.renderDates[0],-1);var n=0;do{this.isWorkDay(i)&&(n+=1),this.parent.activeViewOptions.interval!==n&&(i=C(i,-1))}while(this.parent.activeViewOptions.interval!==n)}return i}var r="next"===e?7:-7;return C(this.parent.selectedDate,r*this.parent.activeViewOptions.interval)},e.prototype.getLabelText=function(e){var t=e.charAt(0).toLowerCase()+e.substring(1);return this.parent.localeObj.getConstant(t)+" of "+L(this.parent.globalize.formatDate(this.parent.selectedDate,{skeleton:"long",calendar:this.parent.getCalendarMode()}),"single")},e.prototype.getDateRangeText=function(){if(this.parent.isAdaptive){var e=this.parent.activeViewOptions.dateFormat?this.parent.activeViewOptions.dateFormat:"MMMM y";return L(this.parent.globalize.formatDate(this.parent.selectedDate,{format:e,calendar:this.parent.getCalendarMode()}),"single")}return this.formatDateRange(this.renderDates[0],this.renderDates[this.renderDates.length-1])},e.prototype.formatDateRange=function(e,i){var n=this.parent.globalize,r=this.parent.getCalendarMode();if(e===i&&(i=null),!t.isNullOrUndefined(this.parent.activeViewOptions.dateFormat)){var a="";return i?(a=n.formatDate(e,{format:this.parent.activeViewOptions.dateFormat,calendar:r})+" - "+n.formatDate(i,{format:this.parent.activeViewOptions.dateFormat,calendar:r}),L(a,"multiple")):(a=n.formatDate(e,{format:this.parent.activeViewOptions.dateFormat,calendar:r}),L(a,"multiple"))}var s,o;if(o="en"===this.parent.locale||"en-US"===this.parent.locale?t.getValue("dateFormats.long",t.getDefaultDateObject(r)):t.getValue("main."+this.parent.locale+".dates.calendars."+r+".dateFormats.long",t.cldrData),!i)return L(n.formatDate(e,{format:o,calendar:r}),"single");var l=o.trim().toLocaleLowerCase();return s="d"===l.substr(0,1)?e.getFullYear()===i.getFullYear()?e.getMonth()===i.getMonth()?n.formatDate(e,{format:"dd",calendar:r})+" - "+n.formatDate(i,{format:"dd MMMM yyyy",calendar:r}):n.formatDate(e,{format:"dd MMM",calendar:r})+" - "+n.formatDate(i,{format:"dd MMM yyyy",calendar:r}):n.formatDate(e,{format:"dd MMM yyyy",calendar:r})+" - "+n.formatDate(i,{format:"dd MMM yyyy",calendar:r}):"m"===l.substr(0,1)?e.getFullYear()===i.getFullYear()?e.getMonth()===i.getMonth()?n.formatDate(e,{format:"MMMM dd",calendar:r})+" - "+n.formatDate(i,{format:"dd, yyyy",calendar:r}):n.formatDate(e,{format:"MMM dd",calendar:r})+" - "+n.formatDate(i,{format:"MMM dd, yyyy",calendar:r}):n.formatDate(e,{format:"MMM dd, yyyy",calendar:r})+" - "+n.formatDate(i,{format:"MMM dd, yyyy",calendar:r}):n.formatDate(e,{format:o,calendar:r})+" - "+n.formatDate(i,{format:o,calendar:r}),L(s,"multiple")},e.prototype.getMobileDateElement=function(e,i){return t.createElement("div",{className:i,innerHTML:'<div class="e-m-date">'+this.parent.globalize.formatDate(e,{format:"d",calendar:this.parent.getCalendarMode()})+'</div><div class="e-m-day">'+L(this.parent.globalize.formatDate(e,{format:"E",calendar:this.parent.getCalendarMode()}),"single")+"</div>"})},e.prototype.setResourceHeaderContent=function(e,i,n){if(void 0===n&&(n=Je),this.parent.activeViewOptions.resourceHeaderTemplate){var r={resource:i.resource,resourceData:i.resourceData},a=this.parent.element.id+"_"+this.parent.activeViewOptions.resourceHeaderTemplateName+"resourceHeaderTemplate",s=[].slice.call(this.parent.getResourceHeaderTemplate()(r,this.parent,"resourceHeaderTemplate",a,!1));t.append(s,e)}else e.appendChild(t.createElement("div",{className:n,innerHTML:i.resourceData[i.resource.textField]}))},e.prototype.renderResourceMobileLayout=function(){this.parent.resourceBase.lastResourceLevel&&this.parent.resourceBase.lastResourceLevel.length<=0||(this.parent.resourceBase.renderResourceHeader(),this.parent.resourceBase.renderResourceTree())},e.prototype.addAutoHeightClass=function(e){!this.parent.uiStateValues.isGroupAdaptive&&this.parent.rowAutoHeight&&this.isTimelineView()&&this.parent.activeViewOptions.group.resources.length>0&&t.addClass([e],"e-auto-height")},e.prototype.getColElements=function(){return[].slice.call(this.element.querySelectorAll(".e-content-wrap col, .e-date-header-wrap col"))},e.prototype.setColWidth=function(e){if(this.isTimelineView()){var i=this.getColElements(),n=this.element.querySelector("."+Qe+" tbody").getBoundingClientRect().width/(i.length/2);if(i.forEach(function(e){return t.setStyleAttribute(e,{width:t.formatUnit(n)})}),e.offsetHeight!==e.clientHeight){var r=this.parent.element.querySelector(".e-resource-column-wrap");t.isNullOrUndefined(r)||t.setStyleAttribute(r,{height:t.formatUnit(e.clientHeight)})}[].slice.call(this.element.querySelectorAll(".e-header-cells,.e-time-slots,.e-header-week-cell,.e-header-month-cell,.e-header-year-cell")).forEach(function(e){var i=t.isNullOrUndefined(e.getAttribute("colspan"))?"1":e.getAttribute("colspan"),r=parseInt(i,10);t.setStyleAttribute(e,{width:t.formatUnit(n*r)})})}},e.prototype.resetColWidth=function(){for(var e=0,t=this.getColElements();e<t.length;e++)t[e].style.width=""},e.prototype.getContentAreaElement=function(){return this.element.querySelector(".e-content-wrap")},e.prototype.wireExpandCollapseIconEvents=function(){if(this.parent.resourceBase&&this.parent.resourceBase.resourceCollection.length>1)for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-resource-tree-icon"));e<i.length;e++){var n=i[e];t.EventHandler.clearEvents(n),t.EventHandler.add(n,"click",this.parent.resourceBase.onTreeIconClick,this.parent.resourceBase)}},e.prototype.scrollToDate=function(e){if(-1!==["Month","TimelineMonth"].indexOf(this.parent.currentView)&&!t.isNullOrUndefined(e)){var i=this.getContentAreaElement(),n=new Date(w(new Date(+e)).getTime()).getTime(),r=i.querySelector('.e-work-cells[data-date="'+n+'"]');"Month"===this.parent.currentView&&r&&(i.scrollTop=r.offsetTop),"TimelineMonth"===this.parent.currentView&&r&&(this.parent.enableRtl?i.scrollLeft=-(this.parent.getContentTable().offsetWidth-r.offsetLeft-r.offsetWidth):i.scrollLeft=r.offsetLeft)}},e.prototype.setPersistence=function(){if(this.parent.enablePersistence){var e=this.element.querySelector(".e-content-wrap");t.isNullOrUndefined(e)||(this.parent.scrollLeft=e.scrollLeft,this.parent.scrollTop=e.scrollTop)}},e.prototype.retainScrollPosition=function(){if(this.parent.enablePersistence){var e=this.parent.element.querySelector(".e-content-wrap");t.isNullOrUndefined(e)||t.isNullOrUndefined(this.parent.scrollLeft)||t.isNullOrUndefined(this.parent.scrollTop)||(e.scrollTop=this.parent.scrollTop,e.scrollLeft=this.parent.scrollLeft)}},e.prototype.getViewStartDate=function(){var e=this.renderDates[0];return this.parent.activeViewOptions.group.resources.length>0&&this.parent.resourceBase.lastResourceLevel.length>0&&(e=this.parent.resourceBase.getResourceRenderDates()[0]),e},e.prototype.getViewEndDate=function(){var e=C(this.renderDates[this.renderDates.length-1],1);return this.parent.activeViewOptions.group.resources.length>0&&this.parent.resourceBase.lastResourceLevel.length>0&&(e=C(this.parent.resourceBase.getResourceRenderDates().slice(-1)[0],1)),e},e.prototype.destroy=function(){this.element&&this.element.parentNode&&t.remove(this.element),this.element=null,this.renderDates=null,this.colLevels=null},e}(),_i=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Gi=function(e){function i(t){var i=e.call(this,t)||this;return i.viewClass="e-day-view",i.isInverseTableSelect=!0,i.baseCssClass="e-vertical-view",i.appointment=null,i}return _i(i,e),i.prototype.getModuleName=function(){return"verticalView"},i.prototype.addEventListener=function(){this.parent.on(Be,this.scrollUiUpdate,this),this.parent.on(Fe,this.renderEvents,this)},i.prototype.removeEventListener=function(){this.parent&&(this.parent.off(Be,this.scrollUiUpdate),this.parent.off(Fe,this.renderEvents))},i.prototype.renderEvents=function(){this.appointment=this.parent.activeViewOptions.timeScale.enable?new Vt(this.parent):new Mt(this.parent),this.appointment.renderAppointments(),this.parent.notify("events-loaded",{})},i.prototype.onContentScroll=function(e){this.parent.removeNewEventElement();var i=e.target;this.parent.notify("virtual-scroll",e),this.scrollLeftPanel(i),this.scrollTopPanel(i),this.parent.isAdaptive||(this.parent.uiStateValues.top=i.scrollTop),this.parent.uiStateValues.left=i.scrollLeft,t.isNullOrUndefined(this.parent.quickPopup)||this.parent.quickPopup.quickPopupHide(),this.setPersistence()},i.prototype.onAdaptiveMove=function(e){this.parent.uiStateValues.action&&e.preventDefault()},i.prototype.onAdaptiveScroll=function(e){this.parent&&!this.parent.isDestroyed&&(this.parent.removeNewEventElement(),this.parent.uiStateValues.top=e.target.scrollTop)},i.prototype.scrollLeftPanel=function(e){var i=this.getLeftPanelElement();t.isNullOrUndefined(i)||(i.scrollTop=e.scrollTop)},i.prototype.scrollUiUpdate=function(e){if(this.parent){var t=this.parent.element.querySelector(".e-date-header-wrap"),i=this.getHeaderBarHeight(),n=this.getLeftPanelElement(),r=this.getScrollableElement(),a=this.getDatesHeaderElement(),s=this.parent.element.offsetHeight-i-a.offsetHeight;this.setColWidth(r),this.setContentHeight(r,n,s);var o=k();a.firstElementChild.style[e.cssProperties.rtlBorder]="",a.style[e.cssProperties.rtlPadding]="";var l=!this.parent.enableAllDayScroll||!(r.offsetWidth-r.clientWidth<=t.offsetWidth-t.clientWidth&&t.classList.contains("e-all-day-scroll"));r.offsetWidth-r.clientWidth>0&&l?(a.firstElementChild.style[e.cssProperties.border]=o>0?"1px":"0px",a.style[e.cssProperties.padding]=o>0?o-1+"px":"0px"):(a.firstElementChild.style[e.cssProperties.border]="",a.style[e.cssProperties.padding]=""),e.isPreventScrollUpdate||(this.parent.uiStateValues.isInitial?(this.scrollToWorkHour(),this.parent.uiStateValues.isInitial=!1):(n&&(n.scrollTop=this.parent.uiStateValues.top),r.scrollTop=this.parent.uiStateValues.top,r.scrollLeft=this.parent.uiStateValues.left)),this.parent.activeViewOptions.timeScale.enable&&this.highlightCurrentTime(),this.retainScrollPosition()}},i.prototype.setContentHeight=function(e,i,n){this.parent.isAdaptive&&!this.isTimelineView()?e.style.height="auto"===this.parent.height?"auto":t.formatUnit(n):(t.isNullOrUndefined(i)||(i.style.height="auto"===this.parent.height?"auto":t.formatUnit(n-this.getScrollXIndent(e))),e.style.height="auto"===this.parent.height?"auto":t.formatUnit(n))},i.prototype.scrollToWorkHour=function(){if(this.parent.workHours.highlight){var e=this.element.querySelector(".e-work-hours");e&&(this.getScrollableElement().scrollTop=e.offsetTop,this.parent.uiStateValues.top=e.offsetTop,this.parent.uiStateValues.left=0)}},i.prototype.scrollToHour=function(e,i){var n=this.parent.getStartEndTime(e);!t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)&&(this.getScrollableElement().scrollTop=this.getTopFromDateTime(n))},i.prototype.generateColumnLevels=function(){var e=this.getDateSlots(this.renderDates,this.parent.activeViewOptions.workDays),t=[];if(this.parent.activeViewOptions.group.resources.length>0){if(t=this.parent.resourceBase.generateResourceLevels(e),this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.lastResourceLevel.length>0){var i=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex],n=i.resourceData[i.resource.startHourField],r=i.resourceData[i.resource.endHourField];t=[this.getDateSlots(i.renderDates,i.workDays,n,r)]}}else t.push(e);return this.colLevels=t,t},i.prototype.getDateSlots=function(e,t,i,n){void 0===i&&(i=this.parent.workHours.start),void 0===n&&(n=this.parent.workHours.end);for(var r=[],a=this.parent.getStartEndTime(i),s=this.parent.getStartEndTime(n),o=0,l=e;o<l.length;o++){var c=l[o],p=["e-header-cells"];this.isCurrentDate(c)&&p.push("e-current-day"),r.push({date:c,type:"dateHeader",className:p,colSpan:1,workDays:t,startHour:new Date(+a),endHour:new Date(+s)})}return r},i.prototype.isWorkHourRange=function(e){return this.getStartHour().getTime()<=e.getTime()&&this.getEndHour().getTime()>=e.getTime()},i.prototype.highlightCurrentTime=function(){var e=this;if(!(this.parent.activeViewOptions.headerRows.length>0&&"Hour"!==this.parent.activeViewOptions.headerRows.slice(-1)[0].option))if(this.parent.showTimeIndicator&&this.isWorkHourRange(this.parent.getCurrentTime()))if(this.getCurrentTimeIndicatorIndex().length>0){if([].slice.call(this.element.querySelectorAll(".e-work-cells")).length>0&&this.changeCurrentTimePosition(),t.isNullOrUndefined(this.currentTimeIndicatorTimer)){var i=this.parent.getCurrentTime(),n=ze-(1e3*i.getSeconds()+i.getMilliseconds());n<=ze-1e3&&window.setTimeout(function(){t.isNullOrUndefined(e.currentTimeIndicatorTimer)||(e.clearCurrentTimeIndicatorTimer(),e.changeCurrentTimePosition(),e.updateCurrentTimeIndicatorTimer())},n),this.updateCurrentTimeIndicatorTimer()}}else this.clearCurrentTimeIndicatorTimer();else this.clearCurrentTimeIndicatorTimer()},i.prototype.getCurrentTimeIndicatorIndex=function(){var e=[];if(!t.isNullOrUndefined(this.parent.resourceBase)&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive)for(var i=0,n=0,r=this.parent.resourceBase.lastResourceLevel;n<r.length;n++){var a=r[n];if((l=this.parent.getIndexOfDate(a.renderDates,w(this.parent.getCurrentTime())))>=0){var s=this.parent.activeViewOptions.group.byDate?this.parent.resourceBase.lastResourceLevel.length*l+i:i+l;e.push(s)}i+=this.parent.activeViewOptions.group.byDate?1:a.renderDates.length}else{var o=this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.lastResourceLevel.length>0?this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex].renderDates:this.renderDates,l=this.parent.getIndexOfDate(o,w(this.parent.getCurrentTime()));l>=0&&e.push(l)}return e},i.prototype.clearCurrentTimeIndicatorTimer=function(){t.isNullOrUndefined(this.currentTimeIndicatorTimer)||(window.clearInterval(this.currentTimeIndicatorTimer),this.currentTimeIndicatorTimer=null,this.removeCurrentTimeIndicatorElements())},i.prototype.updateCurrentTimeIndicatorTimer=function(){var e=this;this.currentTimeIndicatorTimer=window.setInterval(function(){e.changeCurrentTimePosition()},ze)},i.prototype.removeCurrentTimeIndicatorElements=function(){for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-previous-timeline,.e-current-timeline,.e-current-time"));e<i.length;e++){var n=i[e];t.remove(n)}},i.prototype.changeCurrentTimePosition=function(){if(!(!this.parent||this.parent&&this.parent.isDestroyed)){this.removeCurrentTimeIndicatorElements();var e=this.getCurrentTimeIndicatorIndex(),i=this.parent.getContentTable().rows[0],n=this.getTopFromDateTime(this.parent.getCurrentTime()),r=t.formatUnit(n),a=Math.floor(n/i.cells[0].offsetHeight),s=this.getLeftPanelElement(),o=[].slice.call(s.querySelectorAll("tr"));if(!t.isNullOrUndefined(a)&&!isNaN(a)&&a!==o.length){for(var l=[].slice.call(this.element.querySelectorAll(".e-timeline-wrapper")),c=0,p=e[0];c<p;c++)l[c].appendChild(t.createElement("div",{className:"e-previous-timeline",styles:"top:"+r}));for(var h=0,d=e;h<d.length;h++)l[d[h]].appendChild(t.createElement("div",{className:"e-current-timeline",styles:"top:"+r}));var u=t.createElement("div",{innerHTML:this.parent.getTimeString(this.parent.getCurrentTime()),className:"e-current-time",styles:"top:"+r});a<=o.length&&(t.removeClass(s.querySelectorAll(".e-hide-childs"),"e-hide-childs"),o[a]&&t.addClass([o[a].lastElementChild],"e-hide-childs"),t.prepend([u],s),u.style.top=t.formatUnit(u.offsetTop-u.offsetHeight/2))}}},i.prototype.getTopFromDateTime=function(e){var t=this.getStartHour();return(60*(e.getHours()-t.getHours())+(e.getMinutes()-t.getMinutes()))*this.getWorkCellHeight()*this.parent.activeViewOptions.timeScale.slotCount/this.parent.activeViewOptions.timeScale.interval},i.prototype.getWorkCellHeight=function(){return parseFloat(this.element.querySelector(".e-work-cells").getBoundingClientRect().height.toFixed(2))},i.prototype.getTdContent=function(e,i,n){var r,a=t.createElement("div"),s="",o=this.parent.element.id+"_";switch(i){case"dateHeader":if(this.parent.activeViewOptions.dateHeaderTemplate){s="dateHeaderTemplate";var l={date:e,type:i},c=this.parent.activeViewOptions.dateHeaderTemplateName;r=[].slice.call(this.parent.getDateHeaderTemplate()(l,this.parent,s,o+c+s,!1))}else a.innerHTML=this.parent.activeView.isTimelineView()?'<span class="e-header-date e-navigate">'+this.getTimelineDate(e)+"</span>":'<div class="e-header-day">'+L(this.getDayName(e),"single")+'</div><div class="e-header-date e-navigate" role="link">'+this.getDate(e)+"</div>",r=[].slice.call(a.childNodes);break;case"majorSlot":if(this.parent.activeViewOptions.timeScale.majorSlotTemplate){s="majorSlotTemplate";l={date:e,type:i};r=[].slice.call(this.parent.getMajorSlotTemplate()(l,this.parent,s,o+s,!1))}else a.innerHTML="<span>"+this.getTime(e)+"</span>",r=[].slice.call(a.childNodes);break;case"minorSlot":if(this.parent.activeViewOptions.timeScale.minorSlotTemplate){s="minorSlotTemplate";l={date:e,type:i};r=[].slice.call(this.parent.getMinorSlotTemplate()(l,this.parent,s,o+s,!1))}else r=[].slice.call(a.childNodes);break;case"alldayCells":if(this.parent.activeViewOptions.cellTemplate){c=this.parent.activeViewOptions.cellTemplateName;s="cellTemplate";l={date:e,type:i,groupIndex:n};r=[].slice.call(this.parent.getCellTemplate()(l,this.parent,s,o+c+s,!1))}}return r},i.prototype.refreshHeader=function(){t.remove(this.element.querySelector("tbody tr")),this.renderHeader(),this.parent.notify(Ue,{})},i.prototype.renderLayout=function(e){this.setPanel(t.createElement("div",{className:"e-table-wrap"}));var i=[this.baseCssClass,this.viewClass];i.push(e),this.parent.activeViewOptions.group.byDate&&i.push("e-by-date"),this.parent.activeViewOptions.timeScale.enable||t.addClass([this.element],["e-timescale-disable",this.viewClass]),this.parent.activeViewOptions.allowVirtualScrolling&&i.push("e-virtual-scroll"),this.parent.rowAutoHeight&&this.parent.eventSettings.ignoreWhitespace&&i.push("e-ignore-whitespace"),this.renderPanel(e),t.addClass([this.element],i),this.element.appendChild(this.createTableLayout("e-outer-table")),this.element.querySelector("table").setAttribute("role","presentation"),this.colLevels=this.generateColumnLevels(),this.renderHeader(),this.renderContent(),this.parent.uiStateValues.isGroupAdaptive&&!this.parent.element.querySelector(".e-schedule-resource-toolbar-container")&&this.renderResourceMobileLayout(),this.parent.notify(Ue,{})},i.prototype.renderHeader=function(){var e=t.createElement("tr"),i=t.createElement("td");if(i.appendChild(this.renderDatesHeader()),this.parent.activeViewOptions.timeScale.enable){var n=t.createElement("td",{className:"e-left-indent"});n.appendChild(this.renderLeftIndent()),e.appendChild(n)}e.appendChild(i),t.prepend([e],this.element.querySelector("tbody"))},i.prototype.renderContent=function(){var e=t.createElement("tr"),i=t.createElement("td");if(this.parent.isAdaptive){i.setAttribute("colspan",this.parent.activeViewOptions.timeScale.enable?"2":"1");var n=t.createElement("div",{className:"e-scroll-container"});this.parent.activeViewOptions.timeScale.enable&&n.appendChild(this.renderTimeCells()),n.appendChild(this.renderContentArea()),i.appendChild(n),t.EventHandler.add(n,"scroll",this.onAdaptiveScroll,this),t.EventHandler.add(n,t.Browser.touchMoveEvent,this.onAdaptiveMove,this),e.appendChild(i)}else{if(i.appendChild(this.renderContentArea()),this.parent.activeViewOptions.timeScale.enable){var r=t.createElement("td");r.appendChild(this.renderTimeCells()),e.appendChild(r)}e.appendChild(i)}this.element.querySelector("tbody").appendChild(e)},i.prototype.renderLeftIndent=function(){for(var e,i=t.createElement("div",{className:"e-left-indent-wrap"}),n=this.createTableLayout(),r=t.createElement("tr"),a=this.colLevels.length,s=0;s<a;s++){var o=r.cloneNode(),l={className:[this.colLevels[s][0]&&this.colLevels[s][0].className[0]],type:"emptyCells"};if(this.parent.activeViewOptions.showWeekNumber&&-1!==l.className.indexOf("e-header-cells")){l.className.push("e-week-number");var c=this.parent.getWeekNumberContent(this.renderDates);l.template=[t.createElement("span",{innerHTML:""+c,attrs:{title:this.parent.localeObj.getConstant("week")+" "+c}})]}e=this.createTd(l),this.parent.renderHeaderIndentTemplate(l,e),o.appendChild(e),n.querySelector("tbody").appendChild(o)}var p=r.cloneNode(),h=t.createElement("div",{attrs:{tabindex:"0",role:"list",title:this.parent.localeObj.getConstant("expandAllDaySection"),"aria-disabled":"false","aria-label":"Expand section"},className:"e-all-day-appointment-section e-appointment-expand e-icons e-disable"}),d={className:["e-all-day-cells"],type:"emptyCells"};return(e=this.createTd(d)).appendChild(h),this.parent.renderHeaderIndentTemplate(d,e),p.appendChild(e),n.querySelector("tbody").appendChild(p),i.appendChild(n),i},i.prototype.renderDatesHeader=function(){var e=t.createElement("div",{className:"e-date-header-container"}),i=t.createElement("div",{className:"e-date-header-wrap"});e.appendChild(i);for(var n=this.createTableLayout(),r=t.createElement("tr"),a=this.colLevels.length,s=this.colLevels[a-1],o=0;o<a;o++){var l=r.cloneNode();t.addClass([l],"e-header-row");for(var c=this.colLevels[o],p=0;p<c.length;p++)l.appendChild(this.createTd(c[p]));n.querySelector("tbody").appendChild(l)}return this.createAllDayRow(n,s),this.createColGroup(n,s),i.appendChild(n),e},i.prototype.createAllDayRow=function(e,i){var n=t.createElement("tr");t.addClass([n],"e-all-day-row");for(var r=0;r<i.length;r++){var a=t.extend({},i[r]);a.className=["e-all-day-cells"],a.type="alldayCells";var s=this.createTd(a);s.setAttribute("data-date",a.date.getTime().toString()),t.isNullOrUndefined(a.groupIndex)?this.parent.uiStateValues.isGroupAdaptive&&s.setAttribute("data-group-index",""+this.parent.uiStateValues.groupIndex):s.setAttribute("data-group-index",""+a.groupIndex),this.wireCellEvents(s),n.appendChild(s)}e.querySelector("tbody").appendChild(n);var o=t.createElement("thead");o.appendChild(this.createEventWrapper("allDay")),t.prepend([o],e)},i.prototype.createTd=function(e){var i=t.createElement("td");if(this.addAttributes(e,i),e.date&&e.type){var n=this.getTdContent(e.date,e.type,e.groupIndex);n&&n.length&&t.append(n,i)}this.parent.isMinMaxDate(w(new Date(""+e.date)))||t.addClass([i],"e-disable-dates"),"resourceHeader"===e.type&&this.setResourceHeaderContent(i,e),"dateHeader"===e.type&&e.className.indexOf("e-header-cells")>=0&&(i.setAttribute("data-date",e.date.getTime().toString()),t.isNullOrUndefined(e.groupIndex)||i.setAttribute("data-group-index",""+e.groupIndex),this.wireMouseEvents(i));var r={elementType:e.type,element:i,date:e.date,groupIndex:e.groupIndex};return this.parent.trigger(Le,r),i},i.prototype.wireCellEvents=function(e){t.EventHandler.add(e,"mousedown",this.parent.workCellAction.cellMouseDown,this.parent.workCellAction),this.wireMouseEvents(e)},i.prototype.wireMouseEvents=function(e){t.EventHandler.add(e,"click",this.parent.workCellAction.cellClick,this.parent.workCellAction),this.parent.isAdaptive||t.EventHandler.add(e,"dblclick",this.parent.workCellAction.cellDblClick,this.parent.workCellAction)},i.prototype.renderTimeCells=function(){var e=this,i=t.createElement("div",{className:"e-time-cells-wrap"}),n=this.createTableLayout(),r=t.createElement("tr"),a=function(t){t.type=t.first?"majorSlot":"minorSlot",t.className=t.last?["e-time-cells","e-time-slots"]:["e-time-slots"];var i=r.cloneNode(),a={date:t.date,type:t.type,className:t.className};return i.appendChild(e.createTd(a)),n.querySelector("tbody").appendChild(i),t};return this.getTimeSlotRows(a),i.appendChild(n),i},i.prototype.renderContentArea=function(){var e=t.createElement("div",{className:"e-content-wrap"}),i=this.createTableLayout(Qe);return this.addAutoHeightClass(i),this.renderContentTable(i),this.createColGroup(i,this.colLevels.slice(-1)[0]),e.appendChild(i),this.wireCellEvents(i.querySelector("tbody")),t.EventHandler.add(e,"scroll",this.onContentScroll,this),t.EventHandler.add(e,t.Browser.touchMoveEvent,this.onAdaptiveMove,this),e},i.prototype.renderContentTable=function(e){var i=this,n=t.createElement("tr",{attrs:{role:"row"}}),r=t.createElement("td",{attrs:{role:"gridcell","aria-selected":"false"}}),a=e.querySelector("tbody"),s=function(e){for(var t=n.cloneNode(),s=0,o=i.colLevels[i.colLevels.length-1];s<o.length;s++){var l=o[s],c=i.createContentTd(l,e,r);t.appendChild(c)}return a.appendChild(t),e};this.getTimeSlotRows(s),this.renderContentTableHeader(e)},i.prototype.createContentTd=function(e,i,n){var r=n.cloneNode();e.colSpan&&r.setAttribute("colspan",e.colSpan.toString());var a=this.getContentTdClass(i),s=w(e.date);this.parent.isMinMaxDate(s)||a.push("e-disable-dates"),T(s,D(i.date));var o="workCells";if(-1!==e.className.indexOf("e-parent-node")&&(a.push("e-resource-group-cells"),o="resourceGroupCells"),this.parent.workHours.highlight&&(this.parent.activeViewOptions.timeScale.enable&&this.isWorkHour(s,e.startHour,e.endHour,e.workDays)||!this.parent.activeViewOptions.timeScale.enable&&this.isWorkDay(s,e.workDays))&&a.push("e-work-hours"),t.addClass([r],a),this.parent.activeViewOptions.cellTemplate){var l={date:s,type:o,groupIndex:e.groupIndex},c=this.parent.element.id+"_"+this.parent.activeViewOptions.cellTemplateName+"cellTemplate",p=[].slice.call(this.parent.getCellTemplate()(l,this.parent,"cellTemplate",c,!1));t.append(p,r)}if(r.setAttribute("data-date",s.getTime().toString()),!t.isNullOrUndefined(e.groupIndex)||this.parent.uiStateValues.isGroupAdaptive){var h=this.parent.uiStateValues.isGroupAdaptive?this.parent.uiStateValues.groupIndex:e.groupIndex;r.setAttribute("data-group-index",""+h)}var d={elementType:o,element:r,date:s,groupIndex:e.groupIndex};return this.parent.trigger(Le,d),r},i.prototype.getContentTdClass=function(e){return e.last?["e-work-cells"]:["e-work-cells","e-alternate-cells"]},i.prototype.renderContentTableHeader=function(e){var i=t.createElement("thead");i.appendChild(this.createEventWrapper()),this.parent.activeViewOptions.timeScale.enable&&i.appendChild(this.createEventWrapper("timeIndicator")),t.prepend([i],e)},i.prototype.createEventWrapper=function(e){void 0===e&&(e="");for(var i=t.createElement("tr"),n=this.colLevels.slice(-1)[0],r=0,a=n.length;r<a;r++){var s=n[r],o=t.createElement("td",{className:"allDay"===e?"e-all-day-appointment-wrapper":"timeIndicator"===e?"e-timeline-wrapper":"e-day-wrapper",attrs:{"data-date":s.date.getTime().toString()}});if(t.isNullOrUndefined(s.groupIndex)||o.setAttribute("data-group-index",s.groupIndex.toString()),""===e){var l=t.createElement("div",{id:"e-appointment-wrapper-"+r.toString(),className:"e-appointment-wrapper"});o.appendChild(l)}i.appendChild(o)}return i},i.prototype.getScrollableElement=function(){return this.parent.isAdaptive&&!this.isTimelineView()?this.element.querySelector(".e-scroll-container"):this.getContentAreaElement()},i.prototype.getLeftPanelElement=function(){return this.element.querySelector(".e-time-cells-wrap")},i.prototype.getEndDateFromStartDate=function(e){var t=this.parent.activeViewOptions.timeScale.interval*ze/this.parent.activeViewOptions.timeScale.slotCount,i=new Date(e.getTime());return i.setMilliseconds(i.getMilliseconds()+t),i},i.prototype.getTimeSlotRows=function(e){var t=[],i=this.getStartHour(),n=this.getEndHour(),r=this.parent.activeViewOptions.timeScale.interval*ze,a=r/this.parent.activeViewOptions.timeScale.slotCount,s=Math.round(We/a),o=i.getTime(),l=n.getTime();o!==l&&(s=Math.abs(l-o)/a-(new Date(l).getTimezoneOffset()-new Date(o).getTimezoneOffset())/(60/this.parent.activeViewOptions.timeScale.slotCount)),this.parent.activeViewOptions.timeScale.enable||(s=1);for(var c=this.parent.getStartEndTime(this.parent.workHours.start),p=this.parent.getStartEndTime(this.parent.workHours.end),h=0;h<s;h++){var d=new Date(o+a*h);if(I(d)||new Date(o).getTimezoneOffset()!==d.getTimezoneOffset()){var u=new Date(o).getTimezoneOffset()-d.getTimezoneOffset();d=new Date(d.getTime()-6e4*u)}var v=h%(r/a),m={date:new Date(""+d),startHour:c,endHour:p,first:0===v,middle:v<this.parent.activeViewOptions.timeScale.slotCount-1,last:v===this.parent.activeViewOptions.timeScale.slotCount-1,type:""};e&&e(m),t.push(m)}return t},i.prototype.destroy=function(){if(!(!this.parent||this.parent&&this.parent.isDestroyed)&&(this.clearCurrentTimeIndicatorTimer(),this.element)){this.appointment&&(this.appointment.destroy(),this.appointment=null);var i=this.getContentAreaElement();i&&(t.EventHandler.remove(i,"scroll",this.onContentScroll),t.EventHandler.remove(i,t.Browser.touchMoveEvent,this.onAdaptiveMove)),this.parent.resourceBase&&this.parent.resourceBase.destroy(),this.parent.scheduleTouchModule&&this.parent.scheduleTouchModule.resetValues(),e.prototype.destroy.call(this)}},i}(Yi),Xi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Qi=function(e){function t(t){var i=e.call(this,t)||this;return i.viewClass="e-day-view",i}return Xi(t,e),t.prototype.getModuleName=function(){return"day"},t}(Gi),Ki=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Zi=function(e){function t(t){var i=e.call(this,t)||this;return i.viewClass="e-week-view",i}return Ki(t,e),t.prototype.startDate=function(){return this.getViewStartDate()},t.prototype.endDate=function(){return this.getViewEndDate()},t.prototype.getModuleName=function(){return"week"},t}(Gi),Ji=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$i=function(e){function t(t){var i=e.call(this,t)||this;return i.viewClass="e-work-week-view",i}return Ji(t,e),t.prototype.startDate=function(){return this.getViewStartDate()},t.prototype.endDate=function(){return this.getViewEndDate()},t.prototype.getModuleName=function(){return"workWeek"},t}(Gi),en=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),tn=function(e){function i(t){var i=e.call(this,t)||this;return i.dayNameFormat="wide",i.viewClass="e-month-view",i.isInverseTableSelect=!1,i.monthEvent=null,i.monthDates={},i}return en(i,e),i.prototype.addEventListener=function(){this.parent.on(Be,this.onScrollUIUpdate,this),this.parent.on(Fe,this.onDataReady,this),this.parent.on("cellClick",this.onCellClick,this)},i.prototype.removeEventListener=function(){this.parent&&(this.parent.off(Be,this.onScrollUIUpdate),this.parent.off(Fe,this.onDataReady),this.parent.off("cellClick",this.onCellClick))},i.prototype.onDataReady=function(e){this.monthEvent=new Mt(this.parent),this.monthEvent.renderAppointments(),this.parent.notify("events-loaded",{})},i.prototype.onCellClick=function(e){},i.prototype.onContentScroll=function(e){this.parent.removeNewEventElement(),this.parent.notify("virtual-scroll",e),this.scrollTopPanel(e.target),this.scrollLeftPanel(e.target),this.setPersistence()},i.prototype.scrollLeftPanel=function(e){var t=this.getLeftPanelElement();t&&(t.scrollTop=e.scrollTop)},i.prototype.getLeftPanelElement=function(){return this.element.querySelector(".e-week-number-wrapper")},i.prototype.onScrollUIUpdate=function(e){var i=this.getHeaderBarHeight(),n=this.getDatesHeaderElement(),r=this.getContentAreaElement(),a=this.parent.element.offsetHeight-i-n.offsetHeight,s=this.getLeftPanelElement();"auto"!==this.parent.height&&this.setContentHeight(r,s,a);var o=k();if(n.firstElementChild.style[e.cssProperties.rtlBorder]="",n.style[e.cssProperties.rtlPadding]="",r.offsetWidth-r.clientWidth>0?(n.firstElementChild.style[e.cssProperties.border]=o>0?"1px":"0px",n.style[e.cssProperties.padding]=o>0?o-1+"px":"0px"):(n.firstElementChild.style[e.cssProperties.border]="",n.style[e.cssProperties.padding]=""),this.setColWidth(r),e.scrollPosition)s&&(s.scrollTop=e.scrollPosition.top),r.scrollTop=e.scrollPosition.top,r.scrollLeft=e.scrollPosition.left;else{var l=this.element.querySelector('.e-header-cells[data-date="'+this.parent.selectedDate.getTime().toString()+'"]');t.isNullOrUndefined(l)?r.scrollLeft=0:r.scrollLeft=this.parent.enableRtl?-(this.parent.getContentTable().offsetWidth-l.offsetLeft-l.offsetWidth):l.offsetLeft}this.retainScrollPosition()},i.prototype.setContentHeight=function(e,i,n){e.style.height="auto","Month"===this.parent.currentView&&(e.style.height=t.formatUnit(n)),i&&("MonthAgenda"===this.parent.currentView&&(n=this.element.querySelector("."+Qe).offsetHeight),i.style.height="auto",i.style.height=t.formatUnit(n-this.getScrollXIndent(e)))},i.prototype.generateColumnLevels=function(){var e=[],t=this.getDateSlots(this.renderDates,this.parent.activeViewOptions.workDays);if(this.parent.activeViewOptions.group.resources.length>0){if(e=this.parent.resourceBase.generateResourceLevels(t),"MonthAgenda"===this.parent.currentView&&(e=[t]),this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.lastResourceLevel.length>0){var i=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];e=[this.getDateSlots(i.renderDates,i.workDays)]}}else e.push(t);return this.colLevels=e,e},i.prototype.getDateSlots=function(e,t){for(var i=this.parent.activeViewOptions.showWeekend?7:t.length,n=[],r=this.isCurrentMonth(this.parent.selectedDate),a=0;a<i;a++){var s=["e-header-cells"],o=e.slice(0,i).map(function(e){return e.getDay()});r&&o.indexOf(this.parent.getCurrentTime().getDay())===a&&s.push("e-current-day"),n.push({date:e[a],type:"monthDay",className:s,colSpan:1,workDays:t})}return n},i.prototype.getDayNameFormat=function(){return this.parent.isAdaptive||this.parent.activeViewOptions.group.resources.length>0?"abbreviated":"wide"},i.prototype.renderLayout=function(e){this.dayNameFormat=this.getDayNameFormat(),this.setPanel(t.createElement("div",{className:"e-table-wrap"}));var i=[this.viewClass];i.push(e),this.parent.activeViewOptions.group.byDate&&i.push("e-by-date"),this.parent.activeViewOptions.allowVirtualScrolling&&i.push("e-virtual-scroll"),this.parent.rowAutoHeight&&this.parent.eventSettings.ignoreWhitespace&&i.push("e-ignore-whitespace"),t.addClass([this.element],i),this.renderPanel(e),this.element.appendChild(this.createTableLayout("e-outer-table")),this.element.querySelector("table").setAttribute("role","presentation"),this.colLevels=this.generateColumnLevels(),this.renderHeader(),this.renderContent();var n="MonthAgenda"===this.parent.currentView?this.parent.activeView.getPanel():this.parent.element;this.parent.uiStateValues.isGroupAdaptive&&!n.querySelector(".e-schedule-resource-toolbar-container")&&this.renderResourceMobileLayout(),this.parent.notify(Ue,{}),this.parent.uiStateValues.isCustomMonth&&(this.parent.uiStateValues.isCustomMonth=!1)},i.prototype.refreshHeader=function(){t.remove(this.element.querySelector("tbody tr")),this.renderHeader(),this.parent.notify(Ue,{})},i.prototype.wireCellEvents=function(e){t.EventHandler.add(e,"mousedown",this.parent.workCellAction.cellMouseDown,this.parent.workCellAction),t.EventHandler.add(e,"click",this.parent.workCellAction.cellClick,this.parent.workCellAction),this.parent.isAdaptive||t.EventHandler.add(e,"dblclick",this.parent.workCellAction.cellDblClick,this.parent.workCellAction)},i.prototype.renderHeader=function(){var e=t.createElement("tr");this.renderLeftIndent(e);var i=t.createElement("td");i.appendChild(this.renderDatesHeader()),e.appendChild(i),t.prepend([e],this.element.querySelector("tbody"))},i.prototype.renderLeftIndent=function(e){this.parent.activeViewOptions.showWeekNumber&&e.appendChild(t.createElement("td",{className:"e-left-indent"}))},i.prototype.renderContent=function(){var e=t.createElement("tr");this.parent.activeViewOptions.showWeekNumber&&e.appendChild(this.renderWeekNumberContent());var i=t.createElement("td"),n=t.createElement("div",{className:"e-content-wrap"}),r=this.renderContentArea();if("Month"===this.parent.currentView)n.appendChild(r);else{var a=t.createElement("div",{className:Xe});a.appendChild(r),n.appendChild(a)}t.EventHandler.add(n,"scroll",this.onContentScroll,this),i.appendChild(n),e.appendChild(i),this.element.querySelector("tbody").appendChild(e),this.renderAppointmentContainer()},i.prototype.renderWeekNumberContent=function(){var e=this.renderDates.map(function(e){return new Date(+e)}),i=t.createElement("td"),n=t.createElement("div",{className:"e-week-number-wrapper"});i.appendChild(n);var r=this.createTableLayout();n.appendChild(r);for(var a=this.parent.activeViewOptions.showWeekend?7:this.parent.activeViewOptions.workDays.length,s=0,o=this.renderDates.length/a;s<o;s++){var l=e.splice(0,a),c=this.parent.getWeekNumberContent(l);r.querySelector("tbody").appendChild(this.createWeekNumberElement(c))}return i},i.prototype.renderAppointmentContainer=function(){},i.prototype.renderDatesHeader=function(){var e=t.createElement("div",{className:"e-date-header-container"}),i=t.createElement("div",{className:"e-date-header-wrap"});e.appendChild(i);var n=this.createTableLayout();this.createColGroup(n,this.colLevels[this.colLevels.length-1]);for(var r=t.createElement("tr"),a=0;a<this.colLevels.length;a++){for(var s=this.colLevels[a],o=r.cloneNode(),l=0;l<s.length;l++){var c=s[l];o.appendChild(this.createHeaderCell(c))}n.querySelector("tbody").appendChild(o)}return i.appendChild(n),e},i.prototype.createHeaderCell=function(e){var i=t.createElement("td");if(this.addAttributes(e,i),"monthDay"===e.type){s=t.createElement("span",{innerHTML:L(this.parent.getDayNames(this.dayNameFormat)[e.date.getDay()],"single")});i.appendChild(s)}if("resourceHeader"===e.type&&this.setResourceHeaderContent(i,e),"dateHeader"===e.type){if(t.addClass([i],"e-date-header"),i.setAttribute("data-date",e.date.getTime().toString()),this.parent.activeViewOptions.dateHeaderTemplate){var n={date:e.date,type:e.type},r=this.parent.element.id+"_"+this.parent.activeViewOptions.dateHeaderTemplateName+"dateHeaderTemplate",a=[].slice.call(this.parent.getDateHeaderTemplate()(n,this.parent,"dateHeaderTemplate",r,!1));a&&a.length&&t.append(a,i)}else{var s=t.createElement("span",{className:"e-navigate"}),o=this.parent.globalize.formatDate(e.date,{skeleton:"full",calendar:this.parent.getCalendarMode()});s.setAttribute("title",L(o,"multiple"));var l=!this.parent.calendarUtil.isMonthStart(e.date)||this.isCurrentDate(e.date)||this.parent.isAdaptive?this.parent.globalize.formatDate(e.date,{skeleton:"d",calendar:this.parent.getCalendarMode()}):this.parent.globalize.formatDate(e.date,{format:"MMM d",calendar:this.parent.getCalendarMode()});s.innerHTML=L(l,"single"),i.appendChild(s)}this.wireCellEvents(i)}var c={elementType:e.type,element:i,date:e.date,groupIndex:e.groupIndex};return this.parent.trigger(Le,c),i},i.prototype.getContentSlots=function(){if(!this.colLevels[this.colLevels.length-1]||!this.colLevels[this.colLevels.length-1][0])return[];var e=[],t=function(t,i,n,r){var a={date:new Date(+i),groupIndex:n.groupIndex,workDays:n.workDays,type:"monthCells",className:r||["e-work-cells"]};e[t]||(e[t]=[]),e[t].push(a)},i="MonthAgenda"!==this.parent.currentView&&this.parent.activeViewOptions.group.resources.length>0;if(!i||this.parent.uiStateValues.isGroupAdaptive||this.parent.activeViewOptions.group.byDate)for(var n=this.renderDates.map(function(e){return new Date(+e)}),r=this.parent.activeViewOptions.showWeekend?7:this.parent.activeViewOptions.workDays.length,a=0;a<this.renderDates.length/r;a++)for(var s=n.splice(0,r),o=0,l=s;o<l.length;o++){var c=l[o];if(i)for(var p=this.colLevels[this.colLevels.length-1],h=p.slice(0,p.length/r),d=0;d<h.length;d++){var u=void 0;0!==d&&(u=["e-work-cells","e-disable-date"]),t(a,c,h[d],u)}else t(a,c,this.colLevels[this.colLevels.length-1][0])}else for(var v=0,m=this.colLevels[this.colLevels.length-2];v<m.length;v++)for(var g=m[v],n=g.renderDates.map(function(e){return new Date(+e)}),r=this.parent.activeViewOptions.showWeekend?7:g.workDays.length,a=0;a<g.renderDates.length/r;a++)for(var f=0,y=s=n.splice(0,r);f<y.length;f++)t(a,c=y[f],g);return e},i.prototype.updateClassList=function(e){!this.isCustomMonth()&&this.isOtherMonth(e.date)&&e.className.push("e-other-month"),this.parent.isMinMaxDate(e.date)||e.className.push("e-disable-dates"),"MonthAgenda"===this.parent.currentView&&this.parent.isSelectedDate(e.date)&&e.className.push("e-selected-cell")},i.prototype.isOtherMonth=function(e){return e.getTime()<this.monthDates.start.getTime()||e.getTime()>this.monthDates.end.getTime()},i.prototype.renderContentArea=function(){var e=this.createTableLayout(Qe);this.addAutoHeightClass(e),"TimelineMonth"===this.parent.currentView&&this.createColGroup(e,this.colLevels[this.colLevels.length-1]);var i=new Date(this.parent.selectedDate.getTime());this.monthDates={start:this.parent.calendarUtil.firstDateOfMonth(i),end:this.parent.calendarUtil.lastDateOfMonth(O(i,this.parent.activeViewOptions.interval-1))};var n=e.querySelector("tbody");return t.append(this.getContentRows(),n),this.wireCellEvents(n),e},i.prototype.getContentRows=function(){for(var e=[],i=t.createElement("tr",{attrs:{role:"row"}}),n=t.createElement("td",{attrs:{role:"gridcell","aria-selected":"false"}}),r=this.getContentSlots(),a=0;a<r.length;a++){for(var s=i.cloneNode(),o=0;o<r[a].length;o++){var l=this.createContentTd(r[a][o],n);s.appendChild(l)}e.push(s)}return e},i.prototype.createContentTd=function(e,i){var n=i.cloneNode();e.colSpan&&n.setAttribute("colspan",e.colSpan.toString()),this.updateClassList(e);var r=e.type;if(-1!==e.className.indexOf("e-parent-node")&&(e.className.push("e-resource-group-cells"),r="resourceGroupCells"),this.parent.workHours.highlight&&this.isWorkDay(e.date,e.workDays)&&e.className.push("e-work-days"),this.isCurrentDate(e.date)&&e.className.push("e-current-date"),t.addClass([n],e.className),n.setAttribute("data-date",e.date.getTime().toString()),!t.isNullOrUndefined(e.groupIndex)||this.parent.uiStateValues.isGroupAdaptive){var a=this.parent.uiStateValues.isGroupAdaptive?this.parent.uiStateValues.groupIndex:e.groupIndex;n.setAttribute("data-group-index",""+a)}if(this.renderDateHeaderElement(e,n),this.parent.activeViewOptions.cellTemplate){var s={date:e.date,type:r,groupIndex:e.groupIndex},o=this.parent.element.id+"_"+this.parent.activeViewOptions.cellTemplateName+"cellTemplate",l=[].slice.call(this.parent.getCellTemplate()(s,this.parent,"cellTemplate",o,!1));t.append(l,n)}var c={elementType:r,element:n,date:e.date,groupIndex:e.groupIndex};return this.parent.trigger(Le,c),n},i.prototype.renderDateHeaderElement=function(e,i){if("TimelineMonth"!==this.parent.currentView){var n=t.createElement("div",{className:"e-date-header"});if(this.parent.activeViewOptions.cellHeaderTemplate){var r={date:e.date,type:e.type,groupIndex:e.groupIndex},a=this.parent.element.id+"_"+this.parent.activeViewOptions.cellHeaderTemplateName+"cellHeaderTemplate",s=[].slice.call(this.parent.getCellHeaderTemplate()(r,this.parent,"cellHeaderTemplate",a,!1));t.append(s,n)}else{var o=!this.parent.calendarUtil.isMonthStart(e.date)||this.isCurrentDate(e.date)||this.parent.isAdaptive?this.parent.globalize.formatDate(e.date,{skeleton:"d",calendar:this.parent.getCalendarMode()}):this.parent.globalize.formatDate(e.date,{format:"MMM d",calendar:this.parent.getCalendarMode()});n.innerHTML=L(o,"single")}if(i.appendChild(n),"month"===this.getModuleName()){t.addClass([n],"e-navigate");var l=this.parent.globalize.formatDate(e.date,{skeleton:"full",calendar:this.parent.getCalendarMode()});n.setAttribute("aria-label",l)}}},i.prototype.getMonthStart=function(e){var i=u("Month"===this.parent.currentView&&!t.isNullOrUndefined(this.parent.activeViewOptions.displayDate)&&(this.parent.uiStateValues.isCustomMonth||this.isCustomRange())?this.parent.activeViewOptions.displayDate:this.parent.uiStateValues.isCustomMonth||this.isCustomRange()||!this.isCustomMonth()?this.parent.calendarUtil.firstDateOfMonth(e):e,this.parent.activeViewOptions.firstDayOfWeek);return new Date(i.getFullYear(),i.getMonth(),i.getDate())},i.prototype.getMonthEnd=function(e){if(this.isCustomMonth())return C(this.getMonthStart(e),7*(this.parent.activeViewOptions.numberOfWeeks>0?this.parent.activeViewOptions.numberOfWeeks:6)-1);var t=O(e,this.parent.activeViewOptions.interval-1);return C(u(this.parent.calendarUtil.lastDateOfMonth(t),this.parent.activeViewOptions.firstDayOfWeek),6)},i.prototype.isCustomRange=function(){var e=this.parent.getCurrentViewDates();if(e&&e.length>0){var t=w(this.parent.selectedDate).getTime(),i=u(e[e.length-1],this.parent.activeViewOptions.firstDayOfWeek);return!(t>=u(e[0],this.parent.activeViewOptions.firstDayOfWeek).getTime()&&t<=C(i,6).getTime())}return!1},i.prototype.getRenderDates=function(e){var t=[],i=w(this.parent.selectedDate),n=this.getMonthStart(i),r=this.getMonthEnd(i);do{this.parent.activeViewOptions.showWeekend?t.push(n):this.isWorkDay(n,e)&&t.push(n),(n=C(n,1)).getHours()>0&&(n=w(n))}while(n.getTime()<=r.getTime());return e||(this.renderDates=t),this.parent.headerModule&&this.parent.headerModule.previousNextIconHandler(),t},i.prototype.getNextPreviousDate=function(e){if(this.isCustomMonth()){var t=this.parent.getCurrentViewDates();return C(u("next"===e?t[t.length-1]:t[0],this.parent.activeViewOptions.firstDayOfWeek),"next"===e?7:7*-(this.parent.activeViewOptions.numberOfWeeks>0?this.parent.activeViewOptions.numberOfWeeks:6))}return O(this.parent.selectedDate,("next"===e?1:-1)*this.parent.activeViewOptions.interval)},i.prototype.getStartDate=function(){return this.getMonthStart(this.parent.selectedDate)},i.prototype.getEndDate=function(){return this.getMonthEnd(this.parent.selectedDate)},i.prototype.getEndDateFromStartDate=function(e){return C(new Date(e.getTime()),1)},i.prototype.getDateRangeText=function(){if(this.parent.isAdaptive||t.isNullOrUndefined(this.parent.activeViewOptions.dateFormat)){var e=this.parent.selectedDate,i=void 0,n=!1;if(this.isCustomMonth()){var r=this.parent.getCurrentViewDates();(n=r[0].getMonth()!==r[r.length-1].getMonth()||r[0].getFullYear()!==r[r.length-1].getFullYear())&&(e=r[0],i=r[r.length-1])}var a="Month"!==this.parent.currentView||!this.isCustomMonth();if(this.parent.activeViewOptions.interval>1&&a||n)return i=i||O(g(e),this.parent.activeViewOptions.interval-1),e.getFullYear()===i.getFullYear()?L(this.parent.globalize.formatDate(e,{format:"MMMM",calendar:this.parent.getCalendarMode()})+" - "+this.parent.globalize.formatDate(i,{format:"MMMM ",calendar:this.parent.getCalendarMode()})+this.parent.globalize.formatDate(i,{skeleton:"y",calendar:this.parent.getCalendarMode()}),"single"):L(this.parent.globalize.formatDate(e,{format:"MMMM",calendar:this.parent.getCalendarMode()})+" "+e.getFullYear()+" - "+this.parent.globalize.formatDate(i,{format:"MMMM ",calendar:this.parent.getCalendarMode()})+this.parent.globalize.formatDate(i,{skeleton:"y",calendar:this.parent.getCalendarMode()}),"single");var s=this.parent.activeViewOptions.dateFormat?this.parent.activeViewOptions.dateFormat:"MMMM y";return L(this.parent.globalize.formatDate(e,{format:s,calendar:this.parent.getCalendarMode()}),"single")}return this.formatDateRange(this.parent.selectedDate)},i.prototype.getLabelText=function(e){return this.parent.localeObj.getConstant(e)+" of "+L(this.parent.globalize.formatDate(this.parent.selectedDate,{format:"MMMM y",calendar:this.parent.getCalendarMode()}),"single")},i.prototype.createWeekNumberElement=function(e){var i=t.createElement("tr"),n=t.createElement("td",{className:"e-week-number",attrs:{title:e?this.parent.localeObj.getConstant("week")+" "+e:""},innerHTML:e||""});i.appendChild(n);var r={elementType:"weekNumberCell",element:n};return this.parent.trigger(Le,r),i},i.prototype.unWireEvents=function(){var e=this.element.querySelector(".e-content-wrap");e&&t.EventHandler.remove(e,"scroll",this.onContentScroll)},i.prototype.isCustomMonth=function(){return"Month"===this.parent.currentView&&(!t.isNullOrUndefined(this.parent.activeViewOptions.displayDate)||this.parent.activeViewOptions.numberOfWeeks>0)},i.prototype.getModuleName=function(){return"month"},i.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||this.element&&(this.monthEvent&&(this.monthEvent.destroy(),this.monthEvent=null),this.unWireEvents(),this.parent.resourceBase&&this.parent.resourceBase.destroy(),this.parent.scheduleTouchModule&&this.parent.scheduleTouchModule.resetValues(),e.prototype.destroy.call(this))},i}(Yi),nn=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),rn=function(e){function i(t){var i=e.call(this,t)||this;return i.viewClass="e-year-view",i.isInverseTableSelect=!1,i.yearEventModule=null,i}return nn(i,e),i.prototype.getModuleName=function(){return"year"},i.prototype.renderLayout=function(e){this.parent.resourceBase&&this.parent.resourceBase.generateResourceLevels([{renderDates:this.parent.activeView.renderDates}]),this.setPanel(t.createElement("div",{className:"e-table-wrap"}));var i="Horizontal"===this.parent.activeViewOptions.orientation?"e-horizontal":"e-vertical";t.addClass([this.element],[this.viewClass,i,e]),this.renderPanel(e);var n=this.createTableLayout("e-outer-table");this.element.appendChild(n),this.element.querySelector("table").setAttribute("role","presentation");var r=n.querySelector("tbody");this.rowCount=this.getRowColumnCount("row"),this.columnCount=this.getRowColumnCount("column"),this.renderHeader(r),this.renderContent(r),"Year"!==this.parent.currentView&&this.parent.uiStateValues.isGroupAdaptive&&(this.generateColumnLevels(),this.renderResourceMobileLayout()),this.wireEvents(this.element.querySelector(".e-content-wrap"),"scroll"),this.parent.notify(Ue,{})},i.prototype.renderHeader=function(e){},i.prototype.renderContent=function(e){var i=t.createElement("tr");e.appendChild(i);var n=t.createElement("td");i.appendChild(n),this.element.querySelector("tbody").appendChild(i);var r=t.createElement("div",{className:"e-content-wrap"});n.appendChild(r);var a=this.createTableLayout("e-calendar-table");r.appendChild(a);var s=t.createElement("tr");a.querySelector("tbody").appendChild(s);var o=t.createElement("td");s.appendChild(o);var l=t.createElement("div",{className:"e-calendar-wrapper"});o.appendChild(l);for(var c=0,p=this.getMonths();c<p.length;c++){var h=p[c],d=new Date(this.parent.selectedDate.getFullYear(),h,1),u=t.createElement("div",{className:"e-month-calendar e-calendar",attrs:{"data-role":"calendar"}});u.appendChild(this.renderCalendarHeader(d)),u.appendChild(this.renderCalendarContent(d)),l.appendChild(u)}},i.prototype.renderCalendarHeader=function(e){var i=t.createElement("div",{className:"e-header e-month"}),n=t.createElement("div",{className:"e-day e-title",innerHTML:this.getMonthName(e)});return i.appendChild(n),this.parent.trigger(Le,{elementType:"headerCells",element:n,date:e}),i},i.prototype.renderCalendarContent=function(e){var i=this.getMonthDates(e),n=t.createElement("div",{className:"e-content e-month"}),r=this.createTableLayout("e-calendar-table "+Qe);n.appendChild(r);var a=t.createElement("thead",{className:"e-week-header"}),s=t.createElement("tr"),o=u(m(e),this.parent.firstDayOfWeek);this.parent.activeViewOptions.showWeekNumber&&s.appendChild(t.createElement("th"));for(var l=0;l<7;l++)s.appendChild(t.createElement("th",{innerHTML:this.parent.getDayNames("narrow")[o.getDay()]})),o=new Date(o.getTime()+We);a.appendChild(s),t.prepend([a],r);for(var c=r.querySelector("tbody");i.length>0;){var p=i.splice(0,7),h=t.createElement("tr",{attrs:{role:"row"}});if(this.parent.activeViewOptions.showWeekNumber){var d=this.parent.getWeekNumberContent(p),v=t.createElement("td",{className:"e-week-number",attrs:{role:"gridcell",title:this.parent.localeObj.getConstant("week")+" "+d},innerHTML:d});h.appendChild(v),this.parent.trigger(Le,{elementType:"weekNumberCells",element:v})}for(var g=0,f=p;g<f.length;g++){var y=f[g],v=t.createElement("td",{className:"e-cell e-work-cells",attrs:{role:"gridcell","aria-selected":"false","data-date":y.getTime().toString()}}),T=t.createElement("span",{className:"e-day",innerHTML:this.parent.globalize.formatDate(y,{skeleton:"d",calendar:this.parent.getCalendarMode()}),attrs:{title:this.parent.globalize.formatDate(y,{type:"date",skeleton:"full"})}});v.appendChild(T);var w=[];e.getMonth()!==y.getMonth()&&w.push("e-other-month"),this.isCurrentDate(y)&&e.getMonth()===y.getMonth()&&(w=w.concat(["e-today","e-selected"])),w.length>0&&t.addClass([v],w),h.appendChild(v),this.wireEvents(v,"cell"),this.parent.trigger(Le,{elementType:"workCells",element:v,date:y})}c.appendChild(h)}return n},i.prototype.createTableColGroup=function(e){for(var i=t.createElement("colgroup"),n=0;n<e;n++)i.appendChild(t.createElement("col"));return i},i.prototype.getMonthName=function(e){return L(this.parent.globalize.formatDate(e,{format:this.parent.activeViewOptions.dateFormat||"MMMM y",calendar:this.parent.getCalendarMode()}),"multiple")},i.prototype.generateColumnLevels=function(){var e=[],t=this.getDateSlots([this.parent.selectedDate],this.parent.activeViewOptions.workDays);if(this.parent.activeViewOptions.group.resources.length>0){if(e=this.parent.resourceBase.generateResourceLevels(t),this.parent.uiStateValues.isGroupAdaptive){var i=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];e=[this.getDateSlots([this.parent.selectedDate],i.workDays)]}}else e.push(t);return e.pop(),this.colLevels=e,e},i.prototype.getDateSlots=function(e,t,i,n){return void 0===i&&(i=this.parent.workHours.start),void 0===n&&(n=this.parent.workHours.end),[{date:e[0],type:"dateHeader",className:["e-header-cells"],colSpan:1,workDays:t,startHour:new Date(+this.parent.globalize.parseDate(i,{skeleton:"Hm"})),endHour:new Date(+this.parent.globalize.parseDate(n,{skeleton:"Hm"}))}]},i.prototype.getMonthDates=function(e){for(var t=u(m(e),this.parent.firstDayOfWeek),i=C(new Date(+t),42),n=[],r=t;r.getTime()<i.getTime();r=C(r,1))n.push(w(new Date(r)));return n},i.prototype.getRowColumnCount=function(e){for(var t=this.getMonths(),i=this.parent.selectedDate.getFullYear(),n=[],r=0,a=t;r<a.length;r++){var s=a[r];n.push(new Date(i,s,1).getDay()+new Date(i,s+1,0).getDate())}var o=Math.max.apply(Math,n);return"row"===e?"Horizontal"===this.parent.activeViewOptions.orientation?t.length:o:"Horizontal"===this.parent.activeViewOptions.orientation?o:t.length},i.prototype.isCurrentDate=function(e){return w(new Date).getTime()===w(new Date(e.getTime())).getTime()},i.prototype.getMonths=function(){var e=this;return Array.apply(null,{length:this.parent.activeViewOptions.monthsCount}).map(function(t,i){return e.parent.firstMonthOfYear+i})},i.prototype.onCellClick=function(e){var i=t.closest(e.target,".e-work-cells"),n=this.parent.getDateFromElement(i);this.parent.activeCellsData=this.parent.getCellDetails(i);var r=n.getTime()<this.getStartDate().getTime();if(r||n.getTime()>this.getEndDate().getTime()){this.parent.changeDate(this.parent.activeView.getNextPreviousDate(r?"previous":"next"),e);var a=this.parent.activeCellsData.startTime.getTime(),s=a>=this.getStartDate().getTime()&&a<=this.getEndDate().getTime()?a:(r?this.getEndDate():this.getStartDate()).getTime(),o=this.parent.element.querySelector(':not(.e-other-month)[data-date="'+s+'"]');this.parent.selectCell(o),this.parent.activeCellsData=this.parent.getCellDetails(o)}else{var l=C(new Date(n.getTime()),1),c={date:n,event:this.parent.eventBase.filterEvents(n,l),element:e.target};i.classList.contains("e-other-month")&&(i=this.parent.element.querySelector(':not(.e-other-month)[data-date="'+i.getAttribute("data-date")+'"]')),this.parent.activeCellsData=this.parent.getCellDetails(i),this.parent.quickPopup.moreEventClick(c,l)}},i.prototype.onContentScroll=function(e){var t=e.target,i=this.getDatesHeaderElement();i&&(i.firstElementChild.scrollLeft=t.scrollLeft);var n=this.element.querySelector(".e-month-header-wrapper,.e-resource-column-wrap");n&&(n.scrollTop=t.scrollTop),this.setPersistence()},i.prototype.onScrollUiUpdate=function(e){var i=this.parent.element.offsetHeight-this.getHeaderBarHeight(),n=this.element.querySelector(".e-date-header-container");n&&(i-=n.offsetHeight);var r=this.element.querySelector(".e-content-wrap");if(r&&(r.style.height=t.formatUnit(i)),!this.parent.isAdaptive&&n){var a=k();r.offsetWidth-r.clientWidth>0?(n.firstElementChild.style[e.cssProperties.border]=a>0?"1px":"0px",n.style[e.cssProperties.padding]=a>0?a-1+"px":"0px"):(n.firstElementChild.style[e.cssProperties.border]="",n.style[e.cssProperties.padding]="")}this.setColWidth(this.getContentAreaElement());var s=this.element.querySelector(".e-month-header-wrapper,.e-resource-column-wrap");if(s){var o=r.scrollWidth>r.clientWidth;s.style.height=t.formatUnit(i-(o?17:0))}this.retainScrollPosition()},i.prototype.getStartDate=function(){return new Date(this.parent.selectedDate.getFullYear(),this.parent.firstMonthOfYear%12,1)},i.prototype.getEndDate=function(){return C(O(this.getStartDate(),this.parent.monthsCount),-1)},i.prototype.startDate=function(){return"Year"===this.parent.currentView?u(this.getStartDate(),this.parent.firstDayOfWeek):this.getStartDate()},i.prototype.endDate=function(){return"Year"===this.parent.currentView?C(v(this.getEndDate(),this.parent.firstDayOfWeek),1):this.getEndDate()},i.prototype.getEndDateFromStartDate=function(e){var t=new Date(e.getTime());return this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(t=g(t)),C(new Date(t.getTime()),1)},i.prototype.getNextPreviousDate=function(e){return E(this.parent.selectedDate,"next"===e?1:-1)},i.prototype.getDateRangeText=function(){var e=this.getStartDate(),t=this.getEndDate();return e.getFullYear()!==t.getFullYear()?this.parent.globalize.formatDate(e,{skeleton:"yMMM"})+" - "+this.parent.globalize.formatDate(t,{skeleton:"yMMM"}):this.parent.globalize.formatDate(this.parent.selectedDate,{skeleton:"y"})},i.prototype.addEventListener=function(){this.parent.on(Be,this.onScrollUiUpdate,this),this.parent.on(Fe,this.onDataReady,this)},i.prototype.removeEventListener=function(){this.parent&&(this.parent.off(Be,this.onScrollUiUpdate),this.parent.off(Fe,this.onDataReady))},i.prototype.onDataReady=function(e){this.yearEventModule=new Bi(this.parent),this.yearEventModule.renderAppointments(),this.parent.notify("events-loaded",e)},i.prototype.wireEvents=function(e,i){"cell"===i?"TimelineYear"!==this.parent.currentView?t.EventHandler.add(e,"click",this.onCellClick,this):(t.EventHandler.add(e,"mousedown",this.parent.workCellAction.cellMouseDown,this.parent.workCellAction),t.EventHandler.add(e,"click",this.parent.workCellAction.cellClick,this.parent.workCellAction),this.parent.isAdaptive||t.EventHandler.add(e,"dblclick",this.parent.workCellAction.cellDblClick,this.parent.workCellAction)):t.EventHandler.add(e,"scroll",this.onContentScroll,this)},i.prototype.destroy=function(){if(!(!this.parent||this.parent&&this.parent.isDestroyed)&&this.element){var i=this.element.querySelector(".e-content-wrap");i&&t.EventHandler.remove(i,"scroll",this.onContentScroll),this.yearEventModule&&(this.yearEventModule.destroy(),this.yearEventModule=null),this.parent.resourceBase&&this.parent.resourceBase.destroy(),e.prototype.destroy.call(this)}},i}(Yi),an=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sn=function(e){function i(t){return e.call(this,t)||this}return an(i,e),i.prototype.createAgendaContentElement=function(e,i,n,r,a){var s,o=this,l=this.parent.eventFields;if("noEvents"===e){var p=[{subject:this.parent.localeObj.getConstant("noEvents")}];s=c.ListBase.createList(this.parent.createElement,p,{moduleName:"agenda",listClass:this.parent.activeView.viewClass,itemClass:this.parent.activeView.viewClass,template:"<div class=e-no-event>${subject}</div>"})}else s=c.ListBase.createList(this.parent.createElement,i,{moduleName:"agenda",listClass:this.parent.activeView.viewClass,itemClass:this.parent.activeView.viewClass}),[].slice.call(s.children).forEach(function(e,n){var s=t.createElement("div",{className:"e-appointment",attrs:{"data-id":"Appointment_"+i[n][o.parent.eventFields.id],"data-guid":i[n].Guid,role:"button",tabindex:"0","aria-readonly":o.parent.eventBase.getReadonlyAttribute(i[n]),"aria-selected":"false","aria-grabbed":"true","aria-label":o.parent.getAnnouncementString(i[n])}});t.isNullOrUndefined(a)||s.setAttribute("data-group-index",a.toString()),o.parent.eventBase.applyResourceColor(s,i[n],"borderColor",r);var c;if(t.isNullOrUndefined(o.parent.activeViewOptions.eventTemplate))c=o.createAppointment(i[n]);else{t.addClass([s],"e-template");var p=o.parent.element.id+"_"+o.parent.activeViewOptions.eventTemplateName+"eventTemplate";if(c=o.parent.getAppointmentTemplate()(i[n],o.parent,"eventTemplate",p,!1),!t.isNullOrUndefined(i[n][l.recurrenceRule])){var h=i[n][l.id]===i[n][l.recurrenceID]?"e-recurrence-icon":"e-recurrence-edit-icon";s.appendChild(t.createElement("div",{className:Ge+" "+h}))}}t.append([].slice.call(c),s),P(e),e.appendChild(s);var d={data:t.extend({},i[n],null,!0),element:e,cancel:!1};o.parent.trigger("eventRendered",d,function(i){i.cancel&&t.remove(e)})});return n.appendChild(s),("MonthAgenda"===this.parent.currentView&&this.parent.activeViewOptions.group.resources.length>0||"Agenda"===this.parent.currentView)&&t.addClass([n],"e-day-border"),this.parent.renderTemplates(),n},i.prototype.createAppointment=function(e){var i=this.parent.eventFields,n=e[i.subject]||this.parent.eventSettings.fields.subject.default||this.parent.localeObj.getConstant("addTitle"),r=e[i.location]||this.parent.eventSettings.fields.location.default,a=t.createElement("div",{className:"e-subject-wrap"});if(t.isNullOrUndefined(r)||""===r||(n+=","),a.appendChild(t.createElement("div",{className:"e-subject",innerHTML:n})),t.isNullOrUndefined(r)||""===r||a.appendChild(t.createElement("div",{className:"e-location",innerHTML:r})),!t.isNullOrUndefined(e[i.recurrenceRule])){var s=e[i.id]===e[i.recurrenceID]?"e-recurrence-icon":"e-recurrence-edit-icon";a.appendChild(t.createElement("div",{className:Ge+" "+s}))}var o=e[i.startTime],l=e[i.endTime],c=e[i.isAllDay],p=this.parent.localeObj.getConstant("allDay"),h=this.parent.getTimeString(o)+" - "+this.parent.getTimeString(l);t.isNullOrUndefined(e.data)||(p=((l.getTimezoneOffset()!==o.getTimezoneOffset()?l.getTime()-o.getTime()+36e5:l.getTime()-o.getTime())/We>=1?p:h)+" ("+this.parent.localeObj.getConstant("day")+" "+e.data.index+"/"+e.data.count+")");var d=!t.isNullOrUndefined(e.data)||c?p:h;return[a,t.createElement("div",{className:"e-date-time",innerHTML:d})]},i.prototype.processAgendaEvents=function(e){var i=[];if(t.isNullOrUndefined(e))return i;for(var n=0,r=e;n<r.length;n++){var a=r[n],s=this.parent.eventBase.splitEventByDay(a);i=i.concat(s.length>1?s:a)}return i},i.prototype.wireEventActions=function(){for(var e=0,i=[].slice.call(this.parent.element.querySelectorAll(".e-appointment"));e<i.length;e++){a=i[e];this.parent.eventBase.wireAppointmentEvents(a,this.parent.getEventDetails(a),!0)}for(var n=0,r=[].slice.call(this.parent.element.querySelectorAll(".e-m-date"));n<r.length;n++){var a=r[n];t.EventHandler.add(a,"click",this.parent.agendaModule.dayNavigationClick,this)}},i.prototype.calculateResourceTableElement=function(e,i,n){if(t.isNullOrUndefined(this.parent.resourceBase.lastResourceLevel)){var r=this.getDateSlots(this.renderDates,this.parent.activeViewOptions.workDays);this.parent.resourceBase.generateResourceLevels(r)}for(var a=C(new Date(n.getTime()),i),s=this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView?i:1,o=this.parent.resourceBase.resourceCollection,l=this.parent.resourceBase.lastResourceLevel,c=n,p=0;p<s;p++){var h=[],d=[],u=0,v=void 0,m=void 0,g=C(c,p),f=this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView?C(g,1):a,y=this.parent.eventBase.filterEvents(g,f);if(y.length>0||!this.parent.hideEmptyAgendaDays||"MonthAgenda"===this.parent.currentView){for(var T=0;T<l.length;T++){i=this.parent.activeViewOptions.group.byDate&&"MonthAgenda"!==this.parent.currentView?1:i;V=[];n=g;var w=this.parent.eventBase.filterEvents(n,a,y,l[T]);if(w.length>0||!this.parent.hideEmptyAgendaDays||"MonthAgenda"===this.parent.currentView)for(var D=0;D<i;D++){var b=this.parent.eventBase.filterEvents(n,C(n,1),w,void 0);if((b.length>0||!this.parent.hideEmptyAgendaDays||"MonthAgenda"===this.parent.currentView)&&(V.push(b[0]),v={rowSpan:1,type:"eventColumn",resource:o[o.length-1],groupIndex:l[T].groupIndex,groupOrder:l[T].groupOrder,resourceData:l[T].resourceData,eventData:b,date:n},m={rowSpan:1,type:"dateColumn",resource:o[o.length-1],groupOrder:l[T].groupOrder,resourceData:l[T].resourceData,date:n},h[u]||(h[u]=[]),h[u].push(v),h[u].push(m),u++),(n=C(n,1)).getTime()>=a.getTime()||this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView){h[h.length-1][1].cssClass="e-day-border";var O={rowSpan:V.length,type:"resourceColumn",resource:o[o.length-1],groupOrder:l[T].groupOrder.slice(0,-1),resourceData:l[T].resourceData,groupIndex:h.length-V.length,className:["e-resource-name"],date:n};h[h.length-V.length].push(O),d.push(t.extend({},O,null,!0));break}}}for(var E=o.slice(0,-1),S=[],x=0,A=0;A<E.length;A++)for(var V=E[E.length-(A+1)].dataSource,k=0;k<V.length;k++)for(var M=0,R=0;R<d.length;R++)d[R].groupOrder[E.length-(A+1)]===V[k][E[E.length-(A+1)].idField]&&(x+=d[R].rowSpan,S.push(t.extend({},d[R],null,!0))),++M===d.length&&S.length>0&&(S[0].rowSpan=x,S[0].type="parentColumnLevel_"+(A+1),S[0].resource=E[E.length-(A+1)],S[0].resourceData=V[k],S[0].date=n,h[S[0].groupIndex].push(S[0]),S=[],x=0);this.createResourceTableRow(h,e)}}0===this.parent.eventBase.filterEvents(c,a).length&&!this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.hideEmptyAgendaDays&&this.renderEmptyContent(e,c)},i.prototype.createResourceTableRow=function(e,i){var n,r,a,s=t.createElement("tr",{attrs:{role:"row"}}),o=t.createElement("td",{attrs:{role:"gridcell","aria-selected":"false"}}),l=0;if(this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView){for(var c=[],p=this.parent.resourceBase.resourceCollection.slice(0,-1),h=0;h<e.length;h++)c=c.concat(e[h]);a=p.length>0?"parentColumnLevel_"+p.length:"resourceColumn";for(var d=c.filter(function(e){return e.type===a}),u=0;u<d.length;u++)l+=d[u].rowSpan}for(var v=0;v<e.length;v++){n=s.cloneNode();for(var m=e[v].length-1;m>=0;m--){var g=e[v][m],f=o.cloneNode();if("dateColumn"===g.type){if(this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView){r=e[v][m];continue}f.setAttribute("data-date",g.date.getTime().toString()),f.appendChild(this.createDateHeaderElement(g.date));var y=["e-agenda-cells","e-date-column"];g.cssClass&&y.push(g.cssClass),t.addClass([f],y),n.appendChild(f)}else if("eventColumn"===g.type){var T=0===g.eventData.length?"noEvents":"data";(f=this.createAgendaContentElement(T,g.eventData,f,g.groupOrder,g.groupIndex)).setAttribute("data-date",g.date.getTime().toString()),(this.parent.activeViewOptions.group.byDate||"MonthAgenda"===this.parent.currentView)&&t.addClass([f],["e-agenda-cells","e-day-padding"]),n.appendChild(f)}else f.setAttribute("rowspan",g.rowSpan.toString()),t.addClass([f],"e-resource-column"),this.setResourceHeaderContent(f,g,g.className[0]),n.appendChild(f)}if(this.parent.activeViewOptions.group.byDate&&0===v&&"MonthAgenda"!==this.parent.currentView){(f=o.cloneNode()).setAttribute("data-date",r.date.getTime().toString()),f.setAttribute("rowspan",l.toString()),f.appendChild(this.createDateHeaderElement(r.date)),t.addClass([f],["e-agenda-cells","e-date-column","e-date-border"]);var w=A(this.parent.selectedDate.getTime(),r.date.getTime());if(n.setAttribute("aria-rowindex",w.toString()),this.parent.element.querySelector('.e-agenda-view tr[aria-rowindex="'+w+'"]'))break;n.insertBefore(f,n.childNodes[0])}i.appendChild(n)}},i.prototype.createDateHeaderElement=function(e){var i;if(this.parent.activeViewOptions.dateHeaderTemplate){i=t.createElement("div",{className:"e-day-date-header"});var n={date:e,type:"dateHeader"},r=this.parent.element.id+"_"+this.parent.activeViewOptions.dateHeaderTemplateName+"dateHeaderTemplate",a=[].slice.call(this.parent.getDateHeaderTemplate()(n,this.parent,"dateHeaderTemplate",r,!1));t.append(a,i)}else i=this.getMobileDateElement(e,"e-day-date-header");return i},i.prototype.renderEmptyContent=function(e,i){var n=this.createTableRowElement(i,"noEvents"),r=n.children[0],a=t.createElement("div",{className:"e-empty-event",innerHTML:this.parent.localeObj.getConstant("noEvents")});r.appendChild(a),e.appendChild(n)},i.prototype.createTableRowElement=function(e,i){var n=A(this.parent.selectedDate.getTime(),e.getTime()),r=t.createElement("tr",{attrs:{role:"row","aria-rowindex":n.toString()}}),a=t.createElement("td",{attrs:{class:"monthHeader"===i?"e-month-header":"e-agenda-cells",role:"gridcell","aria-selected":"false","aria-colindex":n.toString(),"data-date":e.getTime().toString()}}),s=a.cloneNode(),o=a.cloneNode();return r.appendChild(s),"noEvents"!==i&&r.appendChild(o),r},i.prototype.destroy=function(){e.prototype.destroy.call(this)},i}(Yi),on=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ln=function(e){function i(t){var i=e.call(this,t)||this;return i.viewClass="e-agenda-view",i.isInverseTableSelect=!1,i.agendaDates={},i.virtualScrollTop=1,i}return on(i,e),i.prototype.getModuleName=function(){return"agenda"},i.prototype.renderLayout=function(){this.agendaDates={},this.element=t.createElement("div",{className:"e-table-wrap"}),t.addClass([this.element],this.viewClass),this.element.appendChild(this.createTableLayout("e-outer-table")),this.element.querySelector("table").setAttribute("role","presentation"),this.parent.element.querySelector("."+Xe).appendChild(this.element);var e=t.createElement("tr");this.element.querySelector("tbody").appendChild(e);var i=t.createElement("td");e.appendChild(i);var n=t.createElement("div",{className:"e-content-wrap"});i.appendChild(n);var r=this.createTableLayout(Qe);n.appendChild(r);var a=r.querySelector("tbody"),s=w(this.parent.selectedDate);this.renderEmptyContent(a,s),this.wireEvents(),this.parent.resourceBase&&this.parent.resourceBase.generateResourceLevels([{renderDates:this.parent.activeView.renderDates}]),this.parent.uiStateValues.isGroupAdaptive&&!this.parent.element.querySelector(".e-schedule-resource-toolbar-container")&&this.renderResourceMobileLayout(),this.parent.notify(Ue,{})},i.prototype.eventLoad=function(e){this.dataSource=t.extend([],this.parent.eventsData,null,!0);for(var i=0,n=this.parent.eventsData;i<n.length;i++)delete n[i].generatedDates;var r=this.parent.activeViewOptions.allowVirtualScrolling?e.processedData:this.parent.eventsProcessed;if(this.parent.uiStateValues.isGroupAdaptive){var a=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];this.dataSource=this.parent.eventBase.filterEventsByResource(a,this.dataSource),r=this.parent.eventBase.filterEventsByResource(a,r)}this.parent.eventsProcessed=this.processAgendaEvents(r);var s=w(this.parent.selectedDate),o=this.element.querySelector("."+Qe+" tbody");P(o),this.renderInitialContent(o,s),this.wireEventActions(),t.closest(o,".e-content-wrap").scrollTop=1,this.parent.notify("events-loaded",{}),this.parent.activeViewOptions.allowVirtualScrolling||this.retainScrollPosition()},i.prototype.refreshEvent=function(e){for(var i=[],n=this.parent.eventFields,r=0,a=this.dataSource;r<a.length;r++){var s=a[r];t.isNullOrUndefined(s[n.recurrenceID])&&!t.isNullOrUndefined(s[n.recurrenceRule])&&!t.isNullOrUndefined(s.generatedDates)&&e>=s.generatedDates.end&&(i=i.concat(this.parent.eventBase.generateOccurrence(s,e)))}this.parent.eventsProcessed=this.parent.eventsProcessed.concat(this.processAgendaEvents(i))},i.prototype.refreshHeader=function(){var e=this.element.querySelector("."+Qe+" tbody");this.parent.activeViewOptions.group.byDate?P(e):t.remove(e.firstElementChild);var i=w(this.parent.selectedDate),n=t.createElement("tbody"),r=new Date(i.getTime()),a=this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.hideEmptyAgendaDays?this.getEndDateFromStartDate(r):C(r,this.parent.agendaDaysCount);this.renderContent(n,r,a),t.append([].slice.call(n.childNodes),e)},i.prototype.renderInitialContent=function(e,i){var n=t.createElement("tbody"),r=new Date(i.getTime()),a=this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.hideEmptyAgendaDays?this.getEndDateFromStartDate(r):C(r,this.parent.agendaDaysCount);if(this.renderContent(n,r,a),t.append([].slice.call(n.childNodes),e),this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.hideEmptyAgendaDays&&this.parent.eventsData.length>0)for(var s=this.getContentAreaElement(),o=s.querySelector(".e-content-table");s.offsetWidth<=s.clientWidth&&!(this.parent.isAdaptive&&o.offsetHeight>=s.clientHeight);){var l=t.createElement("tbody");if(a=r,r=C(a,-this.parent.agendaDaysCount),this.renderContent(l,r,a),t.prepend([].slice.call(l.childNodes),e),r<=this.parent.minDate)break}e.childNodes.length<=0&&this.renderEmptyContent(e,i)},i.prototype.renderContent=function(e,i,n){var r=this.parent.eventFields,a=new Date(i.getTime()),s=this.appointmentFiltering(a,n);s.length>0&&this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.hideEmptyAgendaDays&&(i=s[0][r.startTime],i=new Date(new Date(i.getTime()).setHours(0,0,0,0)),this.updateHeaderText(s[0][r.startTime]));var o;if(!this.parent.hideEmptyAgendaDays||this.parent.agendaDaysCount>0&&s.length>0){if(this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive){var l=i;this.parent.activeViewOptions.group.byDate||(this.parent.activeViewOptions.allowVirtualScrolling=!1,l=a,this.parent.headerModule&&(this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText()),this.parent.headerModule.updateHeaderItems("remove"))),this.calculateResourceTableElement(e,this.parent.agendaDaysCount,l)}else for(var c=0;c<this.parent.agendaDaysCount;c++){var p=this.appointmentFiltering(i),h=this.createTableRowElement(i,"data");if(this.element.querySelector('tr[aria-rowindex="'+parseInt(h.getAttribute("aria-rowindex"),10)+'"]'))i=C(i,1);else{var d=h.children[0],u=h.children[1];if(p.length>0||!this.parent.hideEmptyAgendaDays&&0===p.length){var v=this.parent.hideEmptyAgendaDays||0!==p.length?"data":"noEvents";d.appendChild(this.createDateHeaderElement(i)),h.appendChild(d);var m=this.createAgendaContentElement(v,p,u);h.appendChild(m),m.querySelectorAll("li").length>0&&e.appendChild(h)}else this.parent.activeViewOptions.allowVirtualScrolling&&c--;if(this.isCurrentDate(new Date(i.getTime()))&&t.addClass(d.childNodes,"e-current-day"),(i=C(i,1)).getTime()>n.getTime())break}}o=new Date(i.getTime()-We)}this.agendaDates={start:a,end:o}},i.prototype.agendaScrolling=function(e){this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide(),this.parent.activeViewOptions.allowVirtualScrolling&&this.virtualScrolling(e),this.parent.activeViewOptions.allowVirtualScrolling||this.setPersistence()},i.prototype.virtualScrolling=function(e){var i,n=e.target,r=n.scrollTop,a=n.scrollHeight,s=r+n.clientHeight,o=this.virtualScrollTop<r?"next":"previous",l=n.querySelector("tbody"),c=t.createElement("tbody"),p=this.getElementFromScrollerPosition(e),h=this.parent.getDateFromElement(p);if(0===r){if(i=this.getPreviousNextDate(C(h,-1),o),this.appointmentFiltering(i.start,i.end).length>0||!this.parent.hideEmptyAgendaDays){this.renderContent(c,i.start,i.end),t.prepend([].slice.call(c.childNodes),l),this.wireEventActions();for(var d=0,u=l.children;d<u.length;d++)if(u[d].getAttribute("aria-rowindex")===p.getAttribute("aria-colindex")){var v=u[d].offsetTop-this.element.querySelector(".e-agenda-item").offsetHeight;n.scrollTop=v;break}this.updateHeaderText(h)}}else s>=a-5?(i=this.getPreviousNextDate(C(h,1),o),(this.appointmentFiltering(i.start,i.end).length>0||!this.parent.hideEmptyAgendaDays)&&(this.renderContent(c,i.start,i.end),t.append([].slice.call(c.childNodes),l),this.wireEventActions(),this.updateHeaderText(h))):this.updateHeaderText(h);this.virtualScrollTop=r;var m=this.parent.eventBase.getSelectedAppointments();m.length>0&&m[m.length-1].focus()},i.prototype.getElementFromScrollerPosition=function(e){var i,n,r=e.target,a=r.scrollTop,s=r.scrollHeight,o=a+r.clientHeight,l=[].slice.call(r.querySelectorAll(".e-agenda-item"));if(l.length>0)if(0===a)n=l[0],i=t.closest(n,".e-agenda-cells");else if(o===s)n=l[l.length-1],i=t.closest(n,".e-agenda-cells");else for(var c=0,p=l.length;c<p;c++)if(n=l[c],n.getBoundingClientRect().top>=0){i=t.closest(n,".e-agenda-cells");break}return i},i.prototype.updateHeaderText=function(e){this.parent.showHeaderBar&&this.parent.headerModule.updateDateRange(this.getDateRangeText(e))},i.prototype.getPreviousNextDate=function(e,t){var i=new Date(e.getTime()),n=this.getStartDateFromEndDate(e),r=this.getEndDateFromStartDate(e),a=0;do{if((this.appointmentFiltering(i).length>0||!this.parent.hideEmptyAgendaDays)&&a++,(i=C(i,"next"===t?1:-1))<n||i>r)break}while(a!==this.parent.agendaDaysCount);var s=C(i,"next"===t?-1:1);return"next"===t?{start:e,end:C(s,1)}:{start:s,end:C(e,1)}},i.prototype.appointmentFiltering=function(e,i){var n,r;!t.isNullOrUndefined(e)&&t.isNullOrUndefined(i)?(n=w(new Date(e.getTime())),r=T(new Date(n.getTime()),We)):(n=new Date(e.getTime()),r=new Date(i.getTime()));var a=this.parent.eventBase.filterEvents(n,r);return 0===a.length&&(this.refreshEvent(e),a=this.parent.eventBase.filterEvents(n,r)),a},i.prototype.getStartDateFromEndDate=function(e){var t,i=this.parent.eventFields;if(this.parent.eventsProcessed.length>0){var n=Math.min.apply(Math,this.parent.eventsProcessed.map(function(e){return e[i.startTime].getTime()}));t=this.parent.hideEmptyAgendaDays?new Date(n):this.parent.minDate}else t=this.parent.hideEmptyAgendaDays?O(e,-1):this.parent.minDate;return w(t)},i.prototype.getEndDateFromStartDate=function(e){var t,i=this.parent.eventFields;if(this.parent.eventsProcessed.length>0){var n=Math.max.apply(Math,this.parent.eventsProcessed.map(function(e){return e[i.endTime].getTime()}));t=this.parent.hideEmptyAgendaDays?new Date(n):this.parent.maxDate}else t=this.parent.hideEmptyAgendaDays?O(e,1):this.parent.maxDate;return w(C(t,1))},i.prototype.getNextPreviousDate=function(e){var t="next"===e?1:-1;return C(this.parent.selectedDate,t)},i.prototype.startDate=function(){return w(this.parent.selectedDate)},i.prototype.endDate=function(){return this.parent.activeViewOptions.allowVirtualScrolling?this.getEndDateFromStartDate(this.startDate()):C(this.startDate(),this.parent.agendaDaysCount)},i.prototype.getDateRangeText=function(e){var i=this.parent.activeViewOptions.dateFormat?this.parent.activeViewOptions.dateFormat:"MMMM y";if(this.parent.activeViewOptions.allowVirtualScrolling||this.parent.isAdaptive){var n=t.isNullOrUndefined(e)?this.parent.selectedDate:e;return L(this.parent.globalize.formatDate(n,{format:i,calendar:this.parent.getCalendarMode()}),"multiple")}var r=this.parent.selectedDate,a=C(r,this.parent.agendaDaysCount-1);return this.formatDateRange(r,a)},i.prototype.dayNavigationClick=function(e){var i=t.closest(e.currentTarget,".e-agenda-cells"),n=this.parent.getDateFromElement(i);t.isNullOrUndefined(n)||this.parent.isAdaptive||!this.parent.isMinMaxDate(n)||(this.parent.setProperties({selectedDate:n},!0),this.parent.changeView("Day",e))},i.prototype.wireEvents=function(){t.EventHandler.add(this.element.querySelector(".e-content-wrap"),"scroll",this.agendaScrolling,this)},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.element.querySelector(".e-content-wrap"),"scroll",this.agendaScrolling);for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-m-date"));e<i.length;e++){var n=i[e];t.EventHandler.remove(n,"click",this.dayNavigationClick)}},i.prototype.addEventListener=function(){this.parent.on(Be,this.onAgendaScrollUiUpdate,this),this.parent.on(Fe,this.eventLoad,this)},i.prototype.removeEventListener=function(){this.parent&&(this.parent.off(Be,this.onAgendaScrollUiUpdate),this.parent.off(Fe,this.eventLoad))},i.prototype.onAgendaScrollUiUpdate=function(){var e=this.getHeaderBarHeight();this.parent.headerModule&&(this.parent.activeViewOptions.allowVirtualScrolling?this.parent.headerModule.updateHeaderItems("add"):this.parent.headerModule.updateHeaderItems("remove"));var i=this.element.querySelector(".e-content-wrap");"auto"!==this.parent.height&&(i.style.height=t.formatUnit(this.parent.element.offsetHeight-e))},i.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||this.element&&(this.unWireEvents(),this.parent.resourceBase&&this.parent.resourceBase.destroy(),this.parent.headerModule&&this.parent.activeViewOptions.allowVirtualScrolling&&this.parent.headerModule.updateHeaderItems("remove"),e.prototype.destroy.call(this))},i}(sn),cn=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),pn=function(e){function i(t){var i=e.call(this,t)||this;return i.dayNameFormat="narrow",i.viewClass="e-month-agenda-view",i.monthAgendaDate=new Date(""+t.selectedDate),i}return cn(i,e),i.prototype.getModuleName=function(){return"monthAgenda"},i.prototype.renderAppointmentContainer=function(){var e=this.getContentAreaElement(),i=t.createElement("div",{className:"e-wrapper-container"});e.appendChild(i);var n=t.createElement("div",{className:"e-appointment-wrap"});i.appendChild(n),this.appendAppContainer(n),this.setEventWrapperHeight()},i.prototype.getDayNameFormat=function(){return this.parent.isAdaptive?"narrow":"abbreviated"},i.prototype.setEventWrapperHeight=function(){var e=(this.parent.headerModule?this.parent.headerModule.getHeaderElement().offsetHeight:0)+2,i=this.parent.element.querySelector(".e-schedule-resource-toolbar");i&&(e+=i.offsetHeight);var n=this.getContentAreaElement().firstElementChild,r=this.element.querySelector(".e-date-header-wrap"),a=this.parent.element.offsetHeight-e-r.offsetHeight-n.offsetHeight,s=this.element.querySelector(".e-wrapper-container"),o=this.element.querySelector(".e-appointment-wrap");"auto"!==this.parent.height&&(s.style.height=o.style.height=t.formatUnit(a))},i.prototype.onDataReady=function(e){this.setEventWrapperHeight(),this.clearElements();var i=e.processedData;if(this.parent.uiStateValues.isGroupAdaptive){var n=this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];i=this.parent.eventBase.filterEventsByResource(n,i)}this.agendaBase=this.getAgendaBase(),this.parent.eventsProcessed=this.agendaBase.processAgendaEvents(i);for(var r=0,a=0,s=this.renderDates;a<s.length;a++){var o=s[a],l=this.appointmentFiltering(o),c=this.element.querySelectorAll(".e-work-cells")[r];l.length>0&&(c.querySelector(".e-appointment-indicator")||c.appendChild(t.createElement("div",{className:"e-appointment-indicator"})),o.getTime()===w(new Date(this.monthAgendaDate.getTime())).getTime()&&this.onEventRender(l,o)),r++}this.parent.notify("events-loaded",{})},i.prototype.onCellClick=function(e){this.parent.quickPopup&&this.parent.quickPopup.quickPopupHide();var t=this.appointmentFiltering(e.startTime);this.onEventRender(t,e.startTime),this.parent.notify("events-loaded",{}),this.monthAgendaDate=new Date(""+e.startTime)},i.prototype.onEventRender=function(e,i){this.agendaBase=this.getAgendaBase();var n=this.element.querySelector(".e-appointment-wrap");if(P(n),0===this.parent.activeViewOptions.group.resources.length||this.parent.uiStateValues.isGroupAdaptive)if(e.length>0){var r=t.createElement("div",{className:Ze});n.appendChild(this.agendaBase.createAgendaContentElement("data",e,r))}else this.appendAppContainer(n);else if(e.length>0){var a=this.createTableLayout(),s=a.querySelector("tbody");this.agendaBase.calculateResourceTableElement(s,1,i),a.appendChild(s),n.appendChild(a)}else this.appendAppContainer(n);this.agendaBase.wireEventActions()},i.prototype.appointmentFiltering=function(e){var t=w(new Date(e.getTime())),i=T(new Date(t.getTime()),We);return this.parent.eventBase.filterEvents(t,i)},i.prototype.clearElements=function(){for(var e=0,i=[].slice.call(this.element.querySelectorAll(".e-appointment-indicator"));e<i.length;e++){var n=i[e];t.remove(n)}this.appendAppContainer(this.element.querySelector(".e-appointment-wrap"))},i.prototype.appendAppContainer=function(e){var i=t.createElement("div",{className:Ze});t.addClass([i],"e-no-event"),i.innerHTML=this.parent.localeObj.getConstant("noEvents"),P(e),e.appendChild(i)},i.prototype.getNextPreviousDate=function(e){var t=this.parent.selectedDate,i="next"===e?this.parent.activeViewOptions.interval:-this.parent.activeViewOptions.interval,n=O(this.parent.selectedDate,i),r="next"===e?2:0,a=new Date(t.getFullYear(),t.getMonth()+r,0).getDate(),s=a>=this.monthAgendaDate.getDate()?this.monthAgendaDate.getDate():a;return this.monthAgendaDate=new Date(n.getFullYear(),n.getMonth(),s),this.monthAgendaDate},i.prototype.getAgendaBase=function(){return this.agendaBase||new sn(this.parent)},i.prototype.destroy=function(){this.agendaBase&&(this.agendaBase.destroy(),this.agendaBase=null),e.prototype.destroy.call(this)},i}(tn),hn=function(){function e(e,t){this.parent=e,this.renderDates=t}return e.prototype.groupByYear=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i],a=r.getFullYear();t[a]=t[a]||[],t[a].push(r)}return t},e.prototype.groupByMonth=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i],a=12*(r.getFullYear()-1970)+r.getMonth();t[a]=t[a]||[],t[a].push(r)}return t},e.prototype.groupByWeek=function(e){for(var t={},i=0,n=e;i<n.length;i++){var r=n[i],a=+new Date(1970,0,1),s=r.getTimezoneOffset()-new Date(1970,0,1).getTimezoneOffset(),o=Math.ceil(((+r-a-60*s*1e3)/We+new Date(a).getDay()+1)/7);this.parent.firstDayOfWeek&&this.parent.firstDayOfWeek>new Date(+r).getDay()&&(o-=1),t[o]=t[o]||[],t[o].push(r)}return t},e.prototype.generateSlots=function(e,i,n,r,a){for(var s=this,o=function(e,t){return s.parent.globalize.formatDate(e,{format:t,calendar:s.parent.getCalendarMode()})},l=[],c=Object.keys(e),p=0;p<c.length;p++){var h=e[c[p]],d=void 0;if(n.template){var u={date:h[0],type:a},v=this.parent.element.id+"_headerRowTemplate";d=[].slice.call(this.parent.templateParser(n.template)(u,this.parent,"template",v,!1))}else{var m=void 0;switch(n.option){case"Year":m='<span class="e-header-year">'+o(h[0],"y")+"</span>";break;case"Month":m='<span class="e-header-month">'+L(o(h[0],"MMMM"),"single")+"</span>";break;case"Week":m='<span class="e-header-week">'+this.parent.getWeekNumberContent(h)+"</span>"}var g=t.createElement("div",{innerHTML:m});d=[].slice.call(g.childNodes)}l.push({date:h[0],type:a,className:[r],colSpan:h.length*i,template:d})}return l},e.prototype.generateColumnLevels=function(e,t){var i=[],n=this.parent.activeViewOptions.headerRows,r=1;"Hour"===n[n.length-1].option&&t.length>0&&(r=t.length/e.length);for(var a,s,o,l=[],c=0,p=n;c<p.length;c++){var h=p[c];switch(h.option){case"Year":a=this.groupByYear(this.renderDates),l=this.generateSlots(a,r,h,"e-header-year-cell","yearHeader"),i.push(l);break;case"Month":s=this.groupByMonth(this.renderDates),l=this.generateSlots(s,r,h,"e-header-month-cell","monthHeader"),i.push(l);break;case"Week":o=this.groupByWeek(this.renderDates),l=this.generateSlots(o,r,h,"e-header-week-cell","weekHeader"),i.push(l);break;case"Date":l=(l=e).map(function(e){return e.colSpan=r,e}),i.push(l);break;case"Hour":t.length>0&&i.push(t)}}return i},e}(),dn=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),un=function(e){function i(t){var i=e.call(this,t)||this;return i.timelineAppointment=null,i.baseCssClass="e-timeline-view",i}return dn(i,e),i.prototype.getModuleName=function(){return"timelineViews"},i.prototype.getLeftPanelElement=function(){return this.element.querySelector(".e-resource-column-wrap")},i.prototype.scrollTopPanel=function(t){e.prototype.scrollTopPanel.call(this,t),this.scrollHeaderLabels(t)},i.prototype.scrollToWorkHour=function(){var e=this.parent.getStartEndTime(this.parent.workHours.start),i=this.isWorkDay(this.parent.selectedDate)&&this.parent.workHours.highlight&&!t.isNullOrUndefined(e)?new Date(+this.parent.selectedDate).setHours(e.getHours(),e.getMinutes(),0,0):new Date(+this.parent.selectedDate).setHours(0,0,0,0),n='[data-date="'+new Date(i).getTime().toString()+'"]',r=this.element.querySelector(n);r&&(this.getContentAreaElement().scrollLeft=this.parent.enableRtl?-(this.parent.getContentTable().offsetWidth-r.offsetLeft-r.offsetWidth):r.offsetLeft)},i.prototype.scrollToHour=function(e,i){var n,r;if(i&&(r=this.parent.getIndexOfDate(this.renderDates,w(i)))>=0){var a=e.split(":");2===a.length&&(n=new Date(i.setHours(parseInt(a[0],10),parseInt(a[1],10),0)))}if(n=t.isNullOrUndefined(i)?this.parent.getStartEndTime(e):n,!t.isNullOrUndefined(n)){var s=t.isNullOrUndefined(i)?this.getLeftFromDateTime(null,n):this.getLeftFromDateTime([r],n);this.getScrollableElement().scrollLeft=this.parent.enableRtl?-s:s}},i.prototype.generateColumnLevels=function(){var e=[],t=this.getDateSlots(this.renderDates,this.parent.activeViewOptions.workDays);e.push(t),this.parent.activeViewOptions.group.resources.length>0&&this.parent.resourceBase.generateResourceLevels(t,!this.parent.uiStateValues.isGroupAdaptive);var i=[];return this.parent.activeViewOptions.timeScale.enable&&(i=this.generateTimeSlots(e[e.length-1]),e.push(i)),this.parent.activeViewOptions.headerRows.length>0&&(e=new hn(this.parent,this.renderDates).generateColumnLevels(t,i)),e},i.prototype.generateTimeSlots=function(e){for(var i=this,n=function(e){return e.type=e.first?"majorSlot":"minorSlot",e.className=e.first?["e-time-slots"]:["e-time-slots","e-time-cells"],e.workDays=i.parent.activeViewOptions.workDays,e},r=this.getTimeSlotRows(n),a=[],s=0,o=e;s<o.length;s++){var l=o[s];l.colSpan=r.length;for(var c=0,p=t.extend([],r,null,!0);c<p.length;c++){var h=p[c],d=w(new Date(""+l.date));h.date=T(d,D(h.date)),a.push(h)}}return a},i.prototype.changeCurrentTimePosition=function(){if(!(!this.parent||this.parent&&this.parent.isDestroyed)){this.removeCurrentTimeIndicatorElements();var e=this.getCurrentTimeIndicatorIndex(),i=this.getLeftFromDateTime(e,this.parent.getCurrentTime()),n=this.element.querySelector("."+Qe).offsetHeight,r=this.element.querySelector(".e-date-header-wrap");if(this.element.querySelector(".e-content-wrap").appendChild(t.createElement("div",{className:"e-current-timeline",styles:(this.parent.enableRtl?"right":"left")+":"+t.formatUnit(i)+"; height:"+t.formatUnit(n)})),this.parent.virtualScrollModule){var a=this.parent.element.querySelector(".e-current-timeline"),s=this.parent.element.querySelector(".e-content-wrap table");t.setStyleAttribute(a,{transform:s.style.transform})}var o=t.createElement("div",{innerHTML:this.parent.getTimeString(this.parent.getCurrentTime()),className:"e-current-time"});r.appendChild(o),o.style[this.parent.enableRtl?"right":"left"]=t.formatUnit(i-o.offsetWidth/2)}},i.prototype.getLeftFromDateTime=function(e,i){var n=this.getStartHour(),r=this.getEndHour(),a=0,s=60*(i.getHours()-n.getHours())+(i.getMinutes()-n.getMinutes());if(!t.isNullOrUndefined(e)){var o=0===r.getHours()?24:r.getHours();0!==e[0]&&(a=e[0]*(60*(o-n.getHours()))+(r.getMinutes()-n.getMinutes())),s=a+s}return s*this.getWorkCellWidth()*this.parent.activeViewOptions.timeScale.slotCount/this.parent.activeViewOptions.timeScale.interval},i.prototype.getWorkCellWidth=function(){return this.element.querySelector(".e-work-cells").getBoundingClientRect().width},i.prototype.renderHeader=function(){var e=t.createElement("tr");this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.renderResourceHeaderIndent(e);var i=t.createElement("td");i.appendChild(this.renderDatesHeader()),e.appendChild(i),t.prepend([e],this.element.querySelector("tbody"))},i.prototype.createAllDayRow=function(e,t){},i.prototype.getCurrentTimeIndicatorIndex=function(){var e=[],t=this.parent.getIndexOfDate(this.renderDates,w(this.parent.getCurrentTime()));return t>=0&&e.push(t),e},i.prototype.renderContent=function(){var e=t.createElement("tr");if(this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive){var i=t.createElement("td");i.appendChild(this.parent.resourceBase.createResourceColumn()),e.appendChild(i)}var n=t.createElement("td"),r=this.renderContentArea();r.appendChild(this.createEventTable(this.getRowCount())),this.collapseRows(r),n.appendChild(r),e.appendChild(n),this.parent.virtualScrollModule&&this.parent.virtualScrollModule.renderVirtualTrack(r),this.element.querySelector("tbody").appendChild(e)},i.prototype.getRowCount=function(){return this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive?this.parent.resourceBase.renderedResources.length:1},i.prototype.getResourceTdData=function(e,t){var i=this.parent.resourceBase.renderedResources[e],n=i.resourceData[i.resource.startHourField]||this.parent.workHours.start,r=i.resourceData[i.resource.endHourField]||this.parent.workHours.end;return t.startHour=this.parent.getStartEndTime(n),t.endHour=this.parent.getStartEndTime(r),t.workDays=i.resourceData[i.resource.workDaysField]||this.parent.workDays,t.className=i.className,t.groupIndex=i.groupIndex,t.groupOrder=i.groupOrder,t},i.prototype.renderContentTable=function(e){var i=e.querySelector("tbody");t.append(this.getContentRows(),i)},i.prototype.getContentRows=function(){for(var e=[],i=t.createElement("tr",{attrs:{role:"row"}}),n=t.createElement("td",{attrs:{role:"gridcell","aria-selected":"false"}}),r=this.getRowCount(),a=0;a<r;a++){for(var s=i.cloneNode(),o=0,l=this.colLevels[this.colLevels.length-1];o<l.length;o++){var c=l[o];this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(c=this.getResourceTdData(a,c));var p=this.createContentTd(c,c,n);s.appendChild(p)}e.push(s)}return e},i.prototype.getContentTdClass=function(e){return e.first||!this.parent.activeViewOptions.timeScale.enable?["e-work-cells"]:["e-work-cells","e-alternate-cells"]},i.prototype.renderEvents=function(){this.timelineAppointment=new Pt(this.parent,this.parent.activeViewOptions.timeScale.enable?"hour":"day"),this.timelineAppointment.renderAppointments(),this.parent.notify("events-loaded",{})},i.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||(this.timelineAppointment&&(this.timelineAppointment.destroy(),this.timelineAppointment=null),e.prototype.destroy.call(this))},i}(Gi),vn=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),mn=function(e){function i(t){var i=e.call(this,t)||this;return i.viewClass="e-timeline-month-view",i.isInverseTableSelect=!0,i.appointment=null,i}return vn(i,e),i.prototype.getModuleName=function(){return"timelineMonth"},i.prototype.onDataReady=function(){this.appointment=new Pt(this.parent,"day"),this.appointment.renderAppointments(),this.parent.notify("events-loaded",{})},i.prototype.getLeftPanelElement=function(){return this.element.querySelector(".e-resource-column-wrap")},i.prototype.scrollTopPanel=function(t){e.prototype.scrollTopPanel.call(this,t),this.scrollHeaderLabels(t)},i.prototype.setContentHeight=function(e,i,n){i&&(i.style.height=t.formatUnit(n-this.getScrollXIndent(e))),e.style.height=t.formatUnit(n)},i.prototype.getDateSlots=function(e,t){for(var i=[],n=0,r=e;n<r.length;n++){var a=r[n],s=["e-header-cells"];this.isCurrentDate(a)&&s.push("e-current-day"),i.push({date:a,type:"dateHeader",className:s,colSpan:1,workDays:t})}return i},i.prototype.renderLeftIndent=function(e){this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&this.parent.resourceBase.renderResourceHeaderIndent(e)},i.prototype.renderContent=function(){var e=t.createElement("tr");if(this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive){var i=t.createElement("td");i.appendChild(this.parent.resourceBase.createResourceColumn()),e.appendChild(i)}var n=t.createElement("td");this.element.querySelector("tbody").appendChild(e);var r=t.createElement("div",{className:"e-content-wrap"});r.appendChild(this.renderContentArea()),r.appendChild(this.createEventTable(this.getRowCount())),this.collapseRows(r),t.EventHandler.add(r,"scroll",this.onContentScroll,this),n.appendChild(r),this.parent.virtualScrollModule&&this.parent.virtualScrollModule.renderVirtualTrack(r),e.appendChild(n)},i.prototype.getRowCount=function(){return this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive?this.parent.resourceBase.renderedResources.length:1},i.prototype.getContentSlots=function(){for(var e=[],t=0;t<this.getRowCount();t++)for(var i=0,n=this.colLevels[this.colLevels.length-1];i<n.length;i++){var r=n[i];if(r.className=["e-work-cells"],this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive){var a=this.parent.resourceBase.renderedResources[t];r.workDays=a.resourceData[a.resource.workDaysField]||this.parent.workDays,r.className=r.className.concat(a.className),r.groupIndex=a.groupIndex,r.groupOrder=a.groupOrder}var s={date:new Date(+r.date),colSpan:r.colSpan,groupIndex:r.groupIndex,workDays:r.workDays,type:"monthCells",className:r.className};e[t]||(e[t]=[]),e[t].push(s)}return e},i.prototype.updateClassList=function(e){this.parent.isMinMaxDate(e.date)||e.className.push("e-disable-dates")},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.getContentAreaElement(),"scroll",this.onContentScroll)},i.prototype.getMonthStart=function(e){var t=this.parent.calendarUtil.firstDateOfMonth(w(e));return new Date(t.getFullYear(),t.getMonth(),t.getDate())},i.prototype.getMonthEnd=function(e){var t=this.parent.calendarUtil.firstDateOfMonth(w(e));return this.parent.calendarUtil.lastDateOfMonth(O(new Date(+t),this.parent.activeViewOptions.interval-1))},i.prototype.generateColumnLevels=function(){var e=[],t=this.getDateSlots(this.renderDates,this.parent.activeViewOptions.workDays);e.push(t),this.parent.activeViewOptions.group.resources.length>0&&this.parent.resourceBase.generateResourceLevels(t,!this.parent.uiStateValues.isGroupAdaptive);var i=[];return this.parent.activeViewOptions.headerRows.length>0&&(e=new hn(this.parent,this.renderDates).generateColumnLevels(t,i)),this.colLevels=e,e},i.prototype.destroy=function(){if(!(!this.parent||this.parent&&this.parent.isDestroyed)){if(this.element){var i=this.element.querySelector(".e-content-wrap");i&&t.EventHandler.remove(i,"scroll",this.onContentScroll)}this.appointment&&(this.appointment.destroy(),this.appointment=null),e.prototype.destroy.call(this)}},i}(tn),gn=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),fn=function(e){function i(t){var i=e.call(this,t)||this;return i.viewClass="e-timeline-year-view",i.isInverseTableSelect=!0,i}return gn(i,e),i.prototype.getModuleName=function(){return"timelineYear"},i.prototype.renderHeader=function(e){var i=t.createElement("tr");if(e.appendChild(i),"Vertical"===this.parent.activeViewOptions.orientation&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive)this.parent.resourceBase.renderResourceHeaderIndent(i);else{var n=t.createElement("td",{className:"e-left-indent"});i.appendChild(n),n.appendChild(this.renderResourceHeader("e-left-indent-wrap"))}var r="Horizontal"===this.parent.activeViewOptions.orientation,a=this.parent.activeViewOptions.group.resources.length>0;this.isInverseTableSelect=!(r&&!a);var s=t.createElement("td");i.appendChild(s);var o=t.createElement("div",{className:"e-date-header-container"});if(s.appendChild(o),"Horizontal"===this.parent.activeViewOptions.orientation&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive)o.appendChild(this.renderResourceHeader("e-date-header-wrap")),this.columnCount=this.colLevels.slice(-1)[0].length;else{var l=t.createElement("div",{className:"e-date-header-wrap"});o.appendChild(l);var c=this.createTableLayout();l.appendChild(c),c.appendChild(this.createTableColGroup(this.columnCount));var p=t.createElement("tr");c.querySelector("tbody").appendChild(p);for(var h=this.getMonths(),d=this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(),h[0],1)),u=0;u<this.columnCount;u++){var v=new Date(this.parent.selectedDate.getFullYear(),h[u],1),m=t.createElement("td",{className:"e-header-cells"});"Horizontal"===this.parent.activeViewOptions.orientation?this.parent.dayHeaderTemplate?t.append(this.renderDayMonthHeaderTemplate(d[u],u,"dayHeaderTemplate"),m):m.innerHTML="<span>"+this.parent.getDayNames("abbreviated")[u%7]+"</span>":(this.parent.monthHeaderTemplate?t.append(this.renderDayMonthHeaderTemplate(v,h[u],"monthHeaderTemplate"),m):m.innerHTML="<span>"+this.getMonthName(v)+"</span>",m.setAttribute("data-date",v.getTime().toString())),p.appendChild(m),this.parent.trigger(Le,{elementType:"headerCells",element:m})}}},i.prototype.renderResourceHeader=function(e){var i=t.createElement("div",{className:e}),n=this.createTableLayout();i.appendChild(n);var r=t.createElement("tr");if(this.parent.activeViewOptions.group.resources.length>0)this.colLevels=this.generateColumnLevels();else{var a=[{className:["e-header-cells"],type:"headerCell"}];this.colLevels=[a]}for(var s=0,o=this.colLevels;s<o.length;s++){for(var l=o[s],c=r.cloneNode(),p=0,h="e-date-header-wrap"===e?l:[l[0]];p<h.length;p++){var d=h[p],u=t.createElement("td");d.className&&t.addClass([u],d.className),"e-date-header-wrap"===e&&(d.template&&t.append(d.template,u),d.colSpan&&u.setAttribute("colspan",d.colSpan.toString()),d.groupIndex>-1&&u.setAttribute("data-group-index",d.groupIndex.toString()),this.setResourceHeaderContent(u,d)),"e-left-indent-wrap"===e&&this.parent.renderHeaderIndentTemplate(d,u);var v={elementType:d.type,element:u,date:d.date,groupIndex:d.groupIndex};this.parent.trigger(Le,v),c.appendChild(u)}n.querySelector("tbody").appendChild(c)}return"e-date-header-wrap"===e&&n.appendChild(this.createTableColGroup(this.colLevels.slice(-1)[0].length)),i},i.prototype.renderContent=function(e){var i=t.createElement("tr");e.appendChild(i);var n,r=t.createElement("td"),a=t.createElement("td"),s=[];if("Vertical"===this.parent.activeViewOptions.orientation&&this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive)s.push(r),r.appendChild(this.parent.resourceBase.createResourceColumn()),this.rowCount=this.parent.resourceBase.lastResourceLevel.length;else{s.push(r);var o=t.createElement("div",{className:"e-month-header-wrapper"});r.appendChild(o),o.appendChild(this.createTableLayout()),n=o.querySelector("tbody")}s.push(a),t.append(s,i);var l=t.createElement("div",{className:"e-content-wrap"});a.appendChild(l);var c=this.createTableLayout(Qe);l.appendChild(c);var p=t.createElement("div",{className:"e-event-table"});l.appendChild(p);var h=c.querySelector("tbody");if(this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive){if(this.parent.rowAutoHeight){var d=[c],u=this.parent.element.querySelector(".e-month-header-wrapper .e-schedule-table");u&&d.push(u),t.addClass(d,"e-auto-height")}var v="Horizontal"===this.parent.activeViewOptions.orientation?this.colLevels.slice(-1)[0].length:this.columnCount;c.appendChild(this.createTableColGroup(v)),this.renderResourceContent(p,n,h)}else c.appendChild(this.createTableColGroup(this.columnCount)),this.renderDefaultContent(p,n,h)},i.prototype.renderDefaultContent=function(e,i,n){for(var r=this.getMonths(),a=this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(),r[0],1)),s=0;s<this.rowCount;s++){e.appendChild(t.createElement("div",{className:Ze}));var o=new Date(this.parent.selectedDate.getFullYear(),r[s],1),l=this.parent.calendarUtil.getMonthStartDate(new Date(o.getTime())),c=this.parent.calendarUtil.getMonthEndDate(new Date(o.getTime())),p=t.createElement("tr",{attrs:{role:"row"}}),h=p.cloneNode();i.appendChild(h);var d=p.cloneNode();n.appendChild(d);var u=t.createElement("td",{className:"e-month-header",attrs:{role:"gridcell"}});"Horizontal"===this.parent.activeViewOptions.orientation?(this.parent.monthHeaderTemplate?t.append(this.renderDayMonthHeaderTemplate(l,s,"monthHeaderTemplate"),u):u.innerHTML="<span>"+this.getMonthName(o)+"</span>",u.setAttribute("data-date",o.getTime().toString())):this.parent.dayHeaderTemplate?t.append(this.renderDayMonthHeaderTemplate(a[s],s,"dayHeaderTemplate"),u):u.innerHTML="<span>"+this.parent.getDayNames("abbreviated")[s%7]+"</span>",h.appendChild(u),this.parent.trigger(Le,{elementType:"leftHeaderCells",element:u});for(var v=new Date(l.getTime()),m=0;m<this.columnCount;m++){var g=void 0;if("Vertical"===this.parent.activeViewOptions.orientation){o=new Date(this.parent.selectedDate.getFullYear(),r[m],1),l=this.parent.calendarUtil.getMonthStartDate(new Date(o.getTime())),c=this.parent.calendarUtil.getMonthEndDate(new Date(o.getTime()));var f=s-l.getDay()+1;v=new Date(this.parent.selectedDate.getFullYear(),r[m],f),g=f>0&&v.getTime()<c.getTime()}else g=m>=l.getDay()&&v.getTime()<c.getTime();var y=t.createElement("td",{className:"e-work-cells",attrs:{role:"gridcell","aria-selected":"false"}});d.appendChild(y);var T=t.createElement("div",{className:"e-date-header e-navigate",innerHTML:g?this.parent.globalize.formatDate(v,{skeleton:"d",calendar:this.parent.getCalendarMode()}):""}),w=this.parent.globalize.formatDate(v,{skeleton:"full",calendar:this.parent.getCalendarMode()});if(T.setAttribute("aria-label",w),g){var D=[y],b=[];this.parent.activeViewOptions.workDays.indexOf(v.getDay())>-1&&b.push("e-work-days"),this.isCurrentDate(v)&&(b.push("e-current-day"),"Horizontal"===this.parent.activeViewOptions.orientation?D.push(this.element.querySelector(".e-header-cells:nth-child("+(m+1)+")")):D.push(this.element.querySelectorAll(".e-month-header").item(s))),b.length>0&&t.addClass(D,b)}else t.addClass([y],"e-other-month");y.appendChild(T),g&&(y.setAttribute("data-date",v.getTime().toString()),this.wireEvents(y,"cell")),this.renderCellTemplate({date:v,type:"workCells"},y),this.parent.trigger(Le,{elementType:"workCells",element:y,date:v}),g&&"Horizontal"===this.parent.activeViewOptions.orientation&&(v=C(new Date(v.getTime()),1))}}},i.prototype.renderResourceContent=function(e,i,n){for(var r=this.getMonths(),a=0;a<this.rowCount;a++){e.appendChild(t.createElement("div",{className:Ze}));var s=t.createElement("tr",{attrs:{role:"row"}});n.appendChild(s);var o=void 0;this.parent.activeViewOptions.group.resources.length>0&&!this.parent.uiStateValues.isGroupAdaptive&&(o=this.parent.resourceBase.lastResourceLevel[a]);var l=new Date(this.parent.selectedDate.getFullYear(),r[a],1),c=this.parent.calendarUtil.getMonthStartDate(new Date(l.getTime()));if("Horizontal"===this.parent.activeViewOptions.orientation){var p=s.cloneNode();i.appendChild(p);var h=t.createElement("td",{className:"e-month-header",attrs:{role:"gridcell","data-date":c.getTime().toString()}});this.parent.monthHeaderTemplate?t.append(this.renderDayMonthHeaderTemplate(l,a,"monthHeaderTemplate"),h):h.innerHTML="<span>"+this.getMonthName(l)+"</span>",p.appendChild(h)}for(var d=0;d<this.columnCount;d++){var u=[],v=a;"Vertical"===this.parent.activeViewOptions.orientation?((u=u.concat(o.className)).indexOf("e-parent-node")>-1?u.push("e-resource-group-cells"):u.push("e-work-days"),l=new Date(this.parent.selectedDate.getFullYear(),r[d],1),c=this.parent.calendarUtil.getMonthStartDate(new Date(l.getTime()))):(v=this.colLevels.slice(-1)[0][d].groupIndex,u.push("e-work-days"));var m=t.createElement("td",{className:"e-work-cells",attrs:{role:"gridcell","aria-selected":"false","data-date":c.getTime().toString()}});t.addClass([m],u),m.setAttribute("data-group-index",v.toString()),this.renderCellTemplate({date:c,type:"resourceGroupCells",groupIndex:v},m),this.wireEvents(m,"cell"),s.appendChild(m),this.parent.trigger(Le,{elementType:"resourceGroupCells",element:m,date:c})}}"Vertical"===this.parent.activeViewOptions.orientation&&this.collapseRows(this.parent.element.querySelector(".e-content-wrap"))},i.prototype.renderDayMonthHeaderTemplate=function(e,t,i){var n={date:e,type:"dayHeaderTemplate"===i?"dayHeader":"monthHeader"},r="schedule_"+this.parent.activeViewOptions.dayHeaderTemplateName+"dayHeaderTemplate",a="schedule_"+this.parent.activeViewOptions.dayHeaderTemplateName+"monthHeaderTemplate";return"dayHeaderTemplate"===i?(n.day=this.parent.getDayNames("wide")[t%7],[].slice.call(this.parent.getDayHeaderTemplate()(n,this.parent,"dayHeaderTemplate",r,!1))):[].slice.call(this.parent.getMonthHeaderTemplate()(n,this.parent,"monthHeaderTemplate",a,!1))},i.prototype.renderCellTemplate=function(e,i){if(this.parent.activeViewOptions.cellTemplate&&!i.classList.contains("e-other-month")){var n={date:e.date,type:e.type};e.groupIndex&&(n.groupIndex=e.groupIndex);var r=this.parent.element.id+"_"+this.parent.activeViewOptions.cellTemplateName+"cellTemplate",a=[].slice.call(this.parent.getCellTemplate()(n,this.parent,"cellTemplate",r,!1));t.append(a,i)}},i.prototype.scrollToDate=function(e){if(0===this.parent.activeViewOptions.group.resources.length){var t=+new Date(w(e)),i=this.element.querySelector('[data-date="'+t+'"]');i&&(this.getScrollableElement().scrollLeft=i.offsetLeft,this.getScrollableElement().scrollTop=i.offsetTop)}},i.prototype.getScrollableElement=function(){return this.parent.isAdaptive&&!this.isTimelineView()?this.element.querySelector(".e-scroll-container"):this.getContentAreaElement()},i}(rn),yn=function(){function e(e){this.parent=e}return e.prototype.initializeCalendarExport=function(e,i){var n=this,r=i||t.extend([],this.parent.eventsData,null,!0);r=this.parent.eventBase.sortByTime(r);var a=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",s=[],o=[],l=this.parent.timezone||this.parent.tzModule.getLocalTimezoneName(),c=this.parent.eventFields;r.forEach(function(e){var i=n.parent.eventBase.generateGuid(),p=[];if(e[c.recurrenceID]&&(i=n.filterEvents(o,c.id,e[c.recurrenceID])[0].UID),!e[c.recurrenceID]&&e[c.recurrenceRule]&&e[c.recurrenceException]){g=e[c.recurrenceException].split(",");n.filterEvents(r,c.recurrenceID,e[c.id]).forEach(function(e){p.push(Me(e[c.startTime]))});var h=g.filter(function(e){return-1===p.indexOf(e)});e[c.recurrenceException]=h.length>0?h.join(",")+",":""}var d=e[c.startTimezone]||l,u=e[c.endTimezone]||l,v=!!e[c.isReadonly]&&e[c.isReadonly],m=["BEGIN:VEVENT","LOCATION:"+(e[c.location]||""),"SUMMARY:"+(e[c.subject]||""),"UID:"+i,"DESCRIPTION:"+(e[c.description]||""),"ISREADONLY:"+v,"END:VEVENT"];if(e[c.isAllDay]?(m.splice(4,0,"DTEND;VALUE=DATE:"+n.convertDateToString(e[c.endTime],!0)),m.splice(4,0,"DTSTART;VALUE=DATE:"+n.convertDateToString(e[c.startTime],!0))):e[c.isAllDay]||e[c.recurrenceRule]?(m.splice(4,0,'DTEND;TZID="'+u+'":'+n.convertDateToString(e[c.endTime])),m.splice(4,0,'DTSTART;TZID="'+d+'":'+n.convertDateToString(e[c.startTime]))):(m.splice(4,0,"DTEND:"+n.convertDateToString(e[c.endTime])),m.splice(4,0,"DTSTART:"+n.convertDateToString(e[c.startTime]))),e[c.recurrenceRule]&&m.splice(4,0,"RRULE:"+e[c.recurrenceRule]),e[c.recurrenceException])for(var g=e[c.recurrenceException].split(","),f=0;f<g.length-1;f++)m.splice(5,0,"EXDATE:"+n.convertDateToString(B(g[f]),e[c.isAllDay]));e[c.recurrenceID]&&m.splice(4,0,'RECURRENCE-ID;TZID="'+d+'":'+n.convertDateToString(e[c.startTime],e[c.isAllDay]));var y=n.customFieldFilter(e,c);y.length>0&&y.forEach(function(t){return m.splice(4,0,t+":"+(e[t]||""))});var T=t.extend({},e);T.UID=i,o.push(T),s.push(m.join(a))});var p=["BEGIN:VCALENDAR","PRODID:-//Syncfusion Inc//Scheduler//EN","VERSION:2.0","CALSCALE:GREGORIAN","METHOD:PUBLISH","X-WR-CALNAME:"+(e||"Calendar"),"X-WR-TIMEZONE:"+l].join(a)+a+s.join(a)+a+"END:VCALENDAR";this.download(p,e)},e.prototype.customFieldFilter=function(e,t){var i=Object.keys(t).map(function(e){return t[e]});return Object.keys(e).filter(function(e){return-1===i.indexOf(e)&&"Guid"!==e})},e.prototype.convertDateToString=function(e,t){var i=("0000"+e.getFullYear().toString()).slice(-4),n=("00"+(e.getMonth()+1).toString()).slice(-2),r=("00"+e.getDate().toString()).slice(-2),a=("00"+e.getHours().toString()).slice(-2),s=("00"+e.getMinutes().toString()).slice(-2),o=("00"+e.getSeconds().toString()).slice(-2);return t?i+n+r:i+n+r+"T"+a+s+o},e.prototype.download=function(e,t){var i=new Blob([e],{type:"data:text/calendar;charset=utf8"});if(t=(t||"Calendar")+".ics",navigator.msSaveBlob)navigator.msSaveBlob(i,t);else{var n=document.createElementNS("http://www.w3.org/1999/xhtml","a");n.download=t,n.href=URL.createObjectURL(i);var r=document.createEvent("MouseEvent");r.initEvent("click",!0,!0),n.dispatchEvent(r),setTimeout(function(){URL.revokeObjectURL(n.href),n.href=void 0})}},e.prototype.filterEvents=function(e,t,i){return e.filter(function(e){return e[t]===i})},e.prototype.getModuleName=function(){return"iCalendarExport"},e.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed||(this.parent=null)},e}(),Tn=function(){function e(e){this.allDay=!1,this.parent=e}return e.prototype.initializeCalendarImport=function(e){var t=this;if(e&&e instanceof Blob){var i=new FileReader;i.onload=function(){var e=i.result;t.iCalendarParser(e)},i.readAsText(e,"UTF-8")}else e&&"string"==typeof e&&this.iCalendarParser(e)},e.prototype.iCalendarParser=function(e){var i,n=this,r=this.parent.eventFields,a=[],s=e.replace(new RegExp("\\r","g"),"").split("\n"),o=!1,l=this.parent.eventBase.getEventMaxID(),c=0;s.forEach(function(e){var s,p,h;if(o||"BEGIN:VEVENT"!==e||(o=!0,i={}),o&&"END:VEVENT"===e&&(o=!1,a.push(i),i=null),o)if(s=e.indexOf(":"),p=e.substr(0,s).replace(/^\s\s*/,"").replace(/\s\s*$/,""),h=e.substr(s+1,e.length-(s+1)).replace(/^\s\s*/,"").replace(/\s\s*$/,""),-1!==e.indexOf("SUMMARY")&&(p="SUMMARY"),-1!==e.indexOf("DTSTART"))i[r.startTime]=n.dateParsing(e),i[r.isAllDay]=n.allDay,n.allDay=!1;else if(-1!==e.indexOf("DTEND"))i[r.endTime]=n.dateParsing(e);else if(-1!==e.indexOf("EXDATE"))h=Me(n.dateParsing(e)),i[r.recurrenceException]=t.isNullOrUndefined(i[r.recurrenceException])?h:i[r.recurrenceException]+","+h;else if(-1!==e.indexOf("RECURRENCE-ID"))h=Me(n.dateParsing(e)),i[r.recurrenceException]=h,i[r.recurrenceID]=h;else switch(p){case"BEGIN":break;case"UID":i.UID=h,i[r.id]="string"==typeof l?l+c.toString():l+c,c++;break;case"SUMMARY":i[r.subject]=h;break;case"LOCATION":i[r.location]=h;break;case"DESCRIPTION":i[r.description]=h;break;case"ISREADONLY":i[r.isReadonly]=h.indexOf("true")>-1;break;case"RRULE":i[r.recurrenceRule]=h;break;default:if(n.parent.resourceCollection.length>0){var d=n.parent.resourceCollection.filter(function(e){return e.field===p});i[p]=d.length>0&&"number"==typeof d[0].dataSource[0][d[0].idField]?parseInt(h,10):h}else i[p]=h}});var p=t.extend([],a,null,!0);this.parent.addEvent(this.processOccurrence(p))},e.prototype.processOccurrence=function(e){var i=[],n=this.parent.eventFields;return e.forEach(function(r){var a,s;r.hasOwnProperty(n.recurrenceID)||(a=r,s=r[n.id]);var o=e.filter(function(e){return e.UID===r.UID});if(o.length>1&&t.isNullOrUndefined(r[n.recurrenceID])){for(var l=0;l<o.length;l++)if(o[l].hasOwnProperty(n.recurrenceID)){var c=o[l][n.recurrenceID];o[l][n.recurrenceID]=s,o[l][n.recurrenceException]=null,a[n.recurrenceException]=t.isNullOrUndefined(a[n.recurrenceException])?c:a[n.recurrenceException]+","+c,i.push(o[l])}i.push(a)}else r.hasOwnProperty(n.recurrenceID)||i.push(r)}),i},e.prototype.getDateString=function(e){return(e=e||"").replace(/\\\,/g,",").replace(/\\\;/g,";").replace(/\\[nN]/g,"\n").replace(/\\\\/g,"\\")},e.prototype.dateParsing=function(e){var t=e.match(/([^':;]+)((?:;(?:[^':;]+)(?:=(?:(?:'[^']*')|(?:[^':;]+))))*):(.*)/).slice(1),i=t[t.length-1],n=new Date(this.getDateString(i));if(e&&(e.indexOf("VALUE=DATE")>-1||e.indexOf("RECURRENCE-ID;TZID")>-1)){var r=/^(\d{4})(\d{2})(\d{2})$/.exec(i);null!==r&&(n=new Date(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10))),e.indexOf("DTSTART")>-1&&(this.allDay=!0)}var a=/^(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})(Z)?$/.exec(i);return null!==a&&(n="Z"===a[7]?new Date(Date.UTC(parseInt(a[1],10),parseInt(a[2],10)-1,parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5],10),parseInt(a[6],10))):new Date(parseInt(a[1],10),parseInt(a[2],10)-1,parseInt(a[3],10),parseInt(a[4],10),parseInt(a[5],10),parseInt(a[6],10))),n},e.prototype.getModuleName=function(){return"iCalendarImport"},e.prototype.destroy=function(){!this.parent||this.parent&&this.parent.isDestroyed},e}(),wn=function(){function e(e){this.parent=e}return e.prototype.initializeExcelExport=function(e){void 0===e&&(e={});var t,i=this.getExportColumns(e),n=e.fileName||"Schedule",r=e.exportType||"xlsx",a=e.includeOccurrences||!1;t=e.customData?a?this.parent.eventBase.getProcessedEvents(e.customData):e.customData:a?this.parent.eventsProcessed:this.parent.eventsData,this.processWorkbook(i,n,r,t)},e.prototype.processWorkbook=function(e,i,n,r){var a=this,s=[],o=[],l=[];e.forEach(function(e,t){s.push({index:t+1,width:"Id"===e.name?50:150})});var c={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};e.forEach(function(e,t){l.push({index:t+1,value:e.text,style:c})}),o.push({index:1,cells:l}),r.forEach(function(i,n){var r=[];e.forEach(function(e,n){var s={index:n+1,value:i[e.name]||""};if(e.name===a.parent.eventFields.startTime||e.name===a.parent.eventFields.endTime){var o={fontSize:12,numberFormat:"m/d/yyyy h:mm AM/PM"};s=t.extend({},s,{style:o},!0)}r.push(s)}),o.push({index:n+2,cells:r})});var h=[{columns:s,rows:o}];new p.Workbook({worksheets:h},n,this.parent.locale).save(i+"."+n)},e.prototype.getExportColumns=function(e){var t=this,i=e.fieldsInfo||[];return 0===i.length&&(e.fields||Object.keys(this.parent.eventFields).map(function(e){return t.parent.eventFields[e]})).forEach(function(e){i.push({name:e,text:e})}),i},e.prototype.getModuleName=function(){return"excelExport"},e.prototype.destroy=function(){this.parent=null},e}(),Dn=function(){function e(e){this.parent=e}return e.prototype.print=function(e){t.isNullOrUndefined(e)?this.printScheduler():this.printSchedulerWithModel(e)},e.prototype.printScheduler=function(){var e=this.parent.element.cloneNode(!0);e.id=this.parent.element.id+"_print",document.body.appendChild(e);for(var i="MonthAgenda"===this.parent.currentView?".e-appointment-wrap":".e-content-wrap",n=this.parent.element.querySelector(i),r="",a=0,s=[].slice.call(document.getElementsByTagName("head")[0].querySelectorAll("link, style"));a<s.length;a++)r+=s[a].outerHTML;var o=t.createElement("div");e.style.width=this.parent.element.offsetWidth+"px";var l=100*Math.round(parseInt(e.style.width,10)/100);o.appendChild(e);var c=window.open("","print","height=550,width="+l+",tabbar=no");c.document.write("<!DOCTYPE html><html><head>"+r+"</head><body>"+o.innerHTML+"<script>(function() { window.ready = true; })();<\/script></body></html>"),c.document.close(),c.focus(),setTimeout(function(){if(c.ready&&n){n.scrollLeft=n.scrollLeft,n.scrollTop=n.scrollTop;var e=c.document.querySelector(".e-date-header-wrap");e&&(e.scrollLeft=n.scrollLeft);var t=c.document.querySelector(".e-time-cells-wrap");t&&(t.scrollTop=n.scrollTop),c.print(),c.close()}},500)},e.prototype.printSchedulerWithModel=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_print",className:"e-print-schedule"});document.body.appendChild(i),qi.Inject(Qi,Zi,$i,tn,ln,pn,un,mn,rn,fn),this.printInstance=new qi(this.getPrintScheduleModel(e)),this.printInstance.isPrinting=!0,this.printInstance.appendTo(i),this.printInstance.on("print",this.contentReady,this),this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight)},e.prototype.getPrintScheduleModel=function(e){for(var i,n,r={},a=0,s=["agendaDaysCount","calendarMode","cssClass","currentView","dateFormat","enableRtl","endHour","eventSettings","firstDayOfWeek","firstMonthOfYear","group","height","locale","maxDate","minDate","readonly","resources","rowAutoHeight","selectedDate","showHeaderBar","showTimeIndicator","showWeekNumber","showWeekend","startHour","timeFormat","timeScale","timezone","views","width","workDays","workHours"];a<s.length;a++){var o=s[a];switch(o){case"eventSettings":(i=Object.assign({},this.parent.eventSettings.properties)).dataSource=this.parent.eventsData,i.template=null,r.eventSettings=i;break;case"group":(n=t.isNullOrUndefined(e.group)?this.parent.group:e.group).headerTooltipTemplate=null,r.group=n;break;default:r[o]=t.isNullOrUndefined(e[o])?this.parent[o]:e[o]}}return r},e.prototype.contentReady=function(){var e=this;this.printWindow=t.print(this.printInstance.element,this.printWindow),this.printWindow.onbeforeunload=function(){e.printInstance.off("print",e.contentReady),e.printInstance.element.remove(),e.printInstance.destroy(),e.printInstance=null,e.printWindow=null}},e.prototype.getModuleName=function(){return"print"},e.prototype.destroy=function(){this.parent=null},e}();return qi.Inject(Qi,Zi,$i,tn,rn,ln,pn,un,mn,fn,Fi,zi,wn,yn,Tn,Dn),e.Schedule=qi,e.cellClick="cellClick",e.cellDoubleClick="cellDoubleClick",e.moreEventsClick="moreEventsClick",e.select="select",e.hover="hover",e.actionBegin=qe,e.actionComplete="actionComplete",e.actionFailure="actionFailure",e.navigating="navigating",e.renderCell=Le,e.eventClick="eventClick",e.eventRendered="eventRendered",e.dataBinding="dataBinding",e.dataBound="dataBound",e.popupOpen="popupOpen",e.popupClose="popupClose",e.dragStart="dragStart",e.drag="drag",e.dragStop="dragStop",e.resizeStart="resizeStart",e.resizing="resizing",e.resizeStop="resizeStop",e.inlineClick=Ne,e.initialLoad="initial-load",e.initialEnd="initial-end",e.print="print",e.dataReady=Fe,e.eventsLoaded="events-loaded",e.contentReady=Ue,e.scroll="scroll",e.virtualScroll="virtual-scroll",e.scrollUiUpdate=Be,e.uiUpdate="ui-update",e.documentClick="document-click",e.cellMouseDown="cell-mouse-down",e.WEEK_LENGTH=7,e.DEFAULT_WEEKS=6,e.MS_PER_DAY=We,e.MS_PER_MINUTE=ze,e.getElementHeightFromClass=h,e.getTranslateY=d,e.getWeekFirstDate=u,e.getWeekLastDate=v,e.firstDateOfMonth=m,e.lastDateOfMonth=g,e.getWeekNumber=f,e.getWeekMiddleDate=y,e.setTime=T,e.resetTime=w,e.getDateInMs=D,e.getDateCount=b,e.addDays=C,e.addMonths=O,e.addYears=E,e.getStartEndHours=S,e.getMaxDays=x,e.getDaysCount=A,e.getDateFromString=V,e.getScrollBarWidth=k,e.findIndexInData=M,e.getOuterHeight=R,e.removeChildren=P,e.isDaylightSavingTime=I,e.getUniversalTime=H,e.isMobile=j,e.isIPadDevice=q,e.capitalizeFirstWord=L,e.Resize=Fi,e.DragAndDrop=zi,e.HeaderRenderer=tt,e.ViewBase=Yi,e.Day=Qi,e.Week=Zi,e.WorkWeek=$i,e.Month=tn,e.Year=rn,e.Agenda=ln,e.MonthAgenda=pn,e.TimelineViews=un,e.TimelineMonth=mn,e.TimelineYear=fn,e.Timezone=lt,e.timezoneData=ct,e.ICalendarExport=yn,e.ICalendarImport=Tn,e.ExcelExport=wn,e.Print=Dn,e.RecurrenceEditor=ti,e.generateSummary=N,e.generate=U,e.getDateFromRecurrenceDateString=B,e.extractObjectFromRule=we,e.getCalendarUtil=ke,e.getRecurrenceStringFromDate=Me,e.Gregorian=st,e.Islamic=ot,e}({},ej.base,ej.popups,ej.navigations,ej.calendars,ej.data,ej.buttons,ej.inputs,ej.dropdowns,ej.lists,ej.excelexport),this.ejs=ej;
//# sourceMappingURL=ej2-schedule.min.js.map
